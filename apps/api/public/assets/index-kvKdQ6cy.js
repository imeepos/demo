import{r as Ag,g as Pr,a as zD,c as x_}from"./vendor-c5ypKtDW.js";function Q7(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const i in n)if(i!=="default"&&!(i in e)){const a=Object.getOwnPropertyDescriptor(n,i);a&&Object.defineProperty(e,i,a.get?a:{enumerable:!0,get:()=>n[i]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const s of a.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&n(s)}).observe(document,{childList:!0,subtree:!0});function r(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=r(i);fetch(i.href,a)}})();var oE={exports:{}},yp={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lC;function J7(){if(lC)return yp;lC=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function r(n,i,a){var s=null;if(a!==void 0&&(s=""+a),i.key!==void 0&&(s=""+i.key),"key"in i){a={};for(var l in i)l!=="key"&&(a[l]=i[l])}else a=i;return i=a.ref,{$$typeof:e,type:n,key:s,ref:i!==void 0?i:null,props:a}}return yp.Fragment=t,yp.jsx=r,yp.jsxs=r,yp}var cC;function e8(){return cC||(cC=1,oE.exports=J7()),oE.exports}var ze=e8(),bg=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},t8={setTimeout:(e,t)=>setTimeout(e,t),clearTimeout:e=>clearTimeout(e),setInterval:(e,t)=>setInterval(e,t),clearInterval:e=>clearInterval(e)},r8=class{#e=t8;#t=!1;setTimeoutProvider(e){this.#e=e}setTimeout(e,t){return this.#e.setTimeout(e,t)}clearTimeout(e){this.#e.clearTimeout(e)}setInterval(e,t){return this.#e.setInterval(e,t)}clearInterval(e){this.#e.clearInterval(e)}},vb=new r8;function n8(e){setTimeout(e,0)}var xg=typeof window>"u"||"Deno"in globalThis;function xo(){}function i8(e,t){return typeof e=="function"?e(t):e}function a8(e){return typeof e=="number"&&e>=0&&e!==1/0}function o8(e,t){return Math.max(e+(t||0)-Date.now(),0)}function mb(e,t){return typeof e=="function"?e(t):e}function s8(e,t){return typeof e=="function"?e(t):e}function fC(e,t){const{type:r="all",exact:n,fetchStatus:i,predicate:a,queryKey:s,stale:l}=e;if(s){if(n){if(t.queryHash!==Ox(s,t.options))return!1}else if(!Av(t.queryKey,s))return!1}if(r!=="all"){const c=t.isActive();if(r==="active"&&!c||r==="inactive"&&c)return!1}return!(typeof l=="boolean"&&t.isStale()!==l||i&&i!==t.state.fetchStatus||a&&!a(t))}function dC(e,t){const{exact:r,status:n,predicate:i,mutationKey:a}=e;if(a){if(!t.options.mutationKey)return!1;if(r){if(Sv(t.options.mutationKey)!==Sv(a))return!1}else if(!Av(t.options.mutationKey,a))return!1}return!(n&&t.state.status!==n||i&&!i(t))}function Ox(e,t){return(t?.queryKeyHashFn||Sv)(e)}function Sv(e){return JSON.stringify(e,(t,r)=>_b(r)?Object.keys(r).sort().reduce((n,i)=>(n[i]=r[i],n),{}):r)}function Av(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(r=>Av(e[r],t[r])):!1}var u8=Object.prototype.hasOwnProperty;function jD(e,t){if(e===t)return e;const r=hC(e)&&hC(t);if(!r&&!(_b(e)&&_b(t)))return t;const i=(r?e:Object.keys(e)).length,a=r?t:Object.keys(t),s=a.length,l=r?new Array(s):{};let c=0;for(let d=0;d<s;d++){const p=r?d:a[d],h=e[p],m=t[p];if(h===m){l[p]=h,(r?d<i:u8.call(e,p))&&c++;continue}if(h===null||m===null||typeof h!="object"||typeof m!="object"){l[p]=m;continue}const _=jD(h,m);l[p]=_,_===h&&c++}return i===s&&c===i?e:l}function hC(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function _b(e){if(!pC(e))return!1;const t=e.constructor;if(t===void 0)return!0;const r=t.prototype;return!(!pC(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function pC(e){return Object.prototype.toString.call(e)==="[object Object]"}function l8(e){return new Promise(t=>{vb.setTimeout(t,e)})}function c8(e,t,r){return typeof r.structuralSharing=="function"?r.structuralSharing(e,t):r.structuralSharing!==!1?jD(e,t):t}function f8(e,t,r=0){const n=[...e,t];return r&&n.length>r?n.slice(1):n}function d8(e,t,r=0){const n=[t,...e];return r&&n.length>r?n.slice(0,-1):n}var Mx=Symbol();function HD(e,t){return!e.queryFn&&t?.initialPromise?()=>t.initialPromise:!e.queryFn||e.queryFn===Mx?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}var h8=class extends bg{#e;#t;#r;constructor(){super(),this.#r=e=>{if(!xg&&window.addEventListener){const t=()=>e();return window.addEventListener("visibilitychange",t,!1),()=>{window.removeEventListener("visibilitychange",t)}}}}onSubscribe(){this.#t||this.setEventListener(this.#r)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(e){this.#r=e,this.#t?.(),this.#t=e(t=>{typeof t=="boolean"?this.setFocused(t):this.onFocus()})}setFocused(e){this.#e!==e&&(this.#e=e,this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(t=>{t(e)})}isFocused(){return typeof this.#e=="boolean"?this.#e:globalThis.document?.visibilityState!=="hidden"}},VD=new h8;function p8(){let e,t;const r=new Promise((i,a)=>{e=i,t=a});r.status="pending",r.catch(()=>{});function n(i){Object.assign(r,i),delete r.resolve,delete r.reject}return r.resolve=i=>{n({status:"fulfilled",value:i}),e(i)},r.reject=i=>{n({status:"rejected",reason:i}),t(i)},r}var v8=n8;function m8(){let e=[],t=0,r=l=>{l()},n=l=>{l()},i=v8;const a=l=>{t?e.push(l):i(()=>{r(l)})},s=()=>{const l=e;e=[],l.length&&i(()=>{n(()=>{l.forEach(c=>{r(c)})})})};return{batch:l=>{let c;t++;try{c=l()}finally{t--,t||s()}return c},batchCalls:l=>(...c)=>{a(()=>{l(...c)})},schedule:a,setNotifyFunction:l=>{r=l},setBatchNotifyFunction:l=>{n=l},setScheduler:l=>{i=l}}}var Gi=m8(),_8=class extends bg{#e=!0;#t;#r;constructor(){super(),this.#r=e=>{if(!xg&&window.addEventListener){const t=()=>e(!0),r=()=>e(!1);return window.addEventListener("online",t,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",t),window.removeEventListener("offline",r)}}}}onSubscribe(){this.#t||this.setEventListener(this.#r)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(e){this.#r=e,this.#t?.(),this.#t=e(this.setOnline.bind(this))}setOnline(e){this.#e!==e&&(this.#e=e,this.listeners.forEach(r=>{r(e)}))}isOnline(){return this.#e}},b0=new _8;function g8(e){return Math.min(1e3*2**e,3e4)}function XD(e){return(e??"online")==="online"?b0.isOnline():!0}var gb=class extends Error{constructor(e){super("CancelledError"),this.revert=e?.revert,this.silent=e?.silent}};function GD(e){let t=!1,r=0,n;const i=p8(),a=()=>i.status!=="pending",s=E=>{if(!a()){const T=new gb(E);m(T),e.onCancel?.(T)}},l=()=>{t=!0},c=()=>{t=!1},d=()=>VD.isFocused()&&(e.networkMode==="always"||b0.isOnline())&&e.canRun(),p=()=>XD(e.networkMode)&&e.canRun(),h=E=>{a()||(n?.(),i.resolve(E))},m=E=>{a()||(n?.(),i.reject(E))},_=()=>new Promise(E=>{n=T=>{(a()||d())&&E(T)},e.onPause?.()}).then(()=>{n=void 0,a()||e.onContinue?.()}),y=()=>{if(a())return;let E;const T=r===0?e.initialPromise:void 0;try{E=T??e.fn()}catch(A){E=Promise.reject(A)}Promise.resolve(E).then(h).catch(A=>{if(a())return;const b=e.retry??(xg?0:3),R=e.retryDelay??g8,M=typeof R=="function"?R(r,A):R,B=b===!0||typeof b=="number"&&r<b||typeof b=="function"&&b(r,A);if(t||!B){m(A);return}r++,e.onFail?.(r,A),l8(M).then(()=>d()?void 0:_()).then(()=>{t?m(A):y()})})};return{promise:i,status:()=>i.status,cancel:s,continue:()=>(n?.(),i),cancelRetry:l,continueRetry:c,canStart:p,start:()=>(p()?y():_().then(y),i)}}var qD=class{#e;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),a8(this.gcTime)&&(this.#e=vb.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(xg?1/0:300*1e3))}clearGcTimeout(){this.#e&&(vb.clearTimeout(this.#e),this.#e=void 0)}},y8=class extends qD{#e;#t;#r;#i;#n;#o;#s;constructor(e){super(),this.#s=!1,this.#o=e.defaultOptions,this.setOptions(e.options),this.observers=[],this.#i=e.client,this.#r=this.#i.getQueryCache(),this.queryKey=e.queryKey,this.queryHash=e.queryHash,this.#e=vC(this.options),this.state=e.state??this.#e,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#n?.promise}setOptions(e){if(this.options={...this.#o,...e},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const t=vC(this.options);t.data!==void 0&&(this.setData(t.data,{updatedAt:t.dataUpdatedAt,manual:!0}),this.#e=t)}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.#r.remove(this)}setData(e,t){const r=c8(this.state.data,e,this.options);return this.#a({data:r,type:"success",dataUpdatedAt:t?.updatedAt,manual:t?.manual}),r}setState(e,t){this.#a({type:"setState",state:e,setStateOptions:t})}cancel(e){const t=this.#n?.promise;return this.#n?.cancel(e),t?t.then(xo).catch(xo):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#e)}isActive(){return this.observers.some(e=>s8(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Mx||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(e=>mb(e.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(e=0){return this.state.data===void 0?!0:e==="static"?!1:this.state.isInvalidated?!0:!o8(this.state.dataUpdatedAt,e)}onFocus(){this.observers.find(t=>t.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),this.#n?.continue()}onOnline(){this.observers.find(t=>t.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),this.#n?.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),this.#r.notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(t=>t!==e),this.observers.length||(this.#n&&(this.#s?this.#n.cancel({revert:!0}):this.#n.cancelRetry()),this.scheduleGc()),this.#r.notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#a({type:"invalidate"})}async fetch(e,t){if(this.state.fetchStatus!=="idle"&&this.#n?.status()!=="rejected"){if(this.state.data!==void 0&&t?.cancelRefetch)this.cancel({silent:!0});else if(this.#n)return this.#n.continueRetry(),this.#n.promise}if(e&&this.setOptions(e),!this.options.queryFn){const l=this.observers.find(c=>c.options.queryFn);l&&this.setOptions(l.options)}const r=new AbortController,n=l=>{Object.defineProperty(l,"signal",{enumerable:!0,get:()=>(this.#s=!0,r.signal)})},i=()=>{const l=HD(this.options,t),d=(()=>{const p={client:this.#i,queryKey:this.queryKey,meta:this.meta};return n(p),p})();return this.#s=!1,this.options.persister?this.options.persister(l,d,this):l(d)},s=(()=>{const l={fetchOptions:t,options:this.options,queryKey:this.queryKey,client:this.#i,state:this.state,fetchFn:i};return n(l),l})();this.options.behavior?.onFetch(s,this),this.#t=this.state,(this.state.fetchStatus==="idle"||this.state.fetchMeta!==s.fetchOptions?.meta)&&this.#a({type:"fetch",meta:s.fetchOptions?.meta}),this.#n=GD({initialPromise:t?.initialPromise,fn:s.fetchFn,onCancel:l=>{l instanceof gb&&l.revert&&this.setState({...this.#t,fetchStatus:"idle"}),r.abort()},onFail:(l,c)=>{this.#a({type:"failed",failureCount:l,error:c})},onPause:()=>{this.#a({type:"pause"})},onContinue:()=>{this.#a({type:"continue"})},retry:s.options.retry,retryDelay:s.options.retryDelay,networkMode:s.options.networkMode,canRun:()=>!0});try{const l=await this.#n.start();if(l===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(l),this.#r.config.onSuccess?.(l,this),this.#r.config.onSettled?.(l,this.state.error,this),l}catch(l){if(l instanceof gb){if(l.silent)return this.#n.promise;if(l.revert){if(this.state.data===void 0)throw l;return this.state.data}}throw this.#a({type:"error",error:l}),this.#r.config.onError?.(l,this),this.#r.config.onSettled?.(this.state.data,l,this),l}finally{this.scheduleGc()}}#a(e){const t=r=>{switch(e.type){case"failed":return{...r,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...E8(r.data,this.options),fetchMeta:e.meta??null};case"success":const n={...r,data:e.data,dataUpdateCount:r.dataUpdateCount+1,dataUpdatedAt:e.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return this.#t=e.manual?n:void 0,n;case"error":const i=e.error;return{...r,error:i,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:i,fetchStatus:"idle",status:"error"};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...e.state}}};this.state=t(this.state),Gi.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),this.#r.notify({query:this,type:"updated",action:e})})}};function E8(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:XD(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function vC(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,r=t!==void 0,n=r?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:r?n??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}function mC(e){return{onFetch:(t,r)=>{const n=t.options,i=t.fetchOptions?.meta?.fetchMore?.direction,a=t.state.data?.pages||[],s=t.state.data?.pageParams||[];let l={pages:[],pageParams:[]},c=0;const d=async()=>{let p=!1;const h=y=>{Object.defineProperty(y,"signal",{enumerable:!0,get:()=>(t.signal.aborted?p=!0:t.signal.addEventListener("abort",()=>{p=!0}),t.signal)})},m=HD(t.options,t.fetchOptions),_=async(y,E,T)=>{if(p)return Promise.reject();if(E==null&&y.pages.length)return Promise.resolve(y);const b=(()=>{const w={client:t.client,queryKey:t.queryKey,pageParam:E,direction:T?"backward":"forward",meta:t.options.meta};return h(w),w})(),R=await m(b),{maxPages:M}=t.options,B=T?d8:f8;return{pages:B(y.pages,R,M),pageParams:B(y.pageParams,E,M)}};if(i&&a.length){const y=i==="backward",E=y?T8:_C,T={pages:a,pageParams:s},A=E(n,T);l=await _(T,A,y)}else{const y=e??a.length;do{const E=c===0?s[0]??n.initialPageParam:_C(n,l);if(c>0&&E==null)break;l=await _(l,E),c++}while(c<y)}return l};t.options.persister?t.fetchFn=()=>t.options.persister?.(d,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},r):t.fetchFn=d}}}function _C(e,{pages:t,pageParams:r}){const n=t.length-1;return t.length>0?e.getNextPageParam(t[n],t,r[n],r):void 0}function T8(e,{pages:t,pageParams:r}){return t.length>0?e.getPreviousPageParam?.(t[0],t,r[0],r):void 0}var S8=class extends qD{#e;#t;#r;#i;constructor(e){super(),this.#e=e.client,this.mutationId=e.mutationId,this.#r=e.mutationCache,this.#t=[],this.state=e.state||A8(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){this.#t.includes(e)||(this.#t.push(e),this.clearGcTimeout(),this.#r.notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){this.#t=this.#t.filter(t=>t!==e),this.scheduleGc(),this.#r.notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){this.#t.length||(this.state.status==="pending"?this.scheduleGc():this.#r.remove(this))}continue(){return this.#i?.continue()??this.execute(this.state.variables)}async execute(e){const t=()=>{this.#n({type:"continue"})},r={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};this.#i=GD({fn:()=>this.options.mutationFn?this.options.mutationFn(e,r):Promise.reject(new Error("No mutationFn found")),onFail:(a,s)=>{this.#n({type:"failed",failureCount:a,error:s})},onPause:()=>{this.#n({type:"pause"})},onContinue:t,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#r.canRun(this)});const n=this.state.status==="pending",i=!this.#i.canStart();try{if(n)t();else{this.#n({type:"pending",variables:e,isPaused:i}),await this.#r.config.onMutate?.(e,this,r);const s=await this.options.onMutate?.(e,r);s!==this.state.context&&this.#n({type:"pending",context:s,variables:e,isPaused:i})}const a=await this.#i.start();return await this.#r.config.onSuccess?.(a,e,this.state.context,this,r),await this.options.onSuccess?.(a,e,this.state.context,r),await this.#r.config.onSettled?.(a,null,this.state.variables,this.state.context,this,r),await this.options.onSettled?.(a,null,e,this.state.context,r),this.#n({type:"success",data:a}),a}catch(a){try{throw await this.#r.config.onError?.(a,e,this.state.context,this,r),await this.options.onError?.(a,e,this.state.context,r),await this.#r.config.onSettled?.(void 0,a,this.state.variables,this.state.context,this,r),await this.options.onSettled?.(void 0,a,e,this.state.context,r),a}finally{this.#n({type:"error",error:a})}}finally{this.#r.runNext(this)}}#n(e){const t=r=>{switch(e.type){case"failed":return{...r,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...r,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:e.error,failureCount:r.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=t(this.state),Gi.batch(()=>{this.#t.forEach(r=>{r.onMutationUpdate(e)}),this.#r.notify({mutation:this,type:"updated",action:e})})}};function A8(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var b8=class extends bg{constructor(e={}){super(),this.config=e,this.#e=new Set,this.#t=new Map,this.#r=0}#e;#t;#r;build(e,t,r){const n=new S8({client:e,mutationCache:this,mutationId:++this.#r,options:e.defaultMutationOptions(t),state:r});return this.add(n),n}add(e){this.#e.add(e);const t=R_(e);if(typeof t=="string"){const r=this.#t.get(t);r?r.push(e):this.#t.set(t,[e])}this.notify({type:"added",mutation:e})}remove(e){if(this.#e.delete(e)){const t=R_(e);if(typeof t=="string"){const r=this.#t.get(t);if(r)if(r.length>1){const n=r.indexOf(e);n!==-1&&r.splice(n,1)}else r[0]===e&&this.#t.delete(t)}}this.notify({type:"removed",mutation:e})}canRun(e){const t=R_(e);if(typeof t=="string"){const n=this.#t.get(t)?.find(i=>i.state.status==="pending");return!n||n===e}else return!0}runNext(e){const t=R_(e);return typeof t=="string"?this.#t.get(t)?.find(n=>n!==e&&n.state.isPaused)?.continue()??Promise.resolve():Promise.resolve()}clear(){Gi.batch(()=>{this.#e.forEach(e=>{this.notify({type:"removed",mutation:e})}),this.#e.clear(),this.#t.clear()})}getAll(){return Array.from(this.#e)}find(e){const t={exact:!0,...e};return this.getAll().find(r=>dC(t,r))}findAll(e={}){return this.getAll().filter(t=>dC(e,t))}notify(e){Gi.batch(()=>{this.listeners.forEach(t=>{t(e)})})}resumePausedMutations(){const e=this.getAll().filter(t=>t.state.isPaused);return Gi.batch(()=>Promise.all(e.map(t=>t.continue().catch(xo))))}};function R_(e){return e.options.scope?.id}var x8=class extends bg{constructor(e={}){super(),this.config=e,this.#e=new Map}#e;build(e,t,r){const n=t.queryKey,i=t.queryHash??Ox(n,t);let a=this.get(i);return a||(a=new y8({client:e,queryKey:n,queryHash:i,options:e.defaultQueryOptions(t),state:r,defaultOptions:e.getQueryDefaults(n)}),this.add(a)),a}add(e){this.#e.has(e.queryHash)||(this.#e.set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const t=this.#e.get(e.queryHash);t&&(e.destroy(),t===e&&this.#e.delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){Gi.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return this.#e.get(e)}getAll(){return[...this.#e.values()]}find(e){const t={exact:!0,...e};return this.getAll().find(r=>fC(t,r))}findAll(e={}){const t=this.getAll();return Object.keys(e).length>0?t.filter(r=>fC(e,r)):t}notify(e){Gi.batch(()=>{this.listeners.forEach(t=>{t(e)})})}onFocus(){Gi.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){Gi.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},R8=class{#e;#t;#r;#i;#n;#o;#s;#a;constructor(e={}){this.#e=e.queryCache||new x8,this.#t=e.mutationCache||new b8,this.#r=e.defaultOptions||{},this.#i=new Map,this.#n=new Map,this.#o=0}mount(){this.#o++,this.#o===1&&(this.#s=VD.subscribe(async e=>{e&&(await this.resumePausedMutations(),this.#e.onFocus())}),this.#a=b0.subscribe(async e=>{e&&(await this.resumePausedMutations(),this.#e.onOnline())}))}unmount(){this.#o--,this.#o===0&&(this.#s?.(),this.#s=void 0,this.#a?.(),this.#a=void 0)}isFetching(e){return this.#e.findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return this.#t.findAll({...e,status:"pending"}).length}getQueryData(e){const t=this.defaultQueryOptions({queryKey:e});return this.#e.get(t.queryHash)?.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),r=this.#e.build(this,t),n=r.state.data;return n===void 0?this.fetchQuery(e):(e.revalidateIfStale&&r.isStaleByTime(mb(t.staleTime,r))&&this.prefetchQuery(t),Promise.resolve(n))}getQueriesData(e){return this.#e.findAll(e).map(({queryKey:t,state:r})=>{const n=r.data;return[t,n]})}setQueryData(e,t,r){const n=this.defaultQueryOptions({queryKey:e}),a=this.#e.get(n.queryHash)?.state.data,s=i8(t,a);if(s!==void 0)return this.#e.build(this,n).setData(s,{...r,manual:!0})}setQueriesData(e,t,r){return Gi.batch(()=>this.#e.findAll(e).map(({queryKey:n})=>[n,this.setQueryData(n,t,r)]))}getQueryState(e){const t=this.defaultQueryOptions({queryKey:e});return this.#e.get(t.queryHash)?.state}removeQueries(e){const t=this.#e;Gi.batch(()=>{t.findAll(e).forEach(r=>{t.remove(r)})})}resetQueries(e,t){const r=this.#e;return Gi.batch(()=>(r.findAll(e).forEach(n=>{n.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const r={revert:!0,...t},n=Gi.batch(()=>this.#e.findAll(e).map(i=>i.cancel(r)));return Promise.all(n).then(xo).catch(xo)}invalidateQueries(e,t={}){return Gi.batch(()=>(this.#e.findAll(e).forEach(r=>{r.invalidate()}),e?.refetchType==="none"?Promise.resolve():this.refetchQueries({...e,type:e?.refetchType??e?.type??"active"},t)))}refetchQueries(e,t={}){const r={...t,cancelRefetch:t.cancelRefetch??!0},n=Gi.batch(()=>this.#e.findAll(e).filter(i=>!i.isDisabled()&&!i.isStatic()).map(i=>{let a=i.fetch(void 0,r);return r.throwOnError||(a=a.catch(xo)),i.state.fetchStatus==="paused"?Promise.resolve():a}));return Promise.all(n).then(xo)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const r=this.#e.build(this,t);return r.isStaleByTime(mb(t.staleTime,r))?r.fetch(t):Promise.resolve(r.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(xo).catch(xo)}fetchInfiniteQuery(e){return e.behavior=mC(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(xo).catch(xo)}ensureInfiniteQueryData(e){return e.behavior=mC(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return b0.isOnline()?this.#t.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#e}getMutationCache(){return this.#t}getDefaultOptions(){return this.#r}setDefaultOptions(e){this.#r=e}setQueryDefaults(e,t){this.#i.set(Sv(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...this.#i.values()],r={};return t.forEach(n=>{Av(e,n.queryKey)&&Object.assign(r,n.defaultOptions)}),r}setMutationDefaults(e,t){this.#n.set(Sv(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...this.#n.values()],r={};return t.forEach(n=>{Av(e,n.mutationKey)&&Object.assign(r,n.defaultOptions)}),r}defaultQueryOptions(e){if(e._defaulted)return e;const t={...this.#r.queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=Ox(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===Mx&&(t.enabled=!1),t}defaultMutationOptions(e){return e?._defaulted?e:{...this.#r.mutations,...e?.mutationKey&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){this.#e.clear(),this.#t.clear()}},q=Ag();const ua=Pr(q),WD=Q7({__proto__:null,default:ua},[q]);var C8=q.createContext(void 0),O8=({client:e,children:t})=>(q.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),ze.jsx(C8.Provider,{value:e,children:t}));const Rd=new WeakMap,a0=new WeakMap,x0={current:[]};let sE=!1,hv=0;const Qp=new Set,C_=new Map;function YD(e){const t=Array.from(e).sort((r,n)=>r instanceof Cd&&r.options.deps.includes(n)?1:n instanceof Cd&&n.options.deps.includes(r)?-1:0);for(const r of t){if(x0.current.includes(r))continue;x0.current.push(r),r.recompute();const n=a0.get(r);if(n)for(const i of n){const a=Rd.get(i);a&&YD(a)}}}function M8(e){const t={prevVal:e.prevState,currentVal:e.state};for(const r of e.listeners)r(t)}function w8(e){const t={prevVal:e.prevState,currentVal:e.state};for(const r of e.listeners)r(t)}function $D(e){if(hv>0&&!C_.has(e)&&C_.set(e,e.prevState),Qp.add(e),!(hv>0)&&!sE)try{for(sE=!0;Qp.size>0;){const t=Array.from(Qp);Qp.clear();for(const r of t){const n=C_.get(r)??r.prevState;r.prevState=n,M8(r)}for(const r of t){const n=Rd.get(r);n&&(x0.current.push(r),YD(n))}for(const r of t){const n=Rd.get(r);if(n)for(const i of n)w8(i)}}}finally{sE=!1,x0.current=[],C_.clear()}}function pv(e){hv++;try{e()}finally{if(hv--,hv===0){const t=Qp.values().next().value;t&&$D(t)}}}function N8(e){return typeof e=="function"}class yb{constructor(t,r){this.listeners=new Set,this.subscribe=n=>{var i,a;this.listeners.add(n);const s=(a=(i=this.options)==null?void 0:i.onSubscribe)==null?void 0:a.call(i,n,this);return()=>{this.listeners.delete(n),s?.()}},this.prevState=t,this.state=t,this.options=r}setState(t){var r,n,i;this.prevState=this.state,(r=this.options)!=null&&r.updateFn?this.state=this.options.updateFn(this.prevState)(t):N8(t)?this.state=t(this.prevState):this.state=t,(i=(n=this.options)==null?void 0:n.onUpdate)==null||i.call(n),$D(this)}}class Cd{constructor(t){this.listeners=new Set,this._subscriptions=[],this.lastSeenDepValues=[],this.getDepVals=()=>{const r=this.options.deps.length,n=new Array(r),i=new Array(r);for(let a=0;a<r;a++){const s=this.options.deps[a];n[a]=s.prevState,i[a]=s.state}return this.lastSeenDepValues=i,{prevDepVals:n,currDepVals:i,prevVal:this.prevState??void 0}},this.recompute=()=>{var r,n;this.prevState=this.state;const i=this.getDepVals();this.state=this.options.fn(i),(n=(r=this.options).onUpdate)==null||n.call(r)},this.checkIfRecalculationNeededDeeply=()=>{for(const a of this.options.deps)a instanceof Cd&&a.checkIfRecalculationNeededDeeply();let r=!1;const n=this.lastSeenDepValues,{currDepVals:i}=this.getDepVals();for(let a=0;a<i.length;a++)if(i[a]!==n[a]){r=!0;break}r&&this.recompute()},this.mount=()=>(this.registerOnGraph(),this.checkIfRecalculationNeededDeeply(),()=>{this.unregisterFromGraph();for(const r of this._subscriptions)r()}),this.subscribe=r=>{var n,i;this.listeners.add(r);const a=(i=(n=this.options).onSubscribe)==null?void 0:i.call(n,r,this);return()=>{this.listeners.delete(r),a?.()}},this.options=t,this.state=t.fn({prevDepVals:void 0,prevVal:void 0,currDepVals:this.getDepVals().currDepVals})}registerOnGraph(t=this.options.deps){for(const r of t)if(r instanceof Cd)r.registerOnGraph(),this.registerOnGraph(r.options.deps);else if(r instanceof yb){let n=Rd.get(r);n||(n=new Set,Rd.set(r,n)),n.add(this);let i=a0.get(this);i||(i=new Set,a0.set(this,i)),i.add(r)}}unregisterFromGraph(t=this.options.deps){for(const r of t)if(r instanceof Cd)this.unregisterFromGraph(r.options.deps);else if(r instanceof yb){const n=Rd.get(r);n&&n.delete(this);const i=a0.get(this);i&&i.delete(r)}}}const Al="__TSR_index",gC="popstate",yC="beforeunload";function I8(e){let t=e.getLocation();const r=new Set,n=s=>{t=e.getLocation(),r.forEach(l=>l({location:t,action:s}))},i=s=>{e.notifyOnIndexChange??!0?n(s):t=e.getLocation()},a=async({task:s,navigateOpts:l,...c})=>{if(l?.ignoreBlocker??!1){s();return}const p=e.getBlockers?.()??[],h=c.type==="PUSH"||c.type==="REPLACE";if(typeof document<"u"&&p.length&&h)for(const m of p){const _=R0(c.path,c.state);if(await m.blockerFn({currentLocation:t,nextLocation:_,action:c.type})){e.onBlocked?.();return}}s()};return{get location(){return t},get length(){return e.getLength()},subscribers:r,subscribe:s=>(r.add(s),()=>{r.delete(s)}),push:(s,l,c)=>{const d=t.state[Al];l=EC(d+1,l),a({task:()=>{e.pushState(s,l),n({type:"PUSH"})},navigateOpts:c,type:"PUSH",path:s,state:l})},replace:(s,l,c)=>{const d=t.state[Al];l=EC(d,l),a({task:()=>{e.replaceState(s,l),n({type:"REPLACE"})},navigateOpts:c,type:"REPLACE",path:s,state:l})},go:(s,l)=>{a({task:()=>{e.go(s),i({type:"GO",index:s})},navigateOpts:l,type:"GO"})},back:s=>{a({task:()=>{e.back(s?.ignoreBlocker??!1),i({type:"BACK"})},navigateOpts:s,type:"BACK"})},forward:s=>{a({task:()=>{e.forward(s?.ignoreBlocker??!1),i({type:"FORWARD"})},navigateOpts:s,type:"FORWARD"})},canGoBack:()=>t.state[Al]!==0,createHref:s=>e.createHref(s),block:s=>{if(!e.setBlockers)return()=>{};const l=e.getBlockers?.()??[];return e.setBlockers([...l,s]),()=>{const c=e.getBlockers?.()??[];e.setBlockers?.(c.filter(d=>d!==s))}},flush:()=>e.flush?.(),destroy:()=>e.destroy?.(),notify:n}}function EC(e,t){t||(t={});const r=Nx();return{...t,key:r,__TSR_key:r,[Al]:e}}function P8(e){const t=typeof document<"u"?window:void 0,r=t.history.pushState,n=t.history.replaceState;let i=[];const a=()=>i,s=U=>i=U,l=(U=>U),c=(()=>R0(`${t.location.pathname}${t.location.search}${t.location.hash}`,t.history.state));if(!t.history.state?.__TSR_key&&!t.history.state?.key){const U=Nx();t.history.replaceState({[Al]:0,key:U,__TSR_key:U},"")}let d=c(),p,h=!1,m=!1,_=!1,y=!1;const E=()=>d;let T,A;const b=()=>{T&&(D._ignoreSubscribers=!0,(T.isPush?t.history.pushState:t.history.replaceState)(T.state,"",T.href),D._ignoreSubscribers=!1,T=void 0,A=void 0,p=void 0)},R=(U,ae,Q)=>{const X=l(ae);A||(p=d),d=R0(ae,Q),T={href:X,state:Q,isPush:T?.isPush||U==="push"},A||(A=Promise.resolve().then(()=>b()))},M=U=>{d=c(),D.notify({type:U})},B=async()=>{if(m){m=!1;return}const U=c(),ae=U.state[Al]-d.state[Al],Q=ae===1,X=ae===-1,x=!Q&&!X||h;h=!1;const P=x?"GO":X?"BACK":"FORWARD",H=x?{type:"GO",index:ae}:{type:X?"BACK":"FORWARD"};if(_)_=!1;else{const pe=a();if(typeof document<"u"&&pe.length){for(const O of pe)if(await O.blockerFn({currentLocation:d,nextLocation:U,action:P})){m=!0,t.history.go(1),D.notify(H);return}}}d=c(),D.notify(H)},w=U=>{if(y){y=!1;return}let ae=!1;const Q=a();if(typeof document<"u"&&Q.length)for(const X of Q){const x=X.enableBeforeUnload??!0;if(x===!0){ae=!0;break}if(typeof x=="function"&&x()===!0){ae=!0;break}}if(ae)return U.preventDefault(),U.returnValue=""},D=I8({getLocation:E,getLength:()=>t.history.length,pushState:(U,ae)=>R("push",U,ae),replaceState:(U,ae)=>R("replace",U,ae),back:U=>(U&&(_=!0),y=!0,t.history.back()),forward:U=>{U&&(_=!0),y=!0,t.history.forward()},go:U=>{h=!0,t.history.go(U)},createHref:U=>l(U),flush:b,destroy:()=>{t.history.pushState=r,t.history.replaceState=n,t.removeEventListener(yC,w,{capture:!0}),t.removeEventListener(gC,B)},onBlocked:()=>{p&&d!==p&&(d=p)},getBlockers:a,setBlockers:s,notifyOnIndexChange:!1});return t.addEventListener(yC,w,{capture:!0}),t.addEventListener(gC,B),t.history.pushState=function(...U){const ae=r.apply(t.history,U);return D._ignoreSubscribers||M("PUSH"),ae},t.history.replaceState=function(...U){const ae=n.apply(t.history,U);return D._ignoreSubscribers||M("REPLACE"),ae},D}function R0(e,t){const r=e.indexOf("#"),n=e.indexOf("?"),i=Nx();return{href:e,pathname:e.substring(0,r>0?n>0?Math.min(r,n):r:n>0?n:e.length),hash:r>-1?e.substring(r):"",search:n>-1?e.slice(n,r===-1?void 0:r):"",state:t||{[Al]:0,key:i,__TSR_key:i}}}function Nx(){return(Math.random()+1).toString(36).substring(7)}function Eb(e){return e[e.length-1]}function D8(e){return typeof e=="function"}function Nc(e,t){return D8(e)?e(t):e}const L8=Object.prototype.hasOwnProperty;function Xa(e,t){if(e===t)return e;const r=t,n=AC(e)&&AC(r);if(!n&&!(C0(e)&&C0(r)))return r;const i=n?e:TC(e);if(!i)return r;const a=n?r:TC(r);if(!a)return r;const s=i.length,l=a.length,c=n?new Array(l):{};let d=0;for(let p=0;p<l;p++){const h=n?p:a[p],m=e[h],_=r[h];if(m===_){c[h]=m,(n?p<s:L8.call(e,h))&&d++;continue}if(m===null||_===null||typeof m!="object"||typeof _!="object"){c[h]=_;continue}const y=Xa(m,_);c[h]=y,y===m&&d++}return s===l&&d===s?e:c}function TC(e){const t=[],r=Object.getOwnPropertyNames(e);for(const i of r){if(!Object.prototype.propertyIsEnumerable.call(e,i))return!1;t.push(i)}const n=Object.getOwnPropertySymbols(e);for(const i of n){if(!Object.prototype.propertyIsEnumerable.call(e,i))return!1;t.push(i)}return t}function C0(e){if(!SC(e))return!1;const t=e.constructor;if(typeof t>"u")return!0;const r=t.prototype;return!(!SC(r)||!r.hasOwnProperty("isPrototypeOf"))}function SC(e){return Object.prototype.toString.call(e)==="[object Object]"}function AC(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function Ic(e,t,r){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return!1;for(let n=0,i=e.length;n<i;n++)if(!Ic(e[n],t[n],r))return!1;return!0}if(C0(e)&&C0(t)){const n=r?.ignoreUndefined??!0;if(r?.partial){for(const s in t)if((!n||t[s]!==void 0)&&!Ic(e[s],t[s],r))return!1;return!0}let i=0;if(!n)i=Object.keys(e).length;else for(const s in e)e[s]!==void 0&&i++;let a=0;for(const s in t)if((!n||t[s]!==void 0)&&(a++,a>i||!Ic(e[s],t[s],r)))return!1;return i===a}return!1}function Ud(e){let t,r;const n=new Promise((i,a)=>{t=i,r=a});return n.status="pending",n.resolve=i=>{n.status="resolved",n.value=i,t(i),e?.(i)},n.reject=i=>{n.status="rejected",r(i)},n}function bl(e){return!!(e&&typeof e=="object"&&typeof e.then=="function")}var B8="Invariant failed";function au(e,t){if(!e)throw new Error(B8)}const fs=0,Bc=1,kd=2,zd=3;function ru(e){return Ix(e.filter(t=>t!==void 0).join("/"))}function Ix(e){return e.replace(/\/{2,}/g,"/")}function Px(e){return e==="/"?e:e.replace(/^\/{1,}/,"")}function xl(e){return e==="/"?e:e.replace(/\/{1,}$/,"")}function Tb(e){return xl(Px(e))}function O0(e,t){return e?.endsWith("/")&&e!=="/"&&e!==`${t}/`?e.slice(0,-1):e}function F8(e,t,r){return O0(e,r)===O0(t,r)}function U8(e){const{type:t,value:r}=e;if(t===fs)return r;const{prefixSegment:n,suffixSegment:i}=e;if(t===Bc){const a=r.substring(1);if(n&&i)return`${n}{$${a}}${i}`;if(n)return`${n}{$${a}}`;if(i)return`{$${a}}${i}`}if(t===zd){const a=r.substring(1);return n&&i?`${n}{-$${a}}${i}`:n?`${n}{-$${a}}`:i?`{-$${a}}${i}`:`{-$${a}}`}if(t===kd){if(n&&i)return`${n}{$}${i}`;if(n)return`${n}{$}`;if(i)return`{$}${i}`}return r}function k8({base:e,to:t,trailingSlash:r="never",parseCache:n}){let i=ZD(e,n).slice();const a=Rg(t,n);i.length>1&&Eb(i)?.value==="/"&&i.pop();for(let c=0,d=a.length;c<d;c++){const p=a[c],h=p.value;h==="/"?c?c===d-1&&i.push(p):i=[p]:h===".."?i.pop():h==="."||i.push(p)}i.length>1&&(Eb(i).value==="/"?r==="never"&&i.pop():r==="always"&&i.push({type:fs,value:"/"}));const s=i.map(U8);return ru(s)}const ZD=(e,t)=>KD(e,t,!0),Rg=(e,t)=>KD(e,t,!1),KD=(e,t,r)=>{if(!e)return[];const n=t?.get(e);if(n)return n;const i=G8(e,r);return t?.set(e,i),i},z8=/^\$.{1,}$/,j8=/^(.*?)\{(\$[a-zA-Z_$][a-zA-Z0-9_$]*)\}(.*)$/,H8=/^(.*?)\{-(\$[a-zA-Z_$][a-zA-Z0-9_$]*)\}(.*)$/,V8=/^\$$/,X8=/^(.*?)\{\$\}(.*)$/;function G8(e,t){e=Ix(e);const r=[];if(e.slice(0,1)==="/"&&(e=e.substring(1),r.push({type:fs,value:"/"})),!e)return r;const n=e.split("/").filter(Boolean);return r.push(...n.map(i=>{const a=!t&&i.slice(-1)==="_"?i.slice(0,-1):i,s=a.match(X8);if(s){const d=s[1],p=s[2];return{type:kd,value:"$",prefixSegment:d||void 0,suffixSegment:p||void 0}}const l=a.match(H8);if(l){const d=l[1],p=l[2],h=l[3];return{type:zd,value:p,prefixSegment:d||void 0,suffixSegment:h||void 0}}const c=a.match(j8);if(c){const d=c[1],p=c[2],h=c[3];return{type:Bc,value:""+p,prefixSegment:d||void 0,suffixSegment:h||void 0}}if(z8.test(a)){const d=a.substring(1);return{type:Bc,value:"$"+d,prefixSegment:void 0,suffixSegment:void 0}}return V8.test(a)?{type:kd,value:"$",prefixSegment:void 0,suffixSegment:void 0}:{type:fs,value:a.includes("%25")?a.split("%25").map(d=>decodeURI(d)).join("%25"):decodeURI(a)}})),e.slice(-1)==="/"&&(e=e.substring(1),r.push({type:fs,value:"/"})),r}function O_({path:e,params:t,leaveWildcards:r,leaveParams:n,decodeCharMap:i,parseCache:a}){const s=Rg(e,a);function l(h){const m=t[h],_=typeof m=="string";return h==="*"||h==="_splat"?_?encodeURI(m):m:_?q8(m,i):m}let c=!1;const d={},p=ru(s.map(h=>{if(h.type===fs)return h.value;if(h.type===kd){d._splat=t._splat,d["*"]=t._splat;const m=h.prefixSegment||"",_=h.suffixSegment||"";if(!("_splat"in t))return c=!0,r?`${m}${h.value}${_}`:m||_?`${m}${_}`:void 0;const y=l("_splat");return r?`${m}${h.value}${y??""}${_}`:`${m}${y}${_}`}if(h.type===Bc){const m=h.value.substring(1);!c&&!(m in t)&&(c=!0),d[m]=t[m];const _=h.prefixSegment||"",y=h.suffixSegment||"";if(n){const E=l(h.value);return`${_}${h.value}${E??""}${y}`}return`${_}${l(m)??"undefined"}${y}`}if(h.type===zd){const m=h.value.substring(1),_=h.prefixSegment||"",y=h.suffixSegment||"";if(!(m in t)||t[m]==null)return r?`${_}${m}${y}`:_||y?`${_}${y}`:void 0;if(d[m]=t[m],n){const E=l(h.value);return`${_}${h.value}${E??""}${y}`}return r?`${_}${m}${l(m)??""}${y}`:`${_}${l(m)??""}${y}`}return h.value}));return{usedParams:d,interpolatedPath:p,isMissingParams:c}}function q8(e,t){let r=encodeURIComponent(e);if(t)for(const[n,i]of t)r=r.replaceAll(n,i);return r}function Sb(e,t,r){const n=W8(e,t,r);if(!(t.to&&!n))return n??{}}function W8(e,{to:t,fuzzy:r,caseSensitive:n},i){const a=t,s=ZD(e.startsWith("/")?e:`/${e}`,i),l=Rg(a.startsWith("/")?a:`/${a}`,i),c={};return Y8(s,l,c,r,n)?c:void 0}function Y8(e,t,r,n,i){let a=0,s=0;for(;a<e.length||s<t.length;){const l=e[a],c=t[s];if(c){if(c.type===kd){const d=e.slice(a);let p;if(c.prefixSegment||c.suffixSegment){if(!l)return!1;const h=c.prefixSegment||"",m=c.suffixSegment||"",_=l.value;if("prefixSegment"in c&&!_.startsWith(h)||"suffixSegment"in c&&!e[e.length-1]?.value.endsWith(m))return!1;let y=decodeURI(ru(d.map(E=>E.value)));h&&y.startsWith(h)&&(y=y.slice(h.length)),m&&y.endsWith(m)&&(y=y.slice(0,y.length-m.length)),p=y}else p=decodeURI(ru(d.map(h=>h.value)));return r["*"]=p,r._splat=p,!0}if(c.type===fs){if(c.value==="/"&&!l?.value){s++;continue}if(l){if(i){if(c.value!==l.value)return!1}else if(c.value.toLowerCase()!==l.value.toLowerCase())return!1;a++,s++;continue}else return!1}if(c.type===Bc){if(!l||l.value==="/")return!1;let d="",p=!1;if(c.prefixSegment||c.suffixSegment){const h=c.prefixSegment||"",m=c.suffixSegment||"",_=l.value;if(h&&!_.startsWith(h)||m&&!_.endsWith(m))return!1;let y=_;h&&y.startsWith(h)&&(y=y.slice(h.length)),m&&y.endsWith(m)&&(y=y.slice(0,y.length-m.length)),d=decodeURIComponent(y),p=!0}else d=decodeURIComponent(l.value),p=!0;p&&(r[c.value.substring(1)]=d,a++),s++;continue}if(c.type===zd){if(!l){s++;continue}if(l.value==="/"){s++;continue}let d="",p=!1;if(c.prefixSegment||c.suffixSegment){const h=c.prefixSegment||"",m=c.suffixSegment||"",_=l.value;if((!h||_.startsWith(h))&&(!m||_.endsWith(m))){let y=_;h&&y.startsWith(h)&&(y=y.slice(h.length)),m&&y.endsWith(m)&&(y=y.slice(0,y.length-m.length)),d=decodeURIComponent(y),p=!0}}else{let h=!0;for(let m=s+1;m<t.length;m++){const _=t[m];if(_?.type===fs&&_.value===l.value){h=!1;break}if(_?.type===Bc||_?.type===kd){e.length<t.length&&(h=!1);break}}h&&(d=decodeURIComponent(l.value),p=!0)}p&&(r[c.value.substring(1)]=d,a++),s++;continue}}if(a<e.length&&s>=t.length)return r["**"]=ru(e.slice(a).map(d=>d.value)),!!n&&t[t.length-1]?.value!=="/";if(s<t.length&&a>=e.length){for(let d=s;d<t.length;d++)if(t[d]?.type!==zd)return!1;break}break}return!0}const $8=.75,Z8=1,K8=.5,Q8=.4,J8=.25,ek=.2,tk=.05,rk=.02,nk=.01,bC=2e-4,xC=1e-4;function RC(e,t){return e.prefixSegment&&e.suffixSegment?t+tk+bC*e.prefixSegment.length+xC*e.suffixSegment.length:e.prefixSegment?t+rk+bC*e.prefixSegment.length:e.suffixSegment?t+nk+xC*e.suffixSegment.length:t}function ik(e){const t=[];return e.forEach((n,i)=>{if(n.isRoot||!n.path)return;const a=Px(n.fullPath);let s=Rg(a),l=0;for(;s.length>l+1&&s[l]?.value==="/";)l++;l>0&&(s=s.slice(l));let c=0,d=!1;const p=s.map((h,m)=>{if(h.value==="/")return $8;if(h.type===fs)return Z8;let _;h.type===Bc?_=K8:h.type===zd?(_=Q8,c++):_=J8;for(let y=m+1;y<s.length;y++){const E=s[y];if(E.type===fs&&E.value!=="/")return d=!0,RC(h,_+ek)}return RC(h,_)});t.push({child:n,trimmed:a,parsed:s,index:i,scores:p,optionalParamCount:c,hasStaticAfter:d})}),t.sort((n,i)=>{const a=Math.min(n.scores.length,i.scores.length);for(let s=0;s<a;s++)if(n.scores[s]!==i.scores[s])return i.scores[s]-n.scores[s];if(n.scores.length!==i.scores.length){if(n.optionalParamCount!==i.optionalParamCount){if(n.hasStaticAfter===i.hasStaticAfter)return n.optionalParamCount-i.optionalParamCount;if(n.hasStaticAfter&&!i.hasStaticAfter)return-1;if(!n.hasStaticAfter&&i.hasStaticAfter)return 1}return i.scores.length-n.scores.length}for(let s=0;s<a;s++)if(n.parsed[s].value!==i.parsed[s].value)return n.parsed[s].value>i.parsed[s].value?1:-1;return n.index-i.index}).map((n,i)=>(n.child.rank=i,n.child))}function ak({routeTree:e,initRoute:t}){const r={},n={},i=s=>{s.forEach((l,c)=>{t?.(l,c);const d=r[l.id];if(au(!d,`Duplicate routes found with id: ${String(l.id)}`),r[l.id]=l,!l.isRoot&&l.path){const h=xl(l.fullPath);(!n[h]||l.fullPath.endsWith("/"))&&(n[h]=l)}const p=l.children;p?.length&&i(p)})};i([e]);const a=ik(Object.values(r));return{routesById:r,routesByPath:n,flatRoutes:a}}function ps(e){return!!e?.isNotFound}function ok(){try{if(typeof window<"u"&&typeof window.sessionStorage=="object")return window.sessionStorage}catch{}}const M0="tsr-scroll-restoration-v1_3",sk=(e,t)=>{let r;return(...n)=>{r||(r=setTimeout(()=>{e(...n),r=null},t))}};function uk(){const e=ok();if(!e)return null;const t=e.getItem(M0);let r=t?JSON.parse(t):{};return{state:r,set:n=>(r=Nc(n,r)||r,e.setItem(M0,JSON.stringify(r)))}}const M_=uk(),Ab=e=>e.state.__TSR_key||e.href;function lk(e){const t=[];let r;for(;r=e.parentNode;)t.push(`${e.tagName}:nth-child(${Array.prototype.indexOf.call(r.children,e)+1})`),e=r;return`${t.reverse().join(" > ")}`.toLowerCase()}let w0=!1;function QD({storageKey:e,key:t,behavior:r,shouldScrollRestoration:n,scrollToTopSelectors:i,location:a}){let s;try{s=JSON.parse(sessionStorage.getItem(e)||"{}")}catch(d){console.error(d);return}const l=t||window.history.state?.__TSR_key,c=s[l];w0=!0;e:{if(n&&c&&Object.keys(c).length>0){for(const h in c){const m=c[h];if(h==="window")window.scrollTo({top:m.scrollY,left:m.scrollX,behavior:r});else if(h){const _=document.querySelector(h);_&&(_.scrollLeft=m.scrollX,_.scrollTop=m.scrollY)}}break e}const d=(a??window.location).hash.split("#",2)[1];if(d){const h=window.history.state?.__hashScrollIntoViewOptions??!0;if(h){const m=document.getElementById(d);m&&m.scrollIntoView(h)}break e}const p={top:0,left:0,behavior:r};if(window.scrollTo(p),i)for(const h of i){if(h==="window")continue;const m=typeof h=="function"?h():document.querySelector(h);m&&m.scrollTo(p)}}w0=!1}function ck(e,t){if(!M_&&!e.isServer||((e.options.scrollRestoration??!1)&&(e.isScrollRestoring=!0),e.isServer||e.isScrollRestorationSetup||!M_))return;e.isScrollRestorationSetup=!0,w0=!1;const n=e.options.getScrollRestorationKey||Ab;window.history.scrollRestoration="manual";const i=a=>{if(w0||!e.isScrollRestoring)return;let s="";if(a.target===document||a.target===window)s="window";else{const c=a.target.getAttribute("data-scroll-restoration-id");c?s=`[data-scroll-restoration-id="${c}"]`:s=lk(a.target)}const l=n(e.state.location);M_.set(c=>{const d=c[l]||={},p=d[s]||={};if(s==="window")p.scrollX=window.scrollX||0,p.scrollY=window.scrollY||0;else if(s){const h=document.querySelector(s);h&&(p.scrollX=h.scrollLeft||0,p.scrollY=h.scrollTop||0)}return c})};typeof document<"u"&&document.addEventListener("scroll",sk(i,100),!0),e.subscribe("onRendered",a=>{const s=n(a.toLocation);if(!e.resetNextScroll){e.resetNextScroll=!0;return}typeof e.options.scrollRestoration=="function"&&!e.options.scrollRestoration({location:e.latestLocation})||(QD({storageKey:M0,key:s,behavior:e.options.scrollRestorationBehavior,shouldScrollRestoration:e.isScrollRestoring,scrollToTopSelectors:e.options.scrollToTopSelectors,location:e.history.location}),e.isScrollRestoring&&M_.set(l=>(l[s]||={},l)))})}function fk(e){if(typeof document<"u"&&document.querySelector){const t=e.state.location.state.__hashScrollIntoViewOptions??!0;if(t&&e.state.location.hash!==""){const r=document.getElementById(e.state.location.hash);r&&r.scrollIntoView(t)}}}function dk(e,t=String){const r=new URLSearchParams;for(const n in e){const i=e[n];i!==void 0&&r.set(n,t(i))}return r.toString()}function uE(e){return e?e==="false"?!1:e==="true"?!0:+e*0===0&&+e+""===e?+e:e:""}function hk(e){const t=new URLSearchParams(e),r={};for(const[n,i]of t.entries()){const a=r[n];a==null?r[n]=uE(i):Array.isArray(a)?a.push(uE(i)):r[n]=[a,uE(i)]}return r}const pk=mk(JSON.parse),vk=_k(JSON.stringify,JSON.parse);function mk(e){return t=>{t[0]==="?"&&(t=t.substring(1));const r=hk(t);for(const n in r){const i=r[n];if(typeof i=="string")try{r[n]=e(i)}catch{}}return r}}function _k(e,t){const r=typeof t=="function";function n(i){if(typeof i=="object"&&i!==null)try{return e(i)}catch{}else if(r&&typeof i=="string")try{return t(i),e(i)}catch{}return i}return i=>{const a=dk(i,n);return a?`?${a}`:""}}const qa="__root__";function gk(e){if(e.statusCode=e.statusCode||e.code||307,!e.reloadDocument&&typeof e.href=="string")try{new URL(e.href),e.reloadDocument=!0}catch{}const t=new Headers(e.headers);e.href&&t.get("Location")===null&&t.set("Location",e.href);const r=new Response(null,{status:e.statusCode,headers:t});if(r.options=e,e.throw)throw r;return r}function ls(e){return e instanceof Response&&!!e.options}function yk(e){const t=new Map;let r,n;const i=a=>{a.next&&(a.prev?(a.prev.next=a.next,a.next.prev=a.prev,a.next=void 0,n&&(n.next=a,a.prev=n)):(a.next.prev=void 0,r=a.next,a.next=void 0,n&&(a.prev=n,n.next=a)),n=a)};return{get(a){const s=t.get(a);if(s)return i(s),s.value},set(a,s){if(t.size>=e&&r){const c=r;t.delete(c.key),c.next&&(r=c.next,c.next.prev=void 0),c===n&&(n=void 0)}const l=t.get(a);if(l)l.value=s,i(l);else{const c={key:a,value:s,prev:n};n&&(n.next=c),n=c,r||(r=c),t.set(a,c)}}}}const o0=e=>{if(!e.rendered)return e.rendered=!0,e.onReady?.()},Cg=(e,t)=>!!(e.preload&&!e.router.state.matches.some(r=>r.id===t)),JD=(e,t)=>{const r=e.router.routesById[t.routeId??""]??e.router.routeTree;!r.options.notFoundComponent&&e.router.options?.defaultNotFoundComponent&&(r.options.notFoundComponent=e.router.options.defaultNotFoundComponent),au(r.options.notFoundComponent);const n=e.matches.find(i=>i.routeId===r.id);au(n,"Could not find match for route: "+r.id),e.updateMatch(n.id,i=>({...i,status:"notFound",error:t,isFetching:!1})),t.routerCode==="BEFORE_LOAD"&&r.parentRoute&&(t.routeId=r.parentRoute.id,JD(e,t))},yl=(e,t,r)=>{if(!(!ls(r)&&!ps(r))){if(ls(r)&&r.redirectHandled&&!r.options.reloadDocument)throw r;if(t){t._nonReactive.beforeLoadPromise?.resolve(),t._nonReactive.loaderPromise?.resolve(),t._nonReactive.beforeLoadPromise=void 0,t._nonReactive.loaderPromise=void 0;const n=ls(r)?"redirected":"notFound";e.updateMatch(t.id,i=>({...i,status:n,isFetching:!1,error:r})),ps(r)&&!r.routeId&&(r.routeId=t.routeId),t._nonReactive.loadPromise?.resolve()}throw ls(r)?(e.rendered=!0,r.options._fromLocation=e.location,r.redirectHandled=!0,r=e.router.resolveRedirect(r),r):(JD(e,r),r)}},eL=(e,t)=>{const r=e.router.getMatch(t);return!!(!e.router.isServer&&r._nonReactive.dehydrated||e.router.isServer&&r.ssr===!1)},Ep=(e,t,r,n)=>{const{id:i,routeId:a}=e.matches[t],s=e.router.looseRoutesById[a];if(r instanceof Promise)throw r;r.routerCode=n,e.firstBadMatchIndex??=t,yl(e,e.router.getMatch(i),r);try{s.options.onError?.(r)}catch(l){r=l,yl(e,e.router.getMatch(i),r)}e.updateMatch(i,l=>(l._nonReactive.beforeLoadPromise?.resolve(),l._nonReactive.beforeLoadPromise=void 0,l._nonReactive.loadPromise?.resolve(),{...l,error:r,status:"error",isFetching:!1,updatedAt:Date.now(),abortController:new AbortController}))},Ek=(e,t,r,n)=>{const i=e.router.getMatch(t),a=e.matches[r-1]?.id,s=a?e.router.getMatch(a):void 0;if(e.router.isShell()){i.ssr=t===qa;return}if(s?.ssr===!1){i.ssr=!1;return}const l=_=>_===!0&&s?.ssr==="data-only"?"data-only":_,c=e.router.options.defaultSsr??!0;if(n.options.ssr===void 0){i.ssr=l(c);return}if(typeof n.options.ssr!="function"){i.ssr=l(n.options.ssr);return}const{search:d,params:p}=i,h={search:w_(d,i.searchError),params:w_(p,i.paramsError),location:e.location,matches:e.matches.map(_=>({index:_.index,pathname:_.pathname,fullPath:_.fullPath,staticData:_.staticData,id:_.id,routeId:_.routeId,search:w_(_.search,_.searchError),params:w_(_.params,_.paramsError),ssr:_.ssr}))},m=n.options.ssr(h);if(bl(m))return m.then(_=>{i.ssr=l(_??c)});i.ssr=l(m??c)},tL=(e,t,r,n)=>{if(n._nonReactive.pendingTimeout!==void 0)return;const i=r.options.pendingMs??e.router.options.defaultPendingMs;if(!!(e.onReady&&!e.router.isServer&&!Cg(e,t)&&(r.options.loader||r.options.beforeLoad||iL(r))&&typeof i=="number"&&i!==1/0&&(r.options.pendingComponent??e.router.options?.defaultPendingComponent))){const s=setTimeout(()=>{o0(e)},i);n._nonReactive.pendingTimeout=s}},Tk=(e,t,r)=>{const n=e.router.getMatch(t);if(!n._nonReactive.beforeLoadPromise&&!n._nonReactive.loaderPromise)return;tL(e,t,r,n);const i=()=>{const a=e.router.getMatch(t);a.preload&&(a.status==="redirected"||a.status==="notFound")&&yl(e,a,a.error)};return n._nonReactive.beforeLoadPromise?n._nonReactive.beforeLoadPromise.then(i):i()},Sk=(e,t,r,n)=>{const i=e.router.getMatch(t),a=i._nonReactive.loadPromise;i._nonReactive.loadPromise=Ud(()=>{a?.resolve()});const{paramsError:s,searchError:l}=i;s&&Ep(e,r,s,"PARSE_PARAMS"),l&&Ep(e,r,l,"VALIDATE_SEARCH"),tL(e,t,n,i);const c=new AbortController,d=e.matches[r-1]?.id,m={...(d?e.router.getMatch(d):void 0)?.context??e.router.options.context??void 0,...i.__routeContext};let _=!1;const y=()=>{_||(_=!0,e.updateMatch(t,D=>({...D,isFetching:"beforeLoad",fetchCount:D.fetchCount+1,abortController:c,context:m})))},E=()=>{i._nonReactive.beforeLoadPromise?.resolve(),i._nonReactive.beforeLoadPromise=void 0,e.updateMatch(t,D=>({...D,isFetching:!1}))};if(!n.options.beforeLoad){pv(()=>{y(),E()});return}i._nonReactive.beforeLoadPromise=Ud();const{search:T,params:A,cause:b}=i,R=Cg(e,t),M={search:T,abortController:c,params:A,preload:R,context:m,location:e.location,navigate:D=>e.router.navigate({...D,_fromLocation:e.location}),buildLocation:e.router.buildLocation,cause:R?"preload":b,matches:e.matches,...e.router.options.additionalContext},B=D=>{if(D===void 0){pv(()=>{y(),E()});return}(ls(D)||ps(D))&&(y(),Ep(e,r,D,"BEFORE_LOAD")),pv(()=>{y(),e.updateMatch(t,U=>({...U,__beforeLoadContext:D,context:{...U.context,...D}})),E()})};let w;try{if(w=n.options.beforeLoad(M),bl(w))return y(),w.catch(D=>{Ep(e,r,D,"BEFORE_LOAD")}).then(B)}catch(D){y(),Ep(e,r,D,"BEFORE_LOAD")}B(w)},Ak=(e,t)=>{const{id:r,routeId:n}=e.matches[t],i=e.router.looseRoutesById[n],a=()=>{if(e.router.isServer){const c=Ek(e,r,t,i);if(bl(c))return c.then(l)}return l()},s=()=>Sk(e,r,t,i),l=()=>{if(eL(e,r))return;const c=Tk(e,r,i);return bl(c)?c.then(s):s()};return a()},vv=(e,t,r)=>{const n=e.router.getMatch(t);if(!n||!r.options.head&&!r.options.scripts&&!r.options.headers)return;const i={matches:e.matches,match:n,params:n.params,loaderData:n.loaderData};return Promise.all([r.options.head?.(i),r.options.scripts?.(i),r.options.headers?.(i)]).then(([a,s,l])=>{const c=a?.meta,d=a?.links,p=a?.scripts,h=a?.styles;return{meta:c,links:d,headScripts:p,headers:l,scripts:s,styles:h}})},rL=(e,t,r,n)=>{const i=e.matchPromises[r-1],{params:a,loaderDeps:s,abortController:l,context:c,cause:d}=e.router.getMatch(t),p=Cg(e,t);return{params:a,deps:s,preload:!!p,parentMatchPromise:i,abortController:l,context:c,location:e.location,navigate:h=>e.router.navigate({...h,_fromLocation:e.location}),cause:p?"preload":d,route:n,...e.router.options.additionalContext}},CC=async(e,t,r,n)=>{try{const i=e.router.getMatch(t);try{(!e.router.isServer||i.ssr===!0)&&nL(n);const a=n.options.loader?.(rL(e,t,r,n)),s=n.options.loader&&bl(a);if(!!(s||n._lazyPromise||n._componentsPromise||n.options.head||n.options.scripts||n.options.headers||i._nonReactive.minPendingPromise)&&e.updateMatch(t,h=>({...h,isFetching:"loader"})),n.options.loader){const h=s?await a:a;yl(e,e.router.getMatch(t),h),h!==void 0&&e.updateMatch(t,m=>({...m,loaderData:h}))}n._lazyPromise&&await n._lazyPromise;const c=vv(e,t,n),d=c?await c:void 0,p=i._nonReactive.minPendingPromise;p&&await p,n._componentsPromise&&await n._componentsPromise,e.updateMatch(t,h=>({...h,error:void 0,status:"success",isFetching:!1,updatedAt:Date.now(),...d}))}catch(a){let s=a;const l=i._nonReactive.minPendingPromise;l&&await l,yl(e,e.router.getMatch(t),a);try{n.options.onError?.(a)}catch(p){s=p,yl(e,e.router.getMatch(t),p)}const c=vv(e,t,n),d=c?await c:void 0;e.updateMatch(t,p=>({...p,error:s,status:"error",isFetching:!1,...d}))}}catch(i){const a=e.router.getMatch(t);if(a){const s=vv(e,t,n);if(s){const l=await s;e.updateMatch(t,c=>({...c,...l}))}a._nonReactive.loaderPromise=void 0}yl(e,a,i)}},bk=async(e,t)=>{const{id:r,routeId:n}=e.matches[t];let i=!1,a=!1;const s=e.router.looseRoutesById[n];if(eL(e,r)){if(e.router.isServer){const d=vv(e,r,s);if(d){const p=await d;e.updateMatch(r,h=>({...h,...p}))}return e.router.getMatch(r)}}else{const d=e.router.getMatch(r);if(d._nonReactive.loaderPromise){if(d.status==="success"&&!e.sync&&!d.preload)return d;await d._nonReactive.loaderPromise;const p=e.router.getMatch(r);p.error&&yl(e,p,p.error)}else{const p=Date.now()-d.updatedAt,h=Cg(e,r),m=h?s.options.preloadStaleTime??e.router.options.defaultPreloadStaleTime??3e4:s.options.staleTime??e.router.options.defaultStaleTime??0,_=s.options.shouldReload,y=typeof _=="function"?_(rL(e,r,t,s)):_,E=!!h&&!e.router.state.matches.some(R=>R.id===r),T=e.router.getMatch(r);T._nonReactive.loaderPromise=Ud(),E!==T.preload&&e.updateMatch(r,R=>({...R,preload:E}));const{status:A,invalid:b}=T;if(i=A==="success"&&(b||(y??p>m)),!(h&&s.options.preload===!1))if(i&&!e.sync)a=!0,(async()=>{try{await CC(e,r,t,s);const R=e.router.getMatch(r);R._nonReactive.loaderPromise?.resolve(),R._nonReactive.loadPromise?.resolve(),R._nonReactive.loaderPromise=void 0}catch(R){ls(R)&&await e.router.navigate(R.options)}})();else if(A!=="success"||i&&e.sync)await CC(e,r,t,s);else{const R=vv(e,r,s);if(R){const M=await R;e.updateMatch(r,B=>({...B,...M}))}}}}const l=e.router.getMatch(r);a||(l._nonReactive.loaderPromise?.resolve(),l._nonReactive.loadPromise?.resolve()),clearTimeout(l._nonReactive.pendingTimeout),l._nonReactive.pendingTimeout=void 0,a||(l._nonReactive.loaderPromise=void 0),l._nonReactive.dehydrated=void 0;const c=a?l.isFetching:!1;return c!==l.isFetching||l.invalid!==!1?(e.updateMatch(r,d=>({...d,isFetching:c,invalid:!1})),e.router.getMatch(r)):l};async function OC(e){const t=Object.assign(e,{matchPromises:[]});!t.router.isServer&&t.router.state.matches.some(r=>r._forcePending)&&o0(t);try{for(let i=0;i<t.matches.length;i++){const a=Ak(t,i);bl(a)&&await a}const r=t.firstBadMatchIndex??t.matches.length;for(let i=0;i<r;i++)t.matchPromises.push(bk(t,i));await Promise.all(t.matchPromises);const n=o0(t);bl(n)&&await n}catch(r){if(ps(r)&&!t.preload){const n=o0(t);throw bl(n)&&await n,r}if(ls(r))throw r}return t.matches}async function nL(e){if(!e._lazyLoaded&&e._lazyPromise===void 0&&(e.lazyFn?e._lazyPromise=e.lazyFn().then(t=>{const{id:r,...n}=t.options;Object.assign(e.options,n),e._lazyLoaded=!0,e._lazyPromise=void 0}):e._lazyLoaded=!0),!e._componentsLoaded&&e._componentsPromise===void 0){const t=()=>{const r=[];for(const n of aL){const i=e.options[n]?.preload;i&&r.push(i())}if(r.length)return Promise.all(r).then(()=>{e._componentsLoaded=!0,e._componentsPromise=void 0});e._componentsLoaded=!0,e._componentsPromise=void 0};e._componentsPromise=e._lazyPromise?e._lazyPromise.then(t):t()}return e._componentsPromise}function w_(e,t){return t?{status:"error",error:t}:{status:"success",value:e}}function iL(e){for(const t of aL)if(e.options[t]?.preload)return!0;return!1}const aL=["component","errorComponent","pendingComponent","notFoundComponent"];function xk(e){return{input:({url:t})=>{for(const r of e)t=oL(r,t);return t},output:({url:t})=>{for(let r=e.length-1;r>=0;r--)t=sL(e[r],t);return t}}}function Rk(e){const t=Tb(e.basepath),r=new RegExp(`^/${t}/`,e.caseSensitive?"":"i");return{input:({url:n})=>(n.pathname=n.pathname.replace(r,"/"),n),output:({url:n})=>(n.pathname=ru(["/",t,n.pathname]),n)}}function oL(e,t){const r=e?.input?.({url:t});if(r){if(typeof r=="string")return new URL(r);if(r instanceof URL)return r}return t}function sL(e,t){const r=e?.output?.({url:t});if(r){if(typeof r=="string")return new URL(r);if(r instanceof URL)return r}return t}function Pc(e){const t=e.resolvedLocation,r=e.location,n=t?.pathname!==r.pathname,i=t?.href!==r.href,a=t?.hash!==r.hash;return{fromLocation:t,toLocation:r,pathChanged:n,hrefChanged:i,hashChanged:a}}class Ck{constructor(t){this.tempLocationKey=`${Math.round(Math.random()*1e7)}`,this.resetNextScroll=!0,this.shouldViewTransition=void 0,this.isViewTransitionTypesSupported=void 0,this.subscribers=new Set,this.isScrollRestoring=!1,this.isScrollRestorationSetup=!1,this.startTransition=r=>r(),this.update=r=>{if(r.notFoundRoute&&console.warn("The notFoundRoute API is deprecated and will be removed in the next major version. See https://tanstack.com/router/v1/docs/framework/react/guide/not-found-errors#migrating-from-notfoundroute for more info."),this.options={...this.options,...r},this.isServer=this.options.isServer??typeof document>"u",this.pathParamsDecodeCharMap=this.options.pathParamsAllowedCharacters?new Map(this.options.pathParamsAllowedCharacters.map(n=>[encodeURIComponent(n),n])):void 0,(!this.history||this.options.history&&this.options.history!==this.history)&&(this.options.history?this.history=this.options.history:this.isServer||(this.history=P8())),this.options.basepath){const n=Rk({basepath:this.options.basepath});this.options.rewrite?this.rewrite=xk([n,this.options.rewrite]):this.rewrite=n}else this.rewrite=this.options.rewrite;this.origin=this.options.origin,this.origin||(this.isServer?this.origin="http://localhost":this.origin=window.origin),this.history&&this.updateLatestLocation(),this.options.routeTree!==this.routeTree&&(this.routeTree=this.options.routeTree,this.buildRouteTree()),!this.__store&&this.latestLocation&&(this.__store=new yb(Mk(this.latestLocation),{onUpdate:()=>{this.__store.state={...this.state,cachedMatches:this.state.cachedMatches.filter(n=>!["redirected"].includes(n.status))}}}),ck(this)),typeof window<"u"&&"CSS"in window&&typeof window.CSS?.supports=="function"&&(this.isViewTransitionTypesSupported=window.CSS.supports("selector(:active-view-transition-type(a)"))},this.updateLatestLocation=()=>{this.latestLocation=this.parseLocation(this.history.location,this.latestLocation)},this.buildRouteTree=()=>{const{routesById:r,routesByPath:n,flatRoutes:i}=ak({routeTree:this.routeTree,initRoute:(s,l)=>{s.init({originalIndex:l})}});this.routesById=r,this.routesByPath=n,this.flatRoutes=i;const a=this.options.notFoundRoute;a&&(a.init({originalIndex:99999999999}),this.routesById[a.id]=a)},this.subscribe=(r,n)=>{const i={eventType:r,fn:n};return this.subscribers.add(i),()=>{this.subscribers.delete(i)}},this.emit=r=>{this.subscribers.forEach(n=>{n.eventType===r.type&&n.fn(r)})},this.parseLocation=(r,n)=>{const i=({href:c,state:d})=>{const p=new URL(c,this.origin),h=oL(this.rewrite,p),m=this.options.parseSearch(h.search),_=this.options.stringifySearch(m);h.search=_;const y=h.href.replace(h.origin,""),{pathname:E,hash:T}=h;return{href:y,publicHref:c,url:h.href,pathname:E,searchStr:_,search:Xa(n?.search,m),hash:T.split("#").reverse()[0]??"",state:Xa(n?.state,d)}},a=i(r),{__tempLocation:s,__tempKey:l}=a.state;if(s&&(!l||l===this.tempLocationKey)){const c=i(s);return c.state.key=a.state.key,c.state.__TSR_key=a.state.__TSR_key,delete c.state.__tempLocation,{...c,maskedLocation:a}}return a},this.resolvePathWithBase=(r,n)=>k8({base:r,to:Ix(n),trailingSlash:this.options.trailingSlash,parseCache:this.parsePathnameCache}),this.matchRoutes=(r,n,i)=>typeof r=="string"?this.matchRoutesInternal({pathname:r,search:n},i):this.matchRoutesInternal(r,n),this.parsePathnameCache=yk(1e3),this.getMatchedRoutes=(r,n)=>wk({pathname:r,routePathname:n,caseSensitive:this.options.caseSensitive,routesByPath:this.routesByPath,routesById:this.routesById,flatRoutes:this.flatRoutes,parseCache:this.parsePathnameCache}),this.cancelMatch=r=>{const n=this.getMatch(r);n&&(n.abortController.abort(),clearTimeout(n._nonReactive.pendingTimeout),n._nonReactive.pendingTimeout=void 0)},this.cancelMatches=()=>{this.state.pendingMatches?.forEach(r=>{this.cancelMatch(r.id)})},this.buildLocation=r=>{const n=(a={})=>{const s=a._fromLocation||this.latestLocation,l=this.matchRoutes(s,{_buildLocation:!0}),c=Eb(l);a.from;const d=a.unsafeRelative==="path"?s.pathname:a.from??c.fullPath,p=this.resolvePathWithBase(d,"."),h=c.search,m={...c.params},_=a.to?this.resolvePathWithBase(p,`${a.to}`):this.resolvePathWithBase(p,"."),y=a.params===!1||a.params===null?{}:(a.params??!0)===!0?m:Object.assign(m,Nc(a.params,m)),E=O_({path:_,params:y,parseCache:this.parsePathnameCache}).interpolatedPath,T=this.matchRoutes(E,void 0,{_buildLocation:!0}).map(Q=>this.looseRoutesById[Q.routeId]);if(Object.keys(y).length>0)for(const Q of T){const X=Q.options.params?.stringify??Q.options.stringifyParams;X&&Object.assign(y,X(y))}const A=O_({path:_,params:y,leaveWildcards:!1,leaveParams:r.leaveParams,decodeCharMap:this.pathParamsDecodeCharMap,parseCache:this.parsePathnameCache}).interpolatedPath;let b=h;if(r._includeValidateSearch&&this.options.search?.strict){const Q={};T.forEach(X=>{if(X.options.validateSearch)try{Object.assign(Q,bb(X.options.validateSearch,{...Q,...b}))}catch{}}),b=Q}b=Nk({search:b,dest:a,destRoutes:T,_includeValidateSearch:r._includeValidateSearch}),b=Xa(h,b);const R=this.options.stringifySearch(b),M=a.hash===!0?s.hash:a.hash?Nc(a.hash,s.hash):void 0,B=M?`#${M}`:"";let w=a.state===!0?s.state:a.state?Nc(a.state,s.state):{};w=Xa(s.state,w);const D=`${A}${R}${B}`,U=new URL(D,this.origin),ae=sL(this.rewrite,U);return{publicHref:ae.pathname+ae.search+ae.hash,href:D,url:ae.href,pathname:A,search:b,searchStr:R,state:w,hash:M??"",unmaskOnReload:a.unmaskOnReload}},i=(a={},s)=>{const l=n(a);let c=s?n(s):void 0;if(!c){let d={};const p=this.options.routeMasks?.find(h=>{const m=Sb(l.pathname,{to:h.from,caseSensitive:!1,fuzzy:!1},this.parsePathnameCache);return m?(d=m,!0):!1});if(p){const{from:h,...m}=p;s={from:r.from,...m,params:d},c=n(s)}}return c&&(l.maskedLocation=c),l};return r.mask?i(r,{from:r.from,...r.mask}):i(r)},this.commitLocation=({viewTransition:r,ignoreBlocker:n,...i})=>{const a=()=>{const c=["key","__TSR_key","__TSR_index","__hashScrollIntoViewOptions"];c.forEach(p=>{i.state[p]=this.latestLocation.state[p]});const d=Ic(i.state,this.latestLocation.state);return c.forEach(p=>{delete i.state[p]}),d},s=xl(this.latestLocation.href)===xl(i.href),l=this.commitLocationPromise;if(this.commitLocationPromise=Ud(()=>{l?.resolve()}),s&&a())this.load();else{let{maskedLocation:c,hashScrollIntoView:d,...p}=i;c&&(p={...c,state:{...c.state,__tempKey:void 0,__tempLocation:{...p,search:p.searchStr,state:{...p.state,__tempKey:void 0,__tempLocation:void 0,__TSR_key:void 0,key:void 0}}}},(p.unmaskOnReload??this.options.unmaskOnReload??!1)&&(p.state.__tempKey=this.tempLocationKey)),p.state.__hashScrollIntoViewOptions=d??this.options.defaultHashScrollIntoView??!0,this.shouldViewTransition=r,this.history[i.replace?"replace":"push"](p.publicHref,p.state,{ignoreBlocker:n})}return this.resetNextScroll=i.resetScroll??!0,this.history.subscribers.size||this.load(),this.commitLocationPromise},this.buildAndCommitLocation=({replace:r,resetScroll:n,hashScrollIntoView:i,viewTransition:a,ignoreBlocker:s,href:l,...c}={})=>{if(l){const p=this.history.location.state.__TSR_index,h=R0(l,{__TSR_index:r?p:p+1});c.to=h.pathname,c.search=this.options.parseSearch(h.search),c.hash=h.hash.slice(1)}const d=this.buildLocation({...c,_includeValidateSearch:!0});return this.commitLocation({...d,viewTransition:a,replace:r,resetScroll:n,hashScrollIntoView:i,ignoreBlocker:s})},this.navigate=({to:r,reloadDocument:n,href:i,...a})=>{if(!n&&i)try{new URL(`${i}`),n=!0}catch{}return n?(i||(i=this.buildLocation({to:r,...a}).href),a.replace?window.location.replace(i):window.location.href=i,Promise.resolve()):this.buildAndCommitLocation({...a,href:i,to:r,_isNavigate:!0})},this.beforeLoad=()=>{if(this.cancelMatches(),this.updateLatestLocation(),this.isServer){const n=this.buildLocation({to:this.latestLocation.pathname,search:!0,params:!0,hash:!0,state:!0,_includeValidateSearch:!0}),i=a=>{try{return encodeURI(decodeURI(a))}catch{return a}};if(Tb(i(this.latestLocation.href))!==Tb(i(n.href)))throw gk({href:n.href})}const r=this.matchRoutes(this.latestLocation);this.__store.setState(n=>({...n,status:"pending",statusCode:200,isLoading:!0,location:this.latestLocation,pendingMatches:r,cachedMatches:n.cachedMatches.filter(i=>!r.some(a=>a.id===i.id))}))},this.load=async r=>{let n,i,a;for(a=new Promise(s=>{this.startTransition(async()=>{try{this.beforeLoad();const l=this.latestLocation,c=this.state.resolvedLocation;this.state.redirect||this.emit({type:"onBeforeNavigate",...Pc({resolvedLocation:c,location:l})}),this.emit({type:"onBeforeLoad",...Pc({resolvedLocation:c,location:l})}),await OC({router:this,sync:r?.sync,matches:this.state.pendingMatches,location:l,updateMatch:this.updateMatch,onReady:async()=>{this.startViewTransition(async()=>{let d,p,h;pv(()=>{this.__store.setState(m=>{const _=m.matches,y=m.pendingMatches||m.matches;return d=_.filter(E=>!y.some(T=>T.id===E.id)),p=y.filter(E=>!_.some(T=>T.id===E.id)),h=_.filter(E=>y.some(T=>T.id===E.id)),{...m,isLoading:!1,loadedAt:Date.now(),matches:y,pendingMatches:void 0,cachedMatches:[...m.cachedMatches,...d.filter(E=>E.status!=="error")]}}),this.clearExpiredCache()}),[[d,"onLeave"],[p,"onEnter"],[h,"onStay"]].forEach(([m,_])=>{m.forEach(y=>{this.looseRoutesById[y.routeId].options[_]?.(y)})})})}})}catch(l){ls(l)?(n=l,this.isServer||this.navigate({...n.options,replace:!0,ignoreBlocker:!0})):ps(l)&&(i=l),this.__store.setState(c=>({...c,statusCode:n?n.status:i?404:c.matches.some(d=>d.status==="error")?500:200,redirect:n}))}this.latestLoadPromise===a&&(this.commitLocationPromise?.resolve(),this.latestLoadPromise=void 0,this.commitLocationPromise=void 0),s()})}),this.latestLoadPromise=a,await a;this.latestLoadPromise&&a!==this.latestLoadPromise;)await this.latestLoadPromise;this.hasNotFoundMatch()&&this.__store.setState(s=>({...s,statusCode:404}))},this.startViewTransition=r=>{const n=this.shouldViewTransition??this.options.defaultViewTransition;if(delete this.shouldViewTransition,n&&typeof document<"u"&&"startViewTransition"in document&&typeof document.startViewTransition=="function"){let i;if(typeof n=="object"&&this.isViewTransitionTypesSupported){const a=this.latestLocation,s=this.state.resolvedLocation,l=typeof n.types=="function"?n.types(Pc({resolvedLocation:s,location:a})):n.types;i={update:r,types:l}}else i=r;document.startViewTransition(i)}else r()},this.updateMatch=(r,n)=>{const i=this.state.pendingMatches?.some(a=>a.id===r)?"pendingMatches":this.state.matches.some(a=>a.id===r)?"matches":this.state.cachedMatches.some(a=>a.id===r)?"cachedMatches":"";i&&this.__store.setState(a=>({...a,[i]:a[i]?.map(s=>s.id===r?n(s):s)}))},this.getMatch=r=>{const n=i=>i.id===r;return this.state.cachedMatches.find(n)??this.state.pendingMatches?.find(n)??this.state.matches.find(n)},this.invalidate=r=>{const n=i=>r?.filter?.(i)??!0?{...i,invalid:!0,...r?.forcePending||i.status==="error"?{status:"pending",error:void 0}:void 0}:i;return this.__store.setState(i=>({...i,matches:i.matches.map(n),cachedMatches:i.cachedMatches.map(n),pendingMatches:i.pendingMatches?.map(n)})),this.shouldViewTransition=!1,this.load({sync:r?.sync})},this.resolveRedirect=r=>(r.options.href||(r.options.href=this.buildLocation(r.options).href,r.headers.set("Location",r.options.href)),r.headers.get("Location")||r.headers.set("Location",r.options.href),r),this.clearCache=r=>{const n=r?.filter;n!==void 0?this.__store.setState(i=>({...i,cachedMatches:i.cachedMatches.filter(a=>!n(a))})):this.__store.setState(i=>({...i,cachedMatches:[]}))},this.clearExpiredCache=()=>{const r=n=>{const i=this.looseRoutesById[n.routeId];if(!i.options.loader)return!0;const a=(n.preload?i.options.preloadGcTime??this.options.defaultPreloadGcTime:i.options.gcTime??this.options.defaultGcTime)??300*1e3;return n.status==="error"?!0:Date.now()-n.updatedAt>=a};this.clearCache({filter:r})},this.loadRouteChunk=nL,this.preloadRoute=async r=>{const n=this.buildLocation(r);let i=this.matchRoutes(n,{throwOnError:!0,preload:!0,dest:r});const a=new Set([...this.state.matches,...this.state.pendingMatches??[]].map(l=>l.id)),s=new Set([...a,...this.state.cachedMatches.map(l=>l.id)]);pv(()=>{i.forEach(l=>{s.has(l.id)||this.__store.setState(c=>({...c,cachedMatches:[...c.cachedMatches,l]}))})});try{return i=await OC({router:this,matches:i,location:n,preload:!0,updateMatch:(l,c)=>{a.has(l)?i=i.map(d=>d.id===l?c(d):d):this.updateMatch(l,c)}}),i}catch(l){if(ls(l))return l.options.reloadDocument?void 0:await this.preloadRoute({...l.options,_fromLocation:n});ps(l)||console.error(l);return}},this.matchRoute=(r,n)=>{const i={...r,to:r.to?this.resolvePathWithBase(r.from||"",r.to):void 0,params:r.params||{},leaveParams:!0},a=this.buildLocation(i);if(n?.pending&&this.state.status!=="pending")return!1;const l=(n?.pending===void 0?!this.state.isLoading:n.pending)?this.latestLocation:this.state.resolvedLocation||this.state.location,c=Sb(l.pathname,{...n,to:a.pathname},this.parsePathnameCache);return!c||r.params&&!Ic(c,r.params,{partial:!0})?!1:c&&(n?.includeSearch??!0)?Ic(l.search,a.search,{partial:!0})?c:!1:c},this.hasNotFoundMatch=()=>this.__store.state.matches.some(r=>r.status==="notFound"||r.globalNotFound),this.update({defaultPreloadDelay:50,defaultPendingMs:1e3,defaultPendingMinMs:500,context:void 0,...t,caseSensitive:t.caseSensitive??!1,notFoundMode:t.notFoundMode??"fuzzy",stringifySearch:t.stringifySearch??vk,parseSearch:t.parseSearch??pk}),typeof document<"u"&&(self.__TSR_ROUTER__=this)}isShell(){return!!this.options.isShell}isPrerendering(){return!!this.options.isPrerendering}get state(){return this.__store.state}get looseRoutesById(){return this.routesById}matchRoutesInternal(t,r){const{foundRoute:n,matchedRoutes:i,routeParams:a}=this.getMatchedRoutes(t.pathname,r?.dest?.to);let s=!1;(n?n.path!=="/"&&a["**"]:xl(t.pathname))&&(this.options.notFoundRoute?i.push(this.options.notFoundRoute):s=!0);const l=(()=>{if(s){if(this.options.notFoundMode!=="root")for(let p=i.length-1;p>=0;p--){const h=i[p];if(h.children)return h.id}return qa}})(),c=[],d=p=>p?.id?p.context??this.options.context??void 0:this.options.context??void 0;return i.forEach((p,h)=>{const m=c[h-1],[_,y,E]=(()=>{const x=m?.search??t.search,P=m?._strictSearch??void 0;try{const H=bb(p.options.validateSearch,{...x})??void 0;return[{...x,...H},{...P,...H},void 0]}catch(H){let pe=H;if(H instanceof N0||(pe=new N0(H.message,{cause:H})),r?.throwOnError)throw pe;return[x,{},pe]}})(),T=p.options.loaderDeps?.({search:_})??"",A=T?JSON.stringify(T):"",{interpolatedPath:b,usedParams:R}=O_({path:p.fullPath,params:a,decodeCharMap:this.pathParamsDecodeCharMap}),M=O_({path:p.id,params:a,leaveWildcards:!0,decodeCharMap:this.pathParamsDecodeCharMap,parseCache:this.parsePathnameCache}).interpolatedPath+A,B=this.getMatch(M),w=this.state.matches.find(x=>x.routeId===p.id),D=B?._strictParams??R;let U;if(!B){const x=p.options.params?.parse??p.options.parseParams;if(x)try{Object.assign(D,x(D))}catch(P){if(U=new Ok(P.message,{cause:P}),r?.throwOnError)throw U}}Object.assign(a,D);const ae=w?"stay":"enter";let Q;if(B)Q={...B,cause:ae,params:w?Xa(w.params,a):a,_strictParams:D,search:Xa(w?w.search:B.search,_),_strictSearch:y};else{const x=p.options.loader||p.options.beforeLoad||p.lazyFn||iL(p)?"pending":"success";Q={id:M,index:h,routeId:p.id,params:w?Xa(w.params,a):a,_strictParams:D,pathname:b,updatedAt:Date.now(),search:w?Xa(w.search,_):_,_strictSearch:y,searchError:void 0,status:x,isFetching:!1,error:void 0,paramsError:U,__routeContext:void 0,_nonReactive:{loadPromise:Ud()},__beforeLoadContext:void 0,context:{},abortController:new AbortController,fetchCount:0,cause:ae,loaderDeps:w?Xa(w.loaderDeps,T):T,invalid:!1,preload:!1,links:void 0,scripts:void 0,headScripts:void 0,meta:void 0,staticData:p.options.staticData||{},fullPath:p.fullPath}}r?.preload||(Q.globalNotFound=l===p.id),Q.searchError=E;const X=d(m);Q.context={...X,...Q.__routeContext,...Q.__beforeLoadContext},c.push(Q)}),c.forEach((p,h)=>{const m=this.looseRoutesById[p.routeId];if(!this.getMatch(p.id)&&r?._buildLocation!==!0){const y=c[h-1],E=d(y);if(m.options.context){const T={deps:p.loaderDeps,params:p.params,context:E??{},location:t,navigate:A=>this.navigate({...A,_fromLocation:t}),buildLocation:this.buildLocation,cause:p.cause,abortController:p.abortController,preload:!!p.preload,matches:c};p.__routeContext=m.options.context(T)??void 0}p.context={...E,...p.__routeContext,...p.__beforeLoadContext}}}),c}}class N0 extends Error{}class Ok extends Error{}function Mk(e){return{loadedAt:0,isLoading:!1,isTransitioning:!1,status:"idle",resolvedLocation:void 0,location:e,matches:[],pendingMatches:[],cachedMatches:[],statusCode:200}}function bb(e,t){if(e==null)return{};if("~standard"in e){const r=e["~standard"].validate(t);if(r instanceof Promise)throw new N0("Async validation not supported");if(r.issues)throw new N0(JSON.stringify(r.issues,void 0,2),{cause:r});return r.value}return"parse"in e?e.parse(t):typeof e=="function"?e(t):{}}function wk({pathname:e,routePathname:t,caseSensitive:r,routesByPath:n,routesById:i,flatRoutes:a,parseCache:s}){let l={};const c=xl(e),d=_=>Sb(c,{to:_.fullPath,caseSensitive:_.options?.caseSensitive??r,fuzzy:!0},s);let p=t!==void 0?n[t]:void 0;if(p)l=d(p);else{let _;for(const y of a){const E=d(y);if(E)if(y.path!=="/"&&E["**"])_||(_={foundRoute:y,routeParams:E});else{p=y,l=E;break}}!p&&_&&(p=_.foundRoute,l=_.routeParams)}let h=p||i[qa];const m=[h];for(;h.parentRoute;)h=h.parentRoute,m.push(h);return m.reverse(),{matchedRoutes:m,routeParams:l,foundRoute:p}}function Nk({search:e,dest:t,destRoutes:r,_includeValidateSearch:n}){const i=r.reduce((l,c)=>{const d=[];if("search"in c.options)c.options.search?.middlewares&&d.push(...c.options.search.middlewares);else if(c.options.preSearchFilters||c.options.postSearchFilters){const p=({search:h,next:m})=>{let _=h;"preSearchFilters"in c.options&&c.options.preSearchFilters&&(_=c.options.preSearchFilters.reduce((E,T)=>T(E),h));const y=m(_);return"postSearchFilters"in c.options&&c.options.postSearchFilters?c.options.postSearchFilters.reduce((E,T)=>T(E),y):y};d.push(p)}if(n&&c.options.validateSearch){const p=({search:h,next:m})=>{const _=m(h);try{return{..._,...bb(c.options.validateSearch,_)??void 0}}catch{return _}};d.push(p)}return l.concat(d)},[])??[],a=({search:l})=>t.search?t.search===!0?l:Nc(t.search,l):{};i.push(a);const s=(l,c)=>{if(l>=i.length)return c;const d=i[l];return d({search:c,next:h=>s(l+1,h)})};return s(0,e)}const Ik="Error preloading route! ☝️";class uL{constructor(t){if(this.init=r=>{this.originalIndex=r.originalIndex;const n=this.options,i=!n?.path&&!n?.id;this.parentRoute=this.options.getParentRoute?.(),i?this._path=qa:this.parentRoute||au(!1);let a=i?qa:n?.path;a&&a!=="/"&&(a=Px(a));const s=n?.id||a;let l=i?qa:ru([this.parentRoute.id===qa?"":this.parentRoute.id,s]);a===qa&&(a="/"),l!==qa&&(l=ru(["/",l]));const c=l===qa?"/":ru([this.parentRoute.fullPath,a]);this._path=a,this._id=l,this._fullPath=c,this._to=c},this.clone=r=>{this._path=r._path,this._id=r._id,this._fullPath=r._fullPath,this._to=r._to,this.options.getParentRoute=r.options.getParentRoute,this.children=r.children},this.addChildren=r=>this._addFileChildren(r),this._addFileChildren=r=>(Array.isArray(r)&&(this.children=r),typeof r=="object"&&r!==null&&(this.children=Object.values(r)),this),this._addFileTypes=()=>this,this.updateLoader=r=>(Object.assign(this.options,r),this),this.update=r=>(Object.assign(this.options,r),this),this.lazy=r=>(this.lazyFn=r,this),this.options=t||{},this.isRoot=!t?.getParentRoute,t?.id&&t?.path)throw new Error("Route cannot have both an 'id' and a 'path' option.")}get to(){return this._to}get id(){return this._id}get path(){return this._path}get fullPath(){return this._fullPath}}class Pk extends uL{constructor(t){super(t)}}function Dx(e){const t=e.errorComponent??Og;return ze.jsx(Dk,{getResetKey:e.getResetKey,onCatch:e.onCatch,children:({error:r,reset:n})=>r?q.createElement(t,{error:r,reset:n}):e.children})}class Dk extends q.Component{constructor(){super(...arguments),this.state={error:null}}static getDerivedStateFromProps(t){return{resetKey:t.getResetKey()}}static getDerivedStateFromError(t){return{error:t}}reset(){this.setState({error:null})}componentDidUpdate(t,r){r.error&&r.resetKey!==this.state.resetKey&&this.reset()}componentDidCatch(t,r){this.props.onCatch&&this.props.onCatch(t,r)}render(){return this.props.children({error:this.state.resetKey!==this.props.getResetKey()?null:this.state.error,reset:()=>{this.reset()}})}}function Og({error:e}){const[t,r]=q.useState(!1);return ze.jsxs("div",{style:{padding:".5rem",maxWidth:"100%"},children:[ze.jsxs("div",{style:{display:"flex",alignItems:"center",gap:".5rem"},children:[ze.jsx("strong",{style:{fontSize:"1rem"},children:"Something went wrong!"}),ze.jsx("button",{style:{appearance:"none",fontSize:".6em",border:"1px solid currentColor",padding:".1rem .2rem",fontWeight:"bold",borderRadius:".25rem"},onClick:()=>r(n=>!n),children:t?"Hide Error":"Show Error"})]}),ze.jsx("div",{style:{height:".25rem"}}),t?ze.jsx("div",{children:ze.jsx("pre",{style:{fontSize:".7em",border:"1px solid red",borderRadius:".25rem",padding:".3rem",color:"red",overflow:"auto"},children:e.message?ze.jsx("code",{children:e.message}):null})}):null]})}function Lk({children:e,fallback:t=null}){return Bk()?ze.jsx(ua.Fragment,{children:e}):ze.jsx(ua.Fragment,{children:t})}function Bk(){return ua.useSyncExternalStore(Fk,()=>!0,()=>!1)}function Fk(){return()=>{}}var lE={exports:{}},cE={},fE={exports:{}},dE={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var MC;function Uk(){if(MC)return dE;MC=1;var e=Ag();function t(h,m){return h===m&&(h!==0||1/h===1/m)||h!==h&&m!==m}var r=typeof Object.is=="function"?Object.is:t,n=e.useState,i=e.useEffect,a=e.useLayoutEffect,s=e.useDebugValue;function l(h,m){var _=m(),y=n({inst:{value:_,getSnapshot:m}}),E=y[0].inst,T=y[1];return a(function(){E.value=_,E.getSnapshot=m,c(E)&&T({inst:E})},[h,_,m]),i(function(){return c(E)&&T({inst:E}),h(function(){c(E)&&T({inst:E})})},[h]),s(_),_}function c(h){var m=h.getSnapshot;h=h.value;try{var _=m();return!r(h,_)}catch{return!0}}function d(h,m){return m()}var p=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?d:l;return dE.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:p,dE}var wC;function kk(){return wC||(wC=1,fE.exports=Uk()),fE.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var NC;function zk(){if(NC)return cE;NC=1;var e=Ag(),t=kk();function r(d,p){return d===p&&(d!==0||1/d===1/p)||d!==d&&p!==p}var n=typeof Object.is=="function"?Object.is:r,i=t.useSyncExternalStore,a=e.useRef,s=e.useEffect,l=e.useMemo,c=e.useDebugValue;return cE.useSyncExternalStoreWithSelector=function(d,p,h,m,_){var y=a(null);if(y.current===null){var E={hasValue:!1,value:null};y.current=E}else E=y.current;y=l(function(){function A(w){if(!b){if(b=!0,R=w,w=m(w),_!==void 0&&E.hasValue){var D=E.value;if(_(D,w))return M=D}return M=w}if(D=M,n(R,w))return D;var U=m(w);return _!==void 0&&_(D,U)?(R=w,D):(R=w,M=U)}var b=!1,R,M,B=h===void 0?null:h;return[function(){return A(p())},B===null?void 0:function(){return A(B())}]},[p,h,m,_]);var T=i(d,y[0],y[1]);return s(function(){E.hasValue=!0,E.value=T},[T]),c(T),T},cE}var IC;function jk(){return IC||(IC=1,lE.exports=zk()),lE.exports}var Hk=jk();function Vk(e,t=r=>r){return Hk.useSyncExternalStoreWithSelector(e.subscribe,()=>e.state,()=>e.state,t,Xk)}function Xk(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[n,i]of e)if(!t.has(n)||!Object.is(i,t.get(n)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}if(e instanceof Date&&t instanceof Date)return e.getTime()===t.getTime();const r=PC(e);if(r.length!==PC(t).length)return!1;for(let n=0;n<r.length;n++)if(!Object.prototype.hasOwnProperty.call(t,r[n])||!Object.is(e[r[n]],t[r[n]]))return!1;return!0}function PC(e){return Object.keys(e).concat(Object.getOwnPropertySymbols(e))}const hE=q.createContext(null);function lL(){return typeof document>"u"?hE:window.__TSR_ROUTER_CONTEXT__?window.__TSR_ROUTER_CONTEXT__:(window.__TSR_ROUTER_CONTEXT__=hE,hE)}function Ra(e){const t=q.useContext(lL());return e?.warn,t}function ca(e){const t=Ra({warn:e?.router===void 0}),r=e?.router||t,n=q.useRef(void 0);return Vk(r.__store,i=>{if(e?.select){if(e.structuralSharing??r.options.defaultStructuralSharing){const a=Xa(n.current,e.select(i));return n.current=a,a}return e.select(i)}return i})}const Mg=q.createContext(void 0),Gk=q.createContext(void 0);function vs(e){const t=q.useContext(e.from?Gk:Mg);return ca({select:n=>{const i=n.matches.find(a=>e.from?e.from===a.routeId:a.id===t);if(au(!((e.shouldThrow??!0)&&!i),`Could not find ${e.from?`an active match from "${e.from}"`:"a nearest match!"}`),i!==void 0)return e.select?e.select(i):i},structuralSharing:e.structuralSharing})}function Lx(e){return vs({from:e.from,strict:e.strict,structuralSharing:e.structuralSharing,select:t=>e.select?e.select(t.loaderData):t.loaderData})}function Bx(e){const{select:t,...r}=e;return vs({...r,select:n=>t?t(n.loaderDeps):n.loaderDeps})}function Fx(e){return vs({from:e.from,shouldThrow:e.shouldThrow,structuralSharing:e.structuralSharing,strict:e.strict,select:t=>{const r=e.strict===!1?t.params:t._strictParams;return e.select?e.select(r):r}})}function Ux(e){return vs({from:e.from,strict:e.strict,shouldThrow:e.shouldThrow,structuralSharing:e.structuralSharing,select:t=>e.select?e.select(t.search):t.search})}function kx(e){const t=Ra();return q.useCallback(r=>t.navigate({...r,from:r.from??e?.from}),[e?.from,t])}var th=zD();const qk=Pr(th),N_=typeof window<"u"?q.useLayoutEffect:q.useEffect;function pE(e){const t=q.useRef({value:e,prev:null}),r=t.current.value;return e!==r&&(t.current={value:e,prev:r}),t.current.prev}function Wk(e,t,r={},n={}){q.useEffect(()=>{if(!e.current||n.disabled||typeof IntersectionObserver!="function")return;const i=new IntersectionObserver(([a])=>{t(a)},r);return i.observe(e.current),()=>{i.disconnect()}},[t,r,n.disabled,e])}function Yk(e){const t=q.useRef(null);return q.useImperativeHandle(e,()=>t.current,[]),t}function $k(e,t){const r=Ra(),[n,i]=q.useState(!1),a=q.useRef(!1),s=Yk(t),{activeProps:l,inactiveProps:c,activeOptions:d,to:p,preload:h,preloadDelay:m,hashScrollIntoView:_,replace:y,startTransition:E,resetScroll:T,viewTransition:A,children:b,target:R,disabled:M,style:B,className:w,onClick:D,onFocus:U,onMouseEnter:ae,onMouseLeave:Q,onTouchStart:X,ignoreBlocker:x,params:P,search:H,hash:pe,state:O,mask:F,reloadDocument:z,unsafeRelative:re,from:oe,_fromLocation:_e,...ye}=e,Ie=ca({select:V=>V.location.search,structuralSharing:!0}),Je=e.from,We=q.useMemo(()=>({...e,from:Je}),[r,Ie,Je,e._fromLocation,e.hash,e.to,e.search,e.params,e.state,e.mask,e.unsafeRelative]),Ct=q.useMemo(()=>r.buildLocation({...We}),[r,We]),Ve=q.useMemo(()=>{if(M)return;let V=Ct.maskedLocation?Ct.maskedLocation.url:Ct.url,jr=!1;return r.origin&&(V.startsWith(r.origin)?V=V.replace(r.origin,"")||"/":jr=!0),{href:V,external:jr}},[M,Ct.maskedLocation,Ct.url,r.origin]),yt=q.useMemo(()=>{if(Ve?.external)return Ve.href;try{return new URL(p),p}catch{}},[p,Ve]),Ue=e.reloadDocument||yt?!1:h??r.options.defaultPreload,ge=m??r.options.defaultPreloadDelay??0,nt=ca({select:V=>{if(yt)return!1;if(d?.exact){if(!F8(V.location.pathname,Ct.pathname,r.basepath))return!1}else{const jr=O0(V.location.pathname,r.basepath),en=O0(Ct.pathname,r.basepath);if(!(jr.startsWith(en)&&(jr.length===en.length||jr[en.length]==="/")))return!1}return(d?.includeSearch??!0)&&!Ic(V.location.search,Ct.search,{partial:!d?.exact,ignoreUndefined:!d?.explicitUndefined})?!1:d?.includeHash?V.location.hash===Ct.hash:!0}}),Ce=q.useCallback(()=>{r.preloadRoute({...We}).catch(V=>{console.warn(V),console.warn(Ik)})},[r,We]),zt=q.useCallback(V=>{V?.isIntersecting&&Ce()},[Ce]);Wk(s,zt,e9,{disabled:!!M||Ue!=="viewport"}),q.useEffect(()=>{a.current||!M&&Ue==="render"&&(Ce(),a.current=!0)},[M,Ce,Ue]);const jt=V=>{const jr=V.currentTarget.target,en=R!==void 0?R:jr;if(!M&&!t9(V)&&!V.defaultPrevented&&(!en||en==="_self")&&V.button===0){V.preventDefault(),th.flushSync(()=>{i(!0)});const Hn=r.subscribe("onResolved",()=>{Hn(),i(!1)});r.navigate({...We,replace:y,resetScroll:T,hashScrollIntoView:_,startTransition:E,viewTransition:A,ignoreBlocker:x})}};if(yt)return{...ye,ref:s,href:yt,...b&&{children:b},...R&&{target:R},...M&&{disabled:M},...B&&{style:B},...w&&{className:w},...D&&{onClick:D},...U&&{onFocus:U},...ae&&{onMouseEnter:ae},...Q&&{onMouseLeave:Q},...X&&{onTouchStart:X}};const _t=V=>{M||Ue&&Ce()},Ot=_t,xt=V=>{if(!(M||!Ue))if(!ge)Ce();else{const jr=V.target;if(Tp.has(jr))return;const en=setTimeout(()=>{Tp.delete(jr),Ce()},ge);Tp.set(jr,en)}},Xt=V=>{if(M||!Ue||!ge)return;const jr=V.target,en=Tp.get(jr);en&&(clearTimeout(en),Tp.delete(jr))},Or=nt?Nc(l,{})??Zk:vE,qr=nt?vE:Nc(c,{})??vE,Tr=[w,Or.className,qr.className].filter(Boolean).join(" "),zr=(B||Or.style||qr.style)&&{...B,...Or.style,...qr.style};return{...ye,...Or,...qr,href:Ve?.href,ref:s,onClick:Sp([D,jt]),onFocus:Sp([U,_t]),onMouseEnter:Sp([ae,xt]),onMouseLeave:Sp([Q,Xt]),onTouchStart:Sp([X,Ot]),disabled:!!M,target:R,...zr&&{style:zr},...Tr&&{className:Tr},...M&&Kk,...nt&&Qk,...n&&Jk}}const vE={},Zk={className:"active"},Kk={role:"link","aria-disabled":!0},Qk={"data-status":"active","aria-current":"page"},Jk={"data-transitioning":"transitioning"},Tp=new WeakMap,e9={rootMargin:"100px"},Sp=e=>t=>{for(const r of e)if(r){if(t.defaultPrevented)return;r(t)}},zx=q.forwardRef((e,t)=>{const{_asChild:r,...n}=e,{type:i,ref:a,...s}=$k(n,t),l=typeof n.children=="function"?n.children({isActive:s["data-status"]==="active"}):n.children;return r===void 0&&delete s.disabled,q.createElement(r||"a",{...s,ref:a},l)});function t9(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}class r9 extends uL{constructor(t){super(t),this.useMatch=r=>vs({select:r?.select,from:this.id,structuralSharing:r?.structuralSharing}),this.useRouteContext=r=>vs({...r,from:this.id,select:n=>r?.select?r.select(n.context):n.context}),this.useSearch=r=>Ux({select:r?.select,structuralSharing:r?.structuralSharing,from:this.id}),this.useParams=r=>Fx({select:r?.select,structuralSharing:r?.structuralSharing,from:this.id}),this.useLoaderDeps=r=>Bx({...r,from:this.id}),this.useLoaderData=r=>Lx({...r,from:this.id}),this.useNavigate=()=>kx({from:this.fullPath}),this.Link=ua.forwardRef((r,n)=>ze.jsx(zx,{ref:n,from:this.fullPath,...r})),this.$$typeof=Symbol.for("react.memo")}}function jx(e){return new r9(e)}class n9 extends Pk{constructor(t){super(t),this.useMatch=r=>vs({select:r?.select,from:this.id,structuralSharing:r?.structuralSharing}),this.useRouteContext=r=>vs({...r,from:this.id,select:n=>r?.select?r.select(n.context):n.context}),this.useSearch=r=>Ux({select:r?.select,structuralSharing:r?.structuralSharing,from:this.id}),this.useParams=r=>Fx({select:r?.select,structuralSharing:r?.structuralSharing,from:this.id}),this.useLoaderDeps=r=>Bx({...r,from:this.id}),this.useLoaderData=r=>Lx({...r,from:this.id}),this.useNavigate=()=>kx({from:this.fullPath}),this.Link=ua.forwardRef((r,n)=>ze.jsx(zx,{ref:n,from:this.fullPath,...r})),this.$$typeof=Symbol.for("react.memo")}}function i9(e){return new n9(e)}function DC(e){return typeof e=="object"?new LC(e,{silent:!0}).createRoute(e):new LC(e,{silent:!0}).createRoute}class LC{constructor(t,r){this.path=t,this.createRoute=n=>{this.silent;const i=jx(n);return i.isRoot=!1,i},this.silent=r?.silent}}class BC{constructor(t){this.useMatch=r=>vs({select:r?.select,from:this.options.id,structuralSharing:r?.structuralSharing}),this.useRouteContext=r=>vs({from:this.options.id,select:n=>r?.select?r.select(n.context):n.context}),this.useSearch=r=>Ux({select:r?.select,structuralSharing:r?.structuralSharing,from:this.options.id}),this.useParams=r=>Fx({select:r?.select,structuralSharing:r?.structuralSharing,from:this.options.id}),this.useLoaderDeps=r=>Bx({...r,from:this.options.id}),this.useLoaderData=r=>Lx({...r,from:this.options.id}),this.useNavigate=()=>{const r=Ra();return kx({from:r.routesById[this.options.id].fullPath})},this.options=t,this.$$typeof=Symbol.for("react.memo")}}function FC(e){return typeof e=="object"?new BC(e):t=>new BC({id:e,...t})}function a9(){const e=Ra(),t=q.useRef({router:e,mounted:!1}),[r,n]=q.useState(!1),{hasPendingMatches:i,isLoading:a}=ca({select:h=>({isLoading:h.isLoading,hasPendingMatches:h.matches.some(m=>m.status==="pending")}),structuralSharing:!0}),s=pE(a),l=a||r||i,c=pE(l),d=a||i,p=pE(d);return e.startTransition=h=>{n(!0),q.startTransition(()=>{h(),n(!1)})},q.useEffect(()=>{const h=e.history.subscribe(e.load),m=e.buildLocation({to:e.latestLocation.pathname,search:!0,params:!0,hash:!0,state:!0,_includeValidateSearch:!0});return xl(e.latestLocation.href)!==xl(m.href)&&e.commitLocation({...m,replace:!0}),()=>{h()}},[e,e.history]),N_(()=>{if(typeof window<"u"&&e.ssr||t.current.router===e&&t.current.mounted)return;t.current={router:e,mounted:!0},(async()=>{try{await e.load()}catch(m){console.error(m)}})()},[e]),N_(()=>{s&&!a&&e.emit({type:"onLoad",...Pc(e.state)})},[s,e,a]),N_(()=>{p&&!d&&e.emit({type:"onBeforeRouteMount",...Pc(e.state)})},[d,p,e]),N_(()=>{c&&!l&&(e.emit({type:"onResolved",...Pc(e.state)}),e.__store.setState(h=>({...h,status:"idle",resolvedLocation:h.location})),fk(e))},[l,c,e]),null}function o9(e){const t=ca({select:r=>`not-found-${r.location.pathname}-${r.status}`});return ze.jsx(Dx,{getResetKey:()=>t,onCatch:(r,n)=>{if(ps(r))e.onCatch?.(r,n);else throw r},errorComponent:({error:r})=>{if(ps(r))return e.fallback?.(r);throw r},children:e.children})}function s9(){return ze.jsx("p",{children:"Not Found"})}function Ed(e){return ze.jsx(ze.Fragment,{children:e.children})}function cL(e,t,r){return t.options.notFoundComponent?ze.jsx(t.options.notFoundComponent,{data:r}):e.options.defaultNotFoundComponent?ze.jsx(e.options.defaultNotFoundComponent,{data:r}):ze.jsx(s9,{})}function u9({children:e}){const t=Ra();return t.isServer?ze.jsx("script",{nonce:t.options.ssr?.nonce,className:"$tsr",dangerouslySetInnerHTML:{__html:[e].filter(Boolean).join(`
`)+";$_TSR.c()"}}):null}function l9(){const e=Ra();if(!e.isScrollRestoring||!e.isServer||typeof e.options.scrollRestoration=="function"&&!e.options.scrollRestoration({location:e.latestLocation}))return null;const r=(e.options.getScrollRestorationKey||Ab)(e.latestLocation),n=r!==Ab(e.latestLocation)?r:void 0,i={storageKey:M0,shouldScrollRestoration:!0};return n&&(i.key=n),ze.jsx(u9,{children:`(${QD.toString()})(${JSON.stringify(i)})`})}const fL=q.memo(function({matchId:t}){const r=Ra(),n=ca({select:A=>{const b=A.matches.find(R=>R.id===t);return au(b),{routeId:b.routeId,ssr:b.ssr,_displayPending:b._displayPending}},structuralSharing:!0}),i=r.routesById[n.routeId],a=i.options.pendingComponent??r.options.defaultPendingComponent,s=a?ze.jsx(a,{}):null,l=i.options.errorComponent??r.options.defaultErrorComponent,c=i.options.onCatch??r.options.defaultOnCatch,d=i.isRoot?i.options.notFoundComponent??r.options.notFoundRoute?.options.component:i.options.notFoundComponent,p=n.ssr===!1||n.ssr==="data-only",h=(!i.isRoot||i.options.wrapInSuspense||p)&&(i.options.wrapInSuspense??a??(i.options.errorComponent?.preload||p))?q.Suspense:Ed,m=l?Dx:Ed,_=d?o9:Ed,y=ca({select:A=>A.loadedAt}),E=ca({select:A=>{const b=A.matches.findIndex(R=>R.id===t);return A.matches[b-1]?.routeId}}),T=i.isRoot?i.options.shellComponent??Ed:Ed;return ze.jsxs(T,{children:[ze.jsx(Mg.Provider,{value:t,children:ze.jsx(h,{fallback:s,children:ze.jsx(m,{getResetKey:()=>y,errorComponent:l||Og,onCatch:(A,b)=>{if(ps(A))throw A;c?.(A,b)},children:ze.jsx(_,{fallback:A=>{if(!d||A.routeId&&A.routeId!==n.routeId||!A.routeId&&!i.isRoot)throw A;return q.createElement(d,A)},children:p||n._displayPending?ze.jsx(Lk,{fallback:s,children:ze.jsx(UC,{matchId:t})}):ze.jsx(UC,{matchId:t})})})})}),E===qa&&r.options.scrollRestoration?ze.jsxs(ze.Fragment,{children:[ze.jsx(c9,{}),ze.jsx(l9,{})]}):null]})});function c9(){const e=Ra(),t=q.useRef(void 0);return ze.jsx("script",{suppressHydrationWarning:!0,ref:r=>{r&&(t.current===void 0||t.current.href!==e.latestLocation.href)&&(e.emit({type:"onRendered",...Pc(e.state)}),t.current=e.latestLocation)}},e.latestLocation.state.__TSR_key)}const UC=q.memo(function({matchId:t}){const r=Ra(),{match:n,key:i,routeId:a}=ca({select:c=>{const d=c.matches.find(y=>y.id===t),p=d.routeId,m=(r.routesById[p].options.remountDeps??r.options.defaultRemountDeps)?.({routeId:p,loaderDeps:d.loaderDeps,params:d._strictParams,search:d._strictSearch});return{key:m?JSON.stringify(m):void 0,routeId:p,match:{id:d.id,status:d.status,error:d.error,_forcePending:d._forcePending,_displayPending:d._displayPending}}},structuralSharing:!0}),s=r.routesById[a],l=q.useMemo(()=>{const c=s.options.component??r.options.defaultComponent;return c?ze.jsx(c,{},i):ze.jsx(dL,{})},[i,s.options.component,r.options.defaultComponent]);if(n._displayPending)throw r.getMatch(n.id)?._nonReactive.displayPendingPromise;if(n._forcePending)throw r.getMatch(n.id)?._nonReactive.minPendingPromise;if(n.status==="pending"){const c=s.options.pendingMinMs??r.options.defaultPendingMinMs;if(c){const d=r.getMatch(n.id);if(d&&!d._nonReactive.minPendingPromise&&!r.isServer){const p=Ud();d._nonReactive.minPendingPromise=p,setTimeout(()=>{p.resolve(),d._nonReactive.minPendingPromise=void 0},c)}}throw r.getMatch(n.id)?._nonReactive.loadPromise}if(n.status==="notFound")return au(ps(n.error)),cL(r,s,n.error);if(n.status==="redirected")throw au(ls(n.error)),r.getMatch(n.id)?._nonReactive.loadPromise;if(n.status==="error"){if(r.isServer){const c=(s.options.errorComponent??r.options.defaultErrorComponent)||Og;return ze.jsx(c,{error:n.error,reset:void 0,info:{componentStack:""}})}throw n.error}return l}),dL=q.memo(function(){const t=Ra(),r=q.useContext(Mg),n=ca({select:d=>d.matches.find(p=>p.id===r)?.routeId}),i=t.routesById[n],a=ca({select:d=>{const h=d.matches.find(m=>m.id===r);return au(h),h.globalNotFound}}),s=ca({select:d=>{const p=d.matches,h=p.findIndex(m=>m.id===r);return p[h+1]?.id}}),l=t.options.defaultPendingComponent?ze.jsx(t.options.defaultPendingComponent,{}):null;if(a)return cL(t,i,void 0);if(!s)return null;const c=ze.jsx(fL,{matchId:s});return r===qa?ze.jsx(q.Suspense,{fallback:l,children:c}):c});function f9(){const e=Ra(),t=e.options.defaultPendingComponent?ze.jsx(e.options.defaultPendingComponent,{}):null,r=e.isServer||typeof document<"u"&&e.ssr?Ed:q.Suspense,n=ze.jsxs(r,{fallback:t,children:[!e.isServer&&ze.jsx(a9,{}),ze.jsx(d9,{})]});return e.options.InnerWrap?ze.jsx(e.options.InnerWrap,{children:n}):n}function d9(){const e=Ra(),t=ca({select:i=>i.matches[0]?.id}),r=ca({select:i=>i.loadedAt}),n=t?ze.jsx(fL,{matchId:t}):null;return ze.jsx(Mg.Provider,{value:t,children:e.options.disableGlobalCatchBoundary?n:ze.jsx(Dx,{getResetKey:()=>r,errorComponent:Og,onCatch:i=>{i.message||i.toString()},children:n})})}const h9=e=>new p9(e);class p9 extends Ck{constructor(t){super(t)}}typeof globalThis<"u"?(globalThis.createFileRoute=DC,globalThis.createLazyFileRoute=FC):typeof window<"u"&&(window.createFileRoute=DC,window.createLazyFileRoute=FC);function v9({router:e,children:t,...r}){Object.keys(r).length>0&&e.update({...e.options,...r,context:{...e.options.context,...r.context}});const n=lL(),i=ze.jsx(n.Provider,{value:e,children:t});return e.options.Wrap?ze.jsx(e.options.Wrap,{children:i}):i}function m9({router:e,...t}){return ze.jsx(v9,{router:e,...t,children:ze.jsx(f9,{})})}var mE={exports:{}},Ap={},_E={exports:{}},gE={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kC;function _9(){return kC||(kC=1,(function(e){function t(O,F){var z=O.length;O.push(F);e:for(;0<z;){var re=z-1>>>1,oe=O[re];if(0<i(oe,F))O[re]=F,O[z]=oe,z=re;else break e}}function r(O){return O.length===0?null:O[0]}function n(O){if(O.length===0)return null;var F=O[0],z=O.pop();if(z!==F){O[0]=z;e:for(var re=0,oe=O.length,_e=oe>>>1;re<_e;){var ye=2*(re+1)-1,Ie=O[ye],Je=ye+1,We=O[Je];if(0>i(Ie,z))Je<oe&&0>i(We,Ie)?(O[re]=We,O[Je]=z,re=Je):(O[re]=Ie,O[ye]=z,re=ye);else if(Je<oe&&0>i(We,z))O[re]=We,O[Je]=z,re=Je;else break e}}return F}function i(O,F){var z=O.sortIndex-F.sortIndex;return z!==0?z:O.id-F.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;e.unstable_now=function(){return a.now()}}else{var s=Date,l=s.now();e.unstable_now=function(){return s.now()-l}}var c=[],d=[],p=1,h=null,m=3,_=!1,y=!1,E=!1,T=!1,A=typeof setTimeout=="function"?setTimeout:null,b=typeof clearTimeout=="function"?clearTimeout:null,R=typeof setImmediate<"u"?setImmediate:null;function M(O){for(var F=r(d);F!==null;){if(F.callback===null)n(d);else if(F.startTime<=O)n(d),F.sortIndex=F.expirationTime,t(c,F);else break;F=r(d)}}function B(O){if(E=!1,M(O),!y)if(r(c)!==null)y=!0,w||(w=!0,x());else{var F=r(d);F!==null&&pe(B,F.startTime-O)}}var w=!1,D=-1,U=5,ae=-1;function Q(){return T?!0:!(e.unstable_now()-ae<U)}function X(){if(T=!1,w){var O=e.unstable_now();ae=O;var F=!0;try{e:{y=!1,E&&(E=!1,b(D),D=-1),_=!0;var z=m;try{t:{for(M(O),h=r(c);h!==null&&!(h.expirationTime>O&&Q());){var re=h.callback;if(typeof re=="function"){h.callback=null,m=h.priorityLevel;var oe=re(h.expirationTime<=O);if(O=e.unstable_now(),typeof oe=="function"){h.callback=oe,M(O),F=!0;break t}h===r(c)&&n(c),M(O)}else n(c);h=r(c)}if(h!==null)F=!0;else{var _e=r(d);_e!==null&&pe(B,_e.startTime-O),F=!1}}break e}finally{h=null,m=z,_=!1}F=void 0}}finally{F?x():w=!1}}}var x;if(typeof R=="function")x=function(){R(X)};else if(typeof MessageChannel<"u"){var P=new MessageChannel,H=P.port2;P.port1.onmessage=X,x=function(){H.postMessage(null)}}else x=function(){A(X,0)};function pe(O,F){D=A(function(){O(e.unstable_now())},F)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(O){O.callback=null},e.unstable_forceFrameRate=function(O){0>O||125<O?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):U=0<O?Math.floor(1e3/O):5},e.unstable_getCurrentPriorityLevel=function(){return m},e.unstable_next=function(O){switch(m){case 1:case 2:case 3:var F=3;break;default:F=m}var z=m;m=F;try{return O()}finally{m=z}},e.unstable_requestPaint=function(){T=!0},e.unstable_runWithPriority=function(O,F){switch(O){case 1:case 2:case 3:case 4:case 5:break;default:O=3}var z=m;m=O;try{return F()}finally{m=z}},e.unstable_scheduleCallback=function(O,F,z){var re=e.unstable_now();switch(typeof z=="object"&&z!==null?(z=z.delay,z=typeof z=="number"&&0<z?re+z:re):z=re,O){case 1:var oe=-1;break;case 2:oe=250;break;case 5:oe=1073741823;break;case 4:oe=1e4;break;default:oe=5e3}return oe=z+oe,O={id:p++,callback:F,priorityLevel:O,startTime:z,expirationTime:oe,sortIndex:-1},z>re?(O.sortIndex=z,t(d,O),r(c)===null&&O===r(d)&&(E?(b(D),D=-1):E=!0,pe(B,z-re))):(O.sortIndex=oe,t(c,O),y||_||(y=!0,w||(w=!0,x()))),O},e.unstable_shouldYield=Q,e.unstable_wrapCallback=function(O){var F=m;return function(){var z=m;m=F;try{return O.apply(this,arguments)}finally{m=z}}}})(gE)),gE}var zC;function g9(){return zC||(zC=1,_E.exports=_9()),_E.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jC;function y9(){if(jC)return Ap;jC=1;var e=g9(),t=Ag(),r=zD();function n(o){var u="https://react.dev/errors/"+o;if(1<arguments.length){u+="?args[]="+encodeURIComponent(arguments[1]);for(var f=2;f<arguments.length;f++)u+="&args[]="+encodeURIComponent(arguments[f])}return"Minified React error #"+o+"; visit "+u+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(o){return!(!o||o.nodeType!==1&&o.nodeType!==9&&o.nodeType!==11)}function a(o){var u=o,f=o;if(o.alternate)for(;u.return;)u=u.return;else{o=u;do u=o,(u.flags&4098)!==0&&(f=u.return),o=u.return;while(o)}return u.tag===3?f:null}function s(o){if(o.tag===13){var u=o.memoizedState;if(u===null&&(o=o.alternate,o!==null&&(u=o.memoizedState)),u!==null)return u.dehydrated}return null}function l(o){if(a(o)!==o)throw Error(n(188))}function c(o){var u=o.alternate;if(!u){if(u=a(o),u===null)throw Error(n(188));return u!==o?null:o}for(var f=o,v=u;;){var g=f.return;if(g===null)break;var S=g.alternate;if(S===null){if(v=g.return,v!==null){f=v;continue}break}if(g.child===S.child){for(S=g.child;S;){if(S===f)return l(g),o;if(S===v)return l(g),u;S=S.sibling}throw Error(n(188))}if(f.return!==v.return)f=g,v=S;else{for(var I=!1,G=g.child;G;){if(G===f){I=!0,f=g,v=S;break}if(G===v){I=!0,v=g,f=S;break}G=G.sibling}if(!I){for(G=S.child;G;){if(G===f){I=!0,f=S,v=g;break}if(G===v){I=!0,v=S,f=g;break}G=G.sibling}if(!I)throw Error(n(189))}}if(f.alternate!==v)throw Error(n(190))}if(f.tag!==3)throw Error(n(188));return f.stateNode.current===f?o:u}function d(o){var u=o.tag;if(u===5||u===26||u===27||u===6)return o;for(o=o.child;o!==null;){if(u=d(o),u!==null)return u;o=o.sibling}return null}var p=Object.assign,h=Symbol.for("react.element"),m=Symbol.for("react.transitional.element"),_=Symbol.for("react.portal"),y=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),A=Symbol.for("react.provider"),b=Symbol.for("react.consumer"),R=Symbol.for("react.context"),M=Symbol.for("react.forward_ref"),B=Symbol.for("react.suspense"),w=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),U=Symbol.for("react.lazy"),ae=Symbol.for("react.activity"),Q=Symbol.for("react.memo_cache_sentinel"),X=Symbol.iterator;function x(o){return o===null||typeof o!="object"?null:(o=X&&o[X]||o["@@iterator"],typeof o=="function"?o:null)}var P=Symbol.for("react.client.reference");function H(o){if(o==null)return null;if(typeof o=="function")return o.$$typeof===P?null:o.displayName||o.name||null;if(typeof o=="string")return o;switch(o){case y:return"Fragment";case T:return"Profiler";case E:return"StrictMode";case B:return"Suspense";case w:return"SuspenseList";case ae:return"Activity"}if(typeof o=="object")switch(o.$$typeof){case _:return"Portal";case R:return(o.displayName||"Context")+".Provider";case b:return(o._context.displayName||"Context")+".Consumer";case M:var u=o.render;return o=o.displayName,o||(o=u.displayName||u.name||"",o=o!==""?"ForwardRef("+o+")":"ForwardRef"),o;case D:return u=o.displayName||null,u!==null?u:H(o.type)||"Memo";case U:u=o._payload,o=o._init;try{return H(o(u))}catch{}}return null}var pe=Array.isArray,O=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,F=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,z={pending:!1,data:null,method:null,action:null},re=[],oe=-1;function _e(o){return{current:o}}function ye(o){0>oe||(o.current=re[oe],re[oe]=null,oe--)}function Ie(o,u){oe++,re[oe]=o.current,o.current=u}var Je=_e(null),We=_e(null),Ct=_e(null),Ve=_e(null);function yt(o,u){switch(Ie(Ct,u),Ie(We,o),Ie(Je,null),u.nodeType){case 9:case 11:o=(o=u.documentElement)&&(o=o.namespaceURI)?F2(o):0;break;default:if(o=u.tagName,u=u.namespaceURI)u=F2(u),o=U2(u,o);else switch(o){case"svg":o=1;break;case"math":o=2;break;default:o=0}}ye(Je),Ie(Je,o)}function Ue(){ye(Je),ye(We),ye(Ct)}function ge(o){o.memoizedState!==null&&Ie(Ve,o);var u=Je.current,f=U2(u,o.type);u!==f&&(Ie(We,o),Ie(Je,f))}function nt(o){We.current===o&&(ye(Je),ye(We)),Ve.current===o&&(ye(Ve),pp._currentValue=z)}var Ce=Object.prototype.hasOwnProperty,zt=e.unstable_scheduleCallback,jt=e.unstable_cancelCallback,_t=e.unstable_shouldYield,Ot=e.unstable_requestPaint,xt=e.unstable_now,Xt=e.unstable_getCurrentPriorityLevel,Or=e.unstable_ImmediatePriority,qr=e.unstable_UserBlockingPriority,Tr=e.unstable_NormalPriority,zr=e.unstable_LowPriority,V=e.unstable_IdlePriority,jr=e.log,en=e.unstable_setDisableYieldValue,Hn=null,un=null;function tn(o){if(typeof jr=="function"&&en(o),un&&typeof un.setStrictMode=="function")try{un.setStrictMode(Hn,o)}catch{}}var yr=Math.clz32?Math.clz32:ii,Yn=Math.log,pi=Math.LN2;function ii(o){return o>>>=0,o===0?32:31-(Yn(o)/pi|0)|0}var Wr=256,Cn=4194304;function Yi(o){var u=o&42;if(u!==0)return u;switch(o&-o){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return o&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return o}}function Ma(o,u,f){var v=o.pendingLanes;if(v===0)return 0;var g=0,S=o.suspendedLanes,I=o.pingedLanes;o=o.warmLanes;var G=v&134217727;return G!==0?(v=G&~S,v!==0?g=Yi(v):(I&=G,I!==0?g=Yi(I):f||(f=G&~o,f!==0&&(g=Yi(f))))):(G=v&~S,G!==0?g=Yi(G):I!==0?g=Yi(I):f||(f=v&~o,f!==0&&(g=Yi(f)))),g===0?0:u!==0&&u!==g&&(u&S)===0&&(S=g&-g,f=u&-u,S>=f||S===32&&(f&4194048)!==0)?u:g}function to(o,u){return(o.pendingLanes&~(o.suspendedLanes&~o.pingedLanes)&u)===0}function fu(o,u){switch(o){case 1:case 2:case 4:case 8:case 64:return u+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Qc(){var o=Wr;return Wr<<=1,(Wr&4194048)===0&&(Wr=256),o}function Jc(){var o=Cn;return Cn<<=1,(Cn&62914560)===0&&(Cn=4194304),o}function Es(o){for(var u=[],f=0;31>f;f++)u.push(o);return u}function ro(o,u){o.pendingLanes|=u,u!==268435456&&(o.suspendedLanes=0,o.pingedLanes=0,o.warmLanes=0)}function Ul(o,u,f,v,g,S){var I=o.pendingLanes;o.pendingLanes=f,o.suspendedLanes=0,o.pingedLanes=0,o.warmLanes=0,o.expiredLanes&=f,o.entangledLanes&=f,o.errorRecoveryDisabledLanes&=f,o.shellSuspendCounter=0;var G=o.entanglements,le=o.expirationTimes,Ne=o.hiddenUpdates;for(f=I&~f;0<f;){var tt=31-yr(f),ct=1<<tt;G[tt]=0,le[tt]=-1;var Be=Ne[tt];if(Be!==null)for(Ne[tt]=null,tt=0;tt<Be.length;tt++){var ke=Be[tt];ke!==null&&(ke.lane&=-536870913)}f&=~ct}v!==0&&ef(o,v,0),S!==0&&g===0&&o.tag!==0&&(o.suspendedLanes|=S&~(I&~u))}function ef(o,u,f){o.pendingLanes|=u,o.suspendedLanes&=~u;var v=31-yr(u);o.entangledLanes|=u,o.entanglements[v]=o.entanglements[v]|1073741824|f&4194090}function ai(o,u){var f=o.entangledLanes|=u;for(o=o.entanglements;f;){var v=31-yr(f),g=1<<v;g&u|o[v]&u&&(o[v]|=u),f&=~g}}function kl(o){switch(o){case 2:o=1;break;case 8:o=4;break;case 32:o=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:o=128;break;case 268435456:o=134217728;break;default:o=0}return o}function du(o){return o&=-o,2<o?8<o?(o&134217727)!==0?32:268435456:8:2}function tf(){var o=F.p;return o!==0?o:(o=window.event,o===void 0?32:nC(o.type))}function ch(o,u){var f=F.p;try{return F.p=o,u()}finally{F.p=f}}var wa=Math.random().toString(36).slice(2),On="__reactFiber$"+wa,oi="__reactProps$"+wa,Fo="__reactContainer$"+wa,Ts="__reactEvents$"+wa,hu="__reactListeners$"+wa,an="__reactHandles$"+wa,zl="__reactResources$"+wa,Ss="__reactMarker$"+wa;function pu(o){delete o[On],delete o[oi],delete o[Ts],delete o[hu],delete o[an]}function no(o){var u=o[On];if(u)return u;for(var f=o.parentNode;f;){if(u=f[Fo]||f[On]){if(f=u.alternate,u.child!==null||f!==null&&f.child!==null)for(o=H2(o);o!==null;){if(f=o[On])return f;o=H2(o)}return u}o=f,f=o.parentNode}return null}function io(o){if(o=o[On]||o[Fo]){var u=o.tag;if(u===5||u===6||u===13||u===26||u===27||u===3)return o}return null}function Uo(o){var u=o.tag;if(u===5||u===26||u===27||u===6)return o.stateNode;throw Error(n(33))}function Na(o){var u=o[zl];return u||(u=o[zl]={hoistableStyles:new Map,hoistableScripts:new Map}),u}function Zr(o){o[Ss]=!0}var ko=new Set,zo={};function $i(o,u){Ia(o,u),Ia(o+"Capture",u)}function Ia(o,u){for(zo[o]=u,o=0;o<u.length;o++)ko.add(u[o])}var fh=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),rf={},As={};function Si(o){return Ce.call(As,o)?!0:Ce.call(rf,o)?!1:fh.test(o)?As[o]=!0:(rf[o]=!0,!1)}function da(o,u,f){if(Si(u))if(f===null)o.removeAttribute(u);else{switch(typeof f){case"undefined":case"function":case"symbol":o.removeAttribute(u);return;case"boolean":var v=u.toLowerCase().slice(0,5);if(v!=="data-"&&v!=="aria-"){o.removeAttribute(u);return}}o.setAttribute(u,""+f)}}function Di(o,u,f){if(f===null)o.removeAttribute(u);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":o.removeAttribute(u);return}o.setAttribute(u,""+f)}}function Un(o,u,f,v){if(v===null)o.removeAttribute(f);else{switch(typeof v){case"undefined":case"function":case"symbol":case"boolean":o.removeAttribute(f);return}o.setAttributeNS(u,f,""+v)}}var ao,Li;function si(o){if(ao===void 0)try{throw Error()}catch(f){var u=f.stack.trim().match(/\n( *(at )?)/);ao=u&&u[1]||"",Li=-1<f.stack.indexOf(`
    at`)?" (<anonymous>)":-1<f.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ao+o+Li}var vu=!1;function mu(o,u){if(!o||vu)return"";vu=!0;var f=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var v={DetermineComponentFrameRoot:function(){try{if(u){var ct=function(){throw Error()};if(Object.defineProperty(ct.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ct,[])}catch(ke){var Be=ke}Reflect.construct(o,[],ct)}else{try{ct.call()}catch(ke){Be=ke}o.call(ct.prototype)}}else{try{throw Error()}catch(ke){Be=ke}(ct=o())&&typeof ct.catch=="function"&&ct.catch(function(){})}}catch(ke){if(ke&&Be&&typeof ke.stack=="string")return[ke.stack,Be.stack]}return[null,null]}};v.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var g=Object.getOwnPropertyDescriptor(v.DetermineComponentFrameRoot,"name");g&&g.configurable&&Object.defineProperty(v.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var S=v.DetermineComponentFrameRoot(),I=S[0],G=S[1];if(I&&G){var le=I.split(`
`),Ne=G.split(`
`);for(g=v=0;v<le.length&&!le[v].includes("DetermineComponentFrameRoot");)v++;for(;g<Ne.length&&!Ne[g].includes("DetermineComponentFrameRoot");)g++;if(v===le.length||g===Ne.length)for(v=le.length-1,g=Ne.length-1;1<=v&&0<=g&&le[v]!==Ne[g];)g--;for(;1<=v&&0<=g;v--,g--)if(le[v]!==Ne[g]){if(v!==1||g!==1)do if(v--,g--,0>g||le[v]!==Ne[g]){var tt=`
`+le[v].replace(" at new "," at ");return o.displayName&&tt.includes("<anonymous>")&&(tt=tt.replace("<anonymous>",o.displayName)),tt}while(1<=v&&0<=g);break}}}finally{vu=!1,Error.prepareStackTrace=f}return(f=o?o.displayName||o.name:"")?si(f):""}function _u(o){switch(o.tag){case 26:case 27:case 5:return si(o.type);case 16:return si("Lazy");case 13:return si("Suspense");case 19:return si("SuspenseList");case 0:case 15:return mu(o.type,!1);case 11:return mu(o.type.render,!1);case 1:return mu(o.type,!0);case 31:return si("Activity");default:return""}}function Ai(o){try{var u="";do u+=_u(o),o=o.return;while(o);return u}catch(f){return`
Error generating stack: `+f.message+`
`+f.stack}}function $n(o){switch(typeof o){case"bigint":case"boolean":case"number":case"string":case"undefined":return o;case"object":return o;default:return""}}function oo(o){var u=o.type;return(o=o.nodeName)&&o.toLowerCase()==="input"&&(u==="checkbox"||u==="radio")}function gu(o){var u=oo(o)?"checked":"value",f=Object.getOwnPropertyDescriptor(o.constructor.prototype,u),v=""+o[u];if(!o.hasOwnProperty(u)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var g=f.get,S=f.set;return Object.defineProperty(o,u,{configurable:!0,get:function(){return g.call(this)},set:function(I){v=""+I,S.call(this,I)}}),Object.defineProperty(o,u,{enumerable:f.enumerable}),{getValue:function(){return v},setValue:function(I){v=""+I},stopTracking:function(){o._valueTracker=null,delete o[u]}}}}function jo(o){o._valueTracker||(o._valueTracker=gu(o))}function yu(o){if(!o)return!1;var u=o._valueTracker;if(!u)return!0;var f=u.getValue(),v="";return o&&(v=oo(o)?o.checked?"true":"false":o.value),o=v,o!==f?(u.setValue(o),!0):!1}function Bi(o){if(o=o||(typeof document<"u"?document:void 0),typeof o>"u")return null;try{return o.activeElement||o.body}catch{return o.body}}var Zi=/[\n"\\]/g;function vi(o){return o.replace(Zi,function(u){return"\\"+u.charCodeAt(0).toString(16)+" "})}function Ho(o,u,f,v,g,S,I,G){o.name="",I!=null&&typeof I!="function"&&typeof I!="symbol"&&typeof I!="boolean"?o.type=I:o.removeAttribute("type"),u!=null?I==="number"?(u===0&&o.value===""||o.value!=u)&&(o.value=""+$n(u)):o.value!==""+$n(u)&&(o.value=""+$n(u)):I!=="submit"&&I!=="reset"||o.removeAttribute("value"),u!=null?Tu(o,I,$n(u)):f!=null?Tu(o,I,$n(f)):v!=null&&o.removeAttribute("value"),g==null&&S!=null&&(o.defaultChecked=!!S),g!=null&&(o.checked=g&&typeof g!="function"&&typeof g!="symbol"),G!=null&&typeof G!="function"&&typeof G!="symbol"&&typeof G!="boolean"?o.name=""+$n(G):o.removeAttribute("name")}function Eu(o,u,f,v,g,S,I,G){if(S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"&&(o.type=S),u!=null||f!=null){if(!(S!=="submit"&&S!=="reset"||u!=null))return;f=f!=null?""+$n(f):"",u=u!=null?""+$n(u):f,G||u===o.value||(o.value=u),o.defaultValue=u}v=v??g,v=typeof v!="function"&&typeof v!="symbol"&&!!v,o.checked=G?o.checked:!!v,o.defaultChecked=!!v,I!=null&&typeof I!="function"&&typeof I!="symbol"&&typeof I!="boolean"&&(o.name=I)}function Tu(o,u,f){u==="number"&&Bi(o.ownerDocument)===o||o.defaultValue===""+f||(o.defaultValue=""+f)}function Vo(o,u,f,v){if(o=o.options,u){u={};for(var g=0;g<f.length;g++)u["$"+f[g]]=!0;for(f=0;f<o.length;f++)g=u.hasOwnProperty("$"+o[f].value),o[f].selected!==g&&(o[f].selected=g),g&&v&&(o[f].defaultSelected=!0)}else{for(f=""+$n(f),u=null,g=0;g<o.length;g++){if(o[g].value===f){o[g].selected=!0,v&&(o[g].defaultSelected=!0);return}u!==null||o[g].disabled||(u=o[g])}u!==null&&(u.selected=!0)}}function nf(o,u,f){if(u!=null&&(u=""+$n(u),u!==o.value&&(o.value=u),f==null)){o.defaultValue!==u&&(o.defaultValue=u);return}o.defaultValue=f!=null?""+$n(f):""}function j(o,u,f,v){if(u==null){if(v!=null){if(f!=null)throw Error(n(92));if(pe(v)){if(1<v.length)throw Error(n(93));v=v[0]}f=v}f==null&&(f=""),u=f}f=$n(u),o.defaultValue=f,v=o.textContent,v===f&&v!==""&&v!==null&&(o.value=v)}function Z(o,u){if(u){var f=o.firstChild;if(f&&f===o.lastChild&&f.nodeType===3){f.nodeValue=u;return}}o.textContent=u}var fe=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Fe(o,u,f){var v=u.indexOf("--")===0;f==null||typeof f=="boolean"||f===""?v?o.setProperty(u,""):u==="float"?o.cssFloat="":o[u]="":v?o.setProperty(u,f):typeof f!="number"||f===0||fe.has(u)?u==="float"?o.cssFloat=f:o[u]=(""+f).trim():o[u]=f+"px"}function pt(o,u,f){if(u!=null&&typeof u!="object")throw Error(n(62));if(o=o.style,f!=null){for(var v in f)!f.hasOwnProperty(v)||u!=null&&u.hasOwnProperty(v)||(v.indexOf("--")===0?o.setProperty(v,""):v==="float"?o.cssFloat="":o[v]="");for(var g in u)v=u[g],u.hasOwnProperty(g)&&f[g]!==v&&Fe(o,g,v)}else for(var S in u)u.hasOwnProperty(S)&&Fe(o,S,u[S])}function Nt(o){if(o.indexOf("-")===-1)return!1;switch(o){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var pr=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Pn=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Tn(o){return Pn.test(""+o)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":o}var Mn=null;function bi(o){return o=o.target||o.srcElement||window,o.correspondingUseElement&&(o=o.correspondingUseElement),o.nodeType===3?o.parentNode:o}var Su=null,Au=null;function tm(o){var u=io(o);if(u&&(o=u.stateNode)){var f=o[oi]||null;e:switch(o=u.stateNode,u.type){case"input":if(Ho(o,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name),u=f.name,f.type==="radio"&&u!=null){for(f=o;f.parentNode;)f=f.parentNode;for(f=f.querySelectorAll('input[name="'+vi(""+u)+'"][type="radio"]'),u=0;u<f.length;u++){var v=f[u];if(v!==o&&v.form===o.form){var g=v[oi]||null;if(!g)throw Error(n(90));Ho(v,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name)}}for(u=0;u<f.length;u++)v=f[u],v.form===o.form&&yu(v)}break e;case"textarea":nf(o,f.value,f.defaultValue);break e;case"select":u=f.value,u!=null&&Vo(o,!!f.multiple,u,!1)}}}var dh=!1;function rm(o,u,f){if(dh)return o(u,f);dh=!0;try{var v=o(u);return v}finally{if(dh=!1,(Su!==null||Au!==null)&&(i_(),Su&&(u=Su,o=Au,Au=Su=null,tm(u),o)))for(u=0;u<o.length;u++)tm(o[u])}}function jl(o,u){var f=o.stateNode;if(f===null)return null;var v=f[oi]||null;if(v===null)return null;f=v[u];e:switch(u){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(v=!v.disabled)||(o=o.type,v=!(o==="button"||o==="input"||o==="select"||o==="textarea")),o=!v;break e;default:o=!1}if(o)return null;if(f&&typeof f!="function")throw Error(n(231,u,typeof f));return f}var so=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),uo=!1;if(so)try{var Hl={};Object.defineProperty(Hl,"passive",{get:function(){uo=!0}}),window.addEventListener("test",Hl,Hl),window.removeEventListener("test",Hl,Hl)}catch{uo=!1}var Xo=null,bu=null,xu=null;function hh(){if(xu)return xu;var o,u=bu,f=u.length,v,g="value"in Xo?Xo.value:Xo.textContent,S=g.length;for(o=0;o<f&&u[o]===g[o];o++);var I=f-o;for(v=1;v<=I&&u[f-v]===g[S-v];v++);return xu=g.slice(o,1<v?1-v:void 0)}function Vl(o){var u=o.keyCode;return"charCode"in o?(o=o.charCode,o===0&&u===13&&(o=13)):o=u,o===10&&(o=13),32<=o||o===13?o:0}function af(){return!0}function of(){return!1}function ui(o){function u(f,v,g,S,I){this._reactName=f,this._targetInst=g,this.type=v,this.nativeEvent=S,this.target=I,this.currentTarget=null;for(var G in o)o.hasOwnProperty(G)&&(f=o[G],this[G]=f?f(S):S[G]);return this.isDefaultPrevented=(S.defaultPrevented!=null?S.defaultPrevented:S.returnValue===!1)?af:of,this.isPropagationStopped=of,this}return p(u.prototype,{preventDefault:function(){this.defaultPrevented=!0;var f=this.nativeEvent;f&&(f.preventDefault?f.preventDefault():typeof f.returnValue!="unknown"&&(f.returnValue=!1),this.isDefaultPrevented=af)},stopPropagation:function(){var f=this.nativeEvent;f&&(f.stopPropagation?f.stopPropagation():typeof f.cancelBubble!="unknown"&&(f.cancelBubble=!0),this.isPropagationStopped=af)},persist:function(){},isPersistent:af}),u}var xi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(o){return o.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},bs=ui(xi),Ru=p({},xi,{view:0,detail:0}),nm=ui(Ru),ph,vh,Xl,sf=p({},Ru,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:gh,button:0,buttons:0,relatedTarget:function(o){return o.relatedTarget===void 0?o.fromElement===o.srcElement?o.toElement:o.fromElement:o.relatedTarget},movementX:function(o){return"movementX"in o?o.movementX:(o!==Xl&&(Xl&&o.type==="mousemove"?(ph=o.screenX-Xl.screenX,vh=o.screenY-Xl.screenY):vh=ph=0,Xl=o),ph)},movementY:function(o){return"movementY"in o?o.movementY:vh}}),im=ui(sf),oy=p({},sf,{dataTransfer:0}),sy=ui(oy),Cu=p({},Ru,{relatedTarget:0}),mh=ui(Cu),uy=p({},xi,{animationName:0,elapsedTime:0,pseudoElement:0}),Gl=ui(uy),ly=p({},xi,{clipboardData:function(o){return"clipboardData"in o?o.clipboardData:window.clipboardData}}),Ou=ui(ly),am=p({},xi,{data:0}),xs=ui(am),om={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Rs={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_h={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function cy(o){var u=this.nativeEvent;return u.getModifierState?u.getModifierState(o):(o=_h[o])?!!u[o]:!1}function gh(){return cy}var fy=p({},Ru,{key:function(o){if(o.key){var u=om[o.key]||o.key;if(u!=="Unidentified")return u}return o.type==="keypress"?(o=Vl(o),o===13?"Enter":String.fromCharCode(o)):o.type==="keydown"||o.type==="keyup"?Rs[o.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:gh,charCode:function(o){return o.type==="keypress"?Vl(o):0},keyCode:function(o){return o.type==="keydown"||o.type==="keyup"?o.keyCode:0},which:function(o){return o.type==="keypress"?Vl(o):o.type==="keydown"||o.type==="keyup"?o.keyCode:0}}),sm=ui(fy),dy=p({},sf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),um=ui(dy),lm=p({},Ru,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:gh}),ln=ui(lm),cm=p({},xi,{propertyName:0,elapsedTime:0,pseudoElement:0}),hy=ui(cm),lo=p({},sf,{deltaX:function(o){return"deltaX"in o?o.deltaX:"wheelDeltaX"in o?-o.wheelDeltaX:0},deltaY:function(o){return"deltaY"in o?o.deltaY:"wheelDeltaY"in o?-o.wheelDeltaY:"wheelDelta"in o?-o.wheelDelta:0},deltaZ:0,deltaMode:0}),fm=ui(lo),uf=p({},xi,{newState:0,oldState:0}),Cs=ui(uf),yh=[9,13,27,32],Mu=so&&"CompositionEvent"in window,co=null;so&&"documentMode"in document&&(co=document.documentMode);var lf=so&&"TextEvent"in window&&!co,Eh=so&&(!Mu||co&&8<co&&11>=co),cf=" ",Th=!1;function dm(o,u){switch(o){case"keyup":return yh.indexOf(u.keyCode)!==-1;case"keydown":return u.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function hm(o){return o=o.detail,typeof o=="object"&&"data"in o?o.data:null}var wu=!1;function py(o,u){switch(o){case"compositionend":return hm(u);case"keypress":return u.which!==32?null:(Th=!0,cf);case"textInput":return o=u.data,o===cf&&Th?null:o;default:return null}}function Sh(o,u){if(wu)return o==="compositionend"||!Mu&&dm(o,u)?(o=hh(),xu=bu=Xo=null,wu=!1,o):null;switch(o){case"paste":return null;case"keypress":if(!(u.ctrlKey||u.altKey||u.metaKey)||u.ctrlKey&&u.altKey){if(u.char&&1<u.char.length)return u.char;if(u.which)return String.fromCharCode(u.which)}return null;case"compositionend":return Eh&&u.locale!=="ko"?null:u.data;default:return null}}var ff={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function df(o){var u=o&&o.nodeName&&o.nodeName.toLowerCase();return u==="input"?!!ff[o.type]:u==="textarea"}function hf(o,u,f,v){Su?Au?Au.push(v):Au=[v]:Su=v,u=c_(u,"onChange"),0<u.length&&(f=new bs("onChange","change",null,f,v),o.push({event:f,listeners:u}))}var Pa=null,Os=null;function Ah(o){I2(o,0)}function Nu(o){var u=Uo(o);if(yu(u))return o}function pf(o,u){if(o==="change")return u}var bh=!1;if(so){var vf;if(so){var mf="oninput"in document;if(!mf){var xh=document.createElement("div");xh.setAttribute("oninput","return;"),mf=typeof xh.oninput=="function"}vf=mf}else vf=!1;bh=vf&&(!document.documentMode||9<document.documentMode)}function Rh(){Pa&&(Pa.detachEvent("onpropertychange",Ch),Os=Pa=null)}function Ch(o){if(o.propertyName==="value"&&Nu(Os)){var u=[];hf(u,Os,o,bi(o)),rm(Ah,u)}}function pm(o,u,f){o==="focusin"?(Rh(),Pa=u,Os=f,Pa.attachEvent("onpropertychange",Ch)):o==="focusout"&&Rh()}function vm(o){if(o==="selectionchange"||o==="keyup"||o==="keydown")return Nu(Os)}function Iu(o,u){if(o==="click")return Nu(u)}function Oh(o,u){if(o==="input"||o==="change")return Nu(u)}function Mh(o,u){return o===u&&(o!==0||1/o===1/u)||o!==o&&u!==u}var Zn=typeof Object.is=="function"?Object.is:Mh;function ql(o,u){if(Zn(o,u))return!0;if(typeof o!="object"||o===null||typeof u!="object"||u===null)return!1;var f=Object.keys(o),v=Object.keys(u);if(f.length!==v.length)return!1;for(v=0;v<f.length;v++){var g=f[v];if(!Ce.call(u,g)||!Zn(o[g],u[g]))return!1}return!0}function mm(o){for(;o&&o.firstChild;)o=o.firstChild;return o}function _m(o,u){var f=mm(o);o=0;for(var v;f;){if(f.nodeType===3){if(v=o+f.textContent.length,o<=u&&v>=u)return{node:f,offset:u-o};o=v}e:{for(;f;){if(f.nextSibling){f=f.nextSibling;break e}f=f.parentNode}f=void 0}f=mm(f)}}function _f(o,u){return o&&u?o===u?!0:o&&o.nodeType===3?!1:u&&u.nodeType===3?_f(o,u.parentNode):"contains"in o?o.contains(u):o.compareDocumentPosition?!!(o.compareDocumentPosition(u)&16):!1:!1}function gm(o){o=o!=null&&o.ownerDocument!=null&&o.ownerDocument.defaultView!=null?o.ownerDocument.defaultView:window;for(var u=Bi(o.document);u instanceof o.HTMLIFrameElement;){try{var f=typeof u.contentWindow.location.href=="string"}catch{f=!1}if(f)o=u.contentWindow;else break;u=Bi(o.document)}return u}function wh(o){var u=o&&o.nodeName&&o.nodeName.toLowerCase();return u&&(u==="input"&&(o.type==="text"||o.type==="search"||o.type==="tel"||o.type==="url"||o.type==="password")||u==="textarea"||o.contentEditable==="true")}var vy=so&&"documentMode"in document&&11>=document.documentMode,Go=null,Nh=null,Ms=null,gf=!1;function Ih(o,u,f){var v=f.window===f?f.document:f.nodeType===9?f:f.ownerDocument;gf||Go==null||Go!==Bi(v)||(v=Go,"selectionStart"in v&&wh(v)?v={start:v.selectionStart,end:v.selectionEnd}:(v=(v.ownerDocument&&v.ownerDocument.defaultView||window).getSelection(),v={anchorNode:v.anchorNode,anchorOffset:v.anchorOffset,focusNode:v.focusNode,focusOffset:v.focusOffset}),Ms&&ql(Ms,v)||(Ms=v,v=c_(Nh,"onSelect"),0<v.length&&(u=new bs("onSelect","select",null,u,f),o.push({event:u,listeners:v}),u.target=Go)))}function fo(o,u){var f={};return f[o.toLowerCase()]=u.toLowerCase(),f["Webkit"+o]="webkit"+u,f["Moz"+o]="moz"+u,f}var Pu={animationend:fo("Animation","AnimationEnd"),animationiteration:fo("Animation","AnimationIteration"),animationstart:fo("Animation","AnimationStart"),transitionrun:fo("Transition","TransitionRun"),transitionstart:fo("Transition","TransitionStart"),transitioncancel:fo("Transition","TransitionCancel"),transitionend:fo("Transition","TransitionEnd")},Du={},ym={};so&&(ym=document.createElement("div").style,"AnimationEvent"in window||(delete Pu.animationend.animation,delete Pu.animationiteration.animation,delete Pu.animationstart.animation),"TransitionEvent"in window||delete Pu.transitionend.transition);function ws(o){if(Du[o])return Du[o];if(!Pu[o])return o;var u=Pu[o],f;for(f in u)if(u.hasOwnProperty(f)&&f in ym)return Du[o]=u[f];return o}var Em=ws("animationend"),Tm=ws("animationiteration"),Sm=ws("animationstart"),_y=ws("transitionrun"),gy=ws("transitionstart"),Am=ws("transitioncancel"),Wl=ws("transitionend"),bm=new Map,Lu="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Lu.push("scrollEnd");function Sn(o,u){bm.set(o,u),$i(u,[o])}var Ns=new WeakMap;function Fi(o,u){if(typeof o=="object"&&o!==null){var f=Ns.get(o);return f!==void 0?f:(u={value:o,source:u,stack:Ai(u)},Ns.set(o,u),u)}return{value:o,source:u,stack:Ai(u)}}var Ui=[],Is=0,yf=0;function Yl(){for(var o=Is,u=yf=Is=0;u<o;){var f=Ui[u];Ui[u++]=null;var v=Ui[u];Ui[u++]=null;var g=Ui[u];Ui[u++]=null;var S=Ui[u];if(Ui[u++]=null,v!==null&&g!==null){var I=v.pending;I===null?g.next=g:(g.next=I.next,I.next=g),v.pending=g}S!==0&&kn(f,g,S)}}function $l(o,u,f,v){Ui[Is++]=o,Ui[Is++]=u,Ui[Is++]=f,Ui[Is++]=v,yf|=v,o.lanes|=v,o=o.alternate,o!==null&&(o.lanes|=v)}function Ph(o,u,f,v){return $l(o,u,f,v),Zl(o)}function ha(o,u){return $l(o,null,null,u),Zl(o)}function kn(o,u,f){o.lanes|=f;var v=o.alternate;v!==null&&(v.lanes|=f);for(var g=!1,S=o.return;S!==null;)S.childLanes|=f,v=S.alternate,v!==null&&(v.childLanes|=f),S.tag===22&&(o=S.stateNode,o===null||o._visibility&1||(g=!0)),o=S,S=S.return;return o.tag===3?(S=o.stateNode,g&&u!==null&&(g=31-yr(f),o=S.hiddenUpdates,v=o[g],v===null?o[g]=[u]:v.push(u),u.lane=f|536870912),S):null}function Zl(o){if(50<op)throw op=0,wy=null,Error(n(185));for(var u=o.return;u!==null;)o=u,u=o.return;return o.tag===3?o.stateNode:null}var Ps={};function Ds(o,u,f,v){this.tag=o,this.key=f,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=u,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=v,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ri(o,u,f,v){return new Ds(o,u,f,v)}function Ef(o){return o=o.prototype,!(!o||!o.isReactComponent)}function ho(o,u){var f=o.alternate;return f===null?(f=Ri(o.tag,u,o.key,o.mode),f.elementType=o.elementType,f.type=o.type,f.stateNode=o.stateNode,f.alternate=o,o.alternate=f):(f.pendingProps=u,f.type=o.type,f.flags=0,f.subtreeFlags=0,f.deletions=null),f.flags=o.flags&65011712,f.childLanes=o.childLanes,f.lanes=o.lanes,f.child=o.child,f.memoizedProps=o.memoizedProps,f.memoizedState=o.memoizedState,f.updateQueue=o.updateQueue,u=o.dependencies,f.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext},f.sibling=o.sibling,f.index=o.index,f.ref=o.ref,f.refCleanup=o.refCleanup,f}function xm(o,u){o.flags&=65011714;var f=o.alternate;return f===null?(o.childLanes=0,o.lanes=u,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=f.childLanes,o.lanes=f.lanes,o.child=f.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=f.memoizedProps,o.memoizedState=f.memoizedState,o.updateQueue=f.updateQueue,o.type=f.type,u=f.dependencies,o.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext}),o}function Tf(o,u,f,v,g,S){var I=0;if(v=o,typeof o=="function")Ef(o)&&(I=1);else if(typeof o=="string")I=k7(o,f,Je.current)?26:o==="html"||o==="head"||o==="body"?27:5;else e:switch(o){case ae:return o=Ri(31,f,u,g),o.elementType=ae,o.lanes=S,o;case y:return Ls(f.children,g,S,u);case E:I=8,g|=24;break;case T:return o=Ri(12,f,u,g|2),o.elementType=T,o.lanes=S,o;case B:return o=Ri(13,f,u,g),o.elementType=B,o.lanes=S,o;case w:return o=Ri(19,f,u,g),o.elementType=w,o.lanes=S,o;default:if(typeof o=="object"&&o!==null)switch(o.$$typeof){case A:case R:I=10;break e;case b:I=9;break e;case M:I=11;break e;case D:I=14;break e;case U:I=16,v=null;break e}I=29,f=Error(n(130,o===null?"null":typeof o,"")),v=null}return u=Ri(I,f,u,g),u.elementType=o,u.type=v,u.lanes=S,u}function Ls(o,u,f,v){return o=Ri(7,o,v,u),o.lanes=f,o}function Kl(o,u,f){return o=Ri(6,o,null,u),o.lanes=f,o}function Sf(o,u,f){return u=Ri(4,o.children!==null?o.children:[],o.key,u),u.lanes=f,u.stateNode={containerInfo:o.containerInfo,pendingChildren:null,implementation:o.implementation},u}var Bu=[],Bs=0,Ql=null,Af=0,mi=[],Ki=0,Ci=null,Qi=1,Da="";function qo(o,u){Bu[Bs++]=Af,Bu[Bs++]=Ql,Ql=o,Af=u}function Dh(o,u,f){mi[Ki++]=Qi,mi[Ki++]=Da,mi[Ki++]=Ci,Ci=o;var v=Qi;o=Da;var g=32-yr(v)-1;v&=~(1<<g),f+=1;var S=32-yr(u)+g;if(30<S){var I=g-g%5;S=(v&(1<<I)-1).toString(32),v>>=I,g-=I,Qi=1<<32-yr(u)+g|f<<g|v,Da=S+o}else Qi=1<<S|f<<g|v,Da=o}function bf(o){o.return!==null&&(qo(o,1),Dh(o,1,0))}function xf(o){for(;o===Ql;)Ql=Bu[--Bs],Bu[Bs]=null,Af=Bu[--Bs],Bu[Bs]=null;for(;o===Ci;)Ci=mi[--Ki],mi[Ki]=null,Da=mi[--Ki],mi[Ki]=null,Qi=mi[--Ki],mi[Ki]=null}var li=null,cn=null,Dr=!1,Wo=null,Dn=!1,Rf=Error(n(519));function Fs(o){var u=Error(n(418,""));throw Fu(Fi(u,o)),Rf}function La(o){var u=o.stateNode,f=o.type,v=o.memoizedProps;switch(u[On]=o,u[oi]=v,f){case"dialog":wr("cancel",u),wr("close",u);break;case"iframe":case"object":case"embed":wr("load",u);break;case"video":case"audio":for(f=0;f<up.length;f++)wr(up[f],u);break;case"source":wr("error",u);break;case"img":case"image":case"link":wr("error",u),wr("load",u);break;case"details":wr("toggle",u);break;case"input":wr("invalid",u),Eu(u,v.value,v.defaultValue,v.checked,v.defaultChecked,v.type,v.name,!0),jo(u);break;case"select":wr("invalid",u);break;case"textarea":wr("invalid",u),j(u,v.value,v.defaultValue,v.children),jo(u)}f=v.children,typeof f!="string"&&typeof f!="number"&&typeof f!="bigint"||u.textContent===""+f||v.suppressHydrationWarning===!0||B2(u.textContent,f)?(v.popover!=null&&(wr("beforetoggle",u),wr("toggle",u)),v.onScroll!=null&&wr("scroll",u),v.onScrollEnd!=null&&wr("scrollend",u),v.onClick!=null&&(u.onclick=f_),u=!0):u=!1,u||Fs(o)}function Cf(o){for(li=o.return;li;)switch(li.tag){case 5:case 13:Dn=!1;return;case 27:case 3:Dn=!0;return;default:li=li.return}}function pa(o){if(o!==li)return!1;if(!Dr)return Cf(o),Dr=!0,!1;var u=o.tag,f;if((f=u!==3&&u!==27)&&((f=u===5)&&(f=o.type,f=!(f!=="form"&&f!=="button")||qy(o.type,o.memoizedProps)),f=!f),f&&cn&&Fs(o),Cf(o),u===13){if(o=o.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(n(317));e:{for(o=o.nextSibling,u=0;o;){if(o.nodeType===8)if(f=o.data,f==="/$"){if(u===0){cn=Ao(o.nextSibling);break e}u--}else f!=="$"&&f!=="$!"&&f!=="$?"||u++;o=o.nextSibling}cn=null}}else u===27?(u=cn,nl(o.type)?(o=Zy,Zy=null,cn=o):cn=u):cn=li?Ao(o.stateNode.nextSibling):null;return!0}function Yo(){cn=li=null,Dr=!1}function Lh(){var o=Wo;return o!==null&&(ta===null?ta=o:ta.push.apply(ta,o),Wo=null),o}function Fu(o){Wo===null?Wo=[o]:Wo.push(o)}var Of=_e(null),$o=null,Ba=null;function Zo(o,u,f){Ie(Of,u._currentValue),u._currentValue=f}function po(o){o._currentValue=Of.current,ye(Of)}function Bh(o,u,f){for(;o!==null;){var v=o.alternate;if((o.childLanes&u)!==u?(o.childLanes|=u,v!==null&&(v.childLanes|=u)):v!==null&&(v.childLanes&u)!==u&&(v.childLanes|=u),o===f)break;o=o.return}}function Fh(o,u,f,v){var g=o.child;for(g!==null&&(g.return=o);g!==null;){var S=g.dependencies;if(S!==null){var I=g.child;S=S.firstContext;e:for(;S!==null;){var G=S;S=g;for(var le=0;le<u.length;le++)if(G.context===u[le]){S.lanes|=f,G=S.alternate,G!==null&&(G.lanes|=f),Bh(S.return,f,o),v||(I=null);break e}S=G.next}}else if(g.tag===18){if(I=g.return,I===null)throw Error(n(341));I.lanes|=f,S=I.alternate,S!==null&&(S.lanes|=f),Bh(I,f,o),I=null}else I=g.child;if(I!==null)I.return=g;else for(I=g;I!==null;){if(I===o){I=null;break}if(g=I.sibling,g!==null){g.return=I.return,I=g;break}I=I.return}g=I}}function Jl(o,u,f,v){o=null;for(var g=u,S=!1;g!==null;){if(!S){if((g.flags&524288)!==0)S=!0;else if((g.flags&262144)!==0)break}if(g.tag===10){var I=g.alternate;if(I===null)throw Error(n(387));if(I=I.memoizedProps,I!==null){var G=g.type;Zn(g.pendingProps.value,I.value)||(o!==null?o.push(G):o=[G])}}else if(g===Ve.current){if(I=g.alternate,I===null)throw Error(n(387));I.memoizedState.memoizedState!==g.memoizedState.memoizedState&&(o!==null?o.push(pp):o=[pp])}g=g.return}o!==null&&Fh(u,o,f,v),u.flags|=262144}function Mf(o){for(o=o.firstContext;o!==null;){if(!Zn(o.context._currentValue,o.memoizedValue))return!0;o=o.next}return!1}function Us(o){$o=o,Ba=null,o=o.dependencies,o!==null&&(o.firstContext=null)}function Kn(o){return Rm($o,o)}function ec(o,u){return $o===null&&Us(o),Rm(o,u)}function Rm(o,u){var f=u._currentValue;if(u={context:u,memoizedValue:f,next:null},Ba===null){if(o===null)throw Error(n(308));Ba=u,o.dependencies={lanes:0,firstContext:u},o.flags|=524288}else Ba=Ba.next=u;return f}var yy=typeof AbortController<"u"?AbortController:function(){var o=[],u=this.signal={aborted:!1,addEventListener:function(f,v){o.push(v)}};this.abort=function(){u.aborted=!0,o.forEach(function(f){return f()})}},Uh=e.unstable_scheduleCallback,wf=e.unstable_NormalPriority,zn={$$typeof:R,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function kh(){return{controller:new yy,data:new Map,refCount:0}}function tc(o){o.refCount--,o.refCount===0&&Uh(wf,function(){o.controller.abort()})}var rc=null,zh=0,ks=0,Uu=null;function Ey(o,u){if(rc===null){var f=rc=[];zh=0,ks=Fy(),Uu={status:"pending",value:void 0,then:function(v){f.push(v)}}}return zh++,u.then(Cm,Cm),u}function Cm(){if(--zh===0&&rc!==null){Uu!==null&&(Uu.status="fulfilled");var o=rc;rc=null,ks=0,Uu=null;for(var u=0;u<o.length;u++)(0,o[u])()}}function Ty(o,u){var f=[],v={status:"pending",value:null,reason:null,then:function(g){f.push(g)}};return o.then(function(){v.status="fulfilled",v.value=u;for(var g=0;g<f.length;g++)(0,f[g])(u)},function(g){for(v.status="rejected",v.reason=g,g=0;g<f.length;g++)(0,f[g])(void 0)}),v}var Om=O.S;O.S=function(o,u){typeof u=="object"&&u!==null&&typeof u.then=="function"&&Ey(o,u),Om!==null&&Om(o,u)};var Ji=_e(null);function jh(){var o=Ji.current;return o!==null?o:ir.pooledCache}function Nf(o,u){u===null?Ie(Ji,Ji.current):Ie(Ji,u.pool)}function Hh(){var o=jh();return o===null?null:{parent:zn._currentValue,pool:o}}var zs=Error(n(460)),Mm=Error(n(474)),nc=Error(n(542)),Vh={then:function(){}};function wm(o){return o=o.status,o==="fulfilled"||o==="rejected"}function If(){}function Nm(o,u,f){switch(f=o[f],f===void 0?o.push(u):f!==u&&(u.then(If,If),u=f),u.status){case"fulfilled":return u.value;case"rejected":throw o=u.reason,Im(o),o;default:if(typeof u.status=="string")u.then(If,If);else{if(o=ir,o!==null&&100<o.shellSuspendCounter)throw Error(n(482));o=u,o.status="pending",o.then(function(v){if(u.status==="pending"){var g=u;g.status="fulfilled",g.value=v}},function(v){if(u.status==="pending"){var g=u;g.status="rejected",g.reason=v}})}switch(u.status){case"fulfilled":return u.value;case"rejected":throw o=u.reason,Im(o),o}throw ic=u,zs}}var ic=null;function ku(){if(ic===null)throw Error(n(459));var o=ic;return ic=null,o}function Im(o){if(o===zs||o===nc)throw Error(n(483))}var va=!1;function Xh(o){o.updateQueue={baseState:o.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Ko(o,u){o=o.updateQueue,u.updateQueue===o&&(u.updateQueue={baseState:o.baseState,firstBaseUpdate:o.firstBaseUpdate,lastBaseUpdate:o.lastBaseUpdate,shared:o.shared,callbacks:null})}function ki(o){return{lane:o,tag:0,payload:null,callback:null,next:null}}function Qo(o,u,f){var v=o.updateQueue;if(v===null)return null;if(v=v.shared,(Bt&2)!==0){var g=v.pending;return g===null?u.next=u:(u.next=g.next,g.next=u),v.pending=u,u=Zl(o),kn(o,null,f),u}return $l(o,v,u,f),Zl(o)}function Fa(o,u,f){if(u=u.updateQueue,u!==null&&(u=u.shared,(f&4194048)!==0)){var v=u.lanes;v&=o.pendingLanes,f|=v,u.lanes=f,ai(o,f)}}function Pf(o,u){var f=o.updateQueue,v=o.alternate;if(v!==null&&(v=v.updateQueue,f===v)){var g=null,S=null;if(f=f.firstBaseUpdate,f!==null){do{var I={lane:f.lane,tag:f.tag,payload:f.payload,callback:null,next:null};S===null?g=S=I:S=S.next=I,f=f.next}while(f!==null);S===null?g=S=u:S=S.next=u}else g=S=u;f={baseState:v.baseState,firstBaseUpdate:g,lastBaseUpdate:S,shared:v.shared,callbacks:v.callbacks},o.updateQueue=f;return}o=f.lastBaseUpdate,o===null?f.firstBaseUpdate=u:o.next=u,f.lastBaseUpdate=u}var Jo=!1;function js(){if(Jo){var o=Uu;if(o!==null)throw o}}function zu(o,u,f,v){Jo=!1;var g=o.updateQueue;va=!1;var S=g.firstBaseUpdate,I=g.lastBaseUpdate,G=g.shared.pending;if(G!==null){g.shared.pending=null;var le=G,Ne=le.next;le.next=null,I===null?S=Ne:I.next=Ne,I=le;var tt=o.alternate;tt!==null&&(tt=tt.updateQueue,G=tt.lastBaseUpdate,G!==I&&(G===null?tt.firstBaseUpdate=Ne:G.next=Ne,tt.lastBaseUpdate=le))}if(S!==null){var ct=g.baseState;I=0,tt=Ne=le=null,G=S;do{var Be=G.lane&-536870913,ke=Be!==G.lane;if(ke?(xr&Be)===Be:(v&Be)===Be){Be!==0&&Be===ks&&(Jo=!0),tt!==null&&(tt=tt.next={lane:0,tag:G.tag,payload:G.payload,callback:null,next:null});e:{var ur=o,tr=G;Be=u;var Qr=f;switch(tr.tag){case 1:if(ur=tr.payload,typeof ur=="function"){ct=ur.call(Qr,ct,Be);break e}ct=ur;break e;case 3:ur.flags=ur.flags&-65537|128;case 0:if(ur=tr.payload,Be=typeof ur=="function"?ur.call(Qr,ct,Be):ur,Be==null)break e;ct=p({},ct,Be);break e;case 2:va=!0}}Be=G.callback,Be!==null&&(o.flags|=64,ke&&(o.flags|=8192),ke=g.callbacks,ke===null?g.callbacks=[Be]:ke.push(Be))}else ke={lane:Be,tag:G.tag,payload:G.payload,callback:G.callback,next:null},tt===null?(Ne=tt=ke,le=ct):tt=tt.next=ke,I|=Be;if(G=G.next,G===null){if(G=g.shared.pending,G===null)break;ke=G,G=ke.next,ke.next=null,g.lastBaseUpdate=ke,g.shared.pending=null}}while(!0);tt===null&&(le=ct),g.baseState=le,g.firstBaseUpdate=Ne,g.lastBaseUpdate=tt,S===null&&(g.shared.lanes=0),Ju|=I,o.lanes=I,o.memoizedState=ct}}function Gh(o,u){if(typeof o!="function")throw Error(n(191,o));o.call(u)}function qh(o,u){var f=o.callbacks;if(f!==null)for(o.callbacks=null,o=0;o<f.length;o++)Gh(f[o],u)}var Hs=_e(null),ju=_e(0);function Wh(o,u){o=Zs,Ie(ju,o),Ie(Hs,u),Zs=o|u.baseLanes}function Df(){Ie(ju,Zs),Ie(Hs,Hs.current)}function Lf(){Zs=ju.current,ye(Hs),ye(ju)}var Ua=0,hr=null,Hr=null,wn=null,ac=!1,Vs=!1,vo=!1,oc=0,Hu=0,es=null,Yh=0;function An(){throw Error(n(321))}function sc(o,u){if(u===null)return!1;for(var f=0;f<u.length&&f<o.length;f++)if(!Zn(o[f],u[f]))return!1;return!0}function Bf(o,u,f,v,g,S){return Ua=S,hr=u,u.memoizedState=null,u.updateQueue=null,u.lanes=0,O.H=o===null||o.memoizedState===null?Wm:To,vo=!1,S=f(v,g),vo=!1,Vs&&(S=Ff(u,f,v,g)),$h(o),S}function $h(o){O.H=Wf;var u=Hr!==null&&Hr.next!==null;if(Ua=0,wn=Hr=hr=null,ac=!1,Hu=0,es=null,u)throw Error(n(300));o===null||jn||(o=o.dependencies,o!==null&&Mf(o)&&(jn=!0))}function Ff(o,u,f,v){hr=o;var g=0;do{if(Vs&&(es=null),Hu=0,Vs=!1,25<=g)throw Error(n(301));if(g+=1,wn=Hr=null,o.updateQueue!=null){var S=o.updateQueue;S.lastEffect=null,S.events=null,S.stores=null,S.memoCache!=null&&(S.memoCache.index=0)}O.H=Ym,S=u(f,v)}while(Vs);return S}function Pm(){var o=O.H,u=o.useState()[0];return u=typeof u.then=="function"?zi(u):u,o=o.useState()[0],(Hr!==null?Hr.memoizedState:null)!==o&&(hr.flags|=1024),u}function Uf(){var o=oc!==0;return oc=0,o}function uc(o,u,f){u.updateQueue=o.updateQueue,u.flags&=-2053,o.lanes&=~f}function lc(o){if(ac){for(o=o.memoizedState;o!==null;){var u=o.queue;u!==null&&(u.pending=null),o=o.next}ac=!1}Ua=0,wn=Hr=hr=null,Vs=!1,Hu=oc=0,es=null}function Vn(){var o={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return wn===null?hr.memoizedState=wn=o:wn=wn.next=o,wn}function Nn(){if(Hr===null){var o=hr.alternate;o=o!==null?o.memoizedState:null}else o=Hr.next;var u=wn===null?hr.memoizedState:wn.next;if(u!==null)wn=u,Hr=o;else{if(o===null)throw hr.alternate===null?Error(n(467)):Error(n(310));Hr=o,o={memoizedState:Hr.memoizedState,baseState:Hr.baseState,baseQueue:Hr.baseQueue,queue:Hr.queue,next:null},wn===null?hr.memoizedState=wn=o:wn=wn.next=o}return wn}function Vu(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function zi(o){var u=Hu;return Hu+=1,es===null&&(es=[]),o=Nm(es,o,u),u=hr,(wn===null?u.memoizedState:wn.next)===null&&(u=u.alternate,O.H=u===null||u.memoizedState===null?Wm:To),o}function ts(o){if(o!==null&&typeof o=="object"){if(typeof o.then=="function")return zi(o);if(o.$$typeof===R)return Kn(o)}throw Error(n(438,String(o)))}function mo(o){var u=null,f=hr.updateQueue;if(f!==null&&(u=f.memoCache),u==null){var v=hr.alternate;v!==null&&(v=v.updateQueue,v!==null&&(v=v.memoCache,v!=null&&(u={data:v.data.map(function(g){return g.slice()}),index:0})))}if(u==null&&(u={data:[],index:0}),f===null&&(f=Vu(),hr.updateQueue=f),f.memoCache=u,f=u.data[u.index],f===void 0)for(f=u.data[u.index]=Array(o),v=0;v<o;v++)f[v]=Q;return u.index++,f}function ji(o,u){return typeof u=="function"?u(o):u}function rs(o){var u=Nn();return _o(u,Hr,o)}function _o(o,u,f){var v=o.queue;if(v===null)throw Error(n(311));v.lastRenderedReducer=f;var g=o.baseQueue,S=v.pending;if(S!==null){if(g!==null){var I=g.next;g.next=S.next,S.next=I}u.baseQueue=g=S,v.pending=null}if(S=o.baseState,g===null)o.memoizedState=S;else{u=g.next;var G=I=null,le=null,Ne=u,tt=!1;do{var ct=Ne.lane&-536870913;if(ct!==Ne.lane?(xr&ct)===ct:(Ua&ct)===ct){var Be=Ne.revertLane;if(Be===0)le!==null&&(le=le.next={lane:0,revertLane:0,action:Ne.action,hasEagerState:Ne.hasEagerState,eagerState:Ne.eagerState,next:null}),ct===ks&&(tt=!0);else if((Ua&Be)===Be){Ne=Ne.next,Be===ks&&(tt=!0);continue}else ct={lane:0,revertLane:Ne.revertLane,action:Ne.action,hasEagerState:Ne.hasEagerState,eagerState:Ne.eagerState,next:null},le===null?(G=le=ct,I=S):le=le.next=ct,hr.lanes|=Be,Ju|=Be;ct=Ne.action,vo&&f(S,ct),S=Ne.hasEagerState?Ne.eagerState:f(S,ct)}else Be={lane:ct,revertLane:Ne.revertLane,action:Ne.action,hasEagerState:Ne.hasEagerState,eagerState:Ne.eagerState,next:null},le===null?(G=le=Be,I=S):le=le.next=Be,hr.lanes|=ct,Ju|=ct;Ne=Ne.next}while(Ne!==null&&Ne!==u);if(le===null?I=S:le.next=G,!Zn(S,o.memoizedState)&&(jn=!0,tt&&(f=Uu,f!==null)))throw f;o.memoizedState=S,o.baseState=I,o.baseQueue=le,v.lastRenderedState=S}return g===null&&(v.lanes=0),[o.memoizedState,v.dispatch]}function go(o){var u=Nn(),f=u.queue;if(f===null)throw Error(n(311));f.lastRenderedReducer=o;var v=f.dispatch,g=f.pending,S=u.memoizedState;if(g!==null){f.pending=null;var I=g=g.next;do S=o(S,I.action),I=I.next;while(I!==g);Zn(S,u.memoizedState)||(jn=!0),u.memoizedState=S,u.baseQueue===null&&(u.baseState=S),f.lastRenderedState=S}return[S,v]}function ns(o,u,f){var v=hr,g=Nn(),S=Dr;if(S){if(f===void 0)throw Error(n(407));f=f()}else f=u();var I=!Zn((Hr||g).memoizedState,f);I&&(g.memoizedState=f,jn=!0),g=g.queue;var G=Xu.bind(null,v,g,o);if(dc(2048,8,G,[o]),g.getSnapshot!==u||I||wn!==null&&wn.memoizedState.tag&1){if(v.flags|=2048,Gu(9,Hf(),fc.bind(null,v,g,f,u),null),ir===null)throw Error(n(349));S||(Ua&124)!==0||cc(v,u,f)}return f}function cc(o,u,f){o.flags|=16384,o={getSnapshot:u,value:f},u=hr.updateQueue,u===null?(u=Vu(),hr.updateQueue=u,u.stores=[o]):(f=u.stores,f===null?u.stores=[o]:f.push(o))}function fc(o,u,f,v){u.value=f,u.getSnapshot=v,kf(u)&&zf(o)}function Xu(o,u,f){return f(function(){kf(u)&&zf(o)})}function kf(o){var u=o.getSnapshot;o=o.value;try{var f=u();return!Zn(o,f)}catch{return!0}}function zf(o){var u=ha(o,2);u!==null&&Ea(u,o,2)}function is(o){var u=Vn();if(typeof o=="function"){var f=o;if(o=f(),vo){tn(!0);try{f()}finally{tn(!1)}}}return u.memoizedState=u.baseState=o,u.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ji,lastRenderedState:o},u}function Xs(o,u,f,v){return o.baseState=f,_o(o,Hr,typeof v=="function"?v:ji)}function Sy(o,u,f,v,g){if(Tc(o))throw Error(n(485));if(o=u.action,o!==null){var S={payload:g,action:o,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(I){S.listeners.push(I)}};O.T!==null?f(!0):S.isTransition=!1,v(S),f=u.pending,f===null?(S.next=u.pending=S,Dm(u,S)):(S.next=f.next,u.pending=f.next=S)}}function Dm(o,u){var f=u.action,v=u.payload,g=o.state;if(u.isTransition){var S=O.T,I={};O.T=I;try{var G=f(g,v),le=O.S;le!==null&&le(I,G),Zh(o,u,G)}catch(Ne){jf(o,u,Ne)}finally{O.T=S}}else try{S=f(g,v),Zh(o,u,S)}catch(Ne){jf(o,u,Ne)}}function Zh(o,u,f){f!==null&&typeof f=="object"&&typeof f.then=="function"?f.then(function(v){Kh(o,u,v)},function(v){return jf(o,u,v)}):Kh(o,u,f)}function Kh(o,u,f){u.status="fulfilled",u.value=f,Lm(u),o.state=f,u=o.pending,u!==null&&(f=u.next,f===u?o.pending=null:(f=f.next,u.next=f,Dm(o,f)))}function jf(o,u,f){var v=o.pending;if(o.pending=null,v!==null){v=v.next;do u.status="rejected",u.reason=f,Lm(u),u=u.next;while(u!==v)}o.action=null}function Lm(o){o=o.listeners;for(var u=0;u<o.length;u++)(0,o[u])()}function Gs(o,u){return u}function Bm(o,u){if(Dr){var f=ir.formState;if(f!==null){e:{var v=hr;if(Dr){if(cn){t:{for(var g=cn,S=Dn;g.nodeType!==8;){if(!S){g=null;break t}if(g=Ao(g.nextSibling),g===null){g=null;break t}}S=g.data,g=S==="F!"||S==="F"?g:null}if(g){cn=Ao(g.nextSibling),v=g.data==="F!";break e}}Fs(v)}v=!1}v&&(u=f[0])}}return f=Vn(),f.memoizedState=f.baseState=u,v={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Gs,lastRenderedState:u},f.queue=v,f=Jh.bind(null,hr,v),v.dispatch=f,v=is(!1),S=Eo.bind(null,hr,!1,v.queue),v=Vn(),g={state:u,dispatch:null,action:o,pending:null},v.queue=g,f=Sy.bind(null,hr,g,S,f),g.dispatch=f,v.memoizedState=o,[u,f,!1]}function Fm(o){var u=Nn();return Um(u,Hr,o)}function Um(o,u,f){if(u=_o(o,u,Gs)[0],o=rs(ji)[0],typeof u=="object"&&u!==null&&typeof u.then=="function")try{var v=zi(u)}catch(I){throw I===zs?nc:I}else v=u;u=Nn();var g=u.queue,S=g.dispatch;return f!==u.memoizedState&&(hr.flags|=2048,Gu(9,Hf(),km.bind(null,g,f),null)),[v,S,o]}function km(o,u){o.action=u}function zm(o){var u=Nn(),f=Hr;if(f!==null)return Um(u,f,o);Nn(),u=u.memoizedState,f=Nn();var v=f.queue.dispatch;return f.memoizedState=o,[u,v,!1]}function Gu(o,u,f,v){return o={tag:o,create:f,deps:v,inst:u,next:null},u=hr.updateQueue,u===null&&(u=Vu(),hr.updateQueue=u),f=u.lastEffect,f===null?u.lastEffect=o.next=o:(v=f.next,f.next=o,o.next=v,u.lastEffect=o),o}function Hf(){return{destroy:void 0,resource:void 0}}function jm(){return Nn().memoizedState}function Vf(o,u,f,v){var g=Vn();v=v===void 0?null:v,hr.flags|=o,g.memoizedState=Gu(1|u,Hf(),f,v)}function dc(o,u,f,v){var g=Nn();v=v===void 0?null:v;var S=g.memoizedState.inst;Hr!==null&&v!==null&&sc(v,Hr.memoizedState.deps)?g.memoizedState=Gu(u,S,f,v):(hr.flags|=o,g.memoizedState=Gu(1|u,S,f,v))}function Hm(o,u){Vf(8390656,8,o,u)}function Vm(o,u){dc(2048,8,o,u)}function Xm(o,u){return dc(4,2,o,u)}function Gm(o,u){return dc(4,4,o,u)}function Xf(o,u){if(typeof u=="function"){o=o();var f=u(o);return function(){typeof f=="function"?f():u(null)}}if(u!=null)return o=o(),u.current=o,function(){u.current=null}}function hc(o,u,f){f=f!=null?f.concat([o]):null,dc(4,4,Xf.bind(null,u,o),f)}function qu(){}function pc(o,u){var f=Nn();u=u===void 0?null:u;var v=f.memoizedState;return u!==null&&sc(u,v[1])?v[0]:(f.memoizedState=[o,u],o)}function Gf(o,u){var f=Nn();u=u===void 0?null:u;var v=f.memoizedState;if(u!==null&&sc(u,v[1]))return v[0];if(v=o(),vo){tn(!0);try{o()}finally{tn(!1)}}return f.memoizedState=[v,u],v}function Wu(o,u,f){return f===void 0||(Ua&1073741824)!==0?o.memoizedState=u:(o.memoizedState=f,o=l2(),hr.lanes|=o,Ju|=o,f)}function vc(o,u,f,v){return Zn(f,u)?f:Hs.current!==null?(o=Wu(o,f,v),Zn(o,u)||(jn=!0),o):(Ua&42)===0?(jn=!0,o.memoizedState=f):(o=l2(),hr.lanes|=o,Ju|=o,u)}function mc(o,u,f,v,g){var S=F.p;F.p=S!==0&&8>S?S:8;var I=O.T,G={};O.T=G,Eo(o,!1,u,f);try{var le=g(),Ne=O.S;if(Ne!==null&&Ne(G,le),le!==null&&typeof le=="object"&&typeof le.then=="function"){var tt=Ty(le,v);yo(o,u,tt,ya(o))}else yo(o,u,v,ya(o))}catch(ct){yo(o,u,{then:function(){},status:"rejected",reason:ct},ya())}finally{F.p=S,O.T=I}}function Qh(){}function Yu(o,u,f,v){if(o.tag!==5)throw Error(n(476));var g=_c(o).queue;mc(o,g,u,z,f===null?Qh:function(){return gc(o),f(v)})}function _c(o){var u=o.memoizedState;if(u!==null)return u;u={memoizedState:z,baseState:z,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ji,lastRenderedState:z},next:null};var f={};return u.next={memoizedState:f,baseState:f,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ji,lastRenderedState:f},next:null},o.memoizedState=u,o=o.alternate,o!==null&&(o.memoizedState=u),u}function gc(o){var u=_c(o).next.queue;yo(o,u,{},ya())}function qs(){return Kn(pp)}function $u(){return Nn().memoizedState}function Zu(){return Nn().memoizedState}function yc(o){for(var u=o.return;u!==null;){switch(u.tag){case 24:case 3:var f=ya();o=ki(f);var v=Qo(u,o,f);v!==null&&(Ea(v,u,f),Fa(v,u,f)),u={cache:kh()},o.payload=u;return}u=u.return}}function Ec(o,u,f){var v=ya();f={lane:v,revertLane:0,action:f,hasEagerState:!1,eagerState:null,next:null},Tc(o)?qf(u,f):(f=Ph(o,u,f,v),f!==null&&(Ea(f,o,v),qm(f,u,v)))}function Jh(o,u,f){var v=ya();yo(o,u,f,v)}function yo(o,u,f,v){var g={lane:v,revertLane:0,action:f,hasEagerState:!1,eagerState:null,next:null};if(Tc(o))qf(u,g);else{var S=o.alternate;if(o.lanes===0&&(S===null||S.lanes===0)&&(S=u.lastRenderedReducer,S!==null))try{var I=u.lastRenderedState,G=S(I,f);if(g.hasEagerState=!0,g.eagerState=G,Zn(G,I))return $l(o,u,g,0),ir===null&&Yl(),!1}catch{}finally{}if(f=Ph(o,u,g,v),f!==null)return Ea(f,o,v),qm(f,u,v),!0}return!1}function Eo(o,u,f,v){if(v={lane:2,revertLane:Fy(),action:v,hasEagerState:!1,eagerState:null,next:null},Tc(o)){if(u)throw Error(n(479))}else u=Ph(o,f,v,2),u!==null&&Ea(u,o,2)}function Tc(o){var u=o.alternate;return o===hr||u!==null&&u===hr}function qf(o,u){Vs=ac=!0;var f=o.pending;f===null?u.next=u:(u.next=f.next,f.next=u),o.pending=u}function qm(o,u,f){if((f&4194048)!==0){var v=u.lanes;v&=o.pendingLanes,f|=v,u.lanes=f,ai(o,f)}}var Wf={readContext:Kn,use:ts,useCallback:An,useContext:An,useEffect:An,useImperativeHandle:An,useLayoutEffect:An,useInsertionEffect:An,useMemo:An,useReducer:An,useRef:An,useState:An,useDebugValue:An,useDeferredValue:An,useTransition:An,useSyncExternalStore:An,useId:An,useHostTransitionStatus:An,useFormState:An,useActionState:An,useOptimistic:An,useMemoCache:An,useCacheRefresh:An},Wm={readContext:Kn,use:ts,useCallback:function(o,u){return Vn().memoizedState=[o,u===void 0?null:u],o},useContext:Kn,useEffect:Hm,useImperativeHandle:function(o,u,f){f=f!=null?f.concat([o]):null,Vf(4194308,4,Xf.bind(null,u,o),f)},useLayoutEffect:function(o,u){return Vf(4194308,4,o,u)},useInsertionEffect:function(o,u){Vf(4,2,o,u)},useMemo:function(o,u){var f=Vn();u=u===void 0?null:u;var v=o();if(vo){tn(!0);try{o()}finally{tn(!1)}}return f.memoizedState=[v,u],v},useReducer:function(o,u,f){var v=Vn();if(f!==void 0){var g=f(u);if(vo){tn(!0);try{f(u)}finally{tn(!1)}}}else g=u;return v.memoizedState=v.baseState=g,o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:o,lastRenderedState:g},v.queue=o,o=o.dispatch=Ec.bind(null,hr,o),[v.memoizedState,o]},useRef:function(o){var u=Vn();return o={current:o},u.memoizedState=o},useState:function(o){o=is(o);var u=o.queue,f=Jh.bind(null,hr,u);return u.dispatch=f,[o.memoizedState,f]},useDebugValue:qu,useDeferredValue:function(o,u){var f=Vn();return Wu(f,o,u)},useTransition:function(){var o=is(!1);return o=mc.bind(null,hr,o.queue,!0,!1),Vn().memoizedState=o,[!1,o]},useSyncExternalStore:function(o,u,f){var v=hr,g=Vn();if(Dr){if(f===void 0)throw Error(n(407));f=f()}else{if(f=u(),ir===null)throw Error(n(349));(xr&124)!==0||cc(v,u,f)}g.memoizedState=f;var S={value:f,getSnapshot:u};return g.queue=S,Hm(Xu.bind(null,v,S,o),[o]),v.flags|=2048,Gu(9,Hf(),fc.bind(null,v,S,f,u),null),f},useId:function(){var o=Vn(),u=ir.identifierPrefix;if(Dr){var f=Da,v=Qi;f=(v&~(1<<32-yr(v)-1)).toString(32)+f,u="«"+u+"R"+f,f=oc++,0<f&&(u+="H"+f.toString(32)),u+="»"}else f=Yh++,u="«"+u+"r"+f.toString(32)+"»";return o.memoizedState=u},useHostTransitionStatus:qs,useFormState:Bm,useActionState:Bm,useOptimistic:function(o){var u=Vn();u.memoizedState=u.baseState=o;var f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return u.queue=f,u=Eo.bind(null,hr,!0,f),f.dispatch=u,[o,u]},useMemoCache:mo,useCacheRefresh:function(){return Vn().memoizedState=yc.bind(null,hr)}},To={readContext:Kn,use:ts,useCallback:pc,useContext:Kn,useEffect:Vm,useImperativeHandle:hc,useInsertionEffect:Xm,useLayoutEffect:Gm,useMemo:Gf,useReducer:rs,useRef:jm,useState:function(){return rs(ji)},useDebugValue:qu,useDeferredValue:function(o,u){var f=Nn();return vc(f,Hr.memoizedState,o,u)},useTransition:function(){var o=rs(ji)[0],u=Nn().memoizedState;return[typeof o=="boolean"?o:zi(o),u]},useSyncExternalStore:ns,useId:$u,useHostTransitionStatus:qs,useFormState:Fm,useActionState:Fm,useOptimistic:function(o,u){var f=Nn();return Xs(f,Hr,o,u)},useMemoCache:mo,useCacheRefresh:Zu},Ym={readContext:Kn,use:ts,useCallback:pc,useContext:Kn,useEffect:Vm,useImperativeHandle:hc,useInsertionEffect:Xm,useLayoutEffect:Gm,useMemo:Gf,useReducer:go,useRef:jm,useState:function(){return go(ji)},useDebugValue:qu,useDeferredValue:function(o,u){var f=Nn();return Hr===null?Wu(f,o,u):vc(f,Hr.memoizedState,o,u)},useTransition:function(){var o=go(ji)[0],u=Nn().memoizedState;return[typeof o=="boolean"?o:zi(o),u]},useSyncExternalStore:ns,useId:$u,useHostTransitionStatus:qs,useFormState:zm,useActionState:zm,useOptimistic:function(o,u){var f=Nn();return Hr!==null?Xs(f,Hr,o,u):(f.baseState=o,[o,f.queue.dispatch])},useMemoCache:mo,useCacheRefresh:Zu},Ws=null,Ku=0;function Yf(o){var u=Ku;return Ku+=1,Ws===null&&(Ws=[]),Nm(Ws,o,u)}function Qu(o,u){u=u.props.ref,o.ref=u!==void 0?u:null}function $f(o,u){throw u.$$typeof===h?Error(n(525)):(o=Object.prototype.toString.call(u),Error(n(31,o==="[object Object]"?"object with keys {"+Object.keys(u).join(", ")+"}":o)))}function ma(o){var u=o._init;return u(o._payload)}function ep(o){function u(Se,ve){if(o){var Me=Se.deletions;Me===null?(Se.deletions=[ve],Se.flags|=16):Me.push(ve)}}function f(Se,ve){if(!o)return null;for(;ve!==null;)u(Se,ve),ve=ve.sibling;return null}function v(Se){for(var ve=new Map;Se!==null;)Se.key!==null?ve.set(Se.key,Se):ve.set(Se.index,Se),Se=Se.sibling;return ve}function g(Se,ve){return Se=ho(Se,ve),Se.index=0,Se.sibling=null,Se}function S(Se,ve,Me){return Se.index=Me,o?(Me=Se.alternate,Me!==null?(Me=Me.index,Me<ve?(Se.flags|=67108866,ve):Me):(Se.flags|=67108866,ve)):(Se.flags|=1048576,ve)}function I(Se){return o&&Se.alternate===null&&(Se.flags|=67108866),Se}function G(Se,ve,Me,it){return ve===null||ve.tag!==6?(ve=Kl(Me,Se.mode,it),ve.return=Se,ve):(ve=g(ve,Me),ve.return=Se,ve)}function le(Se,ve,Me,it){var Vt=Me.type;return Vt===y?tt(Se,ve,Me.props.children,it,Me.key):ve!==null&&(ve.elementType===Vt||typeof Vt=="object"&&Vt!==null&&Vt.$$typeof===U&&ma(Vt)===ve.type)?(ve=g(ve,Me.props),Qu(ve,Me),ve.return=Se,ve):(ve=Tf(Me.type,Me.key,Me.props,null,Se.mode,it),Qu(ve,Me),ve.return=Se,ve)}function Ne(Se,ve,Me,it){return ve===null||ve.tag!==4||ve.stateNode.containerInfo!==Me.containerInfo||ve.stateNode.implementation!==Me.implementation?(ve=Sf(Me,Se.mode,it),ve.return=Se,ve):(ve=g(ve,Me.children||[]),ve.return=Se,ve)}function tt(Se,ve,Me,it,Vt){return ve===null||ve.tag!==7?(ve=Ls(Me,Se.mode,it,Vt),ve.return=Se,ve):(ve=g(ve,Me),ve.return=Se,ve)}function ct(Se,ve,Me){if(typeof ve=="string"&&ve!==""||typeof ve=="number"||typeof ve=="bigint")return ve=Kl(""+ve,Se.mode,Me),ve.return=Se,ve;if(typeof ve=="object"&&ve!==null){switch(ve.$$typeof){case m:return Me=Tf(ve.type,ve.key,ve.props,null,Se.mode,Me),Qu(Me,ve),Me.return=Se,Me;case _:return ve=Sf(ve,Se.mode,Me),ve.return=Se,ve;case U:var it=ve._init;return ve=it(ve._payload),ct(Se,ve,Me)}if(pe(ve)||x(ve))return ve=Ls(ve,Se.mode,Me,null),ve.return=Se,ve;if(typeof ve.then=="function")return ct(Se,Yf(ve),Me);if(ve.$$typeof===R)return ct(Se,ec(Se,ve),Me);$f(Se,ve)}return null}function Be(Se,ve,Me,it){var Vt=ve!==null?ve.key:null;if(typeof Me=="string"&&Me!==""||typeof Me=="number"||typeof Me=="bigint")return Vt!==null?null:G(Se,ve,""+Me,it);if(typeof Me=="object"&&Me!==null){switch(Me.$$typeof){case m:return Me.key===Vt?le(Se,ve,Me,it):null;case _:return Me.key===Vt?Ne(Se,ve,Me,it):null;case U:return Vt=Me._init,Me=Vt(Me._payload),Be(Se,ve,Me,it)}if(pe(Me)||x(Me))return Vt!==null?null:tt(Se,ve,Me,it,null);if(typeof Me.then=="function")return Be(Se,ve,Yf(Me),it);if(Me.$$typeof===R)return Be(Se,ve,ec(Se,Me),it);$f(Se,Me)}return null}function ke(Se,ve,Me,it,Vt){if(typeof it=="string"&&it!==""||typeof it=="number"||typeof it=="bigint")return Se=Se.get(Me)||null,G(ve,Se,""+it,Vt);if(typeof it=="object"&&it!==null){switch(it.$$typeof){case m:return Se=Se.get(it.key===null?Me:it.key)||null,le(ve,Se,it,Vt);case _:return Se=Se.get(it.key===null?Me:it.key)||null,Ne(ve,Se,it,Vt);case U:var Rr=it._init;return it=Rr(it._payload),ke(Se,ve,Me,it,Vt)}if(pe(it)||x(it))return Se=Se.get(Me)||null,tt(ve,Se,it,Vt,null);if(typeof it.then=="function")return ke(Se,ve,Me,Yf(it),Vt);if(it.$$typeof===R)return ke(Se,ve,Me,ec(ve,it),Vt);$f(ve,it)}return null}function ur(Se,ve,Me,it){for(var Vt=null,Rr=null,$t=ve,nr=ve=0,di=null;$t!==null&&nr<Me.length;nr++){$t.index>nr?(di=$t,$t=null):di=$t.sibling;var Ur=Be(Se,$t,Me[nr],it);if(Ur===null){$t===null&&($t=di);break}o&&$t&&Ur.alternate===null&&u(Se,$t),ve=S(Ur,ve,nr),Rr===null?Vt=Ur:Rr.sibling=Ur,Rr=Ur,$t=di}if(nr===Me.length)return f(Se,$t),Dr&&qo(Se,nr),Vt;if($t===null){for(;nr<Me.length;nr++)$t=ct(Se,Me[nr],it),$t!==null&&(ve=S($t,ve,nr),Rr===null?Vt=$t:Rr.sibling=$t,Rr=$t);return Dr&&qo(Se,nr),Vt}for($t=v($t);nr<Me.length;nr++)di=ke($t,Se,nr,Me[nr],it),di!==null&&(o&&di.alternate!==null&&$t.delete(di.key===null?nr:di.key),ve=S(di,ve,nr),Rr===null?Vt=di:Rr.sibling=di,Rr=di);return o&&$t.forEach(function(ul){return u(Se,ul)}),Dr&&qo(Se,nr),Vt}function tr(Se,ve,Me,it){if(Me==null)throw Error(n(151));for(var Vt=null,Rr=null,$t=ve,nr=ve=0,di=null,Ur=Me.next();$t!==null&&!Ur.done;nr++,Ur=Me.next()){$t.index>nr?(di=$t,$t=null):di=$t.sibling;var ul=Be(Se,$t,Ur.value,it);if(ul===null){$t===null&&($t=di);break}o&&$t&&ul.alternate===null&&u(Se,$t),ve=S(ul,ve,nr),Rr===null?Vt=ul:Rr.sibling=ul,Rr=ul,$t=di}if(Ur.done)return f(Se,$t),Dr&&qo(Se,nr),Vt;if($t===null){for(;!Ur.done;nr++,Ur=Me.next())Ur=ct(Se,Ur.value,it),Ur!==null&&(ve=S(Ur,ve,nr),Rr===null?Vt=Ur:Rr.sibling=Ur,Rr=Ur);return Dr&&qo(Se,nr),Vt}for($t=v($t);!Ur.done;nr++,Ur=Me.next())Ur=ke($t,Se,nr,Ur.value,it),Ur!==null&&(o&&Ur.alternate!==null&&$t.delete(Ur.key===null?nr:Ur.key),ve=S(Ur,ve,nr),Rr===null?Vt=Ur:Rr.sibling=Ur,Rr=Ur);return o&&$t.forEach(function(K7){return u(Se,K7)}),Dr&&qo(Se,nr),Vt}function Qr(Se,ve,Me,it){if(typeof Me=="object"&&Me!==null&&Me.type===y&&Me.key===null&&(Me=Me.props.children),typeof Me=="object"&&Me!==null){switch(Me.$$typeof){case m:e:{for(var Vt=Me.key;ve!==null;){if(ve.key===Vt){if(Vt=Me.type,Vt===y){if(ve.tag===7){f(Se,ve.sibling),it=g(ve,Me.props.children),it.return=Se,Se=it;break e}}else if(ve.elementType===Vt||typeof Vt=="object"&&Vt!==null&&Vt.$$typeof===U&&ma(Vt)===ve.type){f(Se,ve.sibling),it=g(ve,Me.props),Qu(it,Me),it.return=Se,Se=it;break e}f(Se,ve);break}else u(Se,ve);ve=ve.sibling}Me.type===y?(it=Ls(Me.props.children,Se.mode,it,Me.key),it.return=Se,Se=it):(it=Tf(Me.type,Me.key,Me.props,null,Se.mode,it),Qu(it,Me),it.return=Se,Se=it)}return I(Se);case _:e:{for(Vt=Me.key;ve!==null;){if(ve.key===Vt)if(ve.tag===4&&ve.stateNode.containerInfo===Me.containerInfo&&ve.stateNode.implementation===Me.implementation){f(Se,ve.sibling),it=g(ve,Me.children||[]),it.return=Se,Se=it;break e}else{f(Se,ve);break}else u(Se,ve);ve=ve.sibling}it=Sf(Me,Se.mode,it),it.return=Se,Se=it}return I(Se);case U:return Vt=Me._init,Me=Vt(Me._payload),Qr(Se,ve,Me,it)}if(pe(Me))return ur(Se,ve,Me,it);if(x(Me)){if(Vt=x(Me),typeof Vt!="function")throw Error(n(150));return Me=Vt.call(Me),tr(Se,ve,Me,it)}if(typeof Me.then=="function")return Qr(Se,ve,Yf(Me),it);if(Me.$$typeof===R)return Qr(Se,ve,ec(Se,Me),it);$f(Se,Me)}return typeof Me=="string"&&Me!==""||typeof Me=="number"||typeof Me=="bigint"?(Me=""+Me,ve!==null&&ve.tag===6?(f(Se,ve.sibling),it=g(ve,Me),it.return=Se,Se=it):(f(Se,ve),it=Kl(Me,Se.mode,it),it.return=Se,Se=it),I(Se)):f(Se,ve)}return function(Se,ve,Me,it){try{Ku=0;var Vt=Qr(Se,ve,Me,it);return Ws=null,Vt}catch($t){if($t===zs||$t===nc)throw $t;var Rr=Ri(29,$t,null,Se.mode);return Rr.lanes=it,Rr.return=Se,Rr}finally{}}}var _a=ep(!0),So=ep(!1),Hi=_e(null),ea=null;function ga(o){var u=o.alternate;Ie(vr,vr.current&1),Ie(Hi,o),ea===null&&(u===null||Hs.current!==null||u.memoizedState!==null)&&(ea=o)}function tp(o){if(o.tag===22){if(Ie(vr,vr.current),Ie(Hi,o),ea===null){var u=o.alternate;u!==null&&u.memoizedState!==null&&(ea=o)}}else Ln()}function Ln(){Ie(vr,vr.current),Ie(Hi,Hi.current)}function ci(o){ye(Hi),ea===o&&(ea=null),ye(vr)}var vr=_e(0);function Qn(o){for(var u=o;u!==null;){if(u.tag===13){var f=u.memoizedState;if(f!==null&&(f=f.dehydrated,f===null||f.data==="$?"||$y(f)))return u}else if(u.tag===19&&u.memoizedProps.revealOrder!==void 0){if((u.flags&128)!==0)return u}else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===o)break;for(;u.sibling===null;){if(u.return===null||u.return===o)return null;u=u.return}u.sibling.return=u.return,u=u.sibling}return null}function Zf(o,u,f,v){u=o.memoizedState,f=f(v,u),f=f==null?u:p({},u,f),o.memoizedState=f,o.lanes===0&&(o.updateQueue.baseState=f)}var rp={enqueueSetState:function(o,u,f){o=o._reactInternals;var v=ya(),g=ki(v);g.payload=u,f!=null&&(g.callback=f),u=Qo(o,g,v),u!==null&&(Ea(u,o,v),Fa(u,o,v))},enqueueReplaceState:function(o,u,f){o=o._reactInternals;var v=ya(),g=ki(v);g.tag=1,g.payload=u,f!=null&&(g.callback=f),u=Qo(o,g,v),u!==null&&(Ea(u,o,v),Fa(u,o,v))},enqueueForceUpdate:function(o,u){o=o._reactInternals;var f=ya(),v=ki(f);v.tag=2,u!=null&&(v.callback=u),u=Qo(o,v,f),u!==null&&(Ea(u,o,f),Fa(u,o,f))}};function $m(o,u,f,v,g,S,I){return o=o.stateNode,typeof o.shouldComponentUpdate=="function"?o.shouldComponentUpdate(v,S,I):u.prototype&&u.prototype.isPureReactComponent?!ql(f,v)||!ql(g,S):!0}function Zm(o,u,f,v){o=u.state,typeof u.componentWillReceiveProps=="function"&&u.componentWillReceiveProps(f,v),typeof u.UNSAFE_componentWillReceiveProps=="function"&&u.UNSAFE_componentWillReceiveProps(f,v),u.state!==o&&rp.enqueueReplaceState(u,u.state,null)}function Ys(o,u){var f=u;if("ref"in u){f={};for(var v in u)v!=="ref"&&(f[v]=u[v])}if(o=o.defaultProps){f===u&&(f=p({},f));for(var g in o)f[g]===void 0&&(f[g]=o[g])}return f}var Sc=typeof reportError=="function"?reportError:function(o){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var u=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof o=="object"&&o!==null&&typeof o.message=="string"?String(o.message):String(o),error:o});if(!window.dispatchEvent(u))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",o);return}console.error(o)};function Km(o){Sc(o)}function Qm(o){console.error(o)}function Jm(o){Sc(o)}function Kf(o,u){try{var f=o.onUncaughtError;f(u.value,{componentStack:u.stack})}catch(v){setTimeout(function(){throw v})}}function e_(o,u,f){try{var v=o.onCaughtError;v(f.value,{componentStack:f.stack,errorBoundary:u.tag===1?u.stateNode:null})}catch(g){setTimeout(function(){throw g})}}function Qf(o,u,f){return f=ki(f),f.tag=3,f.payload={element:null},f.callback=function(){Kf(o,u)},f}function np(o){return o=ki(o),o.tag=3,o}function ip(o,u,f,v){var g=f.type.getDerivedStateFromError;if(typeof g=="function"){var S=v.value;o.payload=function(){return g(S)},o.callback=function(){e_(u,f,v)}}var I=f.stateNode;I!==null&&typeof I.componentDidCatch=="function"&&(o.callback=function(){e_(u,f,v),typeof g!="function"&&(el===null?el=new Set([this]):el.add(this));var G=v.stack;this.componentDidCatch(v.value,{componentStack:G!==null?G:""})})}function Ay(o,u,f,v,g){if(f.flags|=32768,v!==null&&typeof v=="object"&&typeof v.then=="function"){if(u=f.alternate,u!==null&&Jl(u,f,g,!0),f=Hi.current,f!==null){switch(f.tag){case 13:return ea===null?Iy():f.alternate===null&&Bn===0&&(Bn=3),f.flags&=-257,f.flags|=65536,f.lanes=g,v===Vh?f.flags|=16384:(u=f.updateQueue,u===null?f.updateQueue=new Set([v]):u.add(v),Dy(o,v,g)),!1;case 22:return f.flags|=65536,v===Vh?f.flags|=16384:(u=f.updateQueue,u===null?(u={transitions:null,markerInstances:null,retryQueue:new Set([v])},f.updateQueue=u):(f=u.retryQueue,f===null?u.retryQueue=new Set([v]):f.add(v)),Dy(o,v,g)),!1}throw Error(n(435,f.tag))}return Dy(o,v,g),Iy(),!1}if(Dr)return u=Hi.current,u!==null?((u.flags&65536)===0&&(u.flags|=256),u.flags|=65536,u.lanes=g,v!==Rf&&(o=Error(n(422),{cause:v}),Fu(Fi(o,f)))):(v!==Rf&&(u=Error(n(423),{cause:v}),Fu(Fi(u,f))),o=o.current.alternate,o.flags|=65536,g&=-g,o.lanes|=g,v=Fi(v,f),g=Qf(o.stateNode,v,g),Pf(o,g),Bn!==4&&(Bn=2)),!1;var S=Error(n(520),{cause:v});if(S=Fi(S,f),ap===null?ap=[S]:ap.push(S),Bn!==4&&(Bn=2),u===null)return!0;v=Fi(v,f),f=u;do{switch(f.tag){case 3:return f.flags|=65536,o=g&-g,f.lanes|=o,o=Qf(f.stateNode,v,o),Pf(f,o),!1;case 1:if(u=f.type,S=f.stateNode,(f.flags&128)===0&&(typeof u.getDerivedStateFromError=="function"||S!==null&&typeof S.componentDidCatch=="function"&&(el===null||!el.has(S))))return f.flags|=65536,g&=-g,f.lanes|=g,g=np(g),ip(g,o,f,v),Pf(f,g),!1}f=f.return}while(f!==null);return!1}var t_=Error(n(461)),jn=!1;function Jn(o,u,f,v){u.child=o===null?So(u,null,f,v):_a(u,o.child,f,v)}function C(o,u,f,v,g){f=f.render;var S=u.ref;if("ref"in v){var I={};for(var G in v)G!=="ref"&&(I[G]=v[G])}else I=v;return Us(u),v=Bf(o,u,f,I,S,g),G=Uf(),o!==null&&!jn?(uc(o,u,g),Tt(o,u,g)):(Dr&&G&&bf(u),u.flags|=1,Jn(o,u,v,g),u.child)}function W(o,u,f,v,g){if(o===null){var S=f.type;return typeof S=="function"&&!Ef(S)&&S.defaultProps===void 0&&f.compare===null?(u.tag=15,u.type=S,ne(o,u,S,v,g)):(o=Tf(f.type,null,v,u,u.mode,g),o.ref=u.ref,o.return=u,u.child=o)}if(S=o.child,!st(o,g)){var I=S.memoizedProps;if(f=f.compare,f=f!==null?f:ql,f(I,v)&&o.ref===u.ref)return Tt(o,u,g)}return u.flags|=1,o=ho(S,v),o.ref=u.ref,o.return=u,u.child=o}function ne(o,u,f,v,g){if(o!==null){var S=o.memoizedProps;if(ql(S,v)&&o.ref===u.ref)if(jn=!1,u.pendingProps=v=S,st(o,g))(o.flags&131072)!==0&&(jn=!0);else return u.lanes=o.lanes,Tt(o,u,g)}return De(o,u,f,v,g)}function be(o,u,f){var v=u.pendingProps,g=v.children,S=o!==null?o.memoizedState:null;if(v.mode==="hidden"){if((u.flags&128)!==0){if(v=S!==null?S.baseLanes|f:f,o!==null){for(g=u.child=o.child,S=0;g!==null;)S=S|g.lanes|g.childLanes,g=g.sibling;u.childLanes=S&~v}else u.childLanes=0,u.child=null;return je(o,u,v,f)}if((f&536870912)!==0)u.memoizedState={baseLanes:0,cachePool:null},o!==null&&Nf(u,S!==null?S.cachePool:null),S!==null?Wh(u,S):Df(),tp(u);else return u.lanes=u.childLanes=536870912,je(o,u,S!==null?S.baseLanes|f:f,f)}else S!==null?(Nf(u,S.cachePool),Wh(u,S),Ln(),u.memoizedState=null):(o!==null&&Nf(u,null),Df(),Ln());return Jn(o,u,g,f),u.child}function je(o,u,f,v){var g=jh();return g=g===null?null:{parent:zn._currentValue,pool:g},u.memoizedState={baseLanes:f,cachePool:g},o!==null&&Nf(u,null),Df(),tp(u),o!==null&&Jl(o,u,v,!0),null}function Re(o,u){var f=u.ref;if(f===null)o!==null&&o.ref!==null&&(u.flags|=4194816);else{if(typeof f!="function"&&typeof f!="object")throw Error(n(284));(o===null||o.ref!==f)&&(u.flags|=4194816)}}function De(o,u,f,v,g){return Us(u),f=Bf(o,u,f,v,void 0,g),v=Uf(),o!==null&&!jn?(uc(o,u,g),Tt(o,u,g)):(Dr&&v&&bf(u),u.flags|=1,Jn(o,u,f,g),u.child)}function at(o,u,f,v,g,S){return Us(u),u.updateQueue=null,f=Ff(u,v,f,g),$h(o),v=Uf(),o!==null&&!jn?(uc(o,u,S),Tt(o,u,S)):(Dr&&v&&bf(u),u.flags|=1,Jn(o,u,f,S),u.child)}function ut(o,u,f,v,g){if(Us(u),u.stateNode===null){var S=Ps,I=f.contextType;typeof I=="object"&&I!==null&&(S=Kn(I)),S=new f(v,S),u.memoizedState=S.state!==null&&S.state!==void 0?S.state:null,S.updater=rp,u.stateNode=S,S._reactInternals=u,S=u.stateNode,S.props=v,S.state=u.memoizedState,S.refs={},Xh(u),I=f.contextType,S.context=typeof I=="object"&&I!==null?Kn(I):Ps,S.state=u.memoizedState,I=f.getDerivedStateFromProps,typeof I=="function"&&(Zf(u,f,I,v),S.state=u.memoizedState),typeof f.getDerivedStateFromProps=="function"||typeof S.getSnapshotBeforeUpdate=="function"||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(I=S.state,typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount(),I!==S.state&&rp.enqueueReplaceState(S,S.state,null),zu(u,v,S,g),js(),S.state=u.memoizedState),typeof S.componentDidMount=="function"&&(u.flags|=4194308),v=!0}else if(o===null){S=u.stateNode;var G=u.memoizedProps,le=Ys(f,G);S.props=le;var Ne=S.context,tt=f.contextType;I=Ps,typeof tt=="object"&&tt!==null&&(I=Kn(tt));var ct=f.getDerivedStateFromProps;tt=typeof ct=="function"||typeof S.getSnapshotBeforeUpdate=="function",G=u.pendingProps!==G,tt||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(G||Ne!==I)&&Zm(u,S,v,I),va=!1;var Be=u.memoizedState;S.state=Be,zu(u,v,S,g),js(),Ne=u.memoizedState,G||Be!==Ne||va?(typeof ct=="function"&&(Zf(u,f,ct,v),Ne=u.memoizedState),(le=va||$m(u,f,le,v,Be,Ne,I))?(tt||typeof S.UNSAFE_componentWillMount!="function"&&typeof S.componentWillMount!="function"||(typeof S.componentWillMount=="function"&&S.componentWillMount(),typeof S.UNSAFE_componentWillMount=="function"&&S.UNSAFE_componentWillMount()),typeof S.componentDidMount=="function"&&(u.flags|=4194308)):(typeof S.componentDidMount=="function"&&(u.flags|=4194308),u.memoizedProps=v,u.memoizedState=Ne),S.props=v,S.state=Ne,S.context=I,v=le):(typeof S.componentDidMount=="function"&&(u.flags|=4194308),v=!1)}else{S=u.stateNode,Ko(o,u),I=u.memoizedProps,tt=Ys(f,I),S.props=tt,ct=u.pendingProps,Be=S.context,Ne=f.contextType,le=Ps,typeof Ne=="object"&&Ne!==null&&(le=Kn(Ne)),G=f.getDerivedStateFromProps,(Ne=typeof G=="function"||typeof S.getSnapshotBeforeUpdate=="function")||typeof S.UNSAFE_componentWillReceiveProps!="function"&&typeof S.componentWillReceiveProps!="function"||(I!==ct||Be!==le)&&Zm(u,S,v,le),va=!1,Be=u.memoizedState,S.state=Be,zu(u,v,S,g),js();var ke=u.memoizedState;I!==ct||Be!==ke||va||o!==null&&o.dependencies!==null&&Mf(o.dependencies)?(typeof G=="function"&&(Zf(u,f,G,v),ke=u.memoizedState),(tt=va||$m(u,f,tt,v,Be,ke,le)||o!==null&&o.dependencies!==null&&Mf(o.dependencies))?(Ne||typeof S.UNSAFE_componentWillUpdate!="function"&&typeof S.componentWillUpdate!="function"||(typeof S.componentWillUpdate=="function"&&S.componentWillUpdate(v,ke,le),typeof S.UNSAFE_componentWillUpdate=="function"&&S.UNSAFE_componentWillUpdate(v,ke,le)),typeof S.componentDidUpdate=="function"&&(u.flags|=4),typeof S.getSnapshotBeforeUpdate=="function"&&(u.flags|=1024)):(typeof S.componentDidUpdate!="function"||I===o.memoizedProps&&Be===o.memoizedState||(u.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||I===o.memoizedProps&&Be===o.memoizedState||(u.flags|=1024),u.memoizedProps=v,u.memoizedState=ke),S.props=v,S.state=ke,S.context=le,v=tt):(typeof S.componentDidUpdate!="function"||I===o.memoizedProps&&Be===o.memoizedState||(u.flags|=4),typeof S.getSnapshotBeforeUpdate!="function"||I===o.memoizedProps&&Be===o.memoizedState||(u.flags|=1024),v=!1)}return S=v,Re(o,u),v=(u.flags&128)!==0,S||v?(S=u.stateNode,f=v&&typeof f.getDerivedStateFromError!="function"?null:S.render(),u.flags|=1,o!==null&&v?(u.child=_a(u,o.child,null,g),u.child=_a(u,null,f,g)):Jn(o,u,f,g),u.memoizedState=S.state,o=u.child):o=Tt(o,u,g),o}function mt(o,u,f,v){return Yo(),u.flags|=256,Jn(o,u,f,v),u.child}var lt={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function ft(o){return{baseLanes:o,cachePool:Hh()}}function vt(o,u,f){return o=o!==null?o.childLanes&~f:0,u&&(o|=ka),o}function et(o,u,f){var v=u.pendingProps,g=!1,S=(u.flags&128)!==0,I;if((I=S)||(I=o!==null&&o.memoizedState===null?!1:(vr.current&2)!==0),I&&(g=!0,u.flags&=-129),I=(u.flags&32)!==0,u.flags&=-33,o===null){if(Dr){if(g?ga(u):Ln(),Dr){var G=cn,le;if(le=G){e:{for(le=G,G=Dn;le.nodeType!==8;){if(!G){G=null;break e}if(le=Ao(le.nextSibling),le===null){G=null;break e}}G=le}G!==null?(u.memoizedState={dehydrated:G,treeContext:Ci!==null?{id:Qi,overflow:Da}:null,retryLane:536870912,hydrationErrors:null},le=Ri(18,null,null,0),le.stateNode=G,le.return=u,u.child=le,li=u,cn=null,le=!0):le=!1}le||Fs(u)}if(G=u.memoizedState,G!==null&&(G=G.dehydrated,G!==null))return $y(G)?u.lanes=32:u.lanes=536870912,null;ci(u)}return G=v.children,v=v.fallback,g?(Ln(),g=u.mode,G=me({mode:"hidden",children:G},g),v=Ls(v,g,f,null),G.return=u,v.return=u,G.sibling=v,u.child=G,g=u.child,g.memoizedState=ft(f),g.childLanes=vt(o,I,f),u.memoizedState=lt,v):(ga(u),dt(u,G))}if(le=o.memoizedState,le!==null&&(G=le.dehydrated,G!==null)){if(S)u.flags&256?(ga(u),u.flags&=-257,u=we(o,u,f)):u.memoizedState!==null?(Ln(),u.child=o.child,u.flags|=128,u=null):(Ln(),g=v.fallback,G=u.mode,v=me({mode:"visible",children:v.children},G),g=Ls(g,G,f,null),g.flags|=2,v.return=u,g.return=u,v.sibling=g,u.child=v,_a(u,o.child,null,f),v=u.child,v.memoizedState=ft(f),v.childLanes=vt(o,I,f),u.memoizedState=lt,u=g);else if(ga(u),$y(G)){if(I=G.nextSibling&&G.nextSibling.dataset,I)var Ne=I.dgst;I=Ne,v=Error(n(419)),v.stack="",v.digest=I,Fu({value:v,source:null,stack:null}),u=we(o,u,f)}else if(jn||Jl(o,u,f,!1),I=(f&o.childLanes)!==0,jn||I){if(I=ir,I!==null&&(v=f&-f,v=(v&42)!==0?1:kl(v),v=(v&(I.suspendedLanes|f))!==0?0:v,v!==0&&v!==le.retryLane))throw le.retryLane=v,ha(o,v),Ea(I,o,v),t_;G.data==="$?"||Iy(),u=we(o,u,f)}else G.data==="$?"?(u.flags|=192,u.child=o.child,u=null):(o=le.treeContext,cn=Ao(G.nextSibling),li=u,Dr=!0,Wo=null,Dn=!1,o!==null&&(mi[Ki++]=Qi,mi[Ki++]=Da,mi[Ki++]=Ci,Qi=o.id,Da=o.overflow,Ci=u),u=dt(u,v.children),u.flags|=4096);return u}return g?(Ln(),g=v.fallback,G=u.mode,le=o.child,Ne=le.sibling,v=ho(le,{mode:"hidden",children:v.children}),v.subtreeFlags=le.subtreeFlags&65011712,Ne!==null?g=ho(Ne,g):(g=Ls(g,G,f,null),g.flags|=2),g.return=u,v.return=u,v.sibling=g,u.child=v,v=g,g=u.child,G=o.child.memoizedState,G===null?G=ft(f):(le=G.cachePool,le!==null?(Ne=zn._currentValue,le=le.parent!==Ne?{parent:Ne,pool:Ne}:le):le=Hh(),G={baseLanes:G.baseLanes|f,cachePool:le}),g.memoizedState=G,g.childLanes=vt(o,I,f),u.memoizedState=lt,v):(ga(u),f=o.child,o=f.sibling,f=ho(f,{mode:"visible",children:v.children}),f.return=u,f.sibling=null,o!==null&&(I=u.deletions,I===null?(u.deletions=[o],u.flags|=16):I.push(o)),u.child=f,u.memoizedState=null,f)}function dt(o,u){return u=me({mode:"visible",children:u},o.mode),u.return=o,o.child=u}function me(o,u){return o=Ri(22,o,null,u),o.lanes=0,o.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},o}function we(o,u,f){return _a(u,o.child,null,f),o=dt(u,u.pendingProps.children),o.flags|=2,u.memoizedState=null,o}function ot(o,u,f){o.lanes|=u;var v=o.alternate;v!==null&&(v.lanes|=u),Bh(o.return,u,f)}function Et(o,u,f,v,g){var S=o.memoizedState;S===null?o.memoizedState={isBackwards:u,rendering:null,renderingStartTime:0,last:v,tail:f,tailMode:g}:(S.isBackwards=u,S.rendering=null,S.renderingStartTime=0,S.last=v,S.tail=f,S.tailMode=g)}function $e(o,u,f){var v=u.pendingProps,g=v.revealOrder,S=v.tail;if(Jn(o,u,v.children,f),v=vr.current,(v&2)!==0)v=v&1|2,u.flags|=128;else{if(o!==null&&(o.flags&128)!==0)e:for(o=u.child;o!==null;){if(o.tag===13)o.memoizedState!==null&&ot(o,f,u);else if(o.tag===19)ot(o,f,u);else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===u)break e;for(;o.sibling===null;){if(o.return===null||o.return===u)break e;o=o.return}o.sibling.return=o.return,o=o.sibling}v&=1}switch(Ie(vr,v),g){case"forwards":for(f=u.child,g=null;f!==null;)o=f.alternate,o!==null&&Qn(o)===null&&(g=f),f=f.sibling;f=g,f===null?(g=u.child,u.child=null):(g=f.sibling,f.sibling=null),Et(u,!1,g,f,S);break;case"backwards":for(f=null,g=u.child,u.child=null;g!==null;){if(o=g.alternate,o!==null&&Qn(o)===null){u.child=g;break}o=g.sibling,g.sibling=f,f=g,g=o}Et(u,!0,f,null,S);break;case"together":Et(u,!1,null,null,void 0);break;default:u.memoizedState=null}return u.child}function Tt(o,u,f){if(o!==null&&(u.dependencies=o.dependencies),Ju|=u.lanes,(f&u.childLanes)===0)if(o!==null){if(Jl(o,u,f,!1),(f&u.childLanes)===0)return null}else return null;if(o!==null&&u.child!==o.child)throw Error(n(153));if(u.child!==null){for(o=u.child,f=ho(o,o.pendingProps),u.child=f,f.return=u;o.sibling!==null;)o=o.sibling,f=f.sibling=ho(o,o.pendingProps),f.return=u;f.sibling=null}return u.child}function st(o,u){return(o.lanes&u)!==0?!0:(o=o.dependencies,!!(o!==null&&Mf(o)))}function St(o,u,f){switch(u.tag){case 3:yt(u,u.stateNode.containerInfo),Zo(u,zn,o.memoizedState.cache),Yo();break;case 27:case 5:ge(u);break;case 4:yt(u,u.stateNode.containerInfo);break;case 10:Zo(u,u.type,u.memoizedProps.value);break;case 13:var v=u.memoizedState;if(v!==null)return v.dehydrated!==null?(ga(u),u.flags|=128,null):(f&u.child.childLanes)!==0?et(o,u,f):(ga(u),o=Tt(o,u,f),o!==null?o.sibling:null);ga(u);break;case 19:var g=(o.flags&128)!==0;if(v=(f&u.childLanes)!==0,v||(Jl(o,u,f,!1),v=(f&u.childLanes)!==0),g){if(v)return $e(o,u,f);u.flags|=128}if(g=u.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),Ie(vr,vr.current),v)break;return null;case 22:case 23:return u.lanes=0,be(o,u,f);case 24:Zo(u,zn,o.memoizedState.cache)}return Tt(o,u,f)}function Ke(o,u,f){if(o!==null)if(o.memoizedProps!==u.pendingProps)jn=!0;else{if(!st(o,f)&&(u.flags&128)===0)return jn=!1,St(o,u,f);jn=(o.flags&131072)!==0}else jn=!1,Dr&&(u.flags&1048576)!==0&&Dh(u,Af,u.index);switch(u.lanes=0,u.tag){case 16:e:{o=u.pendingProps;var v=u.elementType,g=v._init;if(v=g(v._payload),u.type=v,typeof v=="function")Ef(v)?(o=Ys(v,o),u.tag=1,u=ut(null,u,v,o,f)):(u.tag=0,u=De(null,u,v,o,f));else{if(v!=null){if(g=v.$$typeof,g===M){u.tag=11,u=C(null,u,v,o,f);break e}else if(g===D){u.tag=14,u=W(null,u,v,o,f);break e}}throw u=H(v)||v,Error(n(306,u,""))}}return u;case 0:return De(o,u,u.type,u.pendingProps,f);case 1:return v=u.type,g=Ys(v,u.pendingProps),ut(o,u,v,g,f);case 3:e:{if(yt(u,u.stateNode.containerInfo),o===null)throw Error(n(387));v=u.pendingProps;var S=u.memoizedState;g=S.element,Ko(o,u),zu(u,v,null,f);var I=u.memoizedState;if(v=I.cache,Zo(u,zn,v),v!==S.cache&&Fh(u,[zn],f,!0),js(),v=I.element,S.isDehydrated)if(S={element:v,isDehydrated:!1,cache:I.cache},u.updateQueue.baseState=S,u.memoizedState=S,u.flags&256){u=mt(o,u,v,f);break e}else if(v!==g){g=Fi(Error(n(424)),u),Fu(g),u=mt(o,u,v,f);break e}else{switch(o=u.stateNode.containerInfo,o.nodeType){case 9:o=o.body;break;default:o=o.nodeName==="HTML"?o.ownerDocument.body:o}for(cn=Ao(o.firstChild),li=u,Dr=!0,Wo=null,Dn=!0,f=So(u,null,v,f),u.child=f;f;)f.flags=f.flags&-3|4096,f=f.sibling}else{if(Yo(),v===g){u=Tt(o,u,f);break e}Jn(o,u,v,f)}u=u.child}return u;case 26:return Re(o,u),o===null?(f=q2(u.type,null,u.pendingProps,null))?u.memoizedState=f:Dr||(f=u.type,o=u.pendingProps,v=d_(Ct.current).createElement(f),v[On]=u,v[oi]=o,gi(v,f,o),Zr(v),u.stateNode=v):u.memoizedState=q2(u.type,o.memoizedProps,u.pendingProps,o.memoizedState),null;case 27:return ge(u),o===null&&Dr&&(v=u.stateNode=V2(u.type,u.pendingProps,Ct.current),li=u,Dn=!0,g=cn,nl(u.type)?(Zy=g,cn=Ao(v.firstChild)):cn=g),Jn(o,u,u.pendingProps.children,f),Re(o,u),o===null&&(u.flags|=4194304),u.child;case 5:return o===null&&Dr&&((g=v=cn)&&(v=R7(v,u.type,u.pendingProps,Dn),v!==null?(u.stateNode=v,li=u,cn=Ao(v.firstChild),Dn=!1,g=!0):g=!1),g||Fs(u)),ge(u),g=u.type,S=u.pendingProps,I=o!==null?o.memoizedProps:null,v=S.children,qy(g,S)?v=null:I!==null&&qy(g,I)&&(u.flags|=32),u.memoizedState!==null&&(g=Bf(o,u,Pm,null,null,f),pp._currentValue=g),Re(o,u),Jn(o,u,v,f),u.child;case 6:return o===null&&Dr&&((o=f=cn)&&(f=C7(f,u.pendingProps,Dn),f!==null?(u.stateNode=f,li=u,cn=null,o=!0):o=!1),o||Fs(u)),null;case 13:return et(o,u,f);case 4:return yt(u,u.stateNode.containerInfo),v=u.pendingProps,o===null?u.child=_a(u,null,v,f):Jn(o,u,v,f),u.child;case 11:return C(o,u,u.type,u.pendingProps,f);case 7:return Jn(o,u,u.pendingProps,f),u.child;case 8:return Jn(o,u,u.pendingProps.children,f),u.child;case 12:return Jn(o,u,u.pendingProps.children,f),u.child;case 10:return v=u.pendingProps,Zo(u,u.type,v.value),Jn(o,u,v.children,f),u.child;case 9:return g=u.type._context,v=u.pendingProps.children,Us(u),g=Kn(g),v=v(g),u.flags|=1,Jn(o,u,v,f),u.child;case 14:return W(o,u,u.type,u.pendingProps,f);case 15:return ne(o,u,u.type,u.pendingProps,f);case 19:return $e(o,u,f);case 31:return v=u.pendingProps,f=u.mode,v={mode:v.mode,children:v.children},o===null?(f=me(v,f),f.ref=u.ref,u.child=f,f.return=u,u=f):(f=ho(o.child,v),f.ref=u.ref,u.child=f,f.return=u,u=f),u;case 22:return be(o,u,f);case 24:return Us(u),v=Kn(zn),o===null?(g=jh(),g===null&&(g=ir,S=kh(),g.pooledCache=S,S.refCount++,S!==null&&(g.pooledCacheLanes|=f),g=S),u.memoizedState={parent:v,cache:g},Xh(u),Zo(u,zn,g)):((o.lanes&f)!==0&&(Ko(o,u),zu(u,null,null,f),js()),g=o.memoizedState,S=u.memoizedState,g.parent!==v?(g={parent:v,cache:v},u.memoizedState=g,u.lanes===0&&(u.memoizedState=u.updateQueue.baseState=g),Zo(u,zn,v)):(v=S.cache,Zo(u,zn,v),v!==g.cache&&Fh(u,[zn],f,!0))),Jn(o,u,u.pendingProps.children,f),u.child;case 29:throw u.pendingProps}throw Error(n(156,u.tag))}function ht(o){o.flags|=4}function Lt(o,u){if(u.type!=="stylesheet"||(u.state.loading&4)!==0)o.flags&=-16777217;else if(o.flags|=16777216,!K2(u)){if(u=Hi.current,u!==null&&((xr&4194048)===xr?ea!==null:(xr&62914560)!==xr&&(xr&536870912)===0||u!==ea))throw ic=Vh,Mm;o.flags|=8192}}function Gt(o,u){u!==null&&(o.flags|=4),o.flags&16384&&(u=o.tag!==22?Jc():536870912,o.lanes|=u,Jf|=u)}function gt(o,u){if(!Dr)switch(o.tailMode){case"hidden":u=o.tail;for(var f=null;u!==null;)u.alternate!==null&&(f=u),u=u.sibling;f===null?o.tail=null:f.sibling=null;break;case"collapsed":f=o.tail;for(var v=null;f!==null;)f.alternate!==null&&(v=f),f=f.sibling;v===null?u||o.tail===null?o.tail=null:o.tail.sibling=null:v.sibling=null}}function He(o){var u=o.alternate!==null&&o.alternate.child===o.child,f=0,v=0;if(u)for(var g=o.child;g!==null;)f|=g.lanes|g.childLanes,v|=g.subtreeFlags&65011712,v|=g.flags&65011712,g.return=o,g=g.sibling;else for(g=o.child;g!==null;)f|=g.lanes|g.childLanes,v|=g.subtreeFlags,v|=g.flags,g.return=o,g=g.sibling;return o.subtreeFlags|=v,o.childLanes=f,u}function qe(o,u,f){var v=u.pendingProps;switch(xf(u),u.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return He(u),null;case 1:return He(u),null;case 3:return f=u.stateNode,v=null,o!==null&&(v=o.memoizedState.cache),u.memoizedState.cache!==v&&(u.flags|=2048),po(zn),Ue(),f.pendingContext&&(f.context=f.pendingContext,f.pendingContext=null),(o===null||o.child===null)&&(pa(u)?ht(u):o===null||o.memoizedState.isDehydrated&&(u.flags&256)===0||(u.flags|=1024,Lh())),He(u),null;case 26:return f=u.memoizedState,o===null?(ht(u),f!==null?(He(u),Lt(u,f)):(He(u),u.flags&=-16777217)):f?f!==o.memoizedState?(ht(u),He(u),Lt(u,f)):(He(u),u.flags&=-16777217):(o.memoizedProps!==v&&ht(u),He(u),u.flags&=-16777217),null;case 27:nt(u),f=Ct.current;var g=u.type;if(o!==null&&u.stateNode!=null)o.memoizedProps!==v&&ht(u);else{if(!v){if(u.stateNode===null)throw Error(n(166));return He(u),null}o=Je.current,pa(u)?La(u):(o=V2(g,v,f),u.stateNode=o,ht(u))}return He(u),null;case 5:if(nt(u),f=u.type,o!==null&&u.stateNode!=null)o.memoizedProps!==v&&ht(u);else{if(!v){if(u.stateNode===null)throw Error(n(166));return He(u),null}if(o=Je.current,pa(u))La(u);else{switch(g=d_(Ct.current),o){case 1:o=g.createElementNS("http://www.w3.org/2000/svg",f);break;case 2:o=g.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;default:switch(f){case"svg":o=g.createElementNS("http://www.w3.org/2000/svg",f);break;case"math":o=g.createElementNS("http://www.w3.org/1998/Math/MathML",f);break;case"script":o=g.createElement("div"),o.innerHTML="<script><\/script>",o=o.removeChild(o.firstChild);break;case"select":o=typeof v.is=="string"?g.createElement("select",{is:v.is}):g.createElement("select"),v.multiple?o.multiple=!0:v.size&&(o.size=v.size);break;default:o=typeof v.is=="string"?g.createElement(f,{is:v.is}):g.createElement(f)}}o[On]=u,o[oi]=v;e:for(g=u.child;g!==null;){if(g.tag===5||g.tag===6)o.appendChild(g.stateNode);else if(g.tag!==4&&g.tag!==27&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===u)break e;for(;g.sibling===null;){if(g.return===null||g.return===u)break e;g=g.return}g.sibling.return=g.return,g=g.sibling}u.stateNode=o;e:switch(gi(o,f,v),f){case"button":case"input":case"select":case"textarea":o=!!v.autoFocus;break e;case"img":o=!0;break e;default:o=!1}o&&ht(u)}}return He(u),u.flags&=-16777217,null;case 6:if(o&&u.stateNode!=null)o.memoizedProps!==v&&ht(u);else{if(typeof v!="string"&&u.stateNode===null)throw Error(n(166));if(o=Ct.current,pa(u)){if(o=u.stateNode,f=u.memoizedProps,v=null,g=li,g!==null)switch(g.tag){case 27:case 5:v=g.memoizedProps}o[On]=u,o=!!(o.nodeValue===f||v!==null&&v.suppressHydrationWarning===!0||B2(o.nodeValue,f)),o||Fs(u)}else o=d_(o).createTextNode(v),o[On]=u,u.stateNode=o}return He(u),null;case 13:if(v=u.memoizedState,o===null||o.memoizedState!==null&&o.memoizedState.dehydrated!==null){if(g=pa(u),v!==null&&v.dehydrated!==null){if(o===null){if(!g)throw Error(n(318));if(g=u.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(n(317));g[On]=u}else Yo(),(u.flags&128)===0&&(u.memoizedState=null),u.flags|=4;He(u),g=!1}else g=Lh(),o!==null&&o.memoizedState!==null&&(o.memoizedState.hydrationErrors=g),g=!0;if(!g)return u.flags&256?(ci(u),u):(ci(u),null)}if(ci(u),(u.flags&128)!==0)return u.lanes=f,u;if(f=v!==null,o=o!==null&&o.memoizedState!==null,f){v=u.child,g=null,v.alternate!==null&&v.alternate.memoizedState!==null&&v.alternate.memoizedState.cachePool!==null&&(g=v.alternate.memoizedState.cachePool.pool);var S=null;v.memoizedState!==null&&v.memoizedState.cachePool!==null&&(S=v.memoizedState.cachePool.pool),S!==g&&(v.flags|=2048)}return f!==o&&f&&(u.child.flags|=8192),Gt(u,u.updateQueue),He(u),null;case 4:return Ue(),o===null&&jy(u.stateNode.containerInfo),He(u),null;case 10:return po(u.type),He(u),null;case 19:if(ye(vr),g=u.memoizedState,g===null)return He(u),null;if(v=(u.flags&128)!==0,S=g.rendering,S===null)if(v)gt(g,!1);else{if(Bn!==0||o!==null&&(o.flags&128)!==0)for(o=u.child;o!==null;){if(S=Qn(o),S!==null){for(u.flags|=128,gt(g,!1),o=S.updateQueue,u.updateQueue=o,Gt(u,o),u.subtreeFlags=0,o=f,f=u.child;f!==null;)xm(f,o),f=f.sibling;return Ie(vr,vr.current&1|2),u.child}o=o.sibling}g.tail!==null&&xt()>r_&&(u.flags|=128,v=!0,gt(g,!1),u.lanes=4194304)}else{if(!v)if(o=Qn(S),o!==null){if(u.flags|=128,v=!0,o=o.updateQueue,u.updateQueue=o,Gt(u,o),gt(g,!0),g.tail===null&&g.tailMode==="hidden"&&!S.alternate&&!Dr)return He(u),null}else 2*xt()-g.renderingStartTime>r_&&f!==536870912&&(u.flags|=128,v=!0,gt(g,!1),u.lanes=4194304);g.isBackwards?(S.sibling=u.child,u.child=S):(o=g.last,o!==null?o.sibling=S:u.child=S,g.last=S)}return g.tail!==null?(u=g.tail,g.rendering=u,g.tail=u.sibling,g.renderingStartTime=xt(),u.sibling=null,o=vr.current,Ie(vr,v?o&1|2:o&1),u):(He(u),null);case 22:case 23:return ci(u),Lf(),v=u.memoizedState!==null,o!==null?o.memoizedState!==null!==v&&(u.flags|=8192):v&&(u.flags|=8192),v?(f&536870912)!==0&&(u.flags&128)===0&&(He(u),u.subtreeFlags&6&&(u.flags|=8192)):He(u),f=u.updateQueue,f!==null&&Gt(u,f.retryQueue),f=null,o!==null&&o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(f=o.memoizedState.cachePool.pool),v=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(v=u.memoizedState.cachePool.pool),v!==f&&(u.flags|=2048),o!==null&&ye(Ji),null;case 24:return f=null,o!==null&&(f=o.memoizedState.cache),u.memoizedState.cache!==f&&(u.flags|=2048),po(zn),He(u),null;case 25:return null;case 30:return null}throw Error(n(156,u.tag))}function Wt(o,u){switch(xf(u),u.tag){case 1:return o=u.flags,o&65536?(u.flags=o&-65537|128,u):null;case 3:return po(zn),Ue(),o=u.flags,(o&65536)!==0&&(o&128)===0?(u.flags=o&-65537|128,u):null;case 26:case 27:case 5:return nt(u),null;case 13:if(ci(u),o=u.memoizedState,o!==null&&o.dehydrated!==null){if(u.alternate===null)throw Error(n(340));Yo()}return o=u.flags,o&65536?(u.flags=o&-65537|128,u):null;case 19:return ye(vr),null;case 4:return Ue(),null;case 10:return po(u.type),null;case 22:case 23:return ci(u),Lf(),o!==null&&ye(Ji),o=u.flags,o&65536?(u.flags=o&-65537|128,u):null;case 24:return po(zn),null;case 25:return null;default:return null}}function lr(o,u){switch(xf(u),u.tag){case 3:po(zn),Ue();break;case 26:case 27:case 5:nt(u);break;case 4:Ue();break;case 13:ci(u);break;case 19:ye(vr);break;case 10:po(u.type);break;case 22:case 23:ci(u),Lf(),o!==null&&ye(Ji);break;case 24:po(zn)}}function Mt(o,u){try{var f=u.updateQueue,v=f!==null?f.lastEffect:null;if(v!==null){var g=v.next;f=g;do{if((f.tag&o)===o){v=void 0;var S=f.create,I=f.inst;v=S(),I.destroy=v}f=f.next}while(f!==g)}}catch(G){rn(u,u.return,G)}}function Zt(o,u,f){try{var v=u.updateQueue,g=v!==null?v.lastEffect:null;if(g!==null){var S=g.next;v=S;do{if((v.tag&o)===o){var I=v.inst,G=I.destroy;if(G!==void 0){I.destroy=void 0,g=u;var le=f,Ne=G;try{Ne()}catch(tt){rn(g,le,tt)}}}v=v.next}while(v!==S)}}catch(tt){rn(u,u.return,tt)}}function Yt(o){var u=o.updateQueue;if(u!==null){var f=o.stateNode;try{qh(u,f)}catch(v){rn(o,o.return,v)}}}function er(o,u,f){f.props=Ys(o.type,o.memoizedProps),f.state=o.memoizedState;try{f.componentWillUnmount()}catch(v){rn(o,u,v)}}function cr(o,u){try{var f=o.ref;if(f!==null){switch(o.tag){case 26:case 27:case 5:var v=o.stateNode;break;case 30:v=o.stateNode;break;default:v=o.stateNode}typeof f=="function"?o.refCleanup=f(v):f.current=v}}catch(g){rn(o,u,g)}}function Br(o,u){var f=o.ref,v=o.refCleanup;if(f!==null)if(typeof v=="function")try{v()}catch(g){rn(o,u,g)}finally{o.refCleanup=null,o=o.alternate,o!=null&&(o.refCleanup=null)}else if(typeof f=="function")try{f(null)}catch(g){rn(o,u,g)}else f.current=null}function In(o){var u=o.type,f=o.memoizedProps,v=o.stateNode;try{e:switch(u){case"button":case"input":case"select":case"textarea":f.autoFocus&&v.focus();break e;case"img":f.src?v.src=f.src:f.srcSet&&(v.srcset=f.srcSet)}}catch(g){rn(o,o.return,g)}}function or(o,u,f){try{var v=o.stateNode;T7(v,o.type,f,u),v[oi]=u}catch(g){rn(o,o.return,g)}}function bn(o){return o.tag===5||o.tag===3||o.tag===26||o.tag===27&&nl(o.type)||o.tag===4}function Fr(o){e:for(;;){for(;o.sibling===null;){if(o.return===null||bn(o.return))return null;o=o.return}for(o.sibling.return=o.return,o=o.sibling;o.tag!==5&&o.tag!==6&&o.tag!==18;){if(o.tag===27&&nl(o.type)||o.flags&2||o.child===null||o.tag===4)continue e;o.child.return=o,o=o.child}if(!(o.flags&2))return o.stateNode}}function on(o,u,f){var v=o.tag;if(v===5||v===6)o=o.stateNode,u?(f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f).insertBefore(o,u):(u=f.nodeType===9?f.body:f.nodeName==="HTML"?f.ownerDocument.body:f,u.appendChild(o),f=f._reactRootContainer,f!=null||u.onclick!==null||(u.onclick=f_));else if(v!==4&&(v===27&&nl(o.type)&&(f=o.stateNode,u=null),o=o.child,o!==null))for(on(o,u,f),o=o.sibling;o!==null;)on(o,u,f),o=o.sibling}function sn(o,u,f){var v=o.tag;if(v===5||v===6)o=o.stateNode,u?f.insertBefore(o,u):f.appendChild(o);else if(v!==4&&(v===27&&nl(o.type)&&(f=o.stateNode),o=o.child,o!==null))for(sn(o,u,f),o=o.sibling;o!==null;)sn(o,u,f),o=o.sibling}function xn(o){var u=o.stateNode,f=o.memoizedProps;try{for(var v=o.type,g=u.attributes;g.length;)u.removeAttributeNode(g[0]);gi(u,v,f),u[On]=o,u[oi]=f}catch(S){rn(o,o.return,S)}}var Yr=!1,Sr=!1,fn=!1,Jt=typeof WeakSet=="function"?WeakSet:Set,Mr=null;function Ar(o,u){if(o=o.containerInfo,Xy=g_,o=gm(o),wh(o)){if("selectionStart"in o)var f={start:o.selectionStart,end:o.selectionEnd};else e:{f=(f=o.ownerDocument)&&f.defaultView||window;var v=f.getSelection&&f.getSelection();if(v&&v.rangeCount!==0){f=v.anchorNode;var g=v.anchorOffset,S=v.focusNode;v=v.focusOffset;try{f.nodeType,S.nodeType}catch{f=null;break e}var I=0,G=-1,le=-1,Ne=0,tt=0,ct=o,Be=null;t:for(;;){for(var ke;ct!==f||g!==0&&ct.nodeType!==3||(G=I+g),ct!==S||v!==0&&ct.nodeType!==3||(le=I+v),ct.nodeType===3&&(I+=ct.nodeValue.length),(ke=ct.firstChild)!==null;)Be=ct,ct=ke;for(;;){if(ct===o)break t;if(Be===f&&++Ne===g&&(G=I),Be===S&&++tt===v&&(le=I),(ke=ct.nextSibling)!==null)break;ct=Be,Be=ct.parentNode}ct=ke}f=G===-1||le===-1?null:{start:G,end:le}}else f=null}f=f||{start:0,end:0}}else f=null;for(Gy={focusedElem:o,selectionRange:f},g_=!1,Mr=u;Mr!==null;)if(u=Mr,o=u.child,(u.subtreeFlags&1024)!==0&&o!==null)o.return=u,Mr=o;else for(;Mr!==null;){switch(u=Mr,S=u.alternate,o=u.flags,u.tag){case 0:break;case 11:case 15:break;case 1:if((o&1024)!==0&&S!==null){o=void 0,f=u,g=S.memoizedProps,S=S.memoizedState,v=f.stateNode;try{var ur=Ys(f.type,g,f.elementType===f.type);o=v.getSnapshotBeforeUpdate(ur,S),v.__reactInternalSnapshotBeforeUpdate=o}catch(tr){rn(f,f.return,tr)}}break;case 3:if((o&1024)!==0){if(o=u.stateNode.containerInfo,f=o.nodeType,f===9)Yy(o);else if(f===1)switch(o.nodeName){case"HEAD":case"HTML":case"BODY":Yy(o);break;default:o.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((o&1024)!==0)throw Error(n(163))}if(o=u.sibling,o!==null){o.return=u.return,Mr=o;break}Mr=u.return}}function Ut(o,u,f){var v=f.flags;switch(f.tag){case 0:case 11:case 15:Ee(o,f),v&4&&Mt(5,f);break;case 1:if(Ee(o,f),v&4)if(o=f.stateNode,u===null)try{o.componentDidMount()}catch(I){rn(f,f.return,I)}else{var g=Ys(f.type,u.memoizedProps);u=u.memoizedState;try{o.componentDidUpdate(g,u,o.__reactInternalSnapshotBeforeUpdate)}catch(I){rn(f,f.return,I)}}v&64&&Yt(f),v&512&&cr(f,f.return);break;case 3:if(Ee(o,f),v&64&&(o=f.updateQueue,o!==null)){if(u=null,f.child!==null)switch(f.child.tag){case 27:case 5:u=f.child.stateNode;break;case 1:u=f.child.stateNode}try{qh(o,u)}catch(I){rn(f,f.return,I)}}break;case 27:u===null&&v&4&&xn(f);case 26:case 5:Ee(o,f),u===null&&v&4&&In(f),v&512&&cr(f,f.return);break;case 12:Ee(o,f);break;case 13:Ee(o,f),v&4&&Oe(o,f),v&64&&(o=f.memoizedState,o!==null&&(o=o.dehydrated,o!==null&&(f=c7.bind(null,f),O7(o,f))));break;case 22:if(v=f.memoizedState!==null||Yr,!v){u=u!==null&&u.memoizedState!==null||Sr,g=Yr;var S=Sr;Yr=v,(Sr=u)&&!S?ie(o,f,(f.subtreeFlags&8772)!==0):Ee(o,f),Yr=g,Sr=S}break;case 30:break;default:Ee(o,f)}}function sr(o){var u=o.alternate;u!==null&&(o.alternate=null,sr(u)),o.child=null,o.deletions=null,o.sibling=null,o.tag===5&&(u=o.stateNode,u!==null&&pu(u)),o.stateNode=null,o.return=null,o.dependencies=null,o.memoizedProps=null,o.memoizedState=null,o.pendingProps=null,o.stateNode=null,o.updateQueue=null}var kt=null,br=!1;function Xn(o,u,f){for(f=f.child;f!==null;)J(o,u,f),f=f.sibling}function J(o,u,f){if(un&&typeof un.onCommitFiberUnmount=="function")try{un.onCommitFiberUnmount(Hn,f)}catch{}switch(f.tag){case 26:Sr||Br(f,u),Xn(o,u,f),f.memoizedState?f.memoizedState.count--:f.stateNode&&(f=f.stateNode,f.parentNode.removeChild(f));break;case 27:Sr||Br(f,u);var v=kt,g=br;nl(f.type)&&(kt=f.stateNode,br=!1),Xn(o,u,f),cp(f.stateNode),kt=v,br=g;break;case 5:Sr||Br(f,u);case 6:if(v=kt,g=br,kt=null,Xn(o,u,f),kt=v,br=g,kt!==null)if(br)try{(kt.nodeType===9?kt.body:kt.nodeName==="HTML"?kt.ownerDocument.body:kt).removeChild(f.stateNode)}catch(S){rn(f,u,S)}else try{kt.removeChild(f.stateNode)}catch(S){rn(f,u,S)}break;case 18:kt!==null&&(br?(o=kt,j2(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,f.stateNode),gp(o)):j2(kt,f.stateNode));break;case 4:v=kt,g=br,kt=f.stateNode.containerInfo,br=!0,Xn(o,u,f),kt=v,br=g;break;case 0:case 11:case 14:case 15:Sr||Zt(2,f,u),Sr||Zt(4,f,u),Xn(o,u,f);break;case 1:Sr||(Br(f,u),v=f.stateNode,typeof v.componentWillUnmount=="function"&&er(f,u,v)),Xn(o,u,f);break;case 21:Xn(o,u,f);break;case 22:Sr=(v=Sr)||f.memoizedState!==null,Xn(o,u,f),Sr=v;break;default:Xn(o,u,f)}}function Oe(o,u){if(u.memoizedState===null&&(o=u.alternate,o!==null&&(o=o.memoizedState,o!==null&&(o=o.dehydrated,o!==null))))try{gp(o)}catch(f){rn(u,u.return,f)}}function Ae(o){switch(o.tag){case 13:case 19:var u=o.stateNode;return u===null&&(u=o.stateNode=new Jt),u;case 22:return o=o.stateNode,u=o._retryCache,u===null&&(u=o._retryCache=new Jt),u;default:throw Error(n(435,o.tag))}}function bt(o,u){var f=Ae(o);u.forEach(function(v){var g=f7.bind(null,o,v);f.has(v)||(f.add(v),v.then(g,g))})}function qt(o,u){var f=u.deletions;if(f!==null)for(var v=0;v<f.length;v++){var g=f[v],S=o,I=u,G=I;e:for(;G!==null;){switch(G.tag){case 27:if(nl(G.type)){kt=G.stateNode,br=!1;break e}break;case 5:kt=G.stateNode,br=!1;break e;case 3:case 4:kt=G.stateNode.containerInfo,br=!0;break e}G=G.return}if(kt===null)throw Error(n(160));J(S,I,g),kt=null,br=!1,S=g.alternate,S!==null&&(S.return=null),g.return=null}if(u.subtreeFlags&13878)for(u=u.child;u!==null;)k(u,o),u=u.sibling}var mr=null;function k(o,u){var f=o.alternate,v=o.flags;switch(o.tag){case 0:case 11:case 14:case 15:qt(u,o),Y(o),v&4&&(Zt(3,o,o.return),Mt(3,o),Zt(5,o,o.return));break;case 1:qt(u,o),Y(o),v&512&&(Sr||f===null||Br(f,f.return)),v&64&&Yr&&(o=o.updateQueue,o!==null&&(v=o.callbacks,v!==null&&(f=o.shared.hiddenCallbacks,o.shared.hiddenCallbacks=f===null?v:f.concat(v))));break;case 26:var g=mr;if(qt(u,o),Y(o),v&512&&(Sr||f===null||Br(f,f.return)),v&4){var S=f!==null?f.memoizedState:null;if(v=o.memoizedState,f===null)if(v===null)if(o.stateNode===null){e:{v=o.type,f=o.memoizedProps,g=g.ownerDocument||g;t:switch(v){case"title":S=g.getElementsByTagName("title")[0],(!S||S[Ss]||S[On]||S.namespaceURI==="http://www.w3.org/2000/svg"||S.hasAttribute("itemprop"))&&(S=g.createElement(v),g.head.insertBefore(S,g.querySelector("head > title"))),gi(S,v,f),S[On]=o,Zr(S),v=S;break e;case"link":var I=$2("link","href",g).get(v+(f.href||""));if(I){for(var G=0;G<I.length;G++)if(S=I[G],S.getAttribute("href")===(f.href==null||f.href===""?null:f.href)&&S.getAttribute("rel")===(f.rel==null?null:f.rel)&&S.getAttribute("title")===(f.title==null?null:f.title)&&S.getAttribute("crossorigin")===(f.crossOrigin==null?null:f.crossOrigin)){I.splice(G,1);break t}}S=g.createElement(v),gi(S,v,f),g.head.appendChild(S);break;case"meta":if(I=$2("meta","content",g).get(v+(f.content||""))){for(G=0;G<I.length;G++)if(S=I[G],S.getAttribute("content")===(f.content==null?null:""+f.content)&&S.getAttribute("name")===(f.name==null?null:f.name)&&S.getAttribute("property")===(f.property==null?null:f.property)&&S.getAttribute("http-equiv")===(f.httpEquiv==null?null:f.httpEquiv)&&S.getAttribute("charset")===(f.charSet==null?null:f.charSet)){I.splice(G,1);break t}}S=g.createElement(v),gi(S,v,f),g.head.appendChild(S);break;default:throw Error(n(468,v))}S[On]=o,Zr(S),v=S}o.stateNode=v}else Z2(g,o.type,o.stateNode);else o.stateNode=Y2(g,v,o.memoizedProps);else S!==v?(S===null?f.stateNode!==null&&(f=f.stateNode,f.parentNode.removeChild(f)):S.count--,v===null?Z2(g,o.type,o.stateNode):Y2(g,v,o.memoizedProps)):v===null&&o.stateNode!==null&&or(o,o.memoizedProps,f.memoizedProps)}break;case 27:qt(u,o),Y(o),v&512&&(Sr||f===null||Br(f,f.return)),f!==null&&v&4&&or(o,o.memoizedProps,f.memoizedProps);break;case 5:if(qt(u,o),Y(o),v&512&&(Sr||f===null||Br(f,f.return)),o.flags&32){g=o.stateNode;try{Z(g,"")}catch(ke){rn(o,o.return,ke)}}v&4&&o.stateNode!=null&&(g=o.memoizedProps,or(o,g,f!==null?f.memoizedProps:g)),v&1024&&(fn=!0);break;case 6:if(qt(u,o),Y(o),v&4){if(o.stateNode===null)throw Error(n(162));v=o.memoizedProps,f=o.stateNode;try{f.nodeValue=v}catch(ke){rn(o,o.return,ke)}}break;case 3:if(v_=null,g=mr,mr=h_(u.containerInfo),qt(u,o),mr=g,Y(o),v&4&&f!==null&&f.memoizedState.isDehydrated)try{gp(u.containerInfo)}catch(ke){rn(o,o.return,ke)}fn&&(fn=!1,te(o));break;case 4:v=mr,mr=h_(o.stateNode.containerInfo),qt(u,o),Y(o),mr=v;break;case 12:qt(u,o),Y(o);break;case 13:qt(u,o),Y(o),o.child.flags&8192&&o.memoizedState!==null!=(f!==null&&f.memoizedState!==null)&&(Cy=xt()),v&4&&(v=o.updateQueue,v!==null&&(o.updateQueue=null,bt(o,v)));break;case 22:g=o.memoizedState!==null;var le=f!==null&&f.memoizedState!==null,Ne=Yr,tt=Sr;if(Yr=Ne||g,Sr=tt||le,qt(u,o),Sr=tt,Yr=Ne,Y(o),v&8192)e:for(u=o.stateNode,u._visibility=g?u._visibility&-2:u._visibility|1,g&&(f===null||le||Yr||Sr||Te(o)),f=null,u=o;;){if(u.tag===5||u.tag===26){if(f===null){le=f=u;try{if(S=le.stateNode,g)I=S.style,typeof I.setProperty=="function"?I.setProperty("display","none","important"):I.display="none";else{G=le.stateNode;var ct=le.memoizedProps.style,Be=ct!=null&&ct.hasOwnProperty("display")?ct.display:null;G.style.display=Be==null||typeof Be=="boolean"?"":(""+Be).trim()}}catch(ke){rn(le,le.return,ke)}}}else if(u.tag===6){if(f===null){le=u;try{le.stateNode.nodeValue=g?"":le.memoizedProps}catch(ke){rn(le,le.return,ke)}}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===o)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===o)break e;for(;u.sibling===null;){if(u.return===null||u.return===o)break e;f===u&&(f=null),u=u.return}f===u&&(f=null),u.sibling.return=u.return,u=u.sibling}v&4&&(v=o.updateQueue,v!==null&&(f=v.retryQueue,f!==null&&(v.retryQueue=null,bt(o,f))));break;case 19:qt(u,o),Y(o),v&4&&(v=o.updateQueue,v!==null&&(o.updateQueue=null,bt(o,v)));break;case 30:break;case 21:break;default:qt(u,o),Y(o)}}function Y(o){var u=o.flags;if(u&2){try{for(var f,v=o.return;v!==null;){if(bn(v)){f=v;break}v=v.return}if(f==null)throw Error(n(160));switch(f.tag){case 27:var g=f.stateNode,S=Fr(o);sn(o,S,g);break;case 5:var I=f.stateNode;f.flags&32&&(Z(I,""),f.flags&=-33);var G=Fr(o);sn(o,G,I);break;case 3:case 4:var le=f.stateNode.containerInfo,Ne=Fr(o);on(o,Ne,le);break;default:throw Error(n(161))}}catch(tt){rn(o,o.return,tt)}o.flags&=-3}u&4096&&(o.flags&=-4097)}function te(o){if(o.subtreeFlags&1024)for(o=o.child;o!==null;){var u=o;te(u),u.tag===5&&u.flags&1024&&u.stateNode.reset(),o=o.sibling}}function Ee(o,u){if(u.subtreeFlags&8772)for(u=u.child;u!==null;)Ut(o,u.alternate,u),u=u.sibling}function Te(o){for(o=o.child;o!==null;){var u=o;switch(u.tag){case 0:case 11:case 14:case 15:Zt(4,u,u.return),Te(u);break;case 1:Br(u,u.return);var f=u.stateNode;typeof f.componentWillUnmount=="function"&&er(u,u.return,f),Te(u);break;case 27:cp(u.stateNode);case 26:case 5:Br(u,u.return),Te(u);break;case 22:u.memoizedState===null&&Te(u);break;case 30:Te(u);break;default:Te(u)}o=o.sibling}}function ie(o,u,f){for(f=f&&(u.subtreeFlags&8772)!==0,u=u.child;u!==null;){var v=u.alternate,g=o,S=u,I=S.flags;switch(S.tag){case 0:case 11:case 15:ie(g,S,f),Mt(4,S);break;case 1:if(ie(g,S,f),v=S,g=v.stateNode,typeof g.componentDidMount=="function")try{g.componentDidMount()}catch(Ne){rn(v,v.return,Ne)}if(v=S,g=v.updateQueue,g!==null){var G=v.stateNode;try{var le=g.shared.hiddenCallbacks;if(le!==null)for(g.shared.hiddenCallbacks=null,g=0;g<le.length;g++)Gh(le[g],G)}catch(Ne){rn(v,v.return,Ne)}}f&&I&64&&Yt(S),cr(S,S.return);break;case 27:xn(S);case 26:case 5:ie(g,S,f),f&&v===null&&I&4&&In(S),cr(S,S.return);break;case 12:ie(g,S,f);break;case 13:ie(g,S,f),f&&I&4&&Oe(g,S);break;case 22:S.memoizedState===null&&ie(g,S,f),cr(S,S.return);break;case 30:break;default:ie(g,S,f)}u=u.sibling}}function ce(o,u){var f=null;o!==null&&o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(f=o.memoizedState.cachePool.pool),o=null,u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(o=u.memoizedState.cachePool.pool),o!==f&&(o!=null&&o.refCount++,f!=null&&tc(f))}function de(o,u){o=null,u.alternate!==null&&(o=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==o&&(u.refCount++,o!=null&&tc(o))}function K(o,u,f,v){if(u.subtreeFlags&10256)for(u=u.child;u!==null;)se(o,u,f,v),u=u.sibling}function se(o,u,f,v){var g=u.flags;switch(u.tag){case 0:case 11:case 15:K(o,u,f,v),g&2048&&Mt(9,u);break;case 1:K(o,u,f,v);break;case 3:K(o,u,f,v),g&2048&&(o=null,u.alternate!==null&&(o=u.alternate.memoizedState.cache),u=u.memoizedState.cache,u!==o&&(u.refCount++,o!=null&&tc(o)));break;case 12:if(g&2048){K(o,u,f,v),o=u.stateNode;try{var S=u.memoizedProps,I=S.id,G=S.onPostCommit;typeof G=="function"&&G(I,u.alternate===null?"mount":"update",o.passiveEffectDuration,-0)}catch(le){rn(u,u.return,le)}}else K(o,u,f,v);break;case 13:K(o,u,f,v);break;case 23:break;case 22:S=u.stateNode,I=u.alternate,u.memoizedState!==null?S._visibility&2?K(o,u,f,v):ue(o,u):S._visibility&2?K(o,u,f,v):(S._visibility|=2,$(o,u,f,v,(u.subtreeFlags&10256)!==0)),g&2048&&ce(I,u);break;case 24:K(o,u,f,v),g&2048&&de(u.alternate,u);break;default:K(o,u,f,v)}}function $(o,u,f,v,g){for(g=g&&(u.subtreeFlags&10256)!==0,u=u.child;u!==null;){var S=o,I=u,G=f,le=v,Ne=I.flags;switch(I.tag){case 0:case 11:case 15:$(S,I,G,le,g),Mt(8,I);break;case 23:break;case 22:var tt=I.stateNode;I.memoizedState!==null?tt._visibility&2?$(S,I,G,le,g):ue(S,I):(tt._visibility|=2,$(S,I,G,le,g)),g&&Ne&2048&&ce(I.alternate,I);break;case 24:$(S,I,G,le,g),g&&Ne&2048&&de(I.alternate,I);break;default:$(S,I,G,le,g)}u=u.sibling}}function ue(o,u){if(u.subtreeFlags&10256)for(u=u.child;u!==null;){var f=o,v=u,g=v.flags;switch(v.tag){case 22:ue(f,v),g&2048&&ce(v.alternate,v);break;case 24:ue(f,v),g&2048&&de(v.alternate,v);break;default:ue(f,v)}u=u.sibling}}var xe=8192;function Pe(o){if(o.subtreeFlags&xe)for(o=o.child;o!==null;)Qe(o),o=o.sibling}function Qe(o){switch(o.tag){case 26:Pe(o),o.flags&xe&&o.memoizedState!==null&&j7(mr,o.memoizedState,o.memoizedProps);break;case 5:Pe(o);break;case 3:case 4:var u=mr;mr=h_(o.stateNode.containerInfo),Pe(o),mr=u;break;case 22:o.memoizedState===null&&(u=o.alternate,u!==null&&u.memoizedState!==null?(u=xe,xe=16777216,Pe(o),xe=u):Pe(o));break;default:Pe(o)}}function Xe(o){var u=o.alternate;if(u!==null&&(o=u.child,o!==null)){u.child=null;do u=o.sibling,o.sibling=null,o=u;while(o!==null)}}function rt(o){var u=o.deletions;if((o.flags&16)!==0){if(u!==null)for(var f=0;f<u.length;f++){var v=u[f];Mr=v,Rt(v,o)}Xe(o)}if(o.subtreeFlags&10256)for(o=o.child;o!==null;)It(o),o=o.sibling}function It(o){switch(o.tag){case 0:case 11:case 15:rt(o),o.flags&2048&&Zt(9,o,o.return);break;case 3:rt(o);break;case 12:rt(o);break;case 22:var u=o.stateNode;o.memoizedState!==null&&u._visibility&2&&(o.return===null||o.return.tag!==13)?(u._visibility&=-3,Kt(o)):rt(o);break;default:rt(o)}}function Kt(o){var u=o.deletions;if((o.flags&16)!==0){if(u!==null)for(var f=0;f<u.length;f++){var v=u[f];Mr=v,Rt(v,o)}Xe(o)}for(o=o.child;o!==null;){switch(u=o,u.tag){case 0:case 11:case 15:Zt(8,u,u.return),Kt(u);break;case 22:f=u.stateNode,f._visibility&2&&(f._visibility&=-3,Kt(u));break;default:Kt(u)}o=o.sibling}}function Rt(o,u){for(;Mr!==null;){var f=Mr;switch(f.tag){case 0:case 11:case 15:Zt(8,f,u);break;case 23:case 22:if(f.memoizedState!==null&&f.memoizedState.cachePool!==null){var v=f.memoizedState.cachePool.pool;v!=null&&v.refCount++}break;case 24:tc(f.memoizedState.cache)}if(v=f.child,v!==null)v.return=f,Mr=v;else e:for(f=o;Mr!==null;){v=Mr;var g=v.sibling,S=v.return;if(sr(v),v===f){Mr=null;break e}if(g!==null){g.return=S,Mr=g;break e}Mr=S}}}var Ht={getCacheForType:function(o){var u=Kn(zn),f=u.data.get(o);return f===void 0&&(f=o(),u.data.set(o,f)),f}},Qt=typeof WeakMap=="function"?WeakMap:Map,Bt=0,ir=null,ar=null,xr=0,_r=0,Oi=null,fi=!1,$s=!1,by=!1,Zs=0,Bn=0,Ju=0,Ac=0,xy=0,ka=0,Jf=0,ap=null,ta=null,Ry=!1,Cy=0,r_=1/0,n_=null,el=null,_i=0,tl=null,ed=null,td=0,Oy=0,My=null,u2=null,op=0,wy=null;function ya(){if((Bt&2)!==0&&xr!==0)return xr&-xr;if(O.T!==null){var o=ks;return o!==0?o:Fy()}return tf()}function l2(){ka===0&&(ka=(xr&536870912)===0||Dr?Qc():536870912);var o=Hi.current;return o!==null&&(o.flags|=32),ka}function Ea(o,u,f){(o===ir&&(_r===2||_r===9)||o.cancelPendingCommit!==null)&&(rd(o,0),rl(o,xr,ka,!1)),ro(o,f),((Bt&2)===0||o!==ir)&&(o===ir&&((Bt&2)===0&&(Ac|=f),Bn===4&&rl(o,xr,ka,!1)),as(o))}function c2(o,u,f){if((Bt&6)!==0)throw Error(n(327));var v=!f&&(u&124)===0&&(u&o.expiredLanes)===0||to(o,u),g=v?s7(o,u):Py(o,u,!0),S=v;do{if(g===0){$s&&!v&&rl(o,u,0,!1);break}else{if(f=o.current.alternate,S&&!a7(f)){g=Py(o,u,!1),S=!1;continue}if(g===2){if(S=u,o.errorRecoveryDisabledLanes&S)var I=0;else I=o.pendingLanes&-536870913,I=I!==0?I:I&536870912?536870912:0;if(I!==0){u=I;e:{var G=o;g=ap;var le=G.current.memoizedState.isDehydrated;if(le&&(rd(G,I).flags|=256),I=Py(G,I,!1),I!==2){if(by&&!le){G.errorRecoveryDisabledLanes|=S,Ac|=S,g=4;break e}S=ta,ta=g,S!==null&&(ta===null?ta=S:ta.push.apply(ta,S))}g=I}if(S=!1,g!==2)continue}}if(g===1){rd(o,0),rl(o,u,0,!0);break}e:{switch(v=o,S=g,S){case 0:case 1:throw Error(n(345));case 4:if((u&4194048)!==u)break;case 6:rl(v,u,ka,!fi);break e;case 2:ta=null;break;case 3:case 5:break;default:throw Error(n(329))}if((u&62914560)===u&&(g=Cy+300-xt(),10<g)){if(rl(v,u,ka,!fi),Ma(v,0,!0)!==0)break e;v.timeoutHandle=k2(f2.bind(null,v,f,ta,n_,Ry,u,ka,Ac,Jf,fi,S,2,-0,0),g);break e}f2(v,f,ta,n_,Ry,u,ka,Ac,Jf,fi,S,0,-0,0)}}break}while(!0);as(o)}function f2(o,u,f,v,g,S,I,G,le,Ne,tt,ct,Be,ke){if(o.timeoutHandle=-1,ct=u.subtreeFlags,(ct&8192||(ct&16785408)===16785408)&&(hp={stylesheets:null,count:0,unsuspend:z7},Qe(u),ct=H7(),ct!==null)){o.cancelPendingCommit=ct(g2.bind(null,o,u,S,f,v,g,I,G,le,tt,1,Be,ke)),rl(o,S,I,!Ne);return}g2(o,u,S,f,v,g,I,G,le)}function a7(o){for(var u=o;;){var f=u.tag;if((f===0||f===11||f===15)&&u.flags&16384&&(f=u.updateQueue,f!==null&&(f=f.stores,f!==null)))for(var v=0;v<f.length;v++){var g=f[v],S=g.getSnapshot;g=g.value;try{if(!Zn(S(),g))return!1}catch{return!1}}if(f=u.child,u.subtreeFlags&16384&&f!==null)f.return=u,u=f;else{if(u===o)break;for(;u.sibling===null;){if(u.return===null||u.return===o)return!0;u=u.return}u.sibling.return=u.return,u=u.sibling}}return!0}function rl(o,u,f,v){u&=~xy,u&=~Ac,o.suspendedLanes|=u,o.pingedLanes&=~u,v&&(o.warmLanes|=u),v=o.expirationTimes;for(var g=u;0<g;){var S=31-yr(g),I=1<<S;v[S]=-1,g&=~I}f!==0&&ef(o,f,u)}function i_(){return(Bt&6)===0?(sp(0),!1):!0}function Ny(){if(ar!==null){if(_r===0)var o=ar.return;else o=ar,Ba=$o=null,lc(o),Ws=null,Ku=0,o=ar;for(;o!==null;)lr(o.alternate,o),o=o.return;ar=null}}function rd(o,u){var f=o.timeoutHandle;f!==-1&&(o.timeoutHandle=-1,A7(f)),f=o.cancelPendingCommit,f!==null&&(o.cancelPendingCommit=null,f()),Ny(),ir=o,ar=f=ho(o.current,null),xr=u,_r=0,Oi=null,fi=!1,$s=to(o,u),by=!1,Jf=ka=xy=Ac=Ju=Bn=0,ta=ap=null,Ry=!1,(u&8)!==0&&(u|=u&32);var v=o.entangledLanes;if(v!==0)for(o=o.entanglements,v&=u;0<v;){var g=31-yr(v),S=1<<g;u|=o[g],v&=~S}return Zs=u,Yl(),f}function d2(o,u){hr=null,O.H=Wf,u===zs||u===nc?(u=ku(),_r=3):u===Mm?(u=ku(),_r=4):_r=u===t_?8:u!==null&&typeof u=="object"&&typeof u.then=="function"?6:1,Oi=u,ar===null&&(Bn=1,Kf(o,Fi(u,o.current)))}function h2(){var o=O.H;return O.H=Wf,o===null?Wf:o}function p2(){var o=O.A;return O.A=Ht,o}function Iy(){Bn=4,fi||(xr&4194048)!==xr&&Hi.current!==null||($s=!0),(Ju&134217727)===0&&(Ac&134217727)===0||ir===null||rl(ir,xr,ka,!1)}function Py(o,u,f){var v=Bt;Bt|=2;var g=h2(),S=p2();(ir!==o||xr!==u)&&(n_=null,rd(o,u)),u=!1;var I=Bn;e:do try{if(_r!==0&&ar!==null){var G=ar,le=Oi;switch(_r){case 8:Ny(),I=6;break e;case 3:case 2:case 9:case 6:Hi.current===null&&(u=!0);var Ne=_r;if(_r=0,Oi=null,nd(o,G,le,Ne),f&&$s){I=0;break e}break;default:Ne=_r,_r=0,Oi=null,nd(o,G,le,Ne)}}o7(),I=Bn;break}catch(tt){d2(o,tt)}while(!0);return u&&o.shellSuspendCounter++,Ba=$o=null,Bt=v,O.H=g,O.A=S,ar===null&&(ir=null,xr=0,Yl()),I}function o7(){for(;ar!==null;)v2(ar)}function s7(o,u){var f=Bt;Bt|=2;var v=h2(),g=p2();ir!==o||xr!==u?(n_=null,r_=xt()+500,rd(o,u)):$s=to(o,u);e:do try{if(_r!==0&&ar!==null){u=ar;var S=Oi;t:switch(_r){case 1:_r=0,Oi=null,nd(o,u,S,1);break;case 2:case 9:if(wm(S)){_r=0,Oi=null,m2(u);break}u=function(){_r!==2&&_r!==9||ir!==o||(_r=7),as(o)},S.then(u,u);break e;case 3:_r=7;break e;case 4:_r=5;break e;case 7:wm(S)?(_r=0,Oi=null,m2(u)):(_r=0,Oi=null,nd(o,u,S,7));break;case 5:var I=null;switch(ar.tag){case 26:I=ar.memoizedState;case 5:case 27:var G=ar;if(!I||K2(I)){_r=0,Oi=null;var le=G.sibling;if(le!==null)ar=le;else{var Ne=G.return;Ne!==null?(ar=Ne,a_(Ne)):ar=null}break t}}_r=0,Oi=null,nd(o,u,S,5);break;case 6:_r=0,Oi=null,nd(o,u,S,6);break;case 8:Ny(),Bn=6;break e;default:throw Error(n(462))}}u7();break}catch(tt){d2(o,tt)}while(!0);return Ba=$o=null,O.H=v,O.A=g,Bt=f,ar!==null?0:(ir=null,xr=0,Yl(),Bn)}function u7(){for(;ar!==null&&!_t();)v2(ar)}function v2(o){var u=Ke(o.alternate,o,Zs);o.memoizedProps=o.pendingProps,u===null?a_(o):ar=u}function m2(o){var u=o,f=u.alternate;switch(u.tag){case 15:case 0:u=at(f,u,u.pendingProps,u.type,void 0,xr);break;case 11:u=at(f,u,u.pendingProps,u.type.render,u.ref,xr);break;case 5:lc(u);default:lr(f,u),u=ar=xm(u,Zs),u=Ke(f,u,Zs)}o.memoizedProps=o.pendingProps,u===null?a_(o):ar=u}function nd(o,u,f,v){Ba=$o=null,lc(u),Ws=null,Ku=0;var g=u.return;try{if(Ay(o,g,u,f,xr)){Bn=1,Kf(o,Fi(f,o.current)),ar=null;return}}catch(S){if(g!==null)throw ar=g,S;Bn=1,Kf(o,Fi(f,o.current)),ar=null;return}u.flags&32768?(Dr||v===1?o=!0:$s||(xr&536870912)!==0?o=!1:(fi=o=!0,(v===2||v===9||v===3||v===6)&&(v=Hi.current,v!==null&&v.tag===13&&(v.flags|=16384))),_2(u,o)):a_(u)}function a_(o){var u=o;do{if((u.flags&32768)!==0){_2(u,fi);return}o=u.return;var f=qe(u.alternate,u,Zs);if(f!==null){ar=f;return}if(u=u.sibling,u!==null){ar=u;return}ar=u=o}while(u!==null);Bn===0&&(Bn=5)}function _2(o,u){do{var f=Wt(o.alternate,o);if(f!==null){f.flags&=32767,ar=f;return}if(f=o.return,f!==null&&(f.flags|=32768,f.subtreeFlags=0,f.deletions=null),!u&&(o=o.sibling,o!==null)){ar=o;return}ar=o=f}while(o!==null);Bn=6,ar=null}function g2(o,u,f,v,g,S,I,G,le){o.cancelPendingCommit=null;do o_();while(_i!==0);if((Bt&6)!==0)throw Error(n(327));if(u!==null){if(u===o.current)throw Error(n(177));if(S=u.lanes|u.childLanes,S|=yf,Ul(o,f,S,I,G,le),o===ir&&(ar=ir=null,xr=0),ed=u,tl=o,td=f,Oy=S,My=g,u2=v,(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?(o.callbackNode=null,o.callbackPriority=0,d7(Tr,function(){return A2(),null})):(o.callbackNode=null,o.callbackPriority=0),v=(u.flags&13878)!==0,(u.subtreeFlags&13878)!==0||v){v=O.T,O.T=null,g=F.p,F.p=2,I=Bt,Bt|=4;try{Ar(o,u,f)}finally{Bt=I,F.p=g,O.T=v}}_i=1,y2(),E2(),T2()}}function y2(){if(_i===1){_i=0;var o=tl,u=ed,f=(u.flags&13878)!==0;if((u.subtreeFlags&13878)!==0||f){f=O.T,O.T=null;var v=F.p;F.p=2;var g=Bt;Bt|=4;try{k(u,o);var S=Gy,I=gm(o.containerInfo),G=S.focusedElem,le=S.selectionRange;if(I!==G&&G&&G.ownerDocument&&_f(G.ownerDocument.documentElement,G)){if(le!==null&&wh(G)){var Ne=le.start,tt=le.end;if(tt===void 0&&(tt=Ne),"selectionStart"in G)G.selectionStart=Ne,G.selectionEnd=Math.min(tt,G.value.length);else{var ct=G.ownerDocument||document,Be=ct&&ct.defaultView||window;if(Be.getSelection){var ke=Be.getSelection(),ur=G.textContent.length,tr=Math.min(le.start,ur),Qr=le.end===void 0?tr:Math.min(le.end,ur);!ke.extend&&tr>Qr&&(I=Qr,Qr=tr,tr=I);var Se=_m(G,tr),ve=_m(G,Qr);if(Se&&ve&&(ke.rangeCount!==1||ke.anchorNode!==Se.node||ke.anchorOffset!==Se.offset||ke.focusNode!==ve.node||ke.focusOffset!==ve.offset)){var Me=ct.createRange();Me.setStart(Se.node,Se.offset),ke.removeAllRanges(),tr>Qr?(ke.addRange(Me),ke.extend(ve.node,ve.offset)):(Me.setEnd(ve.node,ve.offset),ke.addRange(Me))}}}}for(ct=[],ke=G;ke=ke.parentNode;)ke.nodeType===1&&ct.push({element:ke,left:ke.scrollLeft,top:ke.scrollTop});for(typeof G.focus=="function"&&G.focus(),G=0;G<ct.length;G++){var it=ct[G];it.element.scrollLeft=it.left,it.element.scrollTop=it.top}}g_=!!Xy,Gy=Xy=null}finally{Bt=g,F.p=v,O.T=f}}o.current=u,_i=2}}function E2(){if(_i===2){_i=0;var o=tl,u=ed,f=(u.flags&8772)!==0;if((u.subtreeFlags&8772)!==0||f){f=O.T,O.T=null;var v=F.p;F.p=2;var g=Bt;Bt|=4;try{Ut(o,u.alternate,u)}finally{Bt=g,F.p=v,O.T=f}}_i=3}}function T2(){if(_i===4||_i===3){_i=0,Ot();var o=tl,u=ed,f=td,v=u2;(u.subtreeFlags&10256)!==0||(u.flags&10256)!==0?_i=5:(_i=0,ed=tl=null,S2(o,o.pendingLanes));var g=o.pendingLanes;if(g===0&&(el=null),du(f),u=u.stateNode,un&&typeof un.onCommitFiberRoot=="function")try{un.onCommitFiberRoot(Hn,u,void 0,(u.current.flags&128)===128)}catch{}if(v!==null){u=O.T,g=F.p,F.p=2,O.T=null;try{for(var S=o.onRecoverableError,I=0;I<v.length;I++){var G=v[I];S(G.value,{componentStack:G.stack})}}finally{O.T=u,F.p=g}}(td&3)!==0&&o_(),as(o),g=o.pendingLanes,(f&4194090)!==0&&(g&42)!==0?o===wy?op++:(op=0,wy=o):op=0,sp(0)}}function S2(o,u){(o.pooledCacheLanes&=u)===0&&(u=o.pooledCache,u!=null&&(o.pooledCache=null,tc(u)))}function o_(o){return y2(),E2(),T2(),A2()}function A2(){if(_i!==5)return!1;var o=tl,u=Oy;Oy=0;var f=du(td),v=O.T,g=F.p;try{F.p=32>f?32:f,O.T=null,f=My,My=null;var S=tl,I=td;if(_i=0,ed=tl=null,td=0,(Bt&6)!==0)throw Error(n(331));var G=Bt;if(Bt|=4,It(S.current),se(S,S.current,I,f),Bt=G,sp(0,!1),un&&typeof un.onPostCommitFiberRoot=="function")try{un.onPostCommitFiberRoot(Hn,S)}catch{}return!0}finally{F.p=g,O.T=v,S2(o,u)}}function b2(o,u,f){u=Fi(f,u),u=Qf(o.stateNode,u,2),o=Qo(o,u,2),o!==null&&(ro(o,2),as(o))}function rn(o,u,f){if(o.tag===3)b2(o,o,f);else for(;u!==null;){if(u.tag===3){b2(u,o,f);break}else if(u.tag===1){var v=u.stateNode;if(typeof u.type.getDerivedStateFromError=="function"||typeof v.componentDidCatch=="function"&&(el===null||!el.has(v))){o=Fi(f,o),f=np(2),v=Qo(u,f,2),v!==null&&(ip(f,v,u,o),ro(v,2),as(v));break}}u=u.return}}function Dy(o,u,f){var v=o.pingCache;if(v===null){v=o.pingCache=new Qt;var g=new Set;v.set(u,g)}else g=v.get(u),g===void 0&&(g=new Set,v.set(u,g));g.has(f)||(by=!0,g.add(f),o=l7.bind(null,o,u,f),u.then(o,o))}function l7(o,u,f){var v=o.pingCache;v!==null&&v.delete(u),o.pingedLanes|=o.suspendedLanes&f,o.warmLanes&=~f,ir===o&&(xr&f)===f&&(Bn===4||Bn===3&&(xr&62914560)===xr&&300>xt()-Cy?(Bt&2)===0&&rd(o,0):xy|=f,Jf===xr&&(Jf=0)),as(o)}function x2(o,u){u===0&&(u=Jc()),o=ha(o,u),o!==null&&(ro(o,u),as(o))}function c7(o){var u=o.memoizedState,f=0;u!==null&&(f=u.retryLane),x2(o,f)}function f7(o,u){var f=0;switch(o.tag){case 13:var v=o.stateNode,g=o.memoizedState;g!==null&&(f=g.retryLane);break;case 19:v=o.stateNode;break;case 22:v=o.stateNode._retryCache;break;default:throw Error(n(314))}v!==null&&v.delete(u),x2(o,f)}function d7(o,u){return zt(o,u)}var s_=null,id=null,Ly=!1,u_=!1,By=!1,bc=0;function as(o){o!==id&&o.next===null&&(id===null?s_=id=o:id=id.next=o),u_=!0,Ly||(Ly=!0,p7())}function sp(o,u){if(!By&&u_){By=!0;do for(var f=!1,v=s_;v!==null;){if(o!==0){var g=v.pendingLanes;if(g===0)var S=0;else{var I=v.suspendedLanes,G=v.pingedLanes;S=(1<<31-yr(42|o)+1)-1,S&=g&~(I&~G),S=S&201326741?S&201326741|1:S?S|2:0}S!==0&&(f=!0,M2(v,S))}else S=xr,S=Ma(v,v===ir?S:0,v.cancelPendingCommit!==null||v.timeoutHandle!==-1),(S&3)===0||to(v,S)||(f=!0,M2(v,S));v=v.next}while(f);By=!1}}function h7(){R2()}function R2(){u_=Ly=!1;var o=0;bc!==0&&(S7()&&(o=bc),bc=0);for(var u=xt(),f=null,v=s_;v!==null;){var g=v.next,S=C2(v,u);S===0?(v.next=null,f===null?s_=g:f.next=g,g===null&&(id=f)):(f=v,(o!==0||(S&3)!==0)&&(u_=!0)),v=g}sp(o)}function C2(o,u){for(var f=o.suspendedLanes,v=o.pingedLanes,g=o.expirationTimes,S=o.pendingLanes&-62914561;0<S;){var I=31-yr(S),G=1<<I,le=g[I];le===-1?((G&f)===0||(G&v)!==0)&&(g[I]=fu(G,u)):le<=u&&(o.expiredLanes|=G),S&=~G}if(u=ir,f=xr,f=Ma(o,o===u?f:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),v=o.callbackNode,f===0||o===u&&(_r===2||_r===9)||o.cancelPendingCommit!==null)return v!==null&&v!==null&&jt(v),o.callbackNode=null,o.callbackPriority=0;if((f&3)===0||to(o,f)){if(u=f&-f,u===o.callbackPriority)return u;switch(v!==null&&jt(v),du(f)){case 2:case 8:f=qr;break;case 32:f=Tr;break;case 268435456:f=V;break;default:f=Tr}return v=O2.bind(null,o),f=zt(f,v),o.callbackPriority=u,o.callbackNode=f,u}return v!==null&&v!==null&&jt(v),o.callbackPriority=2,o.callbackNode=null,2}function O2(o,u){if(_i!==0&&_i!==5)return o.callbackNode=null,o.callbackPriority=0,null;var f=o.callbackNode;if(o_()&&o.callbackNode!==f)return null;var v=xr;return v=Ma(o,o===ir?v:0,o.cancelPendingCommit!==null||o.timeoutHandle!==-1),v===0?null:(c2(o,v,u),C2(o,xt()),o.callbackNode!=null&&o.callbackNode===f?O2.bind(null,o):null)}function M2(o,u){if(o_())return null;c2(o,u,!0)}function p7(){b7(function(){(Bt&6)!==0?zt(Or,h7):R2()})}function Fy(){return bc===0&&(bc=Qc()),bc}function w2(o){return o==null||typeof o=="symbol"||typeof o=="boolean"?null:typeof o=="function"?o:Tn(""+o)}function N2(o,u){var f=u.ownerDocument.createElement("input");return f.name=u.name,f.value=u.value,o.id&&f.setAttribute("form",o.id),u.parentNode.insertBefore(f,u),o=new FormData(o),f.parentNode.removeChild(f),o}function v7(o,u,f,v,g){if(u==="submit"&&f&&f.stateNode===g){var S=w2((g[oi]||null).action),I=v.submitter;I&&(u=(u=I[oi]||null)?w2(u.formAction):I.getAttribute("formAction"),u!==null&&(S=u,I=null));var G=new bs("action","action",null,v,g);o.push({event:G,listeners:[{instance:null,listener:function(){if(v.defaultPrevented){if(bc!==0){var le=I?N2(g,I):new FormData(g);Yu(f,{pending:!0,data:le,method:g.method,action:S},null,le)}}else typeof S=="function"&&(G.preventDefault(),le=I?N2(g,I):new FormData(g),Yu(f,{pending:!0,data:le,method:g.method,action:S},S,le))},currentTarget:g}]})}}for(var Uy=0;Uy<Lu.length;Uy++){var ky=Lu[Uy],m7=ky.toLowerCase(),_7=ky[0].toUpperCase()+ky.slice(1);Sn(m7,"on"+_7)}Sn(Em,"onAnimationEnd"),Sn(Tm,"onAnimationIteration"),Sn(Sm,"onAnimationStart"),Sn("dblclick","onDoubleClick"),Sn("focusin","onFocus"),Sn("focusout","onBlur"),Sn(_y,"onTransitionRun"),Sn(gy,"onTransitionStart"),Sn(Am,"onTransitionCancel"),Sn(Wl,"onTransitionEnd"),Ia("onMouseEnter",["mouseout","mouseover"]),Ia("onMouseLeave",["mouseout","mouseover"]),Ia("onPointerEnter",["pointerout","pointerover"]),Ia("onPointerLeave",["pointerout","pointerover"]),$i("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),$i("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),$i("onBeforeInput",["compositionend","keypress","textInput","paste"]),$i("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),$i("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),$i("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var up="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),g7=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(up));function I2(o,u){u=(u&4)!==0;for(var f=0;f<o.length;f++){var v=o[f],g=v.event;v=v.listeners;e:{var S=void 0;if(u)for(var I=v.length-1;0<=I;I--){var G=v[I],le=G.instance,Ne=G.currentTarget;if(G=G.listener,le!==S&&g.isPropagationStopped())break e;S=G,g.currentTarget=Ne;try{S(g)}catch(tt){Sc(tt)}g.currentTarget=null,S=le}else for(I=0;I<v.length;I++){if(G=v[I],le=G.instance,Ne=G.currentTarget,G=G.listener,le!==S&&g.isPropagationStopped())break e;S=G,g.currentTarget=Ne;try{S(g)}catch(tt){Sc(tt)}g.currentTarget=null,S=le}}}}function wr(o,u){var f=u[Ts];f===void 0&&(f=u[Ts]=new Set);var v=o+"__bubble";f.has(v)||(P2(u,o,2,!1),f.add(v))}function zy(o,u,f){var v=0;u&&(v|=4),P2(f,o,v,u)}var l_="_reactListening"+Math.random().toString(36).slice(2);function jy(o){if(!o[l_]){o[l_]=!0,ko.forEach(function(f){f!=="selectionchange"&&(g7.has(f)||zy(f,!1,o),zy(f,!0,o))});var u=o.nodeType===9?o:o.ownerDocument;u===null||u[l_]||(u[l_]=!0,zy("selectionchange",!1,u))}}function P2(o,u,f,v){switch(nC(u)){case 2:var g=G7;break;case 8:g=q7;break;default:g=tE}f=g.bind(null,u,f,o),g=void 0,!uo||u!=="touchstart"&&u!=="touchmove"&&u!=="wheel"||(g=!0),v?g!==void 0?o.addEventListener(u,f,{capture:!0,passive:g}):o.addEventListener(u,f,!0):g!==void 0?o.addEventListener(u,f,{passive:g}):o.addEventListener(u,f,!1)}function Hy(o,u,f,v,g){var S=v;if((u&1)===0&&(u&2)===0&&v!==null)e:for(;;){if(v===null)return;var I=v.tag;if(I===3||I===4){var G=v.stateNode.containerInfo;if(G===g)break;if(I===4)for(I=v.return;I!==null;){var le=I.tag;if((le===3||le===4)&&I.stateNode.containerInfo===g)return;I=I.return}for(;G!==null;){if(I=no(G),I===null)return;if(le=I.tag,le===5||le===6||le===26||le===27){v=S=I;continue e}G=G.parentNode}}v=v.return}rm(function(){var Ne=S,tt=bi(f),ct=[];e:{var Be=bm.get(o);if(Be!==void 0){var ke=bs,ur=o;switch(o){case"keypress":if(Vl(f)===0)break e;case"keydown":case"keyup":ke=sm;break;case"focusin":ur="focus",ke=mh;break;case"focusout":ur="blur",ke=mh;break;case"beforeblur":case"afterblur":ke=mh;break;case"click":if(f.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ke=im;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ke=sy;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ke=ln;break;case Em:case Tm:case Sm:ke=Gl;break;case Wl:ke=hy;break;case"scroll":case"scrollend":ke=nm;break;case"wheel":ke=fm;break;case"copy":case"cut":case"paste":ke=Ou;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ke=um;break;case"toggle":case"beforetoggle":ke=Cs}var tr=(u&4)!==0,Qr=!tr&&(o==="scroll"||o==="scrollend"),Se=tr?Be!==null?Be+"Capture":null:Be;tr=[];for(var ve=Ne,Me;ve!==null;){var it=ve;if(Me=it.stateNode,it=it.tag,it!==5&&it!==26&&it!==27||Me===null||Se===null||(it=jl(ve,Se),it!=null&&tr.push(lp(ve,it,Me))),Qr)break;ve=ve.return}0<tr.length&&(Be=new ke(Be,ur,null,f,tt),ct.push({event:Be,listeners:tr}))}}if((u&7)===0){e:{if(Be=o==="mouseover"||o==="pointerover",ke=o==="mouseout"||o==="pointerout",Be&&f!==Mn&&(ur=f.relatedTarget||f.fromElement)&&(no(ur)||ur[Fo]))break e;if((ke||Be)&&(Be=tt.window===tt?tt:(Be=tt.ownerDocument)?Be.defaultView||Be.parentWindow:window,ke?(ur=f.relatedTarget||f.toElement,ke=Ne,ur=ur?no(ur):null,ur!==null&&(Qr=a(ur),tr=ur.tag,ur!==Qr||tr!==5&&tr!==27&&tr!==6)&&(ur=null)):(ke=null,ur=Ne),ke!==ur)){if(tr=im,it="onMouseLeave",Se="onMouseEnter",ve="mouse",(o==="pointerout"||o==="pointerover")&&(tr=um,it="onPointerLeave",Se="onPointerEnter",ve="pointer"),Qr=ke==null?Be:Uo(ke),Me=ur==null?Be:Uo(ur),Be=new tr(it,ve+"leave",ke,f,tt),Be.target=Qr,Be.relatedTarget=Me,it=null,no(tt)===Ne&&(tr=new tr(Se,ve+"enter",ur,f,tt),tr.target=Me,tr.relatedTarget=Qr,it=tr),Qr=it,ke&&ur)t:{for(tr=ke,Se=ur,ve=0,Me=tr;Me;Me=ad(Me))ve++;for(Me=0,it=Se;it;it=ad(it))Me++;for(;0<ve-Me;)tr=ad(tr),ve--;for(;0<Me-ve;)Se=ad(Se),Me--;for(;ve--;){if(tr===Se||Se!==null&&tr===Se.alternate)break t;tr=ad(tr),Se=ad(Se)}tr=null}else tr=null;ke!==null&&D2(ct,Be,ke,tr,!1),ur!==null&&Qr!==null&&D2(ct,Qr,ur,tr,!0)}}e:{if(Be=Ne?Uo(Ne):window,ke=Be.nodeName&&Be.nodeName.toLowerCase(),ke==="select"||ke==="input"&&Be.type==="file")var Vt=pf;else if(df(Be))if(bh)Vt=Oh;else{Vt=vm;var Rr=pm}else ke=Be.nodeName,!ke||ke.toLowerCase()!=="input"||Be.type!=="checkbox"&&Be.type!=="radio"?Ne&&Nt(Ne.elementType)&&(Vt=pf):Vt=Iu;if(Vt&&(Vt=Vt(o,Ne))){hf(ct,Vt,f,tt);break e}Rr&&Rr(o,Be,Ne),o==="focusout"&&Ne&&Be.type==="number"&&Ne.memoizedProps.value!=null&&Tu(Be,"number",Be.value)}switch(Rr=Ne?Uo(Ne):window,o){case"focusin":(df(Rr)||Rr.contentEditable==="true")&&(Go=Rr,Nh=Ne,Ms=null);break;case"focusout":Ms=Nh=Go=null;break;case"mousedown":gf=!0;break;case"contextmenu":case"mouseup":case"dragend":gf=!1,Ih(ct,f,tt);break;case"selectionchange":if(vy)break;case"keydown":case"keyup":Ih(ct,f,tt)}var $t;if(Mu)e:{switch(o){case"compositionstart":var nr="onCompositionStart";break e;case"compositionend":nr="onCompositionEnd";break e;case"compositionupdate":nr="onCompositionUpdate";break e}nr=void 0}else wu?dm(o,f)&&(nr="onCompositionEnd"):o==="keydown"&&f.keyCode===229&&(nr="onCompositionStart");nr&&(Eh&&f.locale!=="ko"&&(wu||nr!=="onCompositionStart"?nr==="onCompositionEnd"&&wu&&($t=hh()):(Xo=tt,bu="value"in Xo?Xo.value:Xo.textContent,wu=!0)),Rr=c_(Ne,nr),0<Rr.length&&(nr=new xs(nr,o,null,f,tt),ct.push({event:nr,listeners:Rr}),$t?nr.data=$t:($t=hm(f),$t!==null&&(nr.data=$t)))),($t=lf?py(o,f):Sh(o,f))&&(nr=c_(Ne,"onBeforeInput"),0<nr.length&&(Rr=new xs("onBeforeInput","beforeinput",null,f,tt),ct.push({event:Rr,listeners:nr}),Rr.data=$t)),v7(ct,o,Ne,f,tt)}I2(ct,u)})}function lp(o,u,f){return{instance:o,listener:u,currentTarget:f}}function c_(o,u){for(var f=u+"Capture",v=[];o!==null;){var g=o,S=g.stateNode;if(g=g.tag,g!==5&&g!==26&&g!==27||S===null||(g=jl(o,f),g!=null&&v.unshift(lp(o,g,S)),g=jl(o,u),g!=null&&v.push(lp(o,g,S))),o.tag===3)return v;o=o.return}return[]}function ad(o){if(o===null)return null;do o=o.return;while(o&&o.tag!==5&&o.tag!==27);return o||null}function D2(o,u,f,v,g){for(var S=u._reactName,I=[];f!==null&&f!==v;){var G=f,le=G.alternate,Ne=G.stateNode;if(G=G.tag,le!==null&&le===v)break;G!==5&&G!==26&&G!==27||Ne===null||(le=Ne,g?(Ne=jl(f,S),Ne!=null&&I.unshift(lp(f,Ne,le))):g||(Ne=jl(f,S),Ne!=null&&I.push(lp(f,Ne,le)))),f=f.return}I.length!==0&&o.push({event:u,listeners:I})}var y7=/\r\n?/g,E7=/\u0000|\uFFFD/g;function L2(o){return(typeof o=="string"?o:""+o).replace(y7,`
`).replace(E7,"")}function B2(o,u){return u=L2(u),L2(o)===u}function f_(){}function Kr(o,u,f,v,g,S){switch(f){case"children":typeof v=="string"?u==="body"||u==="textarea"&&v===""||Z(o,v):(typeof v=="number"||typeof v=="bigint")&&u!=="body"&&Z(o,""+v);break;case"className":Di(o,"class",v);break;case"tabIndex":Di(o,"tabindex",v);break;case"dir":case"role":case"viewBox":case"width":case"height":Di(o,f,v);break;case"style":pt(o,v,S);break;case"data":if(u!=="object"){Di(o,"data",v);break}case"src":case"href":if(v===""&&(u!=="a"||f!=="href")){o.removeAttribute(f);break}if(v==null||typeof v=="function"||typeof v=="symbol"||typeof v=="boolean"){o.removeAttribute(f);break}v=Tn(""+v),o.setAttribute(f,v);break;case"action":case"formAction":if(typeof v=="function"){o.setAttribute(f,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof S=="function"&&(f==="formAction"?(u!=="input"&&Kr(o,u,"name",g.name,g,null),Kr(o,u,"formEncType",g.formEncType,g,null),Kr(o,u,"formMethod",g.formMethod,g,null),Kr(o,u,"formTarget",g.formTarget,g,null)):(Kr(o,u,"encType",g.encType,g,null),Kr(o,u,"method",g.method,g,null),Kr(o,u,"target",g.target,g,null)));if(v==null||typeof v=="symbol"||typeof v=="boolean"){o.removeAttribute(f);break}v=Tn(""+v),o.setAttribute(f,v);break;case"onClick":v!=null&&(o.onclick=f_);break;case"onScroll":v!=null&&wr("scroll",o);break;case"onScrollEnd":v!=null&&wr("scrollend",o);break;case"dangerouslySetInnerHTML":if(v!=null){if(typeof v!="object"||!("__html"in v))throw Error(n(61));if(f=v.__html,f!=null){if(g.children!=null)throw Error(n(60));o.innerHTML=f}}break;case"multiple":o.multiple=v&&typeof v!="function"&&typeof v!="symbol";break;case"muted":o.muted=v&&typeof v!="function"&&typeof v!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(v==null||typeof v=="function"||typeof v=="boolean"||typeof v=="symbol"){o.removeAttribute("xlink:href");break}f=Tn(""+v),o.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",f);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":v!=null&&typeof v!="function"&&typeof v!="symbol"?o.setAttribute(f,""+v):o.removeAttribute(f);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":v&&typeof v!="function"&&typeof v!="symbol"?o.setAttribute(f,""):o.removeAttribute(f);break;case"capture":case"download":v===!0?o.setAttribute(f,""):v!==!1&&v!=null&&typeof v!="function"&&typeof v!="symbol"?o.setAttribute(f,v):o.removeAttribute(f);break;case"cols":case"rows":case"size":case"span":v!=null&&typeof v!="function"&&typeof v!="symbol"&&!isNaN(v)&&1<=v?o.setAttribute(f,v):o.removeAttribute(f);break;case"rowSpan":case"start":v==null||typeof v=="function"||typeof v=="symbol"||isNaN(v)?o.removeAttribute(f):o.setAttribute(f,v);break;case"popover":wr("beforetoggle",o),wr("toggle",o),da(o,"popover",v);break;case"xlinkActuate":Un(o,"http://www.w3.org/1999/xlink","xlink:actuate",v);break;case"xlinkArcrole":Un(o,"http://www.w3.org/1999/xlink","xlink:arcrole",v);break;case"xlinkRole":Un(o,"http://www.w3.org/1999/xlink","xlink:role",v);break;case"xlinkShow":Un(o,"http://www.w3.org/1999/xlink","xlink:show",v);break;case"xlinkTitle":Un(o,"http://www.w3.org/1999/xlink","xlink:title",v);break;case"xlinkType":Un(o,"http://www.w3.org/1999/xlink","xlink:type",v);break;case"xmlBase":Un(o,"http://www.w3.org/XML/1998/namespace","xml:base",v);break;case"xmlLang":Un(o,"http://www.w3.org/XML/1998/namespace","xml:lang",v);break;case"xmlSpace":Un(o,"http://www.w3.org/XML/1998/namespace","xml:space",v);break;case"is":da(o,"is",v);break;case"innerText":case"textContent":break;default:(!(2<f.length)||f[0]!=="o"&&f[0]!=="O"||f[1]!=="n"&&f[1]!=="N")&&(f=pr.get(f)||f,da(o,f,v))}}function Vy(o,u,f,v,g,S){switch(f){case"style":pt(o,v,S);break;case"dangerouslySetInnerHTML":if(v!=null){if(typeof v!="object"||!("__html"in v))throw Error(n(61));if(f=v.__html,f!=null){if(g.children!=null)throw Error(n(60));o.innerHTML=f}}break;case"children":typeof v=="string"?Z(o,v):(typeof v=="number"||typeof v=="bigint")&&Z(o,""+v);break;case"onScroll":v!=null&&wr("scroll",o);break;case"onScrollEnd":v!=null&&wr("scrollend",o);break;case"onClick":v!=null&&(o.onclick=f_);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!zo.hasOwnProperty(f))e:{if(f[0]==="o"&&f[1]==="n"&&(g=f.endsWith("Capture"),u=f.slice(2,g?f.length-7:void 0),S=o[oi]||null,S=S!=null?S[f]:null,typeof S=="function"&&o.removeEventListener(u,S,g),typeof v=="function")){typeof S!="function"&&S!==null&&(f in o?o[f]=null:o.hasAttribute(f)&&o.removeAttribute(f)),o.addEventListener(u,v,g);break e}f in o?o[f]=v:v===!0?o.setAttribute(f,""):da(o,f,v)}}}function gi(o,u,f){switch(u){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":wr("error",o),wr("load",o);var v=!1,g=!1,S;for(S in f)if(f.hasOwnProperty(S)){var I=f[S];if(I!=null)switch(S){case"src":v=!0;break;case"srcSet":g=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,u));default:Kr(o,u,S,I,f,null)}}g&&Kr(o,u,"srcSet",f.srcSet,f,null),v&&Kr(o,u,"src",f.src,f,null);return;case"input":wr("invalid",o);var G=S=I=g=null,le=null,Ne=null;for(v in f)if(f.hasOwnProperty(v)){var tt=f[v];if(tt!=null)switch(v){case"name":g=tt;break;case"type":I=tt;break;case"checked":le=tt;break;case"defaultChecked":Ne=tt;break;case"value":S=tt;break;case"defaultValue":G=tt;break;case"children":case"dangerouslySetInnerHTML":if(tt!=null)throw Error(n(137,u));break;default:Kr(o,u,v,tt,f,null)}}Eu(o,S,G,le,Ne,I,g,!1),jo(o);return;case"select":wr("invalid",o),v=I=S=null;for(g in f)if(f.hasOwnProperty(g)&&(G=f[g],G!=null))switch(g){case"value":S=G;break;case"defaultValue":I=G;break;case"multiple":v=G;default:Kr(o,u,g,G,f,null)}u=S,f=I,o.multiple=!!v,u!=null?Vo(o,!!v,u,!1):f!=null&&Vo(o,!!v,f,!0);return;case"textarea":wr("invalid",o),S=g=v=null;for(I in f)if(f.hasOwnProperty(I)&&(G=f[I],G!=null))switch(I){case"value":v=G;break;case"defaultValue":g=G;break;case"children":S=G;break;case"dangerouslySetInnerHTML":if(G!=null)throw Error(n(91));break;default:Kr(o,u,I,G,f,null)}j(o,v,g,S),jo(o);return;case"option":for(le in f)if(f.hasOwnProperty(le)&&(v=f[le],v!=null))switch(le){case"selected":o.selected=v&&typeof v!="function"&&typeof v!="symbol";break;default:Kr(o,u,le,v,f,null)}return;case"dialog":wr("beforetoggle",o),wr("toggle",o),wr("cancel",o),wr("close",o);break;case"iframe":case"object":wr("load",o);break;case"video":case"audio":for(v=0;v<up.length;v++)wr(up[v],o);break;case"image":wr("error",o),wr("load",o);break;case"details":wr("toggle",o);break;case"embed":case"source":case"link":wr("error",o),wr("load",o);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Ne in f)if(f.hasOwnProperty(Ne)&&(v=f[Ne],v!=null))switch(Ne){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,u));default:Kr(o,u,Ne,v,f,null)}return;default:if(Nt(u)){for(tt in f)f.hasOwnProperty(tt)&&(v=f[tt],v!==void 0&&Vy(o,u,tt,v,f,void 0));return}}for(G in f)f.hasOwnProperty(G)&&(v=f[G],v!=null&&Kr(o,u,G,v,f,null))}function T7(o,u,f,v){switch(u){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var g=null,S=null,I=null,G=null,le=null,Ne=null,tt=null;for(ke in f){var ct=f[ke];if(f.hasOwnProperty(ke)&&ct!=null)switch(ke){case"checked":break;case"value":break;case"defaultValue":le=ct;default:v.hasOwnProperty(ke)||Kr(o,u,ke,null,v,ct)}}for(var Be in v){var ke=v[Be];if(ct=f[Be],v.hasOwnProperty(Be)&&(ke!=null||ct!=null))switch(Be){case"type":S=ke;break;case"name":g=ke;break;case"checked":Ne=ke;break;case"defaultChecked":tt=ke;break;case"value":I=ke;break;case"defaultValue":G=ke;break;case"children":case"dangerouslySetInnerHTML":if(ke!=null)throw Error(n(137,u));break;default:ke!==ct&&Kr(o,u,Be,ke,v,ct)}}Ho(o,I,G,le,Ne,tt,S,g);return;case"select":ke=I=G=Be=null;for(S in f)if(le=f[S],f.hasOwnProperty(S)&&le!=null)switch(S){case"value":break;case"multiple":ke=le;default:v.hasOwnProperty(S)||Kr(o,u,S,null,v,le)}for(g in v)if(S=v[g],le=f[g],v.hasOwnProperty(g)&&(S!=null||le!=null))switch(g){case"value":Be=S;break;case"defaultValue":G=S;break;case"multiple":I=S;default:S!==le&&Kr(o,u,g,S,v,le)}u=G,f=I,v=ke,Be!=null?Vo(o,!!f,Be,!1):!!v!=!!f&&(u!=null?Vo(o,!!f,u,!0):Vo(o,!!f,f?[]:"",!1));return;case"textarea":ke=Be=null;for(G in f)if(g=f[G],f.hasOwnProperty(G)&&g!=null&&!v.hasOwnProperty(G))switch(G){case"value":break;case"children":break;default:Kr(o,u,G,null,v,g)}for(I in v)if(g=v[I],S=f[I],v.hasOwnProperty(I)&&(g!=null||S!=null))switch(I){case"value":Be=g;break;case"defaultValue":ke=g;break;case"children":break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(n(91));break;default:g!==S&&Kr(o,u,I,g,v,S)}nf(o,Be,ke);return;case"option":for(var ur in f)if(Be=f[ur],f.hasOwnProperty(ur)&&Be!=null&&!v.hasOwnProperty(ur))switch(ur){case"selected":o.selected=!1;break;default:Kr(o,u,ur,null,v,Be)}for(le in v)if(Be=v[le],ke=f[le],v.hasOwnProperty(le)&&Be!==ke&&(Be!=null||ke!=null))switch(le){case"selected":o.selected=Be&&typeof Be!="function"&&typeof Be!="symbol";break;default:Kr(o,u,le,Be,v,ke)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var tr in f)Be=f[tr],f.hasOwnProperty(tr)&&Be!=null&&!v.hasOwnProperty(tr)&&Kr(o,u,tr,null,v,Be);for(Ne in v)if(Be=v[Ne],ke=f[Ne],v.hasOwnProperty(Ne)&&Be!==ke&&(Be!=null||ke!=null))switch(Ne){case"children":case"dangerouslySetInnerHTML":if(Be!=null)throw Error(n(137,u));break;default:Kr(o,u,Ne,Be,v,ke)}return;default:if(Nt(u)){for(var Qr in f)Be=f[Qr],f.hasOwnProperty(Qr)&&Be!==void 0&&!v.hasOwnProperty(Qr)&&Vy(o,u,Qr,void 0,v,Be);for(tt in v)Be=v[tt],ke=f[tt],!v.hasOwnProperty(tt)||Be===ke||Be===void 0&&ke===void 0||Vy(o,u,tt,Be,v,ke);return}}for(var Se in f)Be=f[Se],f.hasOwnProperty(Se)&&Be!=null&&!v.hasOwnProperty(Se)&&Kr(o,u,Se,null,v,Be);for(ct in v)Be=v[ct],ke=f[ct],!v.hasOwnProperty(ct)||Be===ke||Be==null&&ke==null||Kr(o,u,ct,Be,v,ke)}var Xy=null,Gy=null;function d_(o){return o.nodeType===9?o:o.ownerDocument}function F2(o){switch(o){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function U2(o,u){if(o===0)switch(u){case"svg":return 1;case"math":return 2;default:return 0}return o===1&&u==="foreignObject"?0:o}function qy(o,u){return o==="textarea"||o==="noscript"||typeof u.children=="string"||typeof u.children=="number"||typeof u.children=="bigint"||typeof u.dangerouslySetInnerHTML=="object"&&u.dangerouslySetInnerHTML!==null&&u.dangerouslySetInnerHTML.__html!=null}var Wy=null;function S7(){var o=window.event;return o&&o.type==="popstate"?o===Wy?!1:(Wy=o,!0):(Wy=null,!1)}var k2=typeof setTimeout=="function"?setTimeout:void 0,A7=typeof clearTimeout=="function"?clearTimeout:void 0,z2=typeof Promise=="function"?Promise:void 0,b7=typeof queueMicrotask=="function"?queueMicrotask:typeof z2<"u"?function(o){return z2.resolve(null).then(o).catch(x7)}:k2;function x7(o){setTimeout(function(){throw o})}function nl(o){return o==="head"}function j2(o,u){var f=u,v=0,g=0;do{var S=f.nextSibling;if(o.removeChild(f),S&&S.nodeType===8)if(f=S.data,f==="/$"){if(0<v&&8>v){f=v;var I=o.ownerDocument;if(f&1&&cp(I.documentElement),f&2&&cp(I.body),f&4)for(f=I.head,cp(f),I=f.firstChild;I;){var G=I.nextSibling,le=I.nodeName;I[Ss]||le==="SCRIPT"||le==="STYLE"||le==="LINK"&&I.rel.toLowerCase()==="stylesheet"||f.removeChild(I),I=G}}if(g===0){o.removeChild(S),gp(u);return}g--}else f==="$"||f==="$?"||f==="$!"?g++:v=f.charCodeAt(0)-48;else v=0;f=S}while(f);gp(u)}function Yy(o){var u=o.firstChild;for(u&&u.nodeType===10&&(u=u.nextSibling);u;){var f=u;switch(u=u.nextSibling,f.nodeName){case"HTML":case"HEAD":case"BODY":Yy(f),pu(f);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(f.rel.toLowerCase()==="stylesheet")continue}o.removeChild(f)}}function R7(o,u,f,v){for(;o.nodeType===1;){var g=f;if(o.nodeName.toLowerCase()!==u.toLowerCase()){if(!v&&(o.nodeName!=="INPUT"||o.type!=="hidden"))break}else if(v){if(!o[Ss])switch(u){case"meta":if(!o.hasAttribute("itemprop"))break;return o;case"link":if(S=o.getAttribute("rel"),S==="stylesheet"&&o.hasAttribute("data-precedence"))break;if(S!==g.rel||o.getAttribute("href")!==(g.href==null||g.href===""?null:g.href)||o.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin)||o.getAttribute("title")!==(g.title==null?null:g.title))break;return o;case"style":if(o.hasAttribute("data-precedence"))break;return o;case"script":if(S=o.getAttribute("src"),(S!==(g.src==null?null:g.src)||o.getAttribute("type")!==(g.type==null?null:g.type)||o.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin))&&S&&o.hasAttribute("async")&&!o.hasAttribute("itemprop"))break;return o;default:return o}}else if(u==="input"&&o.type==="hidden"){var S=g.name==null?null:""+g.name;if(g.type==="hidden"&&o.getAttribute("name")===S)return o}else return o;if(o=Ao(o.nextSibling),o===null)break}return null}function C7(o,u,f){if(u==="")return null;for(;o.nodeType!==3;)if((o.nodeType!==1||o.nodeName!=="INPUT"||o.type!=="hidden")&&!f||(o=Ao(o.nextSibling),o===null))return null;return o}function $y(o){return o.data==="$!"||o.data==="$?"&&o.ownerDocument.readyState==="complete"}function O7(o,u){var f=o.ownerDocument;if(o.data!=="$?"||f.readyState==="complete")u();else{var v=function(){u(),f.removeEventListener("DOMContentLoaded",v)};f.addEventListener("DOMContentLoaded",v),o._reactRetry=v}}function Ao(o){for(;o!=null;o=o.nextSibling){var u=o.nodeType;if(u===1||u===3)break;if(u===8){if(u=o.data,u==="$"||u==="$!"||u==="$?"||u==="F!"||u==="F")break;if(u==="/$")return null}}return o}var Zy=null;function H2(o){o=o.previousSibling;for(var u=0;o;){if(o.nodeType===8){var f=o.data;if(f==="$"||f==="$!"||f==="$?"){if(u===0)return o;u--}else f==="/$"&&u++}o=o.previousSibling}return null}function V2(o,u,f){switch(u=d_(f),o){case"html":if(o=u.documentElement,!o)throw Error(n(452));return o;case"head":if(o=u.head,!o)throw Error(n(453));return o;case"body":if(o=u.body,!o)throw Error(n(454));return o;default:throw Error(n(451))}}function cp(o){for(var u=o.attributes;u.length;)o.removeAttributeNode(u[0]);pu(o)}var za=new Map,X2=new Set;function h_(o){return typeof o.getRootNode=="function"?o.getRootNode():o.nodeType===9?o:o.ownerDocument}var Ks=F.d;F.d={f:M7,r:w7,D:N7,C:I7,L:P7,m:D7,X:B7,S:L7,M:F7};function M7(){var o=Ks.f(),u=i_();return o||u}function w7(o){var u=io(o);u!==null&&u.tag===5&&u.type==="form"?gc(u):Ks.r(o)}var od=typeof document>"u"?null:document;function G2(o,u,f){var v=od;if(v&&typeof u=="string"&&u){var g=vi(u);g='link[rel="'+o+'"][href="'+g+'"]',typeof f=="string"&&(g+='[crossorigin="'+f+'"]'),X2.has(g)||(X2.add(g),o={rel:o,crossOrigin:f,href:u},v.querySelector(g)===null&&(u=v.createElement("link"),gi(u,"link",o),Zr(u),v.head.appendChild(u)))}}function N7(o){Ks.D(o),G2("dns-prefetch",o,null)}function I7(o,u){Ks.C(o,u),G2("preconnect",o,u)}function P7(o,u,f){Ks.L(o,u,f);var v=od;if(v&&o&&u){var g='link[rel="preload"][as="'+vi(u)+'"]';u==="image"&&f&&f.imageSrcSet?(g+='[imagesrcset="'+vi(f.imageSrcSet)+'"]',typeof f.imageSizes=="string"&&(g+='[imagesizes="'+vi(f.imageSizes)+'"]')):g+='[href="'+vi(o)+'"]';var S=g;switch(u){case"style":S=sd(o);break;case"script":S=ud(o)}za.has(S)||(o=p({rel:"preload",href:u==="image"&&f&&f.imageSrcSet?void 0:o,as:u},f),za.set(S,o),v.querySelector(g)!==null||u==="style"&&v.querySelector(fp(S))||u==="script"&&v.querySelector(dp(S))||(u=v.createElement("link"),gi(u,"link",o),Zr(u),v.head.appendChild(u)))}}function D7(o,u){Ks.m(o,u);var f=od;if(f&&o){var v=u&&typeof u.as=="string"?u.as:"script",g='link[rel="modulepreload"][as="'+vi(v)+'"][href="'+vi(o)+'"]',S=g;switch(v){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":S=ud(o)}if(!za.has(S)&&(o=p({rel:"modulepreload",href:o},u),za.set(S,o),f.querySelector(g)===null)){switch(v){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(f.querySelector(dp(S)))return}v=f.createElement("link"),gi(v,"link",o),Zr(v),f.head.appendChild(v)}}}function L7(o,u,f){Ks.S(o,u,f);var v=od;if(v&&o){var g=Na(v).hoistableStyles,S=sd(o);u=u||"default";var I=g.get(S);if(!I){var G={loading:0,preload:null};if(I=v.querySelector(fp(S)))G.loading=5;else{o=p({rel:"stylesheet",href:o,"data-precedence":u},f),(f=za.get(S))&&Ky(o,f);var le=I=v.createElement("link");Zr(le),gi(le,"link",o),le._p=new Promise(function(Ne,tt){le.onload=Ne,le.onerror=tt}),le.addEventListener("load",function(){G.loading|=1}),le.addEventListener("error",function(){G.loading|=2}),G.loading|=4,p_(I,u,v)}I={type:"stylesheet",instance:I,count:1,state:G},g.set(S,I)}}}function B7(o,u){Ks.X(o,u);var f=od;if(f&&o){var v=Na(f).hoistableScripts,g=ud(o),S=v.get(g);S||(S=f.querySelector(dp(g)),S||(o=p({src:o,async:!0},u),(u=za.get(g))&&Qy(o,u),S=f.createElement("script"),Zr(S),gi(S,"link",o),f.head.appendChild(S)),S={type:"script",instance:S,count:1,state:null},v.set(g,S))}}function F7(o,u){Ks.M(o,u);var f=od;if(f&&o){var v=Na(f).hoistableScripts,g=ud(o),S=v.get(g);S||(S=f.querySelector(dp(g)),S||(o=p({src:o,async:!0,type:"module"},u),(u=za.get(g))&&Qy(o,u),S=f.createElement("script"),Zr(S),gi(S,"link",o),f.head.appendChild(S)),S={type:"script",instance:S,count:1,state:null},v.set(g,S))}}function q2(o,u,f,v){var g=(g=Ct.current)?h_(g):null;if(!g)throw Error(n(446));switch(o){case"meta":case"title":return null;case"style":return typeof f.precedence=="string"&&typeof f.href=="string"?(u=sd(f.href),f=Na(g).hoistableStyles,v=f.get(u),v||(v={type:"style",instance:null,count:0,state:null},f.set(u,v)),v):{type:"void",instance:null,count:0,state:null};case"link":if(f.rel==="stylesheet"&&typeof f.href=="string"&&typeof f.precedence=="string"){o=sd(f.href);var S=Na(g).hoistableStyles,I=S.get(o);if(I||(g=g.ownerDocument||g,I={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},S.set(o,I),(S=g.querySelector(fp(o)))&&!S._p&&(I.instance=S,I.state.loading=5),za.has(o)||(f={rel:"preload",as:"style",href:f.href,crossOrigin:f.crossOrigin,integrity:f.integrity,media:f.media,hrefLang:f.hrefLang,referrerPolicy:f.referrerPolicy},za.set(o,f),S||U7(g,o,f,I.state))),u&&v===null)throw Error(n(528,""));return I}if(u&&v!==null)throw Error(n(529,""));return null;case"script":return u=f.async,f=f.src,typeof f=="string"&&u&&typeof u!="function"&&typeof u!="symbol"?(u=ud(f),f=Na(g).hoistableScripts,v=f.get(u),v||(v={type:"script",instance:null,count:0,state:null},f.set(u,v)),v):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,o))}}function sd(o){return'href="'+vi(o)+'"'}function fp(o){return'link[rel="stylesheet"]['+o+"]"}function W2(o){return p({},o,{"data-precedence":o.precedence,precedence:null})}function U7(o,u,f,v){o.querySelector('link[rel="preload"][as="style"]['+u+"]")?v.loading=1:(u=o.createElement("link"),v.preload=u,u.addEventListener("load",function(){return v.loading|=1}),u.addEventListener("error",function(){return v.loading|=2}),gi(u,"link",f),Zr(u),o.head.appendChild(u))}function ud(o){return'[src="'+vi(o)+'"]'}function dp(o){return"script[async]"+o}function Y2(o,u,f){if(u.count++,u.instance===null)switch(u.type){case"style":var v=o.querySelector('style[data-href~="'+vi(f.href)+'"]');if(v)return u.instance=v,Zr(v),v;var g=p({},f,{"data-href":f.href,"data-precedence":f.precedence,href:null,precedence:null});return v=(o.ownerDocument||o).createElement("style"),Zr(v),gi(v,"style",g),p_(v,f.precedence,o),u.instance=v;case"stylesheet":g=sd(f.href);var S=o.querySelector(fp(g));if(S)return u.state.loading|=4,u.instance=S,Zr(S),S;v=W2(f),(g=za.get(g))&&Ky(v,g),S=(o.ownerDocument||o).createElement("link"),Zr(S);var I=S;return I._p=new Promise(function(G,le){I.onload=G,I.onerror=le}),gi(S,"link",v),u.state.loading|=4,p_(S,f.precedence,o),u.instance=S;case"script":return S=ud(f.src),(g=o.querySelector(dp(S)))?(u.instance=g,Zr(g),g):(v=f,(g=za.get(S))&&(v=p({},f),Qy(v,g)),o=o.ownerDocument||o,g=o.createElement("script"),Zr(g),gi(g,"link",v),o.head.appendChild(g),u.instance=g);case"void":return null;default:throw Error(n(443,u.type))}else u.type==="stylesheet"&&(u.state.loading&4)===0&&(v=u.instance,u.state.loading|=4,p_(v,f.precedence,o));return u.instance}function p_(o,u,f){for(var v=f.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),g=v.length?v[v.length-1]:null,S=g,I=0;I<v.length;I++){var G=v[I];if(G.dataset.precedence===u)S=G;else if(S!==g)break}S?S.parentNode.insertBefore(o,S.nextSibling):(u=f.nodeType===9?f.head:f,u.insertBefore(o,u.firstChild))}function Ky(o,u){o.crossOrigin==null&&(o.crossOrigin=u.crossOrigin),o.referrerPolicy==null&&(o.referrerPolicy=u.referrerPolicy),o.title==null&&(o.title=u.title)}function Qy(o,u){o.crossOrigin==null&&(o.crossOrigin=u.crossOrigin),o.referrerPolicy==null&&(o.referrerPolicy=u.referrerPolicy),o.integrity==null&&(o.integrity=u.integrity)}var v_=null;function $2(o,u,f){if(v_===null){var v=new Map,g=v_=new Map;g.set(f,v)}else g=v_,v=g.get(f),v||(v=new Map,g.set(f,v));if(v.has(o))return v;for(v.set(o,null),f=f.getElementsByTagName(o),g=0;g<f.length;g++){var S=f[g];if(!(S[Ss]||S[On]||o==="link"&&S.getAttribute("rel")==="stylesheet")&&S.namespaceURI!=="http://www.w3.org/2000/svg"){var I=S.getAttribute(u)||"";I=o+I;var G=v.get(I);G?G.push(S):v.set(I,[S])}}return v}function Z2(o,u,f){o=o.ownerDocument||o,o.head.insertBefore(f,u==="title"?o.querySelector("head > title"):null)}function k7(o,u,f){if(f===1||u.itemProp!=null)return!1;switch(o){case"meta":case"title":return!0;case"style":if(typeof u.precedence!="string"||typeof u.href!="string"||u.href==="")break;return!0;case"link":if(typeof u.rel!="string"||typeof u.href!="string"||u.href===""||u.onLoad||u.onError)break;switch(u.rel){case"stylesheet":return o=u.disabled,typeof u.precedence=="string"&&o==null;default:return!0}case"script":if(u.async&&typeof u.async!="function"&&typeof u.async!="symbol"&&!u.onLoad&&!u.onError&&u.src&&typeof u.src=="string")return!0}return!1}function K2(o){return!(o.type==="stylesheet"&&(o.state.loading&3)===0)}var hp=null;function z7(){}function j7(o,u,f){if(hp===null)throw Error(n(475));var v=hp;if(u.type==="stylesheet"&&(typeof f.media!="string"||matchMedia(f.media).matches!==!1)&&(u.state.loading&4)===0){if(u.instance===null){var g=sd(f.href),S=o.querySelector(fp(g));if(S){o=S._p,o!==null&&typeof o=="object"&&typeof o.then=="function"&&(v.count++,v=m_.bind(v),o.then(v,v)),u.state.loading|=4,u.instance=S,Zr(S);return}S=o.ownerDocument||o,f=W2(f),(g=za.get(g))&&Ky(f,g),S=S.createElement("link"),Zr(S);var I=S;I._p=new Promise(function(G,le){I.onload=G,I.onerror=le}),gi(S,"link",f),u.instance=S}v.stylesheets===null&&(v.stylesheets=new Map),v.stylesheets.set(u,o),(o=u.state.preload)&&(u.state.loading&3)===0&&(v.count++,u=m_.bind(v),o.addEventListener("load",u),o.addEventListener("error",u))}}function H7(){if(hp===null)throw Error(n(475));var o=hp;return o.stylesheets&&o.count===0&&Jy(o,o.stylesheets),0<o.count?function(u){var f=setTimeout(function(){if(o.stylesheets&&Jy(o,o.stylesheets),o.unsuspend){var v=o.unsuspend;o.unsuspend=null,v()}},6e4);return o.unsuspend=u,function(){o.unsuspend=null,clearTimeout(f)}}:null}function m_(){if(this.count--,this.count===0){if(this.stylesheets)Jy(this,this.stylesheets);else if(this.unsuspend){var o=this.unsuspend;this.unsuspend=null,o()}}}var __=null;function Jy(o,u){o.stylesheets=null,o.unsuspend!==null&&(o.count++,__=new Map,u.forEach(V7,o),__=null,m_.call(o))}function V7(o,u){if(!(u.state.loading&4)){var f=__.get(o);if(f)var v=f.get(null);else{f=new Map,__.set(o,f);for(var g=o.querySelectorAll("link[data-precedence],style[data-precedence]"),S=0;S<g.length;S++){var I=g[S];(I.nodeName==="LINK"||I.getAttribute("media")!=="not all")&&(f.set(I.dataset.precedence,I),v=I)}v&&f.set(null,v)}g=u.instance,I=g.getAttribute("data-precedence"),S=f.get(I)||v,S===v&&f.set(null,g),f.set(I,g),this.count++,v=m_.bind(this),g.addEventListener("load",v),g.addEventListener("error",v),S?S.parentNode.insertBefore(g,S.nextSibling):(o=o.nodeType===9?o.head:o,o.insertBefore(g,o.firstChild)),u.state.loading|=4}}var pp={$$typeof:R,Provider:null,Consumer:null,_currentValue:z,_currentValue2:z,_threadCount:0};function X7(o,u,f,v,g,S,I,G){this.tag=1,this.containerInfo=o,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Es(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Es(0),this.hiddenUpdates=Es(null),this.identifierPrefix=v,this.onUncaughtError=g,this.onCaughtError=S,this.onRecoverableError=I,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=G,this.incompleteTransitions=new Map}function Q2(o,u,f,v,g,S,I,G,le,Ne,tt,ct){return o=new X7(o,u,f,I,G,le,Ne,ct),u=1,S===!0&&(u|=24),S=Ri(3,null,null,u),o.current=S,S.stateNode=o,u=kh(),u.refCount++,o.pooledCache=u,u.refCount++,S.memoizedState={element:v,isDehydrated:f,cache:u},Xh(S),o}function J2(o){return o?(o=Ps,o):Ps}function eC(o,u,f,v,g,S){g=J2(g),v.context===null?v.context=g:v.pendingContext=g,v=ki(u),v.payload={element:f},S=S===void 0?null:S,S!==null&&(v.callback=S),f=Qo(o,v,u),f!==null&&(Ea(f,o,u),Fa(f,o,u))}function tC(o,u){if(o=o.memoizedState,o!==null&&o.dehydrated!==null){var f=o.retryLane;o.retryLane=f!==0&&f<u?f:u}}function eE(o,u){tC(o,u),(o=o.alternate)&&tC(o,u)}function rC(o){if(o.tag===13){var u=ha(o,67108864);u!==null&&Ea(u,o,67108864),eE(o,67108864)}}var g_=!0;function G7(o,u,f,v){var g=O.T;O.T=null;var S=F.p;try{F.p=2,tE(o,u,f,v)}finally{F.p=S,O.T=g}}function q7(o,u,f,v){var g=O.T;O.T=null;var S=F.p;try{F.p=8,tE(o,u,f,v)}finally{F.p=S,O.T=g}}function tE(o,u,f,v){if(g_){var g=rE(v);if(g===null)Hy(o,u,v,y_,f),iC(o,v);else if(Y7(g,o,u,f,v))v.stopPropagation();else if(iC(o,v),u&4&&-1<W7.indexOf(o)){for(;g!==null;){var S=io(g);if(S!==null)switch(S.tag){case 3:if(S=S.stateNode,S.current.memoizedState.isDehydrated){var I=Yi(S.pendingLanes);if(I!==0){var G=S;for(G.pendingLanes|=2,G.entangledLanes|=2;I;){var le=1<<31-yr(I);G.entanglements[1]|=le,I&=~le}as(S),(Bt&6)===0&&(r_=xt()+500,sp(0))}}break;case 13:G=ha(S,2),G!==null&&Ea(G,S,2),i_(),eE(S,2)}if(S=rE(v),S===null&&Hy(o,u,v,y_,f),S===g)break;g=S}g!==null&&v.stopPropagation()}else Hy(o,u,v,null,f)}}function rE(o){return o=bi(o),nE(o)}var y_=null;function nE(o){if(y_=null,o=no(o),o!==null){var u=a(o);if(u===null)o=null;else{var f=u.tag;if(f===13){if(o=s(u),o!==null)return o;o=null}else if(f===3){if(u.stateNode.current.memoizedState.isDehydrated)return u.tag===3?u.stateNode.containerInfo:null;o=null}else u!==o&&(o=null)}}return y_=o,null}function nC(o){switch(o){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Xt()){case Or:return 2;case qr:return 8;case Tr:case zr:return 32;case V:return 268435456;default:return 32}default:return 32}}var iE=!1,il=null,al=null,ol=null,vp=new Map,mp=new Map,sl=[],W7="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function iC(o,u){switch(o){case"focusin":case"focusout":il=null;break;case"dragenter":case"dragleave":al=null;break;case"mouseover":case"mouseout":ol=null;break;case"pointerover":case"pointerout":vp.delete(u.pointerId);break;case"gotpointercapture":case"lostpointercapture":mp.delete(u.pointerId)}}function _p(o,u,f,v,g,S){return o===null||o.nativeEvent!==S?(o={blockedOn:u,domEventName:f,eventSystemFlags:v,nativeEvent:S,targetContainers:[g]},u!==null&&(u=io(u),u!==null&&rC(u)),o):(o.eventSystemFlags|=v,u=o.targetContainers,g!==null&&u.indexOf(g)===-1&&u.push(g),o)}function Y7(o,u,f,v,g){switch(u){case"focusin":return il=_p(il,o,u,f,v,g),!0;case"dragenter":return al=_p(al,o,u,f,v,g),!0;case"mouseover":return ol=_p(ol,o,u,f,v,g),!0;case"pointerover":var S=g.pointerId;return vp.set(S,_p(vp.get(S)||null,o,u,f,v,g)),!0;case"gotpointercapture":return S=g.pointerId,mp.set(S,_p(mp.get(S)||null,o,u,f,v,g)),!0}return!1}function aC(o){var u=no(o.target);if(u!==null){var f=a(u);if(f!==null){if(u=f.tag,u===13){if(u=s(f),u!==null){o.blockedOn=u,ch(o.priority,function(){if(f.tag===13){var v=ya();v=kl(v);var g=ha(f,v);g!==null&&Ea(g,f,v),eE(f,v)}});return}}else if(u===3&&f.stateNode.current.memoizedState.isDehydrated){o.blockedOn=f.tag===3?f.stateNode.containerInfo:null;return}}}o.blockedOn=null}function E_(o){if(o.blockedOn!==null)return!1;for(var u=o.targetContainers;0<u.length;){var f=rE(o.nativeEvent);if(f===null){f=o.nativeEvent;var v=new f.constructor(f.type,f);Mn=v,f.target.dispatchEvent(v),Mn=null}else return u=io(f),u!==null&&rC(u),o.blockedOn=f,!1;u.shift()}return!0}function oC(o,u,f){E_(o)&&f.delete(u)}function $7(){iE=!1,il!==null&&E_(il)&&(il=null),al!==null&&E_(al)&&(al=null),ol!==null&&E_(ol)&&(ol=null),vp.forEach(oC),mp.forEach(oC)}function T_(o,u){o.blockedOn===u&&(o.blockedOn=null,iE||(iE=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,$7)))}var S_=null;function sC(o){S_!==o&&(S_=o,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){S_===o&&(S_=null);for(var u=0;u<o.length;u+=3){var f=o[u],v=o[u+1],g=o[u+2];if(typeof v!="function"){if(nE(v||f)===null)continue;break}var S=io(f);S!==null&&(o.splice(u,3),u-=3,Yu(S,{pending:!0,data:g,method:f.method,action:v},v,g))}}))}function gp(o){function u(le){return T_(le,o)}il!==null&&T_(il,o),al!==null&&T_(al,o),ol!==null&&T_(ol,o),vp.forEach(u),mp.forEach(u);for(var f=0;f<sl.length;f++){var v=sl[f];v.blockedOn===o&&(v.blockedOn=null)}for(;0<sl.length&&(f=sl[0],f.blockedOn===null);)aC(f),f.blockedOn===null&&sl.shift();if(f=(o.ownerDocument||o).$$reactFormReplay,f!=null)for(v=0;v<f.length;v+=3){var g=f[v],S=f[v+1],I=g[oi]||null;if(typeof S=="function")I||sC(f);else if(I){var G=null;if(S&&S.hasAttribute("formAction")){if(g=S,I=S[oi]||null)G=I.formAction;else if(nE(g)!==null)continue}else G=I.action;typeof G=="function"?f[v+1]=G:(f.splice(v,3),v-=3),sC(f)}}}function aE(o){this._internalRoot=o}A_.prototype.render=aE.prototype.render=function(o){var u=this._internalRoot;if(u===null)throw Error(n(409));var f=u.current,v=ya();eC(f,v,o,u,null,null)},A_.prototype.unmount=aE.prototype.unmount=function(){var o=this._internalRoot;if(o!==null){this._internalRoot=null;var u=o.containerInfo;eC(o.current,2,null,o,null,null),i_(),u[Fo]=null}};function A_(o){this._internalRoot=o}A_.prototype.unstable_scheduleHydration=function(o){if(o){var u=tf();o={blockedOn:null,target:o,priority:u};for(var f=0;f<sl.length&&u!==0&&u<sl[f].priority;f++);sl.splice(f,0,o),f===0&&aC(o)}};var uC=t.version;if(uC!=="19.1.1")throw Error(n(527,uC,"19.1.1"));F.findDOMNode=function(o){var u=o._reactInternals;if(u===void 0)throw typeof o.render=="function"?Error(n(188)):(o=Object.keys(o).join(","),Error(n(268,o)));return o=c(u),o=o!==null?d(o):null,o=o===null?null:o.stateNode,o};var Z7={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:O,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var b_=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!b_.isDisabled&&b_.supportsFiber)try{Hn=b_.inject(Z7),un=b_}catch{}}return Ap.createRoot=function(o,u){if(!i(o))throw Error(n(299));var f=!1,v="",g=Km,S=Qm,I=Jm,G=null;return u!=null&&(u.unstable_strictMode===!0&&(f=!0),u.identifierPrefix!==void 0&&(v=u.identifierPrefix),u.onUncaughtError!==void 0&&(g=u.onUncaughtError),u.onCaughtError!==void 0&&(S=u.onCaughtError),u.onRecoverableError!==void 0&&(I=u.onRecoverableError),u.unstable_transitionCallbacks!==void 0&&(G=u.unstable_transitionCallbacks)),u=Q2(o,1,!1,null,null,f,v,g,S,I,G,null),o[Fo]=u.current,jy(o),new aE(u)},Ap.hydrateRoot=function(o,u,f){if(!i(o))throw Error(n(299));var v=!1,g="",S=Km,I=Qm,G=Jm,le=null,Ne=null;return f!=null&&(f.unstable_strictMode===!0&&(v=!0),f.identifierPrefix!==void 0&&(g=f.identifierPrefix),f.onUncaughtError!==void 0&&(S=f.onUncaughtError),f.onCaughtError!==void 0&&(I=f.onCaughtError),f.onRecoverableError!==void 0&&(G=f.onRecoverableError),f.unstable_transitionCallbacks!==void 0&&(le=f.unstable_transitionCallbacks),f.formState!==void 0&&(Ne=f.formState)),u=Q2(o,1,!0,u,f??null,v,g,S,I,G,le,Ne),u.context=J2(null),f=u.current,v=ya(),v=kl(v),g=ki(v),g.callback=null,Qo(f,g,v),f=v,u.current.lanes=f,ro(u,f),as(u),o[Fo]=u.current,jy(o),new A_(u)},Ap.version="19.1.1",Ap}var HC;function E9(){if(HC)return mE.exports;HC=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),mE.exports=y9(),mE.exports}var T9=E9();const S9=q.createContext(void 0),A9=({children:e})=>{const[t,r]=q.useState(""),[n,i]=q.useState(!1),a=()=>{r(""),i(!1)},s=q.useMemo(()=>({searchQuery:t,setSearchQuery:r,isSearching:n,setIsSearching:i,clearSearch:a}),[t,n]);return ze.jsx(S9.Provider,{value:s,children:e})},b9=new R8({defaultOptions:{queries:{staleTime:300*1e3,gcTime:600*1e3,retry:2,retryDelay:e=>Math.min(1e3*2**e,3e4),refetchOnWindowFocus:!1,refetchOnReconnect:!0},mutations:{retry:1}}});function x9(){return ze.jsx("div",{className:"min-h-screen bg-background text-foreground",children:ze.jsx("main",{className:"py-0 px-0",children:ze.jsx(dL,{})})})}function R9({title:e,description:t}){return ze.jsxs("div",{className:"p-6 bg-card border rounded-lg",children:[ze.jsx("h3",{className:"text-xl font-semibold mb-2",children:e}),ze.jsx("p",{className:"text-muted-foreground",children:t})]})}const C9=[{title:"React 19",description:"最新的 React 版本，带来更好的性能和开发体验"},{title:"TanStack Router",description:"类型安全的路由管理，支持预加载和缓存"},{title:"TailwindCSS v4",description:"原子化 CSS 框架，快速构建现代化界面"}];function O9(){return ze.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:C9.map(e=>ze.jsx(R9,{title:e.title,description:e.description},e.title))})}function M9(){return ze.jsxs("div",{className:"text-center",children:[ze.jsx("h2",{className:"text-3xl font-bold mb-4",children:"欢迎来到 SKER 项目"}),ze.jsx("p",{className:"text-lg text-muted-foreground",children:"这是一个基于 React 19 + TanStack Router 的现代化前端应用"})]})}function w9(){return ze.jsxs("div",{className:"space-y-6",children:[ze.jsx(M9,{}),ze.jsx(O9,{}),ze.jsx("div",{className:"text-center pt-8",children:ze.jsx(zx,{to:"/dashboard",className:"inline-flex items-center px-6 py-3 bg-primary text-primary-foreground rounded-lg font-medium hover:bg-primary/90 transition-colors",children:"进入舆情分析大屏 →"})})]})}function N9({data:e,type:t,height:r=200}){const n=Math.max(...e.map(i=>i.value));if(t==="bar")return ze.jsx("div",{className:"chart-container",style:{height:r},children:ze.jsx("div",{className:"flex items-end justify-between h-full gap-2 p-4",children:e.map((i,a)=>ze.jsxs("div",{className:"flex flex-col items-center flex-1",children:[ze.jsx("div",{className:"w-full bg-gradient-to-t from-blue-500 to-blue-400 rounded-t",style:{height:`${i.value/n*80}%`,backgroundColor:i.color||"var(--primary)"}}),ze.jsx("div",{className:"text-xs mt-2 text-center",children:i.label}),ze.jsx("div",{className:"text-sm font-semibold",children:i.value})]},a))})});if(t==="pie"){const i=e.reduce((a,s)=>a+s.value,0);return ze.jsx("div",{className:"chart-container flex items-center justify-center",style:{height:r},children:ze.jsx("div",{className:"grid grid-cols-2 gap-4 w-full",children:e.map((a,s)=>{const l=(a.value/i*100).toFixed(1);return ze.jsxs("div",{className:"flex items-center gap-2",children:[ze.jsx("div",{className:"w-4 h-4 rounded",style:{backgroundColor:a.color||`var(--chart-${s%6+1})`}}),ze.jsxs("div",{className:"text-sm",children:[ze.jsx("div",{children:a.label}),ze.jsxs("div",{className:"font-semibold",children:[l,"%"]})]})]},s)})})})}return ze.jsx("div",{className:"chart-container flex items-center justify-center",style:{height:r},children:ze.jsx("div",{className:"text-muted-foreground",children:"图表加载中..."})})}function ll({title:e,icon:t,children:r,className:n=""}){return ze.jsxs("div",{className:`dashboard-card ${n}`,children:[ze.jsxs("div",{className:"dashboard-card-title",children:[t,ze.jsx("span",{children:e})]}),ze.jsx("div",{className:"dashboard-card-content",children:r})]})}function I_({title:e,value:t,trend:r,trendValue:n,icon:i}){const a=()=>{switch(r){case"up":return"trend-up";case"down":return"trend-down";case"neutral":return"trend-neutral";default:return""}},s=()=>{switch(r){case"up":return"↗";case"down":return"↘";case"neutral":return"→";default:return""}};return ze.jsxs("div",{className:"metric-card",children:[i&&ze.jsx("div",{className:"metric-icon",children:i}),ze.jsx("div",{className:"metric-value",children:t}),ze.jsx("div",{className:"metric-label",children:e}),r&&n&&ze.jsxs("div",{className:`trend-indicator ${a()}`,children:[ze.jsx("span",{children:s()}),ze.jsx("span",{children:n})]})]})}var hL={},pL={},VC=e=>pL[e],Ca=(e,t)=>{pL[e]=t},I9=e=>hL[e],rh=(e,t)=>{hL[e]=t},XC={},yE={},EE=34,bp=10,TE=13;function vL(e){return new Function("d","return {"+e.map(function(t,r){return JSON.stringify(t)+": d["+r+'] || ""'}).join(",")+"}")}function P9(e,t){var r=vL(e);return function(n,i){return t(r(n),i,e)}}function GC(e){var t=Object.create(null),r=[];return e.forEach(function(n){for(var i in n)i in t||r.push(t[i]=i)}),r}function ra(e,t){var r=e+"",n=r.length;return n<t?new Array(t-n+1).join(0)+r:r}function D9(e){return e<0?"-"+ra(-e,6):e>9999?"+"+ra(e,6):ra(e,4)}function L9(e){var t=e.getUTCHours(),r=e.getUTCMinutes(),n=e.getUTCSeconds(),i=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":D9(e.getUTCFullYear())+"-"+ra(e.getUTCMonth()+1,2)+"-"+ra(e.getUTCDate(),2)+(i?"T"+ra(t,2)+":"+ra(r,2)+":"+ra(n,2)+"."+ra(i,3)+"Z":n?"T"+ra(t,2)+":"+ra(r,2)+":"+ra(n,2)+"Z":r||t?"T"+ra(t,2)+":"+ra(r,2)+"Z":"")}function B9(e){var t=new RegExp('["'+e+`
\r]`),r=e.charCodeAt(0);function n(h,m){var _,y,E=i(h,function(T,A){if(_)return _(T,A-1);y=T,_=m?P9(T,m):vL(T)});return E.columns=y||[],E}function i(h,m){var _=[],y=h.length,E=0,T=0,A,b=y<=0,R=!1;h.charCodeAt(y-1)===bp&&--y,h.charCodeAt(y-1)===TE&&--y;function M(){if(b)return yE;if(R)return R=!1,XC;var w,D=E,U;if(h.charCodeAt(D)===EE){for(;E++<y&&h.charCodeAt(E)!==EE||h.charCodeAt(++E)===EE;);return(w=E)>=y?b=!0:(U=h.charCodeAt(E++))===bp?R=!0:U===TE&&(R=!0,h.charCodeAt(E)===bp&&++E),h.slice(D+1,w-1).replace(/""/g,'"')}for(;E<y;){if((U=h.charCodeAt(w=E++))===bp)R=!0;else if(U===TE)R=!0,h.charCodeAt(E)===bp&&++E;else if(U!==r)continue;return h.slice(D,w)}return b=!0,h.slice(D,y)}for(;(A=M())!==yE;){for(var B=[];A!==XC&&A!==yE;)B.push(A),A=M();m&&(B=m(B,T++))==null||_.push(B)}return _}function a(h,m){return h.map(function(_){return m.map(function(y){return p(_[y])}).join(e)})}function s(h,m){return m==null&&(m=GC(h)),[m.map(p).join(e)].concat(a(h,m)).join(`
`)}function l(h,m){return m==null&&(m=GC(h)),a(h,m).join(`
`)}function c(h){return h.map(d).join(`
`)}function d(h){return h.map(p).join(e)}function p(h){return h==null?"":h instanceof Date?L9(h):t.test(h+="")?'"'+h.replace(/"/g,'""')+'"':h}return{parse:n,parseRows:i,format:s,formatBody:l,formatRows:c,formatRow:d,formatValue:p}}var F9=B9(","),U9=F9.parse;function bv(e,t,r){r===void 0&&(r={});var n={type:"Feature"};return(r.id===0||r.id)&&(n.id=r.id),r.bbox&&(n.bbox=r.bbox),n.properties=t||{},n.geometry=e,n}function Hx(e,t,r){r===void 0&&(r={});for(var n=0,i=e;n<i.length;n++){var a=i[n];if(a.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var s=0;s<a[a.length-1].length;s++)if(a[a.length-1][s]!==a[0][s])throw new Error("First and last Position are not equivalent.")}var l={type:"Polygon",coordinates:e};return bv(l,t,r)}function k9(e,t,r){if(r===void 0&&(r={}),e.length<2)throw new Error("coordinates must be an array of two or more positions");var n={type:"LineString",coordinates:e};return bv(n,t,r)}function z9(e,t){t===void 0&&(t={});var r={type:"FeatureCollection"};return t.id&&(r.id=t.id),t.bbox&&(r.bbox=t.bbox),r.features=e,r}function j9(e,t,r){r===void 0&&(r={});var n={type:"MultiPolygon",coordinates:e};return bv(n,t,r)}function mL(e){if(Array.isArray(e))return e;if(e.type==="Feature"){if(e.geometry!==null)return e.geometry.coordinates}else if(e.coordinates)return e.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function qC(e){return e.type==="Feature"?e.geometry:e}function _L(e,t,r){if(e!==null)for(var n,i,a,s,l,c,d,p=0,h=0,m,_=e.type,y=_==="FeatureCollection",E=_==="Feature",T=y?e.features.length:1,A=0;A<T;A++){d=y?e.features[A].geometry:E?e.geometry:e,m=d?d.type==="GeometryCollection":!1,l=m?d.geometries.length:1;for(var b=0;b<l;b++){var R=0,M=0;if(s=m?d.geometries[b]:d,s!==null){c=s.coordinates;var B=s.type;switch(p=0,B){case null:break;case"Point":if(t(c,h,A,R,M)===!1)return!1;h++,R++;break;case"LineString":case"MultiPoint":for(n=0;n<c.length;n++){if(t(c[n],h,A,R,M)===!1)return!1;h++,B==="MultiPoint"&&R++}B==="LineString"&&R++;break;case"Polygon":case"MultiLineString":for(n=0;n<c.length;n++){for(i=0;i<c[n].length-p;i++){if(t(c[n][i],h,A,R,M)===!1)return!1;h++}B==="MultiLineString"&&R++,B==="Polygon"&&M++}B==="Polygon"&&R++;break;case"MultiPolygon":for(n=0;n<c.length;n++){for(M=0,i=0;i<c[n].length;i++){for(a=0;a<c[n][i].length-p;a++){if(t(c[n][i][a],h,A,R,M)===!1)return!1;h++}M++}R++}break;case"GeometryCollection":for(n=0;n<s.geometries.length;n++)if(_L(s.geometries[n],t)===!1)return!1;break;default:throw new Error("Unknown Geometry Type")}}}}}function H9(e,t){var r,n,i,a,s,l,c,d,p,h,m=0,_=e.type==="FeatureCollection",y=e.type==="Feature",E=_?e.features.length:1;for(r=0;r<E;r++){for(l=_?e.features[r].geometry:y?e.geometry:e,d=_?e.features[r].properties:y?e.properties:{},p=_?e.features[r].bbox:y?e.bbox:void 0,h=_?e.features[r].id:y?e.id:void 0,c=l?l.type==="GeometryCollection":!1,s=c?l.geometries.length:1,i=0;i<s;i++){if(a=c?l.geometries[i]:l,a===null){if(t(null,m,d,p,h)===!1)return!1;continue}switch(a.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":{if(t(a,m,d,p,h)===!1)return!1;break}case"GeometryCollection":{for(n=0;n<a.geometries.length;n++)if(t(a.geometries[n],m,d,p,h)===!1)return!1;break}default:throw new Error("Unknown Geometry Type")}}m++}}function gL(e,t){H9(e,function(r,n,i,a,s){var l=r===null?null:r.type;switch(l){case null:case"Point":case"LineString":case"Polygon":return t(bv(r,i,{bbox:a,id:s}),n,0)===!1?!1:void 0}var c;switch(l){case"MultiPoint":c="Point";break;case"MultiLineString":c="LineString";break;case"MultiPolygon":c="Polygon";break}for(var d=0;d<r.coordinates.length;d++){var p=r.coordinates[d],h={type:c,coordinates:p};if(t(bv(h,i),n,d)===!1)return!1}})}var s0={REGISTERED_PROTOCOLS:{}},V9=Object.defineProperty,X9=Object.defineProperties,G9=Object.getOwnPropertyDescriptors,WC=Object.getOwnPropertySymbols,q9=Object.prototype.hasOwnProperty,W9=Object.prototype.propertyIsEnumerable,YC=(e,t,r)=>t in e?V9(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Vx=(e,t)=>{for(var r in t||(t={}))q9.call(t,r)&&YC(e,r,t[r]);if(WC)for(var r of WC(t))W9.call(t,r)&&YC(e,r,t[r]);return e},Xx=(e,t)=>X9(e,G9(t)),Gx=e=>s0.REGISTERED_PROTOCOLS[e.substring(0,e.indexOf("://"))],Y9=class extends Error{constructor(e,t,r,n){super(`AJAXError: ${t} (${e}): ${r}`),this.status=e,this.statusText=t,this.url=r,this.body=n}};function yL(e,t){const r=new XMLHttpRequest,n=Array.isArray(e.url)?e.url[0]:e.url;r.open(e.method||"GET",n,!0),e.type==="arrayBuffer"&&(r.responseType="arraybuffer");for(const i in e.headers)e.headers.hasOwnProperty(i)&&r.setRequestHeader(i,e.headers[i]);return e.type==="json"&&(r.responseType="text",r.setRequestHeader("Accept","application/json")),r.withCredentials=e.credentials==="include",r.onerror=()=>{t(new Error(r.statusText))},r.onload=()=>{if((r.status>=200&&r.status<300||r.status===0)&&r.response!==null){let i=r.response;if(e.type==="json")try{i=JSON.parse(r.response)}catch(a){return t(a)}t(null,i,r.getResponseHeader("Cache-Control"),r.getResponseHeader("Expires"),r)}else{const i=new Blob([r.response],{type:r.getResponseHeader("Content-Type")});t(new Y9(r.status,r.statusText,n.toString(),i))}},r.cancel=r.abort,r.send(e.body),r}function $9(e){return new Promise((t,r)=>{yL(e,(n,i,a,s,l)=>{n?r({err:n,data:null,xhr:l}):t({err:null,data:i,cacheControl:a,expires:s,xhr:l})})})}function qx(e,t){return yL(e,t)}var Z9=(e,t)=>(Gx(e.url)||qx)(Xx(Vx({},e),{type:"json"}),t),Wx=(e,t)=>(Gx(e.url)||qx)(Xx(Vx({},e),{type:"arrayBuffer"}),t),K9=(e,t)=>qx(Xx(Vx({},e),{method:"GET"}),t),$C="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function EL(e,t){const r=new window.Image,n=window.URL||window.webkitURL;r.crossOrigin="anonymous",r.onload=()=>{t(null,r),n.revokeObjectURL(r.src),r.onload=null,window.requestAnimationFrame(()=>{r.src=$C})},r.onerror=()=>t(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const i=new Blob([new Uint8Array(e)],{type:"image/png"});r.src=e.byteLength?n.createObjectURL(i):$C}function TL(e,t){const r=new Blob([new Uint8Array(e)],{type:"image/png"});createImageBitmap(r).then(n=>{t(null,n)}).catch(n=>{t(new Error(`Could not load image because of ${n.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}var xb=(e,t,r)=>{const n=(i,a)=>{if(i)t(i);else if(a){const s=typeof createImageBitmap=="function",l=r?r(a):a;s?TL(l,t):EL(l,t)}};return e.type==="json"?Z9(e,n):Wx(e,n)},Q9=(e,t)=>{typeof createImageBitmap=="function"?TL(e,t):EL(e,t)};function Yx(e,t,r){e.prototype=t.prototype=r,r.constructor=e}function SL(e,t){var r=Object.create(e.prototype);for(var n in t)r[n]=t[n];return r}function Hv(){}var xv=.7,I0=1/xv,Od="\\s*([+-]?\\d+)\\s*",Rv="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)\\s*",ds="\\s*([+-]?\\d*\\.?\\d+(?:[eE][+-]?\\d+)?)%\\s*",J9=/^#([0-9a-f]{3,8})$/,ez=new RegExp("^rgb\\("+[Od,Od,Od]+"\\)$"),tz=new RegExp("^rgb\\("+[ds,ds,ds]+"\\)$"),rz=new RegExp("^rgba\\("+[Od,Od,Od,Rv]+"\\)$"),nz=new RegExp("^rgba\\("+[ds,ds,ds,Rv]+"\\)$"),iz=new RegExp("^hsl\\("+[Rv,ds,ds]+"\\)$"),az=new RegExp("^hsla\\("+[Rv,ds,ds,Rv]+"\\)$"),ZC={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Yx(Hv,jd,{copy:function(e){return Object.assign(new this.constructor,this,e)},displayable:function(){return this.rgb().displayable()},hex:KC,formatHex:KC,formatHsl:oz,formatRgb:QC,toString:QC});function KC(){return this.rgb().formatHex()}function oz(){return AL(this).formatHsl()}function QC(){return this.rgb().formatRgb()}function jd(e){var t,r;return e=(e+"").trim().toLowerCase(),(t=J9.exec(e))?(r=t[1].length,t=parseInt(t[1],16),r===6?JC(t):r===3?new Aa(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):r===8?P_(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):r===4?P_(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=ez.exec(e))?new Aa(t[1],t[2],t[3],1):(t=tz.exec(e))?new Aa(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=rz.exec(e))?P_(t[1],t[2],t[3],t[4]):(t=nz.exec(e))?P_(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=iz.exec(e))?r3(t[1],t[2]/100,t[3]/100,1):(t=az.exec(e))?r3(t[1],t[2]/100,t[3]/100,t[4]):ZC.hasOwnProperty(e)?JC(ZC[e]):e==="transparent"?new Aa(NaN,NaN,NaN,0):null}function JC(e){return new Aa(e>>16&255,e>>8&255,e&255,1)}function P_(e,t,r,n){return n<=0&&(e=t=r=NaN),new Aa(e,t,r,n)}function sz(e){return e instanceof Hv||(e=jd(e)),e?(e=e.rgb(),new Aa(e.r,e.g,e.b,e.opacity)):new Aa}function P0(e,t,r,n){return arguments.length===1?sz(e):new Aa(e,t,r,n??1)}function Aa(e,t,r,n){this.r=+e,this.g=+t,this.b=+r,this.opacity=+n}Yx(Aa,P0,SL(Hv,{brighter:function(e){return e=e==null?I0:Math.pow(I0,e),new Aa(this.r*e,this.g*e,this.b*e,this.opacity)},darker:function(e){return e=e==null?xv:Math.pow(xv,e),new Aa(this.r*e,this.g*e,this.b*e,this.opacity)},rgb:function(){return this},displayable:function(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:e3,formatHex:e3,formatRgb:t3,toString:t3}));function e3(){return"#"+SE(this.r)+SE(this.g)+SE(this.b)}function t3(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"rgb(":"rgba(")+Math.max(0,Math.min(255,Math.round(this.r)||0))+", "+Math.max(0,Math.min(255,Math.round(this.g)||0))+", "+Math.max(0,Math.min(255,Math.round(this.b)||0))+(e===1?")":", "+e+")")}function SE(e){return e=Math.max(0,Math.min(255,Math.round(e)||0)),(e<16?"0":"")+e.toString(16)}function r3(e,t,r,n){return n<=0?e=t=r=NaN:r<=0||r>=1?e=t=NaN:t<=0&&(e=NaN),new ss(e,t,r,n)}function AL(e){if(e instanceof ss)return new ss(e.h,e.s,e.l,e.opacity);if(e instanceof Hv||(e=jd(e)),!e)return new ss;if(e instanceof ss)return e;e=e.rgb();var t=e.r/255,r=e.g/255,n=e.b/255,i=Math.min(t,r,n),a=Math.max(t,r,n),s=NaN,l=a-i,c=(a+i)/2;return l?(t===a?s=(r-n)/l+(r<n)*6:r===a?s=(n-t)/l+2:s=(t-r)/l+4,l/=c<.5?a+i:2-a-i,s*=60):l=c>0&&c<1?0:s,new ss(s,l,c,e.opacity)}function uz(e,t,r,n){return arguments.length===1?AL(e):new ss(e,t,r,n??1)}function ss(e,t,r,n){this.h=+e,this.s=+t,this.l=+r,this.opacity=+n}Yx(ss,uz,SL(Hv,{brighter:function(e){return e=e==null?I0:Math.pow(I0,e),new ss(this.h,this.s,this.l*e,this.opacity)},darker:function(e){return e=e==null?xv:Math.pow(xv,e),new ss(this.h,this.s,this.l*e,this.opacity)},rgb:function(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,r=this.l,n=r+(r<.5?r:1-r)*t,i=2*r-n;return new Aa(AE(e>=240?e-240:e+120,i,n),AE(e,i,n),AE(e<120?e+240:e-120,i,n),this.opacity)},displayable:function(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl:function(){var e=this.opacity;return e=isNaN(e)?1:Math.max(0,Math.min(1,e)),(e===1?"hsl(":"hsla(")+(this.h||0)+", "+(this.s||0)*100+"%, "+(this.l||0)*100+"%"+(e===1?")":", "+e+")")}}));function AE(e,t,r){return(e<60?t+(r-t)*e/60:e<180?r:e<240?t+(r-t)*(240-e)/60:t)*255}function $r(e){const t=jd(e),r=[0,0,0,0];return t!=null&&(r[0]=t.r/255,r[1]=t.g/255,r[2]=t.b/255,r[3]=t.opacity),r}function Dc(e){const t=e&&e[0],r=e&&e[1],n=e&&e[2];return t+r*256+n*65536-1}function Hd(e){return[e+1&255,e+1>>8&255,e+1>>8>>8&255]}function lz(e){let t=window.document.createElement("canvas"),r=t.getContext("2d");t.width=256,t.height=1;let n=null;const i=r.createLinearGradient(0,0,256,1),a=e.positions[0],s=e.positions[e.positions.length-1];for(let l=0;l<e.colors.length;++l){const c=(e.positions[l]-a)/(s-a);i.addColorStop(c,e.colors[l])}return r.fillStyle=i,r.fillRect(0,0,256,1),n=new Uint8ClampedArray(r.getImageData(0,0,256,1).data),t=null,r=null,{data:n,width:256,height:1}}function cz(e,t){let r=window.document.createElement("canvas"),n=r.getContext("2d");r.width=256,r.height=1;const i=n.createLinearGradient(0,0,256,1),a=t[1]-t[0];for(let c=0;c<e.colors.length;++c){const d=Math.max((e.positions[c]-t[0])/a,0);i.addColorStop(d,e.colors[c])}n.fillStyle=i,n.fillRect(0,0,256,1);const s=n.getImageData(0,0,256,1).data,l=$x(n,s);return r=null,n=null,l}function fz(e){let t=window.document.createElement("canvas"),r=t.getContext("2d");t.width=256,t.height=1;const n=r.createImageData(256,1);return n.data.fill(0),e.positions.forEach((i,a)=>{const s=$r(e.colors[a]);n.data[i*4+0]=s[0]*255,n.data[i*4+1]=s[1]*255,n.data[i*4+2]=s[2]*255,n.data[i*4+3]=s[3]*255}),t=null,r=null,n}function dz(e){let t=window.document.createElement("canvas"),r=t.getContext("2d");r.globalAlpha=1,t.width=256,t.height=1;const n=256/e.colors.length;for(let s=0;s<e.colors.length;s++)r.beginPath(),r.lineWidth=2,r.strokeStyle=e.colors[s],r.moveTo(s*n,0),r.lineTo((s+1)*n,0),r.stroke();const i=r.getImageData(0,0,256,1).data,a=$x(r,i);return t=null,r=null,a}function hz(e,t){let r=window.document.createElement("canvas"),n=r.getContext("2d");n.globalAlpha=1,r.width=256,r.height=1;const i=t[1]-t[0];e.positions.length-e.colors.length!==1&&console.warn("positions 的数字个数应当比 colors 的样式多一个,poisitions 的首尾值一般为数据的最大最新值");for(let l=0;l<e.colors.length;l++)n.beginPath(),n.lineWidth=2,n.strokeStyle=e.colors[l],n.moveTo((e.positions[l]-t[0])/i*255,0),n.lineTo((e.positions[l+1]-t[0])/i*255,0),n.stroke();const a=n.getImageData(0,0,256,1).data,s=$x(n,a);return r=null,n=null,s}function $x(e,t){const r=e.createImageData(256,1);for(let n=0;n<r.data.length;n+=4)r.data[n+0]=t[n+0],r.data[n+1]=t[n+1],r.data[n+2]=t[n+2],r.data[n+3]=t[n+3];return r}function Zx(e){switch(e?.type){case"cat":return[0,255];default:return[0,1]}}var bE,n3;function pz(){if(n3)return bE;n3=1;function e(t,r,n){return t===t&&(n!==void 0&&(t=t<=n?t:n),r!==void 0&&(t=t>=r?t:r)),t}return bE=e,bE}var xE,i3;function vz(){if(i3)return xE;i3=1;var e=/\s/;function t(r){for(var n=r.length;n--&&e.test(r.charAt(n)););return n}return xE=t,xE}var RE,a3;function mz(){if(a3)return RE;a3=1;var e=vz(),t=/^\s+/;function r(n){return n&&n.slice(0,e(n)+1).replace(t,"")}return RE=r,RE}var CE,o3;function Qa(){if(o3)return CE;o3=1;function e(t){var r=typeof t;return t!=null&&(r=="object"||r=="function")}return CE=e,CE}var OE,s3;function bL(){if(s3)return OE;s3=1;var e=typeof x_=="object"&&x_&&x_.Object===Object&&x_;return OE=e,OE}var ME,u3;function Do(){if(u3)return ME;u3=1;var e=bL(),t=typeof self=="object"&&self&&self.Object===Object&&self,r=e||t||Function("return this")();return ME=r,ME}var wE,l3;function Vv(){if(l3)return wE;l3=1;var e=Do(),t=e.Symbol;return wE=t,wE}var NE,c3;function _z(){if(c3)return NE;c3=1;var e=Vv(),t=Object.prototype,r=t.hasOwnProperty,n=t.toString,i=e?e.toStringTag:void 0;function a(s){var l=r.call(s,i),c=s[i];try{s[i]=void 0;var d=!0}catch{}var p=n.call(s);return d&&(l?s[i]=c:delete s[i]),p}return NE=a,NE}var IE,f3;function gz(){if(f3)return IE;f3=1;var e=Object.prototype,t=e.toString;function r(n){return t.call(n)}return IE=r,IE}var PE,d3;function uu(){if(d3)return PE;d3=1;var e=Vv(),t=_z(),r=gz(),n="[object Null]",i="[object Undefined]",a=e?e.toStringTag:void 0;function s(l){return l==null?l===void 0?i:n:a&&a in Object(l)?t(l):r(l)}return PE=s,PE}var DE,h3;function Ja(){if(h3)return DE;h3=1;function e(t){return t!=null&&typeof t=="object"}return DE=e,DE}var LE,p3;function wg(){if(p3)return LE;p3=1;var e=uu(),t=Ja(),r="[object Symbol]";function n(i){return typeof i=="symbol"||t(i)&&e(i)==r}return LE=n,LE}var BE,v3;function xL(){if(v3)return BE;v3=1;var e=mz(),t=Qa(),r=wg(),n=NaN,i=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,s=/^0o[0-7]+$/i,l=parseInt;function c(d){if(typeof d=="number")return d;if(r(d))return n;if(t(d)){var p=typeof d.valueOf=="function"?d.valueOf():d;d=t(p)?p+"":p}if(typeof d!="string")return d===0?d:+d;d=e(d);var h=a.test(d);return h||s.test(d)?l(d.slice(2),h?2:8):i.test(d)?n:+d}return BE=c,BE}var FE,m3;function yz(){if(m3)return FE;m3=1;var e=pz(),t=xL();function r(n,i,a){return a===void 0&&(a=i,i=void 0),a!==void 0&&(a=t(a),a=a===a?a:0),i!==void 0&&(i=t(i),i=i===i?i:0),e(t(n),i,a)}return FE=r,FE}var Ez=yz();const Tz=Pr(Ez);var UE,_3;function Sz(){if(_3)return UE;_3=1;function e(){this.__data__=[],this.size=0}return UE=e,UE}var kE,g3;function Xv(){if(g3)return kE;g3=1;function e(t,r){return t===r||t!==t&&r!==r}return kE=e,kE}var zE,y3;function Ng(){if(y3)return zE;y3=1;var e=Xv();function t(r,n){for(var i=r.length;i--;)if(e(r[i][0],n))return i;return-1}return zE=t,zE}var jE,E3;function Az(){if(E3)return jE;E3=1;var e=Ng(),t=Array.prototype,r=t.splice;function n(i){var a=this.__data__,s=e(a,i);if(s<0)return!1;var l=a.length-1;return s==l?a.pop():r.call(a,s,1),--this.size,!0}return jE=n,jE}var HE,T3;function bz(){if(T3)return HE;T3=1;var e=Ng();function t(r){var n=this.__data__,i=e(n,r);return i<0?void 0:n[i][1]}return HE=t,HE}var VE,S3;function xz(){if(S3)return VE;S3=1;var e=Ng();function t(r){return e(this.__data__,r)>-1}return VE=t,VE}var XE,A3;function Rz(){if(A3)return XE;A3=1;var e=Ng();function t(r,n){var i=this.__data__,a=e(i,r);return a<0?(++this.size,i.push([r,n])):i[a][1]=n,this}return XE=t,XE}var GE,b3;function Ig(){if(b3)return GE;b3=1;var e=Sz(),t=Az(),r=bz(),n=xz(),i=Rz();function a(s){var l=-1,c=s==null?0:s.length;for(this.clear();++l<c;){var d=s[l];this.set(d[0],d[1])}}return a.prototype.clear=e,a.prototype.delete=t,a.prototype.get=r,a.prototype.has=n,a.prototype.set=i,GE=a,GE}var qE,x3;function Cz(){if(x3)return qE;x3=1;var e=Ig();function t(){this.__data__=new e,this.size=0}return qE=t,qE}var WE,R3;function Oz(){if(R3)return WE;R3=1;function e(t){var r=this.__data__,n=r.delete(t);return this.size=r.size,n}return WE=e,WE}var YE,C3;function Mz(){if(C3)return YE;C3=1;function e(t){return this.__data__.get(t)}return YE=e,YE}var $E,O3;function wz(){if(O3)return $E;O3=1;function e(t){return this.__data__.has(t)}return $E=e,$E}var ZE,M3;function Pg(){if(M3)return ZE;M3=1;var e=uu(),t=Qa(),r="[object AsyncFunction]",n="[object Function]",i="[object GeneratorFunction]",a="[object Proxy]";function s(l){if(!t(l))return!1;var c=e(l);return c==n||c==i||c==r||c==a}return ZE=s,ZE}var KE,w3;function Nz(){if(w3)return KE;w3=1;var e=Do(),t=e["__core-js_shared__"];return KE=t,KE}var QE,N3;function Iz(){if(N3)return QE;N3=1;var e=Nz(),t=(function(){var n=/[^.]+$/.exec(e&&e.keys&&e.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""})();function r(n){return!!t&&t in n}return QE=r,QE}var JE,I3;function RL(){if(I3)return JE;I3=1;var e=Function.prototype,t=e.toString;function r(n){if(n!=null){try{return t.call(n)}catch{}try{return n+""}catch{}}return""}return JE=r,JE}var e1,P3;function Pz(){if(P3)return e1;P3=1;var e=Pg(),t=Iz(),r=Qa(),n=RL(),i=/[\\^$.*+?()[\]{}|]/g,a=/^\[object .+?Constructor\]$/,s=Function.prototype,l=Object.prototype,c=s.toString,d=l.hasOwnProperty,p=RegExp("^"+c.call(d).replace(i,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function h(m){if(!r(m)||t(m))return!1;var _=e(m)?p:a;return _.test(n(m))}return e1=h,e1}var t1,D3;function Dz(){if(D3)return t1;D3=1;function e(t,r){return t?.[r]}return t1=e,t1}var r1,L3;function Wc(){if(L3)return r1;L3=1;var e=Pz(),t=Dz();function r(n,i){var a=t(n,i);return e(a)?a:void 0}return r1=r,r1}var n1,B3;function Kx(){if(B3)return n1;B3=1;var e=Wc(),t=Do(),r=e(t,"Map");return n1=r,n1}var i1,F3;function Dg(){if(F3)return i1;F3=1;var e=Wc(),t=e(Object,"create");return i1=t,i1}var a1,U3;function Lz(){if(U3)return a1;U3=1;var e=Dg();function t(){this.__data__=e?e(null):{},this.size=0}return a1=t,a1}var o1,k3;function Bz(){if(k3)return o1;k3=1;function e(t){var r=this.has(t)&&delete this.__data__[t];return this.size-=r?1:0,r}return o1=e,o1}var s1,z3;function Fz(){if(z3)return s1;z3=1;var e=Dg(),t="__lodash_hash_undefined__",r=Object.prototype,n=r.hasOwnProperty;function i(a){var s=this.__data__;if(e){var l=s[a];return l===t?void 0:l}return n.call(s,a)?s[a]:void 0}return s1=i,s1}var u1,j3;function Uz(){if(j3)return u1;j3=1;var e=Dg(),t=Object.prototype,r=t.hasOwnProperty;function n(i){var a=this.__data__;return e?a[i]!==void 0:r.call(a,i)}return u1=n,u1}var l1,H3;function kz(){if(H3)return l1;H3=1;var e=Dg(),t="__lodash_hash_undefined__";function r(n,i){var a=this.__data__;return this.size+=this.has(n)?0:1,a[n]=e&&i===void 0?t:i,this}return l1=r,l1}var c1,V3;function zz(){if(V3)return c1;V3=1;var e=Lz(),t=Bz(),r=Fz(),n=Uz(),i=kz();function a(s){var l=-1,c=s==null?0:s.length;for(this.clear();++l<c;){var d=s[l];this.set(d[0],d[1])}}return a.prototype.clear=e,a.prototype.delete=t,a.prototype.get=r,a.prototype.has=n,a.prototype.set=i,c1=a,c1}var f1,X3;function jz(){if(X3)return f1;X3=1;var e=zz(),t=Ig(),r=Kx();function n(){this.size=0,this.__data__={hash:new e,map:new(r||t),string:new e}}return f1=n,f1}var d1,G3;function Hz(){if(G3)return d1;G3=1;function e(t){var r=typeof t;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?t!=="__proto__":t===null}return d1=e,d1}var h1,q3;function Lg(){if(q3)return h1;q3=1;var e=Hz();function t(r,n){var i=r.__data__;return e(n)?i[typeof n=="string"?"string":"hash"]:i.map}return h1=t,h1}var p1,W3;function Vz(){if(W3)return p1;W3=1;var e=Lg();function t(r){var n=e(this,r).delete(r);return this.size-=n?1:0,n}return p1=t,p1}var v1,Y3;function Xz(){if(Y3)return v1;Y3=1;var e=Lg();function t(r){return e(this,r).get(r)}return v1=t,v1}var m1,$3;function Gz(){if($3)return m1;$3=1;var e=Lg();function t(r){return e(this,r).has(r)}return m1=t,m1}var _1,Z3;function qz(){if(Z3)return _1;Z3=1;var e=Lg();function t(r,n){var i=e(this,r),a=i.size;return i.set(r,n),this.size+=i.size==a?0:1,this}return _1=t,_1}var g1,K3;function Qx(){if(K3)return g1;K3=1;var e=jz(),t=Vz(),r=Xz(),n=Gz(),i=qz();function a(s){var l=-1,c=s==null?0:s.length;for(this.clear();++l<c;){var d=s[l];this.set(d[0],d[1])}}return a.prototype.clear=e,a.prototype.delete=t,a.prototype.get=r,a.prototype.has=n,a.prototype.set=i,g1=a,g1}var y1,Q3;function Wz(){if(Q3)return y1;Q3=1;var e=Ig(),t=Kx(),r=Qx(),n=200;function i(a,s){var l=this.__data__;if(l instanceof e){var c=l.__data__;if(!t||c.length<n-1)return c.push([a,s]),this.size=++l.size,this;l=this.__data__=new r(c)}return l.set(a,s),this.size=l.size,this}return y1=i,y1}var E1,J3;function Jx(){if(J3)return E1;J3=1;var e=Ig(),t=Cz(),r=Oz(),n=Mz(),i=wz(),a=Wz();function s(l){var c=this.__data__=new e(l);this.size=c.size}return s.prototype.clear=t,s.prototype.delete=r,s.prototype.get=n,s.prototype.has=i,s.prototype.set=a,E1=s,E1}var T1,eO;function Yz(){if(eO)return T1;eO=1;function e(t,r){for(var n=-1,i=t==null?0:t.length;++n<i&&r(t[n],n,t)!==!1;);return t}return T1=e,T1}var S1,tO;function CL(){if(tO)return S1;tO=1;var e=Wc(),t=(function(){try{var r=e(Object,"defineProperty");return r({},"",{}),r}catch{}})();return S1=t,S1}var A1,rO;function eR(){if(rO)return A1;rO=1;var e=CL();function t(r,n,i){n=="__proto__"&&e?e(r,n,{configurable:!0,enumerable:!0,value:i,writable:!0}):r[n]=i}return A1=t,A1}var b1,nO;function OL(){if(nO)return b1;nO=1;var e=eR(),t=Xv(),r=Object.prototype,n=r.hasOwnProperty;function i(a,s,l){var c=a[s];(!(n.call(a,s)&&t(c,l))||l===void 0&&!(s in a))&&e(a,s,l)}return b1=i,b1}var x1,iO;function Gv(){if(iO)return x1;iO=1;var e=OL(),t=eR();function r(n,i,a,s){var l=!a;a||(a={});for(var c=-1,d=i.length;++c<d;){var p=i[c],h=s?s(a[p],n[p],p,a,n):void 0;h===void 0&&(h=n[p]),l?t(a,p,h):e(a,p,h)}return a}return x1=r,x1}var R1,aO;function $z(){if(aO)return R1;aO=1;function e(t,r){for(var n=-1,i=Array(t);++n<t;)i[n]=r(n);return i}return R1=e,R1}var C1,oO;function Zz(){if(oO)return C1;oO=1;var e=uu(),t=Ja(),r="[object Arguments]";function n(i){return t(i)&&e(i)==r}return C1=n,C1}var O1,sO;function ML(){if(sO)return O1;sO=1;var e=Zz(),t=Ja(),r=Object.prototype,n=r.hasOwnProperty,i=r.propertyIsEnumerable,a=e((function(){return arguments})())?e:function(s){return t(s)&&n.call(s,"callee")&&!i.call(s,"callee")};return O1=a,O1}var M1,uO;function lu(){if(uO)return M1;uO=1;var e=Array.isArray;return M1=e,M1}var Jp={exports:{}},w1,lO;function Kz(){if(lO)return w1;lO=1;function e(){return!1}return w1=e,w1}Jp.exports;var cO;function Bg(){return cO||(cO=1,(function(e,t){var r=Do(),n=Kz(),i=t&&!t.nodeType&&t,a=i&&!0&&e&&!e.nodeType&&e,s=a&&a.exports===i,l=s?r.Buffer:void 0,c=l?l.isBuffer:void 0,d=c||n;e.exports=d})(Jp,Jp.exports)),Jp.exports}var N1,fO;function wL(){if(fO)return N1;fO=1;var e=9007199254740991,t=/^(?:0|[1-9]\d*)$/;function r(n,i){var a=typeof n;return i=i??e,!!i&&(a=="number"||a!="symbol"&&t.test(n))&&n>-1&&n%1==0&&n<i}return N1=r,N1}var I1,dO;function NL(){if(dO)return I1;dO=1;var e=9007199254740991;function t(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=e}return I1=t,I1}var P1,hO;function Qz(){if(hO)return P1;hO=1;var e=uu(),t=NL(),r=Ja(),n="[object Arguments]",i="[object Array]",a="[object Boolean]",s="[object Date]",l="[object Error]",c="[object Function]",d="[object Map]",p="[object Number]",h="[object Object]",m="[object RegExp]",_="[object Set]",y="[object String]",E="[object WeakMap]",T="[object ArrayBuffer]",A="[object DataView]",b="[object Float32Array]",R="[object Float64Array]",M="[object Int8Array]",B="[object Int16Array]",w="[object Int32Array]",D="[object Uint8Array]",U="[object Uint8ClampedArray]",ae="[object Uint16Array]",Q="[object Uint32Array]",X={};X[b]=X[R]=X[M]=X[B]=X[w]=X[D]=X[U]=X[ae]=X[Q]=!0,X[n]=X[i]=X[T]=X[a]=X[A]=X[s]=X[l]=X[c]=X[d]=X[p]=X[h]=X[m]=X[_]=X[y]=X[E]=!1;function x(P){return r(P)&&t(P.length)&&!!X[e(P)]}return P1=x,P1}var D1,pO;function Fg(){if(pO)return D1;pO=1;function e(t){return function(r){return t(r)}}return D1=e,D1}var ev={exports:{}};ev.exports;var vO;function tR(){return vO||(vO=1,(function(e,t){var r=bL(),n=t&&!t.nodeType&&t,i=n&&!0&&e&&!e.nodeType&&e,a=i&&i.exports===n,s=a&&r.process,l=(function(){try{var c=i&&i.require&&i.require("util").types;return c||s&&s.binding&&s.binding("util")}catch{}})();e.exports=l})(ev,ev.exports)),ev.exports}var L1,mO;function Ug(){if(mO)return L1;mO=1;var e=Qz(),t=Fg(),r=tR(),n=r&&r.isTypedArray,i=n?t(n):e;return L1=i,L1}var B1,_O;function IL(){if(_O)return B1;_O=1;var e=$z(),t=ML(),r=lu(),n=Bg(),i=wL(),a=Ug(),s=Object.prototype,l=s.hasOwnProperty;function c(d,p){var h=r(d),m=!h&&t(d),_=!h&&!m&&n(d),y=!h&&!m&&!_&&a(d),E=h||m||_||y,T=E?e(d.length,String):[],A=T.length;for(var b in d)(p||l.call(d,b))&&!(E&&(b=="length"||_&&(b=="offset"||b=="parent")||y&&(b=="buffer"||b=="byteLength"||b=="byteOffset")||i(b,A)))&&T.push(b);return T}return B1=c,B1}var F1,gO;function rR(){if(gO)return F1;gO=1;var e=Object.prototype;function t(r){var n=r&&r.constructor,i=typeof n=="function"&&n.prototype||e;return r===i}return F1=t,F1}var U1,yO;function PL(){if(yO)return U1;yO=1;function e(t,r){return function(n){return t(r(n))}}return U1=e,U1}var k1,EO;function Jz(){if(EO)return k1;EO=1;var e=PL(),t=e(Object.keys,Object);return k1=t,k1}var z1,TO;function ej(){if(TO)return z1;TO=1;var e=rR(),t=Jz(),r=Object.prototype,n=r.hasOwnProperty;function i(a){if(!e(a))return t(a);var s=[];for(var l in Object(a))n.call(a,l)&&l!="constructor"&&s.push(l);return s}return z1=i,z1}var j1,SO;function kg(){if(SO)return j1;SO=1;var e=Pg(),t=NL();function r(n){return n!=null&&t(n.length)&&!e(n)}return j1=r,j1}var H1,AO;function nR(){if(AO)return H1;AO=1;var e=IL(),t=ej(),r=kg();function n(i){return r(i)?e(i):t(i)}return H1=n,H1}var V1,bO;function tj(){if(bO)return V1;bO=1;var e=Gv(),t=nR();function r(n,i){return n&&e(i,t(i),n)}return V1=r,V1}var X1,xO;function rj(){if(xO)return X1;xO=1;function e(t){var r=[];if(t!=null)for(var n in Object(t))r.push(n);return r}return X1=e,X1}var G1,RO;function nj(){if(RO)return G1;RO=1;var e=Qa(),t=rR(),r=rj(),n=Object.prototype,i=n.hasOwnProperty;function a(s){if(!e(s))return r(s);var l=t(s),c=[];for(var d in s)d=="constructor"&&(l||!i.call(s,d))||c.push(d);return c}return G1=a,G1}var q1,CO;function qv(){if(CO)return q1;CO=1;var e=IL(),t=nj(),r=kg();function n(i){return r(i)?e(i,!0):t(i)}return q1=n,q1}var W1,OO;function ij(){if(OO)return W1;OO=1;var e=Gv(),t=qv();function r(n,i){return n&&e(i,t(i),n)}return W1=r,W1}var tv={exports:{}};tv.exports;var MO;function DL(){return MO||(MO=1,(function(e,t){var r=Do(),n=t&&!t.nodeType&&t,i=n&&!0&&e&&!e.nodeType&&e,a=i&&i.exports===n,s=a?r.Buffer:void 0,l=s?s.allocUnsafe:void 0;function c(d,p){if(p)return d.slice();var h=d.length,m=l?l(h):new d.constructor(h);return d.copy(m),m}e.exports=c})(tv,tv.exports)),tv.exports}var Y1,wO;function iR(){if(wO)return Y1;wO=1;function e(t,r){var n=-1,i=t.length;for(r||(r=Array(i));++n<i;)r[n]=t[n];return r}return Y1=e,Y1}var $1,NO;function aj(){if(NO)return $1;NO=1;function e(t,r){for(var n=-1,i=t==null?0:t.length,a=0,s=[];++n<i;){var l=t[n];r(l,n,t)&&(s[a++]=l)}return s}return $1=e,$1}var Z1,IO;function LL(){if(IO)return Z1;IO=1;function e(){return[]}return Z1=e,Z1}var K1,PO;function aR(){if(PO)return K1;PO=1;var e=aj(),t=LL(),r=Object.prototype,n=r.propertyIsEnumerable,i=Object.getOwnPropertySymbols,a=i?function(s){return s==null?[]:(s=Object(s),e(i(s),function(l){return n.call(s,l)}))}:t;return K1=a,K1}var Q1,DO;function oj(){if(DO)return Q1;DO=1;var e=Gv(),t=aR();function r(n,i){return e(n,t(n),i)}return Q1=r,Q1}var J1,LO;function BL(){if(LO)return J1;LO=1;function e(t,r){for(var n=-1,i=r.length,a=t.length;++n<i;)t[a+n]=r[n];return t}return J1=e,J1}var eT,BO;function oR(){if(BO)return eT;BO=1;var e=PL(),t=e(Object.getPrototypeOf,Object);return eT=t,eT}var tT,FO;function FL(){if(FO)return tT;FO=1;var e=BL(),t=oR(),r=aR(),n=LL(),i=Object.getOwnPropertySymbols,a=i?function(s){for(var l=[];s;)e(l,r(s)),s=t(s);return l}:n;return tT=a,tT}var rT,UO;function sj(){if(UO)return rT;UO=1;var e=Gv(),t=FL();function r(n,i){return e(n,t(n),i)}return rT=r,rT}var nT,kO;function UL(){if(kO)return nT;kO=1;var e=BL(),t=lu();function r(n,i,a){var s=i(n);return t(n)?s:e(s,a(n))}return nT=r,nT}var iT,zO;function kL(){if(zO)return iT;zO=1;var e=UL(),t=aR(),r=nR();function n(i){return e(i,r,t)}return iT=n,iT}var aT,jO;function uj(){if(jO)return aT;jO=1;var e=UL(),t=FL(),r=qv();function n(i){return e(i,r,t)}return aT=n,aT}var oT,HO;function lj(){if(HO)return oT;HO=1;var e=Wc(),t=Do(),r=e(t,"DataView");return oT=r,oT}var sT,VO;function cj(){if(VO)return sT;VO=1;var e=Wc(),t=Do(),r=e(t,"Promise");return sT=r,sT}var uT,XO;function zL(){if(XO)return uT;XO=1;var e=Wc(),t=Do(),r=e(t,"Set");return uT=r,uT}var lT,GO;function fj(){if(GO)return lT;GO=1;var e=Wc(),t=Do(),r=e(t,"WeakMap");return lT=r,lT}var cT,qO;function zg(){if(qO)return cT;qO=1;var e=lj(),t=Kx(),r=cj(),n=zL(),i=fj(),a=uu(),s=RL(),l="[object Map]",c="[object Object]",d="[object Promise]",p="[object Set]",h="[object WeakMap]",m="[object DataView]",_=s(e),y=s(t),E=s(r),T=s(n),A=s(i),b=a;return(e&&b(new e(new ArrayBuffer(1)))!=m||t&&b(new t)!=l||r&&b(r.resolve())!=d||n&&b(new n)!=p||i&&b(new i)!=h)&&(b=function(R){var M=a(R),B=M==c?R.constructor:void 0,w=B?s(B):"";if(w)switch(w){case _:return m;case y:return l;case E:return d;case T:return p;case A:return h}return M}),cT=b,cT}var fT,WO;function dj(){if(WO)return fT;WO=1;var e=Object.prototype,t=e.hasOwnProperty;function r(n){var i=n.length,a=new n.constructor(i);return i&&typeof n[0]=="string"&&t.call(n,"index")&&(a.index=n.index,a.input=n.input),a}return fT=r,fT}var dT,YO;function jL(){if(YO)return dT;YO=1;var e=Do(),t=e.Uint8Array;return dT=t,dT}var hT,$O;function sR(){if($O)return hT;$O=1;var e=jL();function t(r){var n=new r.constructor(r.byteLength);return new e(n).set(new e(r)),n}return hT=t,hT}var pT,ZO;function hj(){if(ZO)return pT;ZO=1;var e=sR();function t(r,n){var i=n?e(r.buffer):r.buffer;return new r.constructor(i,r.byteOffset,r.byteLength)}return pT=t,pT}var vT,KO;function pj(){if(KO)return vT;KO=1;var e=/\w*$/;function t(r){var n=new r.constructor(r.source,e.exec(r));return n.lastIndex=r.lastIndex,n}return vT=t,vT}var mT,QO;function vj(){if(QO)return mT;QO=1;var e=Vv(),t=e?e.prototype:void 0,r=t?t.valueOf:void 0;function n(i){return r?Object(r.call(i)):{}}return mT=n,mT}var _T,JO;function HL(){if(JO)return _T;JO=1;var e=sR();function t(r,n){var i=n?e(r.buffer):r.buffer;return new r.constructor(i,r.byteOffset,r.length)}return _T=t,_T}var gT,eM;function mj(){if(eM)return gT;eM=1;var e=sR(),t=hj(),r=pj(),n=vj(),i=HL(),a="[object Boolean]",s="[object Date]",l="[object Map]",c="[object Number]",d="[object RegExp]",p="[object Set]",h="[object String]",m="[object Symbol]",_="[object ArrayBuffer]",y="[object DataView]",E="[object Float32Array]",T="[object Float64Array]",A="[object Int8Array]",b="[object Int16Array]",R="[object Int32Array]",M="[object Uint8Array]",B="[object Uint8ClampedArray]",w="[object Uint16Array]",D="[object Uint32Array]";function U(ae,Q,X){var x=ae.constructor;switch(Q){case _:return e(ae);case a:case s:return new x(+ae);case y:return t(ae,X);case E:case T:case A:case b:case R:case M:case B:case w:case D:return i(ae,X);case l:return new x;case c:case h:return new x(ae);case d:return r(ae);case p:return new x;case m:return n(ae)}}return gT=U,gT}var yT,tM;function _j(){if(tM)return yT;tM=1;var e=Qa(),t=Object.create,r=(function(){function n(){}return function(i){if(!e(i))return{};if(t)return t(i);n.prototype=i;var a=new n;return n.prototype=void 0,a}})();return yT=r,yT}var ET,rM;function VL(){if(rM)return ET;rM=1;var e=_j(),t=oR(),r=rR();function n(i){return typeof i.constructor=="function"&&!r(i)?e(t(i)):{}}return ET=n,ET}var TT,nM;function gj(){if(nM)return TT;nM=1;var e=zg(),t=Ja(),r="[object Map]";function n(i){return t(i)&&e(i)==r}return TT=n,TT}var ST,iM;function yj(){if(iM)return ST;iM=1;var e=gj(),t=Fg(),r=tR(),n=r&&r.isMap,i=n?t(n):e;return ST=i,ST}var AT,aM;function Ej(){if(aM)return AT;aM=1;var e=zg(),t=Ja(),r="[object Set]";function n(i){return t(i)&&e(i)==r}return AT=n,AT}var bT,oM;function Tj(){if(oM)return bT;oM=1;var e=Ej(),t=Fg(),r=tR(),n=r&&r.isSet,i=n?t(n):e;return bT=i,bT}var xT,sM;function Sj(){if(sM)return xT;sM=1;var e=Jx(),t=Yz(),r=OL(),n=tj(),i=ij(),a=DL(),s=iR(),l=oj(),c=sj(),d=kL(),p=uj(),h=zg(),m=dj(),_=mj(),y=VL(),E=lu(),T=Bg(),A=yj(),b=Qa(),R=Tj(),M=nR(),B=qv(),w=1,D=2,U=4,ae="[object Arguments]",Q="[object Array]",X="[object Boolean]",x="[object Date]",P="[object Error]",H="[object Function]",pe="[object GeneratorFunction]",O="[object Map]",F="[object Number]",z="[object Object]",re="[object RegExp]",oe="[object Set]",_e="[object String]",ye="[object Symbol]",Ie="[object WeakMap]",Je="[object ArrayBuffer]",We="[object DataView]",Ct="[object Float32Array]",Ve="[object Float64Array]",yt="[object Int8Array]",Ue="[object Int16Array]",ge="[object Int32Array]",nt="[object Uint8Array]",Ce="[object Uint8ClampedArray]",zt="[object Uint16Array]",jt="[object Uint32Array]",_t={};_t[ae]=_t[Q]=_t[Je]=_t[We]=_t[X]=_t[x]=_t[Ct]=_t[Ve]=_t[yt]=_t[Ue]=_t[ge]=_t[O]=_t[F]=_t[z]=_t[re]=_t[oe]=_t[_e]=_t[ye]=_t[nt]=_t[Ce]=_t[zt]=_t[jt]=!0,_t[P]=_t[H]=_t[Ie]=!1;function Ot(xt,Xt,Or,qr,Tr,zr){var V,jr=Xt&w,en=Xt&D,Hn=Xt&U;if(Or&&(V=Tr?Or(xt,qr,Tr,zr):Or(xt)),V!==void 0)return V;if(!b(xt))return xt;var un=E(xt);if(un){if(V=m(xt),!jr)return s(xt,V)}else{var tn=h(xt),yr=tn==H||tn==pe;if(T(xt))return a(xt,jr);if(tn==z||tn==ae||yr&&!Tr){if(V=en||yr?{}:y(xt),!jr)return en?c(xt,i(V,xt)):l(xt,n(V,xt))}else{if(!_t[tn])return Tr?xt:{};V=_(xt,tn,jr)}}zr||(zr=new e);var Yn=zr.get(xt);if(Yn)return Yn;zr.set(xt,V),R(xt)?xt.forEach(function(Wr){V.add(Ot(Wr,Xt,Or,Wr,xt,zr))}):A(xt)&&xt.forEach(function(Wr,Cn){V.set(Cn,Ot(Wr,Xt,Or,Cn,xt,zr))});var pi=Hn?en?p:d:en?B:M,ii=un?void 0:pi(xt);return t(ii||xt,function(Wr,Cn){ii&&(Cn=Wr,Wr=xt[Cn]),r(V,Cn,Ot(Wr,Xt,Or,Cn,xt,zr))}),V}return xT=Ot,xT}var RT,uM;function Aj(){if(uM)return RT;uM=1;var e=Sj(),t=1,r=4;function n(i){return e(i,t|r)}return RT=n,RT}var bj=Aj();const xj=Pr(bj);var CT,lM;function Rj(){if(lM)return CT;lM=1;var e=Do(),t=function(){return e.Date.now()};return CT=t,CT}var OT,cM;function XL(){if(cM)return OT;cM=1;var e=Qa(),t=Rj(),r=xL(),n="Expected a function",i=Math.max,a=Math.min;function s(l,c,d){var p,h,m,_,y,E,T=0,A=!1,b=!1,R=!0;if(typeof l!="function")throw new TypeError(n);c=r(c)||0,e(d)&&(A=!!d.leading,b="maxWait"in d,m=b?i(r(d.maxWait)||0,c):m,R="trailing"in d?!!d.trailing:R);function M(P){var H=p,pe=h;return p=h=void 0,T=P,_=l.apply(pe,H),_}function B(P){return T=P,y=setTimeout(U,c),A?M(P):_}function w(P){var H=P-E,pe=P-T,O=c-H;return b?a(O,m-pe):O}function D(P){var H=P-E,pe=P-T;return E===void 0||H>=c||H<0||b&&pe>=m}function U(){var P=t();if(D(P))return ae(P);y=setTimeout(U,w(P))}function ae(P){return y=void 0,R&&p?M(P):(p=h=void 0,_)}function Q(){y!==void 0&&clearTimeout(y),T=0,p=E=h=y=void 0}function X(){return y===void 0?_:ae(t())}function x(){var P=t(),H=D(P);if(p=arguments,h=this,E=P,H){if(y===void 0)return B(E);if(b)return clearTimeout(y),y=setTimeout(U,c),M(E)}return y===void 0&&(y=setTimeout(U,c)),_}return x.cancel=Q,x.flush=X,x}return OT=s,OT}var Cj=XL();const Oj=Pr(Cj);var MT,fM;function Mj(){if(fM)return MT;fM=1;var e=lu(),t=wg(),r=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,n=/^\w*$/;function i(a,s){if(e(a))return!1;var l=typeof a;return l=="number"||l=="symbol"||l=="boolean"||a==null||t(a)?!0:n.test(a)||!r.test(a)||s!=null&&a in Object(s)}return MT=i,MT}var wT,dM;function wj(){if(dM)return wT;dM=1;var e=Qx(),t="Expected a function";function r(n,i){if(typeof n!="function"||i!=null&&typeof i!="function")throw new TypeError(t);var a=function(){var s=arguments,l=i?i.apply(this,s):s[0],c=a.cache;if(c.has(l))return c.get(l);var d=n.apply(this,s);return a.cache=c.set(l,d)||c,d};return a.cache=new(r.Cache||e),a}return r.Cache=e,wT=r,wT}var NT,hM;function Nj(){if(hM)return NT;hM=1;var e=wj(),t=500;function r(n){var i=e(n,function(s){return a.size===t&&a.clear(),s}),a=i.cache;return i}return NT=r,NT}var IT,pM;function Ij(){if(pM)return IT;pM=1;var e=Nj(),t=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,r=/\\(\\)?/g,n=e(function(i){var a=[];return i.charCodeAt(0)===46&&a.push(""),i.replace(t,function(s,l,c,d){a.push(c?d.replace(r,"$1"):l||s)}),a});return IT=n,IT}var PT,vM;function GL(){if(vM)return PT;vM=1;function e(t,r){for(var n=-1,i=t==null?0:t.length,a=Array(i);++n<i;)a[n]=r(t[n],n,t);return a}return PT=e,PT}var DT,mM;function Pj(){if(mM)return DT;mM=1;var e=Vv(),t=GL(),r=lu(),n=wg(),i=e?e.prototype:void 0,a=i?i.toString:void 0;function s(l){if(typeof l=="string")return l;if(r(l))return t(l,s)+"";if(n(l))return a?a.call(l):"";var c=l+"";return c=="0"&&1/l==-1/0?"-0":c}return DT=s,DT}var LT,_M;function nh(){if(_M)return LT;_M=1;var e=Pj();function t(r){return r==null?"":e(r)}return LT=t,LT}var BT,gM;function Dj(){if(gM)return BT;gM=1;var e=lu(),t=Mj(),r=Ij(),n=nh();function i(a,s){return e(a)?a:t(a,s)?[a]:r(n(a))}return BT=i,BT}var FT,yM;function Lj(){if(yM)return FT;yM=1;var e=wg();function t(r){if(typeof r=="string"||e(r))return r;var n=r+"";return n=="0"&&1/r==-1/0?"-0":n}return FT=t,FT}var UT,EM;function Bj(){if(EM)return UT;EM=1;var e=Dj(),t=Lj();function r(n,i){i=e(i,n);for(var a=0,s=i.length;n!=null&&a<s;)n=n[t(i[a++])];return a&&a==s?n:void 0}return UT=r,UT}var kT,TM;function Fj(){if(TM)return kT;TM=1;var e=Bj();function t(r,n,i){var a=r==null?void 0:e(r,n);return a===void 0?i:a}return kT=t,kT}var Uj=Fj();const kj=Pr(Uj);var zT,SM;function zj(){if(SM)return zT;SM=1;var e=uu(),t=Ja(),r="[object Boolean]";function n(i){return i===!0||i===!1||t(i)&&e(i)==r}return zT=n,zT}var jj=zj();const Hj=Pr(jj);var jT,AM;function Vj(){if(AM)return jT;AM=1;var e="__lodash_hash_undefined__";function t(r){return this.__data__.set(r,e),this}return jT=t,jT}var HT,bM;function Xj(){if(bM)return HT;bM=1;function e(t){return this.__data__.has(t)}return HT=e,HT}var VT,xM;function qL(){if(xM)return VT;xM=1;var e=Qx(),t=Vj(),r=Xj();function n(i){var a=-1,s=i==null?0:i.length;for(this.__data__=new e;++a<s;)this.add(i[a])}return n.prototype.add=n.prototype.push=t,n.prototype.has=r,VT=n,VT}var XT,RM;function Gj(){if(RM)return XT;RM=1;function e(t,r){for(var n=-1,i=t==null?0:t.length;++n<i;)if(r(t[n],n,t))return!0;return!1}return XT=e,XT}var GT,CM;function WL(){if(CM)return GT;CM=1;function e(t,r){return t.has(r)}return GT=e,GT}var qT,OM;function YL(){if(OM)return qT;OM=1;var e=qL(),t=Gj(),r=WL(),n=1,i=2;function a(s,l,c,d,p,h){var m=c&n,_=s.length,y=l.length;if(_!=y&&!(m&&y>_))return!1;var E=h.get(s),T=h.get(l);if(E&&T)return E==l&&T==s;var A=-1,b=!0,R=c&i?new e:void 0;for(h.set(s,l),h.set(l,s);++A<_;){var M=s[A],B=l[A];if(d)var w=m?d(B,M,A,l,s,h):d(M,B,A,s,l,h);if(w!==void 0){if(w)continue;b=!1;break}if(R){if(!t(l,function(D,U){if(!r(R,U)&&(M===D||p(M,D,c,d,h)))return R.push(U)})){b=!1;break}}else if(!(M===B||p(M,B,c,d,h))){b=!1;break}}return h.delete(s),h.delete(l),b}return qT=a,qT}var WT,MM;function qj(){if(MM)return WT;MM=1;function e(t){var r=-1,n=Array(t.size);return t.forEach(function(i,a){n[++r]=[a,i]}),n}return WT=e,WT}var YT,wM;function uR(){if(wM)return YT;wM=1;function e(t){var r=-1,n=Array(t.size);return t.forEach(function(i){n[++r]=i}),n}return YT=e,YT}var $T,NM;function Wj(){if(NM)return $T;NM=1;var e=Vv(),t=jL(),r=Xv(),n=YL(),i=qj(),a=uR(),s=1,l=2,c="[object Boolean]",d="[object Date]",p="[object Error]",h="[object Map]",m="[object Number]",_="[object RegExp]",y="[object Set]",E="[object String]",T="[object Symbol]",A="[object ArrayBuffer]",b="[object DataView]",R=e?e.prototype:void 0,M=R?R.valueOf:void 0;function B(w,D,U,ae,Q,X,x){switch(U){case b:if(w.byteLength!=D.byteLength||w.byteOffset!=D.byteOffset)return!1;w=w.buffer,D=D.buffer;case A:return!(w.byteLength!=D.byteLength||!X(new t(w),new t(D)));case c:case d:case m:return r(+w,+D);case p:return w.name==D.name&&w.message==D.message;case _:case E:return w==D+"";case h:var P=i;case y:var H=ae&s;if(P||(P=a),w.size!=D.size&&!H)return!1;var pe=x.get(w);if(pe)return pe==D;ae|=l,x.set(w,D);var O=n(P(w),P(D),ae,Q,X,x);return x.delete(w),O;case T:if(M)return M.call(w)==M.call(D)}return!1}return $T=B,$T}var ZT,IM;function Yj(){if(IM)return ZT;IM=1;var e=kL(),t=1,r=Object.prototype,n=r.hasOwnProperty;function i(a,s,l,c,d,p){var h=l&t,m=e(a),_=m.length,y=e(s),E=y.length;if(_!=E&&!h)return!1;for(var T=_;T--;){var A=m[T];if(!(h?A in s:n.call(s,A)))return!1}var b=p.get(a),R=p.get(s);if(b&&R)return b==s&&R==a;var M=!0;p.set(a,s),p.set(s,a);for(var B=h;++T<_;){A=m[T];var w=a[A],D=s[A];if(c)var U=h?c(D,w,A,s,a,p):c(w,D,A,a,s,p);if(!(U===void 0?w===D||d(w,D,l,c,p):U)){M=!1;break}B||(B=A=="constructor")}if(M&&!B){var ae=a.constructor,Q=s.constructor;ae!=Q&&"constructor"in a&&"constructor"in s&&!(typeof ae=="function"&&ae instanceof ae&&typeof Q=="function"&&Q instanceof Q)&&(M=!1)}return p.delete(a),p.delete(s),M}return ZT=i,ZT}var KT,PM;function $j(){if(PM)return KT;PM=1;var e=Jx(),t=YL(),r=Wj(),n=Yj(),i=zg(),a=lu(),s=Bg(),l=Ug(),c=1,d="[object Arguments]",p="[object Array]",h="[object Object]",m=Object.prototype,_=m.hasOwnProperty;function y(E,T,A,b,R,M){var B=a(E),w=a(T),D=B?p:i(E),U=w?p:i(T);D=D==d?h:D,U=U==d?h:U;var ae=D==h,Q=U==h,X=D==U;if(X&&s(E)){if(!s(T))return!1;B=!0,ae=!1}if(X&&!ae)return M||(M=new e),B||l(E)?t(E,T,A,b,R,M):r(E,T,D,A,b,R,M);if(!(A&c)){var x=ae&&_.call(E,"__wrapped__"),P=Q&&_.call(T,"__wrapped__");if(x||P){var H=x?E.value():E,pe=P?T.value():T;return M||(M=new e),R(H,pe,A,b,M)}}return X?(M||(M=new e),n(E,T,A,b,R,M)):!1}return KT=y,KT}var QT,DM;function Zj(){if(DM)return QT;DM=1;var e=$j(),t=Ja();function r(n,i,a,s,l){return n===i?!0:n==null||i==null||!t(n)&&!t(i)?n!==n&&i!==i:e(n,i,a,s,r,l)}return QT=r,QT}var JT,LM;function Kj(){if(LM)return JT;LM=1;var e=Zj();function t(r,n){return e(r,n)}return JT=t,JT}var Qj=Kj();const Jj=Pr(Qj);var eS,BM;function eH(){if(BM)return eS;BM=1;function e(t){return t==null}return eS=e,eS}var tH=eH();const rH=Pr(tH);var tS,FM;function nH(){if(FM)return tS;FM=1;var e=uu(),t=Ja(),r="[object Number]";function n(i){return typeof i=="number"||t(i)&&e(i)==r}return tS=n,tS}var iH=nH();const aH=Pr(iH);var rS,UM;function $L(){if(UM)return rS;UM=1;var e=uu(),t=oR(),r=Ja(),n="[object Object]",i=Function.prototype,a=Object.prototype,s=i.toString,l=a.hasOwnProperty,c=s.call(Object);function d(p){if(!r(p)||e(p)!=n)return!1;var h=t(p);if(h===null)return!0;var m=l.call(h,"constructor")&&h.constructor;return typeof m=="function"&&m instanceof m&&s.call(m)==c}return rS=d,rS}var oH=$L();const sH=Pr(oH);var nS,kM;function uH(){if(kM)return nS;kM=1;var e=uu(),t=lu(),r=Ja(),n="[object String]";function i(a){return typeof a=="string"||!t(a)&&r(a)&&e(a)==n}return nS=i,nS}var lH=uH();const cH=Pr(lH);var fH=Ug();const dH=Pr(fH);var iS,zM;function ZL(){if(zM)return iS;zM=1;var e=eR(),t=Xv();function r(n,i,a){(a!==void 0&&!t(n[i],a)||a===void 0&&!(i in n))&&e(n,i,a)}return iS=r,iS}var aS,jM;function hH(){if(jM)return aS;jM=1;function e(t){return function(r,n,i){for(var a=-1,s=Object(r),l=i(r),c=l.length;c--;){var d=l[t?c:++a];if(n(s[d],d,s)===!1)break}return r}}return aS=e,aS}var oS,HM;function pH(){if(HM)return oS;HM=1;var e=hH(),t=e();return oS=t,oS}var sS,VM;function vH(){if(VM)return sS;VM=1;var e=kg(),t=Ja();function r(n){return t(n)&&e(n)}return sS=r,sS}var uS,XM;function KL(){if(XM)return uS;XM=1;function e(t,r){if(!(r==="constructor"&&typeof t[r]=="function")&&r!="__proto__")return t[r]}return uS=e,uS}var lS,GM;function mH(){if(GM)return lS;GM=1;var e=Gv(),t=qv();function r(n){return e(n,t(n))}return lS=r,lS}var cS,qM;function _H(){if(qM)return cS;qM=1;var e=ZL(),t=DL(),r=HL(),n=iR(),i=VL(),a=ML(),s=lu(),l=vH(),c=Bg(),d=Pg(),p=Qa(),h=$L(),m=Ug(),_=KL(),y=mH();function E(T,A,b,R,M,B,w){var D=_(T,b),U=_(A,b),ae=w.get(U);if(ae){e(T,b,ae);return}var Q=B?B(D,U,b+"",T,A,w):void 0,X=Q===void 0;if(X){var x=s(U),P=!x&&c(U),H=!x&&!P&&m(U);Q=U,x||P||H?s(D)?Q=D:l(D)?Q=n(D):P?(X=!1,Q=t(U,!0)):H?(X=!1,Q=r(U,!0)):Q=[]:h(U)||a(U)?(Q=D,a(D)?Q=y(D):(!p(D)||d(D))&&(Q=i(U))):X=!1}X&&(w.set(U,Q),M(Q,U,R,B,w),w.delete(U)),e(T,b,Q)}return cS=E,cS}var fS,WM;function QL(){if(WM)return fS;WM=1;var e=Jx(),t=ZL(),r=pH(),n=_H(),i=Qa(),a=qv(),s=KL();function l(c,d,p,h,m){c!==d&&r(d,function(_,y){if(m||(m=new e),i(_))n(c,d,y,p,l,h,m);else{var E=h?h(s(c,y),_,y+"",c,d,m):void 0;E===void 0&&(E=_),t(c,y,E)}},a)}return fS=l,fS}var dS,YM;function JL(){if(YM)return dS;YM=1;function e(t){return t}return dS=e,dS}var hS,$M;function gH(){if($M)return hS;$M=1;function e(t,r,n){switch(n.length){case 0:return t.call(r);case 1:return t.call(r,n[0]);case 2:return t.call(r,n[0],n[1]);case 3:return t.call(r,n[0],n[1],n[2])}return t.apply(r,n)}return hS=e,hS}var pS,ZM;function yH(){if(ZM)return pS;ZM=1;var e=gH(),t=Math.max;function r(n,i,a){return i=t(i===void 0?n.length-1:i,0),function(){for(var s=arguments,l=-1,c=t(s.length-i,0),d=Array(c);++l<c;)d[l]=s[i+l];l=-1;for(var p=Array(i+1);++l<i;)p[l]=s[l];return p[i]=a(d),e(n,this,p)}}return pS=r,pS}var vS,KM;function EH(){if(KM)return vS;KM=1;function e(t){return function(){return t}}return vS=e,vS}var mS,QM;function TH(){if(QM)return mS;QM=1;var e=EH(),t=CL(),r=JL(),n=t?function(i,a){return t(i,"toString",{configurable:!0,enumerable:!1,value:e(a),writable:!0})}:r;return mS=n,mS}var _S,JM;function SH(){if(JM)return _S;JM=1;var e=800,t=16,r=Date.now;function n(i){var a=0,s=0;return function(){var l=r(),c=t-(l-s);if(s=l,c>0){if(++a>=e)return arguments[0]}else a=0;return i.apply(void 0,arguments)}}return _S=n,_S}var gS,ew;function AH(){if(ew)return gS;ew=1;var e=TH(),t=SH(),r=t(e);return gS=r,gS}var yS,tw;function eB(){if(tw)return yS;tw=1;var e=JL(),t=yH(),r=AH();function n(i,a){return r(t(i,a,e),i+"")}return yS=n,yS}var ES,rw;function bH(){if(rw)return ES;rw=1;var e=Xv(),t=kg(),r=wL(),n=Qa();function i(a,s,l){if(!n(l))return!1;var c=typeof s;return(c=="number"?t(l)&&r(s,l.length):c=="string"&&s in l)?e(l[s],a):!1}return ES=i,ES}var TS,nw;function tB(){if(nw)return TS;nw=1;var e=eB(),t=bH();function r(n){return e(function(i,a){var s=-1,l=a.length,c=l>1?a[l-1]:void 0,d=l>2?a[2]:void 0;for(c=n.length>3&&typeof c=="function"?(l--,c):void 0,d&&t(a[0],a[1],d)&&(c=l<3?void 0:c,l=1),i=Object(i);++s<l;){var p=a[s];p&&n(i,p,s,c)}return i})}return TS=r,TS}var SS,iw;function xH(){if(iw)return SS;iw=1;var e=QL(),t=tB(),r=t(function(n,i,a){e(n,i,a)});return SS=r,SS}var RH=xH();const CH=Pr(RH);var AS,aw;function OH(){if(aw)return AS;aw=1;var e=QL(),t=tB(),r=t(function(n,i,a,s){e(n,i,a,s)});return AS=r,AS}var MH=OH();const wH=Pr(MH);var bS,ow;function NH(){if(ow)return bS;ow=1;function e(t,r,n,i){for(var a=t.length,s=n+(i?1:-1);i?s--:++s<a;)if(r(t[s],s,t))return s;return-1}return bS=e,bS}var xS,sw;function IH(){if(sw)return xS;sw=1;function e(t){return t!==t}return xS=e,xS}var RS,uw;function PH(){if(uw)return RS;uw=1;function e(t,r,n){for(var i=n-1,a=t.length;++i<a;)if(t[i]===r)return i;return-1}return RS=e,RS}var CS,lw;function rB(){if(lw)return CS;lw=1;var e=NH(),t=IH(),r=PH();function n(i,a,s){return a===a?r(i,a,s):e(i,t,s)}return CS=n,CS}var OS,cw;function DH(){if(cw)return OS;cw=1;function e(t,r,n,i){for(var a=n-1,s=t.length;++a<s;)if(i(t[a],r))return a;return-1}return OS=e,OS}var MS,fw;function LH(){if(fw)return MS;fw=1;var e=GL(),t=rB(),r=DH(),n=Fg(),i=iR(),a=Array.prototype,s=a.splice;function l(c,d,p,h){var m=h?r:t,_=-1,y=d.length,E=c;for(c===d&&(d=i(d)),p&&(E=e(c,n(p)));++_<y;)for(var T=0,A=d[_],b=p?p(A):A;(T=m(E,b,T,h))>-1;)E!==c&&s.call(E,T,1),s.call(c,T,1);return c}return MS=l,MS}var wS,dw;function BH(){if(dw)return wS;dw=1;var e=LH();function t(r,n){return r&&r.length&&n&&n.length?e(r,n):r}return wS=t,wS}var NS,hw;function FH(){if(hw)return NS;hw=1;var e=eB(),t=BH(),r=e(t);return NS=r,NS}var UH=FH();const kH=Pr(UH);var IS,pw;function zH(){if(pw)return IS;pw=1;var e=XL(),t=Qa(),r="Expected a function";function n(i,a,s){var l=!0,c=!0;if(typeof i!="function")throw new TypeError(r);return t(s)&&(l="leading"in s?!!s.leading:l,c="trailing"in s?!!s.trailing:c),e(i,a,{leading:l,maxWait:a,trailing:c})}return IS=n,IS}var jH=zH();const HH=Pr(jH);var PS,vw;function VH(){if(vw)return PS;vw=1;var e=rB();function t(r,n){var i=r==null?0:r.length;return!!i&&e(r,n,0)>-1}return PS=t,PS}var DS,mw;function XH(){if(mw)return DS;mw=1;function e(t,r,n){for(var i=-1,a=t==null?0:t.length;++i<a;)if(n(r,t[i]))return!0;return!1}return DS=e,DS}var LS,_w;function GH(){if(_w)return LS;_w=1;function e(){}return LS=e,LS}var BS,gw;function qH(){if(gw)return BS;gw=1;var e=zL(),t=GH(),r=uR(),n=1/0,i=e&&1/r(new e([,-0]))[1]==n?function(a){return new e(a)}:t;return BS=i,BS}var FS,yw;function WH(){if(yw)return FS;yw=1;var e=qL(),t=VH(),r=XH(),n=WL(),i=qH(),a=uR(),s=200;function l(c,d,p){var h=-1,m=t,_=c.length,y=!0,E=[],T=E;if(p)y=!1,m=r;else if(_>=s){var A=d?null:i(c);if(A)return a(A);y=!1,m=n,T=new e}else T=d?[]:E;e:for(;++h<_;){var b=c[h],R=d?d(b):b;if(b=p||b!==0?b:0,y&&R===R){for(var M=T.length;M--;)if(T[M]===R)continue e;d&&T.push(R),E.push(b)}else m(T,R,p)||(T!==E&&T.push(R),E.push(b))}return E}return FS=l,FS}var US,Ew;function YH(){if(Ew)return US;Ew=1;var e=WH();function t(r){return r&&r.length?e(r):[]}return US=t,US}var $H=YH();const ZH=Pr($H);var kS,Tw;function KH(){if(Tw)return kS;Tw=1;function e(t,r,n){var i=-1,a=t.length;r<0&&(r=-r>a?0:a+r),n=n>a?a:n,n<0&&(n+=a),a=r>n?0:n-r>>>0,r>>>=0;for(var s=Array(a);++i<a;)s[i]=t[i+r];return s}return kS=e,kS}var zS,Sw;function QH(){if(Sw)return zS;Sw=1;var e=KH();function t(r,n,i){var a=r.length;return i=i===void 0?a:i,!n&&i>=a?r:e(r,n,i)}return zS=t,zS}var jS,Aw;function nB(){if(Aw)return jS;Aw=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",r="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",i=t+r+n,a="\\ufe0e\\ufe0f",s="\\u200d",l=RegExp("["+s+e+i+a+"]");function c(d){return l.test(d)}return jS=c,jS}var HS,bw;function JH(){if(bw)return HS;bw=1;function e(t){return t.split("")}return HS=e,HS}var VS,xw;function eV(){if(xw)return VS;xw=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",r="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",i=t+r+n,a="\\ufe0e\\ufe0f",s="["+e+"]",l="["+i+"]",c="\\ud83c[\\udffb-\\udfff]",d="(?:"+l+"|"+c+")",p="[^"+e+"]",h="(?:\\ud83c[\\udde6-\\uddff]){2}",m="[\\ud800-\\udbff][\\udc00-\\udfff]",_="\\u200d",y=d+"?",E="["+a+"]?",T="(?:"+_+"(?:"+[p,h,m].join("|")+")"+E+y+")*",A=E+y+T,b="(?:"+[p+l+"?",l,h,m,s].join("|")+")",R=RegExp(c+"(?="+c+")|"+b+A,"g");function M(B){return B.match(R)||[]}return VS=M,VS}var XS,Rw;function tV(){if(Rw)return XS;Rw=1;var e=JH(),t=nB(),r=eV();function n(i){return t(i)?r(i):e(i)}return XS=n,XS}var GS,Cw;function rV(){if(Cw)return GS;Cw=1;var e=QH(),t=nB(),r=tV(),n=nh();function i(a){return function(s){s=n(s);var l=t(s)?r(s):void 0,c=l?l[0]:s.charAt(0),d=l?e(l,1).join(""):s.slice(1);return c[a]()+d}}return GS=i,GS}var qS,Ow;function iB(){if(Ow)return qS;Ow=1;var e=rV(),t=e("toUpperCase");return qS=t,qS}var nV=iB();const iV=Pr(nV);var aV=Pg();const oV=Pr(aV);var sV=Qa();const uV=Pr(sV);var WS,Mw;function lV(){if(Mw)return WS;Mw=1;function e(t){return t===void 0}return WS=e,WS}var cV=lV();const fV=Pr(cV);var YS,ww;function dV(){if(ww)return YS;ww=1;var e=nh(),t=iB();function r(n){return t(e(n).toLowerCase())}return YS=r,YS}var $S,Nw;function hV(){if(Nw)return $S;Nw=1;function e(t,r,n,i){var a=-1,s=t==null?0:t.length;for(i&&s&&(n=t[++a]);++a<s;)n=r(n,t[a],a,t);return n}return $S=e,$S}var ZS,Iw;function pV(){if(Iw)return ZS;Iw=1;function e(t){return function(r){return t?.[r]}}return ZS=e,ZS}var KS,Pw;function vV(){if(Pw)return KS;Pw=1;var e=pV(),t={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},r=e(t);return KS=r,KS}var QS,Dw;function mV(){if(Dw)return QS;Dw=1;var e=vV(),t=nh(),r=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,n="\\u0300-\\u036f",i="\\ufe20-\\ufe2f",a="\\u20d0-\\u20ff",s=n+i+a,l="["+s+"]",c=RegExp(l,"g");function d(p){return p=t(p),p&&p.replace(r,e).replace(c,"")}return QS=d,QS}var JS,Lw;function _V(){if(Lw)return JS;Lw=1;var e=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g;function t(r){return r.match(e)||[]}return JS=t,JS}var eA,Bw;function gV(){if(Bw)return eA;Bw=1;var e=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/;function t(r){return e.test(r)}return eA=t,eA}var tA,Fw;function yV(){if(Fw)return tA;Fw=1;var e="\\ud800-\\udfff",t="\\u0300-\\u036f",r="\\ufe20-\\ufe2f",n="\\u20d0-\\u20ff",i=t+r+n,a="\\u2700-\\u27bf",s="a-z\\xdf-\\xf6\\xf8-\\xff",l="\\xac\\xb1\\xd7\\xf7",c="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",d="\\u2000-\\u206f",p=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",h="A-Z\\xc0-\\xd6\\xd8-\\xde",m="\\ufe0e\\ufe0f",_=l+c+d+p,y="['’]",E="["+_+"]",T="["+i+"]",A="\\d+",b="["+a+"]",R="["+s+"]",M="[^"+e+_+A+a+s+h+"]",B="\\ud83c[\\udffb-\\udfff]",w="(?:"+T+"|"+B+")",D="[^"+e+"]",U="(?:\\ud83c[\\udde6-\\uddff]){2}",ae="[\\ud800-\\udbff][\\udc00-\\udfff]",Q="["+h+"]",X="\\u200d",x="(?:"+R+"|"+M+")",P="(?:"+Q+"|"+M+")",H="(?:"+y+"(?:d|ll|m|re|s|t|ve))?",pe="(?:"+y+"(?:D|LL|M|RE|S|T|VE))?",O=w+"?",F="["+m+"]?",z="(?:"+X+"(?:"+[D,U,ae].join("|")+")"+F+O+")*",re="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",oe="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",_e=F+O+z,ye="(?:"+[b,U,ae].join("|")+")"+_e,Ie=RegExp([Q+"?"+R+"+"+H+"(?="+[E,Q,"$"].join("|")+")",P+"+"+pe+"(?="+[E,Q+x,"$"].join("|")+")",Q+"?"+x+"+"+H,Q+"+"+pe,oe,re,A,ye].join("|"),"g");function Je(We){return We.match(Ie)||[]}return tA=Je,tA}var rA,Uw;function EV(){if(Uw)return rA;Uw=1;var e=_V(),t=gV(),r=nh(),n=yV();function i(a,s,l){return a=r(a),s=l?void 0:s,s===void 0?t(a)?n(a):e(a):a.match(s)||[]}return rA=i,rA}var nA,kw;function TV(){if(kw)return nA;kw=1;var e=hV(),t=mV(),r=EV(),n="['’]",i=RegExp(n,"g");function a(s){return function(l){return e(r(t(l).replace(i,"")),s,"")}}return nA=a,nA}var iA,zw;function SV(){if(zw)return iA;zw=1;var e=dV(),t=TV(),r=t(function(n,i,a){return i=i.toLowerCase(),n+(a?e(i):i)});return iA=r,iA}var AV=SV();const bV=Pr(AV);var aA,jw;function xV(){if(jw)return aA;jw=1;var e=nh(),t=0;function r(n){var i=++t;return e(n)+i}return aA=r,aA}var RV=xV();const CV=Pr(RV);var yn={isNil:rH,merge:CH,throttle:HH,isString:cH,debounce:Oj,pull:kH,isTypedArray:dH,isPlainObject:sH,isNumber:aH,isBoolean:Hj,isEqual:Jj,cloneDeep:xj,uniq:ZH,clamp:Tz,upperFirst:iV,get:kj,mergeWith:wH,isFunction:oV,isObject:uV,isUndefined:fV,camelCase:bV,uniqueId:CV},{pull:sde}=yn;function OV(e){let t=e;return typeof e=="string"&&(t=window.document.getElementById(e)),t}function aB(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function oB(e){return aB(e).split(/\s+/)}function MV(e){var t;const r=(t=document?.documentElement)==null?void 0:t.style;if(!r)return e[0];for(const n in e)if(e[n]&&e[n]in r)return e[n];return e[0]}function ba(e,t,r){const n=window.document.createElement(e);return t&&(n.className=t||""),r&&r.appendChild(n),n}function D0(e){const t=e.parentNode;t&&t.removeChild(e)}function mv(e,t){if(e.classList!==void 0){const r=oB(t);for(let n=0,i=r.length;n<i;n++)e.classList.add(r[n])}else if(!wV(e,t)){const r=lR(e);sB(e,(r?r+" ":"")+t)}}function Rb(e,t){e.classList!==void 0?oB(t).forEach(n=>{e.classList.remove(n)}):sB(e,aB((" "+lR(e)+" ").replace(" "+t+" "," ")))}function wV(e,t){if(e.classList!==void 0)return e.classList.contains(t);const r=lR(e);return r.length>0&&new RegExp("(^|\\s)"+t+"(\\s|$)").test(r)}function sB(e,t){e instanceof HTMLElement?e.className=t:e.className.baseVal=t}function lR(e){return e instanceof SVGElement&&(e=e.correspondingElement),e.className.baseVal===void 0?e.className:e.className.baseVal}MV(["transform","WebkitTransform"]);function NV(){var e;const t=window.document.querySelector('meta[name="viewport"]');if(!t)return 1;const n=((e=t.content)==null?void 0:e.split(",")).find(i=>{const[a]=i.split("=");return a==="initial-scale"});return n?n.split("=")[1]*1:1}var na=NV()<1?1:window.devicePixelRatio;function IV(e,t){e.setAttribute("style",`${e.style.cssText}${t}`)}function PV(e){return Object.entries(e).map(([t,r])=>`${t}: ${r}`).join(";")}function DV(e,t){return{left:e.left-t.left,top:e.top-t.top,right:t.left+t.width-e.left-e.width,bottom:t.top+t.height-e.top-e.height}}function uB(e){e.innerHTML=""}function LV(e){e.setAttribute("draggable","false")}function BV(e,t){var r;const n=Array.isArray(t)?t:[t];let i=e;for(;i instanceof Element&&i!==window.document.body;){if(n.find(a=>i?.matches(a)))return i;i=(r=i?.parentElement)!=null?r:null}}function FV(e){return typeof ImageBitmap<"u"&&e instanceof ImageBitmap}var Cb=navigator?.userAgent;Cb.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/);Cb.indexOf("Android")>-1||Cb.indexOf("Adr")>-1;function Ob(e){var t=[1/0,1/0,-1/0,-1/0];return _L(e,function(r){t[0]>r[0]&&(t[0]=r[0]),t[1]>r[1]&&(t[1]=r[1]),t[2]<r[0]&&(t[2]=r[0]),t[3]<r[1]&&(t[3]=r[1])}),t}Ob.default=Ob;function oA(e){return typeof e=="number"}function Wn(e){return e-Math.fround(e)}var Hw=2*Math.PI*6378137/2;function UV(e,t){const[r,n,i,a]=t;return e.lng>r&&e.lng<=i&&e.lat>n&&e.lat<=a}function kV(e){const t=[1/0,1/0,-1/0,-1/0];return e.forEach(r=>{const{coordinates:n}=r;lB(t,n)}),t}function lB(e,t){return Array.isArray(t[0])?t.forEach(r=>{lB(e,r)}):(e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])),e}function u0(e,t=!0,r={enable:!0,decimal:1}){e=HV(e,t);const n=e[0],i=e[1];let a=n*Hw/180,s=Math.log(Math.tan((90+i)*Math.PI/360))/(Math.PI/180);return s=s*Hw/180,r.enable&&(a=Number(a.toFixed(r.decimal)),s=Number(s.toFixed(r.decimal))),e.length===3?[a,s,e[2]]:[a,s]}function zV(e){if(e==null)throw new Error("lng is required");return(e>180||e<-180)&&(e=e%360,e>180&&(e=-360+e),e<-180&&(e=360+e),e===0&&(e=0)),e}function jV(e){if(e==null)throw new Error("lat is required");return(e>90||e<-90)&&(e=e%180,e>90&&(e=-180+e),e<-90&&(e=180+e),e===0&&(e=0)),e}function HV(e,t){if(t===!1)return e;const r=zV(e[0]);let n=jV(e[1]);return n>85&&(n=85),n<-85&&(n=-85),e.length===3?[r,n,e[2]]:[r,n]}function Ya(e){const t=85.0511287798,r=Math.max(Math.min(t,e[1]),-t),n=256<<20;let i=Math.PI/180,a=e[0]*i,s=r*i;s=Math.log(Math.tan(Math.PI/4+s/2));const l=.5/Math.PI,c=.5,d=-.5/Math.PI;return i=.5,a=n*(l*a+c),s=n*(d*s+i),[Math.floor(a),Math.floor(s)]}function sA(e,t){const r=85.0511287798,n=Math.PI/180,i=6378137;return t=Math.max(Math.min(r,t),-r),e*=n,t*=n,t=Math.log(Math.tan(Math.PI/4+t/2)),[e*i,t*i]}function cR(e,t){const r=Math.abs(e[1][1]-e[0][1])*t,n=Math.abs(e[1][0]-e[0][0])*t;return[[e[0][0]-n,e[0][1]-r],[e[1][0]+n,e[1][1]+r]]}function cB(e,t){return e[0][0]<=t[0][0]&&e[0][1]<=t[0][1]&&e[1][0]>=t[1][0]&&e[1][1]>=t[1][1]}function L0(e){return[[e[0],e[1]],[e[2],e[3]]]}function VV(e){const t=XV(e,[0,0]);return[e[0]/t,e[1]/t]}function XV(e,t){return Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2))}function Fc(e){if(oA(e[0]))return e;if(oA(e[0][0]))throw new Error("当前数据不支持标注");if(oA(e[0][0][0])){const t=e;let r=0,n=0,i=0;return t.forEach(a=>{a.forEach(s=>{r+=s[0],n+=s[1],i++})}),[r/i,n/i,0]}else throw new Error("当前数据不支持标注")}function GV(e){let t=e[0],r=e[1],n=e[0],i=e[1],a=0,s=0,l=0;for(let c=0;c<e.length;c+=2){const d=e[c],p=e[c+1];d&&p&&(t=Math.max(d,t),r=Math.max(p,r),n=Math.min(d,n),i=Math.min(p,i),a+=d,s+=p,l++)}return{center:[a/l,s/l],radius:Math.sqrt(Math.pow(t-n,2)+Math.pow(r-i,2))/2}}function qV(e){return Ob(z9([k9(e)]))}function WV(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)})}var YV=class{constructor(e=50,t){this.limit=e,this.destroy=t||this.defaultDestroy,this.order=[],this.clear()}clear(){this.order.forEach(e=>{this.delete(e)}),this.cache={},this.order=[]}get(e){const t=this.cache[e];return t&&(this.deleteOrder(e),this.appendOrder(e)),t}set(e,t){this.cache[e]?(this.delete(e),this.cache[e]=t,this.appendOrder(e)):(Object.keys(this.cache).length===this.limit&&this.delete(this.order[0]),this.cache[e]=t,this.appendOrder(e))}delete(e){const t=this.cache[e];t&&(this.deleteCache(e),this.deleteOrder(e),this.destroy(t,e))}deleteCache(e){delete this.cache[e]}deleteOrder(e){const t=this.order.findIndex(r=>r===e);t>=0&&this.order.splice(t,1)}appendOrder(e){this.order.push(e)}defaultDestroy(e,t){return null}};function $V(e){if(e.length===0)throw new Error("max requires at least one data point");let t=e[0];for(let r=1;r<e.length;r++)e[r]>t&&(t=e[r]);return t*1}function ZV(e){if(e.length===0)throw new Error("min requires at least one data point");let t=e[0];for(let r=1;r<e.length;r++)e[r]<t&&(t=e[r]);return t*1}function fB(e){if(e.length===0)return 0;let t=e[0]*1;for(let r=1;r<e.length;r++)t+=e[r]*1;return t}function KV(e){if(e.length===0)throw new Error("mean requires at least one data point");return fB(e)/e.length}function QV(e){if(e.length===0)throw new Error("mean requires at least one data point");if(e.length<3)return e[0];e.sort();let t=e[0],r=NaN,n=0,i=1;for(let a=1;a<e.length+1;a++)e[a]!==t?(i>n&&(n=i,r=t),i=1,t=e[a]):i++;return r*1}var dB={min:ZV,max:$V,mean:KV,sum:fB,mode:QV};function hB(e,t){return e.map(r=>r[t])}function JV(e,t){t===void 0&&(t={});var r=Number(e[0]),n=Number(e[1]),i=Number(e[2]),a=Number(e[3]);if(e.length===6)throw new Error("@turf/bbox-polygon does not support BBox with 6 positions");var s=[r,n],l=[r,a],c=[i,a],d=[i,n];return Hx([[s,d,c,l,s]],t.properties,{bbox:e,id:t.id})}var uA={exports:{}},Vw;function eX(){return Vw||(Vw=1,(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function i(c,d,p){this.fn=c,this.context=d,this.once=p||!1}function a(c,d,p,h,m){if(typeof p!="function")throw new TypeError("The listener must be a function");var _=new i(p,h||c,m),y=r?r+d:d;return c._events[y]?c._events[y].fn?c._events[y]=[c._events[y],_]:c._events[y].push(_):(c._events[y]=_,c._eventsCount++),c}function s(c,d){--c._eventsCount===0?c._events=new n:delete c._events[d]}function l(){this._events=new n,this._eventsCount=0}l.prototype.eventNames=function(){var d=[],p,h;if(this._eventsCount===0)return d;for(h in p=this._events)t.call(p,h)&&d.push(r?h.slice(1):h);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(p)):d},l.prototype.listeners=function(d){var p=r?r+d:d,h=this._events[p];if(!h)return[];if(h.fn)return[h.fn];for(var m=0,_=h.length,y=new Array(_);m<_;m++)y[m]=h[m].fn;return y},l.prototype.listenerCount=function(d){var p=r?r+d:d,h=this._events[p];return h?h.fn?1:h.length:0},l.prototype.emit=function(d,p,h,m,_,y){var E=r?r+d:d;if(!this._events[E])return!1;var T=this._events[E],A=arguments.length,b,R;if(T.fn){switch(T.once&&this.removeListener(d,T.fn,void 0,!0),A){case 1:return T.fn.call(T.context),!0;case 2:return T.fn.call(T.context,p),!0;case 3:return T.fn.call(T.context,p,h),!0;case 4:return T.fn.call(T.context,p,h,m),!0;case 5:return T.fn.call(T.context,p,h,m,_),!0;case 6:return T.fn.call(T.context,p,h,m,_,y),!0}for(R=1,b=new Array(A-1);R<A;R++)b[R-1]=arguments[R];T.fn.apply(T.context,b)}else{var M=T.length,B;for(R=0;R<M;R++)switch(T[R].once&&this.removeListener(d,T[R].fn,void 0,!0),A){case 1:T[R].fn.call(T[R].context);break;case 2:T[R].fn.call(T[R].context,p);break;case 3:T[R].fn.call(T[R].context,p,h);break;case 4:T[R].fn.call(T[R].context,p,h,m);break;default:if(!b)for(B=1,b=new Array(A-1);B<A;B++)b[B-1]=arguments[B];T[R].fn.apply(T[R].context,b)}}return!0},l.prototype.on=function(d,p,h){return a(this,d,p,h,!1)},l.prototype.once=function(d,p,h){return a(this,d,p,h,!0)},l.prototype.removeListener=function(d,p,h,m){var _=r?r+d:d;if(!this._events[_])return this;if(!p)return s(this,_),this;var y=this._events[_];if(y.fn)y.fn===p&&(!m||y.once)&&(!h||y.context===h)&&s(this,_);else{for(var E=0,T=[],A=y.length;E<A;E++)(y[E].fn!==p||m&&!y[E].once||h&&y[E].context!==h)&&T.push(y[E]);T.length?this._events[_]=T.length===1?T[0]:T:s(this,_)}return this},l.prototype.removeAllListeners=function(d){var p;return d?(p=r?r+d:d,this._events[p]&&s(this,p)):(this._events=new n,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=r,l.EventEmitter=l,e.exports=l})(uA)),uA.exports}var Oa=eX();const fR=Pr(Oa);var _v=(e=>(e.Realtime="realtime",e.Overlap="overlap",e.Replace="replace",e))(_v||{}),Ha=(e=>(e.Loading="Loading",e.Loaded="Loaded",e.Failure="Failure",e.Cancelled="Cancelled",e))(Ha||{}),pB=0,Xw=1,jg=2;function tX(e){e.forEach(t=>{t.isCurrent&&(t.isVisible=t.isLoaded)})}function rX(e){e.forEach(t=>{t.properties.state=pB}),e.forEach(t=>{t.isCurrent&&!vB(t)&&dR(t)}),e.forEach(t=>{t.isVisible=!!(t.properties.state&jg)})}function nX(e){e.forEach(r=>{r.properties.state=pB}),e.forEach(r=>{r.isCurrent&&vB(r)}),e.slice().sort((r,n)=>r.z-n.z).forEach(r=>{r.isVisible=!!(r.properties.state&jg),r.children.length&&(r.isVisible||r.properties.state&Xw)?r.children.forEach(n=>{n.properties.state=Xw}):r.isCurrent&&dR(r)})}function vB(e){for(;e;){if(e.isLoaded)return e.properties.state|=jg,!0;e=e.parent}return!1}function dR(e){e.children.forEach(t=>{t.isLoaded?t.properties.state|=jg:dR(t)})}var mB=[-1/0,-1/0,1/0,1/0],iX=.2,aX=5,oX={[_v.Realtime]:tX,[_v.Overlap]:rX,[_v.Replace]:nX},sX=()=>{};function Mb(e,t,r){const n=Math.floor((e+180)/360*Math.pow(2,r)),i=Math.floor((1-Math.log(Math.tan(t*Math.PI/180)+1/Math.cos(t*Math.PI/180))/Math.PI)/2*Math.pow(2,r));return[n,i]}function Gw(e,t,r){const n=e/Math.pow(2,r)*360-180,i=Math.PI-2*Math.PI*t/Math.pow(2,r),a=180/Math.PI*Math.atan(.5*(Math.exp(i)-Math.exp(-i)));return[n,a]}var _B=(e,t,r)=>{const[n,i]=Gw(e,t,r),[a,s]=Gw(e+1,t+1,r);return[n,s,a,i]};function uX({zoom:e,latLonBounds:t,maxZoom:r=1/0,minZoom:n=0,zoomOffset:i=0,extent:a=mB}){let s=Math.ceil(e)+i;if(Number.isFinite(n)&&s<n)return[];Number.isFinite(r)&&s>r&&(s=r);const[l,c,d,p]=t,h=[Math.max(l,a[0]),Math.max(c,a[1]),Math.min(d,a[2]),Math.min(p,a[3])],m=[],[_,y]=Mb(h[0],h[1],s),[E,T]=Mb(h[2],h[3],s);for(let M=_;M<=E;M++)for(let B=T;B<=y;B++)m.push({x:M,y:B,z:s});const A=(E+_)/2,b=(y+T)/2,R=(M,B)=>Math.abs(M-A)+Math.abs(B-b);return m.sort((M,B)=>R(M.x,M.y)-R(B.x,B.y)),m}var lX=(e,t,r,n=!0)=>{const i=Math.pow(2,r),a=i-1,s=i;let l=e;const c=t;return n&&(l<0?l=l+s:l>a&&(l=l%s)),{warpX:l,warpY:c}},cX=(e,t,r)=>new Promise((n,i)=>{var a=c=>{try{l(r.next(c))}catch(d){i(d)}},s=c=>{try{l(r.throw(c))}catch(d){i(d)}},l=c=>c.done?n(c.value):Promise.resolve(c.value).then(a,s);l((r=r.apply(e,t)).next())}),fX=class extends Oa.EventEmitter{constructor(e){super(),this.tileSize=256,this.isVisible=!1,this.isCurrent=!1,this.isVisibleChange=!1,this.loadedLayers=0,this.isLayerLoaded=!1,this.isLoad=!1,this.isChildLoad=!1,this.parent=null,this.children=[],this.data=null,this.properties={},this.loadDataId=0;const{x:t,y:r,z:n,tileSize:i,warp:a=!0}=e;this.x=t,this.y=r,this.z=n,this.warp=a||!0,this.tileSize=i}get isLoading(){return this.loadStatus===Ha.Loading}get isLoaded(){return this.loadStatus===Ha.Loaded}get isFailure(){return this.loadStatus===Ha.Failure}setTileLayerLoaded(){this.isLayerLoaded=!0}get isCancelled(){return this.loadStatus===Ha.Cancelled}get isDone(){return[Ha.Loaded,Ha.Cancelled,Ha.Failure].includes(this.loadStatus)}get bounds(){return _B(this.x,this.y,this.z)}get bboxPolygon(){const[e,t,r,n]=this.bounds,i=[(r-e)/2,(n-t)/2];return JV(this.bounds,{properties:{key:this.key,id:this.key,bbox:this.bounds,center:i,meta:`
      ${this.key}
      `}})}get key(){return`${this.x}_${this.y}_${this.z}`}layerLoad(){this.loadedLayers++,this.emit("layerLoaded")}loadData(e){return cX(this,arguments,function*({getData:t,onLoad:r,onError:n}){this.loadDataId++;const i=this.loadDataId;this.isLoading&&this.abortLoad(),this.abortController=new AbortController,this.loadStatus=Ha.Loading;let a=null,s;try{const{x:l,y:c,z:d,bounds:p,tileSize:h,warp:m}=this,{warpX:_,warpY:y}=lX(l,c,d,m),{signal:E}=this.abortController;a=yield t({x:_,y,z:d,bounds:p,tileSize:h,signal:E,warp:m},this)}catch(l){s=l}if(i===this.loadDataId&&!(this.isCancelled&&!a)){if(s||!a){this.loadStatus=Ha.Failure,n(s,this);return}this.loadStatus=Ha.Loaded,this.data=a,r(this)}})}reloadData(e){this.isLoading&&this.abortLoad(),this.loadData(e)}abortLoad(){this.isLoaded||this.isCancelled||(this.loadStatus=Ha.Cancelled,this.abortController.abort(),this.xhrCancel&&this.xhrCancel())}},dX=(e,t)=>{const r=L0(e),n=cR(r,t),i=360*3-180,a=85.0511287798065;return[Math.max(n[0][0],-i),Math.max(n[0][1],-a),Math.min(n[1][0],i),Math.min(n[1][1],a)]},hX=(e,t)=>{const r=L0(e),n=L0(t);return cB(r,n)},pX=Object.defineProperty,vX=Object.defineProperties,mX=Object.getOwnPropertyDescriptors,qw=Object.getOwnPropertySymbols,_X=Object.prototype.hasOwnProperty,gX=Object.prototype.propertyIsEnumerable,Ww=(e,t,r)=>t in e?pX(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Yw=(e,t)=>{for(var r in t||(t={}))_X.call(t,r)&&Ww(e,r,t[r]);if(qw)for(var r of qw(t))gX.call(t,r)&&Ww(e,r,t[r]);return e},yX=(e,t)=>vX(e,mX(t)),{throttle:EX}=yn,TX=class extends fR{constructor(e){super(),this.currentTiles=[],this.cacheTiles=new Map,this.throttleUpdate=EX((t,r)=>{this.update(t,r)},16),this.onTileLoad=t=>{this.emit("tile-loaded",t),this.updateTileVisible(),this.loadFinished()},this.onTileError=(t,r)=>{this.emit("tile-error",{error:t,tile:r}),this.updateTileVisible(),this.loadFinished()},this.onTileUnload=t=>{this.emit("tile-unload",t),this.loadFinished()},this.options={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,extent:mB,getTileData:sX,warp:!0,updateStrategy:_v.Replace},this.updateOptions(e)}get isLoaded(){return this.currentTiles.every(e=>e.isDone)}get tiles(){return Array.from(this.cacheTiles.values()).sort((t,r)=>t.z-r.z)}updateOptions(e){const t=e.minZoom===void 0?this.options.minZoom:Math.ceil(e.minZoom),r=e.maxZoom===void 0?this.options.maxZoom:Math.floor(e.maxZoom);this.options=yX(Yw(Yw({},this.options),e),{minZoom:t,maxZoom:r})}update(e,t){const r=Math.max(0,Math.ceil(e));if(this.lastViewStates&&this.lastViewStates.zoom===r&&hX(this.lastViewStates.latLonBoundsBuffer,t))return;const n=dX(t,iX);this.lastViewStates={zoom:r,latLonBounds:t,latLonBoundsBuffer:n},this.currentZoom=r;let i=!1;const a=this.getTileIndices(r,n).filter(s=>this.options.warp||s.x>=0&&s.x<Math.pow(2,r));this.emit("tiles-load-start"),this.currentTiles=a.map(({x:s,y:l,z:c})=>{let d=this.getTile(s,l,c);return d?((d?.isFailure||d?.isCancelled)&&d.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError}),d):(d=this.createTile(s,l,c),i=!0,d)}),i&&this.resizeCacheTiles(),this.updateTileVisible(),this.pruneRequests()}reloadAll(){for(const[e,t]of this.cacheTiles){if(!this.currentTiles.includes(t)){this.cacheTiles.delete(e),this.onTileUnload(t);return}this.onTileUnload(t),t.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError})}}reloadTileById(e,t,r){const n=this.cacheTiles.get(`${t},${r},${e}`);n&&(this.onTileUnload(n),n.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError}))}reloadTileByLnglat(e,t,r){const n=this.getTileByLngLat(e,t,r);n&&this.reloadTileById(n.z,n.x,n.y)}reloadTileByExtent(e,t){this.getTileIndices(t,e).forEach(n=>{this.reloadTileById(n.z,n.x,n.y)})}pruneRequests(){const e=[];for(const t of this.cacheTiles.values())t.isLoading&&!t.isCurrent&&!t.isVisible&&e.push(t);for(;e.length>0;)e.shift().abortLoad()}getTileByLngLat(e,t,r){const{zoomOffset:n}=this.options,i=Math.ceil(r)+n,a=Mb(e,t,i);return this.tiles.filter(l=>l.key===`${a[0]}_${a[1]}_${i}`)[0]}getTileExtent(e,t){return this.getTileIndices(t,e)}getTileByZXY(e,t,r){return this.tiles.filter(i=>i.key===`${t}_${r}_${e}`)[0]}clear(){for(const e of this.cacheTiles.values())e.isLoading?e.abortLoad():this.onTileUnload(e);this.lastViewStates=void 0,this.cacheTiles.clear(),this.currentTiles=[]}destroy(){this.clear(),this.removeAllListeners()}updateTileVisible(){const e=this.options.updateStrategy,t=new Map;for(const i of this.cacheTiles.values())t.set(i.key,i.isVisible),i.isCurrent=!1,i.isVisible=!1;for(const i of this.currentTiles)i.isCurrent=!0,i.isVisible=!0;const r=Array.from(this.cacheTiles.values());typeof e=="function"?e(r):oX[e](r);let n=!1;Array.from(this.cacheTiles.values()).forEach(i=>{i.isVisible!==t.get(i.key)?(i.isVisibleChange=!0,n=!0):i.isVisibleChange=!1}),n&&this.emit("tile-update")}getTileIndices(e,t){const{tileSize:r,extent:n,zoomOffset:i}=this.options,a=Math.floor(this.options.maxZoom),s=Math.ceil(this.options.minZoom);return uX({maxZoom:a,minZoom:s,zoomOffset:i,zoom:e,latLonBounds:t,extent:n})}getTileId(e,t,r){return`${e},${t},${r}`}loadFinished(){const e=!this.currentTiles.some(t=>!t.isDone);return e&&this.emit("tiles-load-finished"),e}getTile(e,t,r){const n=this.getTileId(e,t,r);return this.cacheTiles.get(n)}createTile(e,t,r){const n=this.getTileId(e,t,r),i=new fX({x:e,y:t,z:r,tileSize:this.options.tileSize,warp:this.options.warp});return this.cacheTiles.set(n,i),i.loadData({getData:this.options.getTileData,onLoad:this.onTileLoad,onError:this.onTileError}),i}resizeCacheTiles(){const e=aX*this.currentTiles.length;if(this.cacheTiles.size>e){for(const[r,n]of this.cacheTiles)if(!n.isVisible&&!this.currentTiles.includes(n)&&(this.cacheTiles.delete(r),this.onTileUnload(n)),this.cacheTiles.size<=e)break}this.rebuildTileTree()}rebuildTileTree(){for(const e of this.cacheTiles.values())e.parent=null,e.children.length=0;for(const e of this.cacheTiles.values()){const t=this.getNearestAncestor(e.x,e.y,e.z);e.parent=t,t?.children&&t.children.push(e)}}getNearestAncestor(e,t,r){for(;r>this.options.minZoom;){e=Math.floor(e/2),t=Math.floor(t/2),r=r-1;const n=this.getTile(e,t,r);if(n)return n}return null}};function gB(e){const t=[];let r=/\{([a-z])-([a-z])\}/.exec(e);if(r){const n=r[1].charCodeAt(0),i=r[2].charCodeAt(0);let a;for(a=n;a<=i;++a)t.push(e.replace(r[0],String.fromCharCode(a)));return t}if(r=/\{(\d+)-(\d+)\}/.exec(e),r){const n=parseInt(r[2],10);for(let i=parseInt(r[1],10);i<=n;i++)t.push(e.replace(r[0],i.toString()));return t}return t.push(e),t}function Md(e,t){if(!e||!e.length)throw new Error("url is not allowed to be empty");const{x:r,y:n,z:i}=t,a=gB(e),s=Math.abs(r+n)%a.length;return(Gx(a[s])?`${a[s]}/{z}/{x}/{y}`:a[s]).replace(/\{x\}/g,r.toString()).replace(/\{y\}/g,n.toString()).replace(/\{z\}/g,i.toString()).replace(/\{bbox\}/g,_B(r,n,i).join(",")).replace(/\{-y\}/g,(Math.pow(2,i)-n-1).toString())}function SX(e,t){const{x:r,y:n,z:i,layer:a,version:s="1.0.0",style:l="default",format:c,service:d="WMTS",tileMatrixset:p}=t,h=gB(e),m=Math.abs(r+n)%h.length;return`${h[m]}&SERVICE=${d}&REQUEST=GetTile&VERSION=${s}&LAYER=${a}&STYLE=${l}&TILEMATRIXSET=${p}&FORMAT=${c}&TILECOL=${r}&TILEROW=${n}&TILEMATRIX=${i}`}function xp(e,t){return e??t}var lA,$w;function AX(){if($w)return lA;$w=1,lA=e;function e(n,i){var a=n&&n.type,s;if(a==="FeatureCollection")for(s=0;s<n.features.length;s++)e(n.features[s],i);else if(a==="GeometryCollection")for(s=0;s<n.geometries.length;s++)e(n.geometries[s],i);else if(a==="Feature")e(n.geometry,i);else if(a==="Polygon")t(n.coordinates,i);else if(a==="MultiPolygon")for(s=0;s<n.coordinates.length;s++)t(n.coordinates[s],i);return n}function t(n,i){if(n.length!==0){r(n[0],i);for(var a=1;a<n.length;a++)r(n[a],!i)}}function r(n,i){for(var a=0,s=0,l=0,c=n.length,d=c-1;l<c;d=l++){var p=(n[l][0]-n[d][0])*(n[d][1]+n[l][1]),h=a+p;s+=Math.abs(a)>=Math.abs(p)?a-h+p:p-h+a,a=h}a+s>=0!=!!i&&n.reverse()}return lA}var bX=AX();const xX=Pr(bX);function RX(e,t){return e.map(r=>r[t]*1)}function yB(e){return Array.isArray(e)?e.length===0||typeof e[0]=="number":!1}function wb(e){const t=Object.isFrozen(e)?yn.cloneDeep(e):e;return xX(t,!0),t}function ih(e,t){return e||[[t[0],t[3]],[t[2],t[3]],[t[2],t[1]],[t[0],t[1]]]}var CX=Object.defineProperty,OX=Object.defineProperties,MX=Object.getOwnPropertyDescriptors,Zw=Object.getOwnPropertySymbols,wX=Object.prototype.hasOwnProperty,NX=Object.prototype.propertyIsEnumerable,Kw=(e,t,r)=>t in e?CX(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Qw=(e,t)=>{for(var r in t||(t={}))wX.call(t,r)&&Kw(e,r,t[r]);if(Zw)for(var r of Zw(t))NX.call(t,r)&&Kw(e,r,t[r]);return e},Jw=(e,t)=>OX(e,MX(t));function EB(e,t){const{x:r,y:n,x1:i,y1:a,coordinates:s,geometry:l}=t,c=[];if(!Array.isArray(e))return{dataArray:[]};if(l)return e.filter(d=>d[l]&&d[l].type&&d[l].coordinates&&d[l].coordinates.length>0).forEach((d,p)=>{const h=wb(d[l]);gL(h,m=>{const _=mL(m),y=Jw(Qw({},d),{_id:p,coordinates:_});c.push(y)})}),{dataArray:c};for(let d=0;d<e.length;d++){const p=e[d];let h=[];if(s){let _="Polygon";Array.isArray(s[0])||(_="Point"),Array.isArray(s[0])&&!Array.isArray(s[0][0])&&(_="LineString"),h=wb({type:_,coordinates:p[s]}).coordinates}else if(r&&n&&i&&a){const _=[parseFloat(p[r]),parseFloat(p[n])],y=[parseFloat(p[i]),parseFloat(p[a])];h=[_,y]}else r&&n&&(h=[parseFloat(p[r]),parseFloat(p[n])]);const m=Jw(Qw({},p),{_id:d,coordinates:h});c.push(m)}return{dataArray:c}}function IX(e,t){const r=U9(e);return EB(r,t)}var PX=Object.defineProperty,DX=Object.defineProperties,LX=Object.getOwnPropertyDescriptors,eN=Object.getOwnPropertySymbols,BX=Object.prototype.hasOwnProperty,FX=Object.prototype.propertyIsEnumerable,tN=(e,t,r)=>t in e?PX(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,UX=(e,t)=>{for(var r in t||(t={}))BX.call(t,r)&&tN(e,r,t[r]);if(eN)for(var r of eN(t))FX.call(t,r)&&tN(e,r,t[r]);return e},kX=(e,t)=>DX(e,LX(t));function zX(e){const t=e.toString();let r=5381,n=t.length;for(;n;)r=r*33^t.charCodeAt(--n);return r>>>0}function jX(e,t){return t===void 0?null:isNaN(e.properties[t]*1)?e.properties&&e.properties[t]?zX(e.properties[t]+"")%1000019:null:e.properties[t]*1}function HX(e,t){const r=[],n={};return e.features?(e.features=e.features.filter(i=>{const a=i.geometry;return i!=null&&a&&a.type&&a.coordinates&&a.coordinates.length>0}),e=wb(e),e.features.length===0?{dataArray:[],featureKeys:n}:(gL(e,(i,a)=>{let s=jX(i,t?.featureId);s===null&&(s=a);const l=s,c=mL(i),d=kX(UX({},i.properties),{coordinates:c,_id:l});r.push(d)}),{dataArray:r,featureKeys:n})):(e.features=[],{dataArray:[]})}function Nb(e,t,r,n){for(var i=n,a=r-t>>1,s=r-t,l,c=e[t],d=e[t+1],p=e[r],h=e[r+1],m=t+3;m<r;m+=3){var _=VX(e[m],e[m+1],c,d,p,h);if(_>i)l=m,i=_;else if(_===i){var y=Math.abs(m-a);y<s&&(l=m,s=y)}}i>n&&(l-t>3&&Nb(e,t,l,n),e[l+2]=i,r-l>3&&Nb(e,l,r,n))}function VX(e,t,r,n,i,a){var s=i-r,l=a-n;if(s!==0||l!==0){var c=((e-r)*s+(t-n)*l)/(s*s+l*l);c>1?(r=i,n=a):c>0&&(r+=s*c,n+=l*c)}return s=e-r,l=t-n,s*s+l*l}function Cv(e,t,r,n){var i={id:typeof e>"u"?null:e,type:t,geometry:r,tags:n,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return XX(i),i}function XX(e){var t=e.geometry,r=e.type;if(r==="Point"||r==="MultiPoint"||r==="LineString")cA(e,t);else if(r==="Polygon"||r==="MultiLineString")for(var n=0;n<t.length;n++)cA(e,t[n]);else if(r==="MultiPolygon")for(n=0;n<t.length;n++)for(var i=0;i<t[n].length;i++)cA(e,t[n][i])}function cA(e,t){for(var r=0;r<t.length;r+=3)e.minX=Math.min(e.minX,t[r]),e.minY=Math.min(e.minY,t[r+1]),e.maxX=Math.max(e.maxX,t[r]),e.maxY=Math.max(e.maxY,t[r+1])}function GX(e,t){var r=[];if(e.type==="FeatureCollection")for(var n=0;n<e.features.length;n++)l0(r,e.features[n],t,n);else e.type==="Feature"?l0(r,e,t):l0(r,{geometry:e},t);return r}function l0(e,t,r,n){if(t.geometry){var i=t.geometry.coordinates,a=t.geometry.type,s=Math.pow(r.tolerance/((1<<r.maxZoom)*r.extent),2),l=[],c=t.id;if(r.promoteId?c=t.properties[r.promoteId]:r.generateId&&(c=n||0),a==="Point")rN(i,l);else if(a==="MultiPoint")for(var d=0;d<i.length;d++)rN(i[d],l);else if(a==="LineString")Ib(i,l,s,!1);else if(a==="MultiLineString")if(r.lineMetrics){for(d=0;d<i.length;d++)l=[],Ib(i[d],l,s,!1),e.push(Cv(c,"LineString",l,t.properties));return}else fA(i,l,s,!1);else if(a==="Polygon")fA(i,l,s,!0);else if(a==="MultiPolygon")for(d=0;d<i.length;d++){var p=[];fA(i[d],p,s,!0),l.push(p)}else if(a==="GeometryCollection"){for(d=0;d<t.geometry.geometries.length;d++)l0(e,{id:c,geometry:t.geometry.geometries[d],properties:t.properties},r,n);return}else throw new Error("Input data is not a valid GeoJSON object.");e.push(Cv(c,a,l,t.properties))}}function rN(e,t){t.push(TB(e[0])),t.push(SB(e[1])),t.push(0)}function Ib(e,t,r,n){for(var i,a,s=0,l=0;l<e.length;l++){var c=TB(e[l][0]),d=SB(e[l][1]);t.push(c),t.push(d),t.push(0),l>0&&(n?s+=(i*d-c*a)/2:s+=Math.sqrt(Math.pow(c-i,2)+Math.pow(d-a,2))),i=c,a=d}var p=t.length-3;t[2]=1,Nb(t,0,p,r),t[p+2]=1,t.size=Math.abs(s),t.start=0,t.end=t.size}function fA(e,t,r,n){for(var i=0;i<e.length;i++){var a=[];Ib(e[i],a,r,n),t.push(a)}}function TB(e){return e/360+.5}function SB(e){var t=Math.sin(e*Math.PI/180),r=.5-.25*Math.log((1+t)/(1-t))/Math.PI;return r<0?0:r>1?1:r}function eu(e,t,r,n,i,a,s,l){if(r/=t,n/=t,a>=r&&s<n)return e;if(s<r||a>=n)return null;for(var c=[],d=0;d<e.length;d++){var p=e[d],h=p.geometry,m=p.type,_=i===0?p.minX:p.minY,y=i===0?p.maxX:p.maxY;if(_>=r&&y<n){c.push(p);continue}else if(y<r||_>=n)continue;var E=[];if(m==="Point"||m==="MultiPoint")qX(h,E,r,n,i);else if(m==="LineString")AB(h,E,r,n,i,!1,l.lineMetrics);else if(m==="MultiLineString")dA(h,E,r,n,i,!1);else if(m==="Polygon")dA(h,E,r,n,i,!0);else if(m==="MultiPolygon")for(var T=0;T<h.length;T++){var A=[];dA(h[T],A,r,n,i,!0),A.length&&E.push(A)}if(E.length){if(l.lineMetrics&&m==="LineString"){for(T=0;T<E.length;T++)c.push(Cv(p.id,m,E[T],p.tags));continue}(m==="LineString"||m==="MultiLineString")&&(E.length===1?(m="LineString",E=E[0]):m="MultiLineString"),(m==="Point"||m==="MultiPoint")&&(m=E.length===3?"Point":"MultiPoint"),c.push(Cv(p.id,m,E,p.tags))}}return c.length?c:null}function qX(e,t,r,n,i){for(var a=0;a<e.length;a+=3){var s=e[a+i];s>=r&&s<=n&&(t.push(e[a]),t.push(e[a+1]),t.push(e[a+2]))}}function AB(e,t,r,n,i,a,s){for(var l=nN(e),c=i===0?WX:YX,d=e.start,p,h,m=0;m<e.length-3;m+=3){var _=e[m],y=e[m+1],E=e[m+2],T=e[m+3],A=e[m+4],b=i===0?_:y,R=i===0?T:A,M=!1;s&&(p=Math.sqrt(Math.pow(_-T,2)+Math.pow(y-A,2))),b<r?R>r&&(h=c(l,_,y,T,A,r),s&&(l.start=d+p*h)):b>n?R<n&&(h=c(l,_,y,T,A,n),s&&(l.start=d+p*h)):hA(l,_,y,E),R<r&&b>=r&&(h=c(l,_,y,T,A,r),M=!0),R>n&&b<=n&&(h=c(l,_,y,T,A,n),M=!0),!a&&M&&(s&&(l.end=d+p*h),t.push(l),l=nN(e)),s&&(d+=p)}var B=e.length-3;_=e[B],y=e[B+1],E=e[B+2],b=i===0?_:y,b>=r&&b<=n&&hA(l,_,y,E),B=l.length-3,a&&B>=3&&(l[B]!==l[0]||l[B+1]!==l[1])&&hA(l,l[0],l[1],l[2]),l.length&&t.push(l)}function nN(e){var t=[];return t.size=e.size,t.start=e.start,t.end=e.end,t}function dA(e,t,r,n,i,a){for(var s=0;s<e.length;s++)AB(e[s],t,r,n,i,a,!1)}function hA(e,t,r,n){e.push(t),e.push(r),e.push(n)}function WX(e,t,r,n,i,a){var s=(a-t)/(n-t);return e.push(a),e.push(r+(i-r)*s),e.push(1),s}function YX(e,t,r,n,i,a){var s=(a-r)/(i-r);return e.push(t+(n-t)*s),e.push(a),e.push(1),s}function $X(e,t){var r=t.buffer/t.extent,n=e,i=eu(e,1,-1-r,r,0,-1,2,t),a=eu(e,1,1-r,2+r,0,-1,2,t);return(i||a)&&(n=eu(e,1,-r,1+r,0,-1,2,t)||[],i&&(n=iN(i,1).concat(n)),a&&(n=n.concat(iN(a,-1)))),n}function iN(e,t){for(var r=[],n=0;n<e.length;n++){var i=e[n],a=i.type,s;if(a==="Point"||a==="MultiPoint"||a==="LineString")s=pA(i.geometry,t);else if(a==="MultiLineString"||a==="Polygon"){s=[];for(var l=0;l<i.geometry.length;l++)s.push(pA(i.geometry[l],t))}else if(a==="MultiPolygon")for(s=[],l=0;l<i.geometry.length;l++){for(var c=[],d=0;d<i.geometry[l].length;d++)c.push(pA(i.geometry[l][d],t));s.push(c)}r.push(Cv(i.id,a,s,i.tags))}return r}function pA(e,t){var r=[];r.size=e.size,e.start!==void 0&&(r.start=e.start,r.end=e.end);for(var n=0;n<e.length;n+=3)r.push(e[n]+t,e[n+1],e[n+2]);return r}function aN(e,t){if(e.transformed)return e;var r=1<<e.z,n=e.x,i=e.y,a,s,l;for(a=0;a<e.features.length;a++){var c=e.features[a],d=c.geometry,p=c.type;if(c.geometry=[],p===1)for(s=0;s<d.length;s+=2)c.geometry.push(oN(d[s],d[s+1],t,r,n,i));else for(s=0;s<d.length;s++){var h=[];for(l=0;l<d[s].length;l+=2)h.push(oN(d[s][l],d[s][l+1],t,r,n,i));c.geometry.push(h)}}return e.transformed=!0,e}function oN(e,t,r,n,i,a){return[Math.round(r*(e*n-i)),Math.round(r*(t*n-a))]}function ZX(e,t,r,n,i){for(var a=t===i.maxZoom?0:i.tolerance/((1<<t)*i.extent),s={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:r,y:n,z:t,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},l=0;l<e.length;l++){s.numFeatures++,KX(s,e[l],a,i);var c=e[l].minX,d=e[l].minY,p=e[l].maxX,h=e[l].maxY;c<s.minX&&(s.minX=c),d<s.minY&&(s.minY=d),p>s.maxX&&(s.maxX=p),h>s.maxY&&(s.maxY=h)}return s}function KX(e,t,r,n){var i=t.geometry,a=t.type,s=[];if(a==="Point"||a==="MultiPoint")for(var l=0;l<i.length;l+=3)s.push(i[l]),s.push(i[l+1]),e.numPoints++,e.numSimplified++;else if(a==="LineString")vA(s,i,e,r,!1,!1);else if(a==="MultiLineString"||a==="Polygon")for(l=0;l<i.length;l++)vA(s,i[l],e,r,a==="Polygon",l===0);else if(a==="MultiPolygon")for(var c=0;c<i.length;c++){var d=i[c];for(l=0;l<d.length;l++)vA(s,d[l],e,r,!0,l===0)}if(s.length){var p=t.tags||null;if(a==="LineString"&&n.lineMetrics){p={};for(var h in t.tags)p[h]=t.tags[h];p.mapbox_clip_start=i.start/i.size,p.mapbox_clip_end=i.end/i.size}var m={geometry:s,type:a==="Polygon"||a==="MultiPolygon"?3:a==="LineString"||a==="MultiLineString"?2:1,tags:p};t.id!==null&&(m.id=t.id),e.features.push(m)}}function vA(e,t,r,n,i,a){var s=n*n;if(n>0&&t.size<(i?s:n)){r.numPoints+=t.length/3;return}for(var l=[],c=0;c<t.length;c+=3)(n===0||t[c+2]>s)&&(r.numSimplified++,l.push(t[c]),l.push(t[c+1])),r.numPoints++;i&&QX(l,a),e.push(l)}function QX(e,t){for(var r=0,n=0,i=e.length,a=i-2;n<i;a=n,n+=2)r+=(e[n]-e[a])*(e[n+1]+e[a+1]);if(r>0===t)for(n=0,i=e.length;n<i/2;n+=2){var s=e[n],l=e[n+1];e[n]=e[i-2-n],e[n+1]=e[i-1-n],e[i-2-n]=s,e[i-1-n]=l}}function JX(e,t){return new Hg(e,t)}function Hg(e,t){t=this.options=eG(Object.create(this.options),t);var r=t.debug;if(r&&console.time("preprocess data"),t.maxZoom<0||t.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(t.promoteId&&t.generateId)throw new Error("promoteId and generateId cannot be used together.");var n=GX(e,t);this.tiles={},this.tileCoords=[],r&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",t.indexMaxZoom,t.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),n=$X(n,t),n.length&&this.splitTile(n,0,0,0),r&&(n.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}Hg.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};Hg.prototype.splitTile=function(e,t,r,n,i,a,s){for(var l=[e,t,r,n],c=this.options,d=c.debug;l.length;){n=l.pop(),r=l.pop(),t=l.pop(),e=l.pop();var p=1<<t,h=Pb(t,r,n),m=this.tiles[h];if(!m&&(d>1&&console.time("creation"),m=this.tiles[h]=ZX(e,t,r,n,c),this.tileCoords.push({z:t,x:r,y:n}),d)){d>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",t,r,n,m.numFeatures,m.numPoints,m.numSimplified),console.timeEnd("creation"));var _="z"+t;this.stats[_]=(this.stats[_]||0)+1,this.total++}if(m.source=e,i){if(t===c.maxZoom||t===i)continue;var y=1<<i-t;if(r!==Math.floor(a/y)||n!==Math.floor(s/y))continue}else if(t===c.indexMaxZoom||m.numPoints<=c.indexMaxPoints)continue;if(m.source=null,e.length!==0){d>1&&console.time("clipping");var E=.5*c.buffer/c.extent,T=.5-E,A=.5+E,b=1+E,R,M,B,w,D,U;R=M=B=w=null,D=eu(e,p,r-E,r+A,0,m.minX,m.maxX,c),U=eu(e,p,r+T,r+b,0,m.minX,m.maxX,c),e=null,D&&(R=eu(D,p,n-E,n+A,1,m.minY,m.maxY,c),M=eu(D,p,n+T,n+b,1,m.minY,m.maxY,c),D=null),U&&(B=eu(U,p,n-E,n+A,1,m.minY,m.maxY,c),w=eu(U,p,n+T,n+b,1,m.minY,m.maxY,c),U=null),d>1&&console.timeEnd("clipping"),l.push(R||[],t+1,r*2,n*2),l.push(M||[],t+1,r*2,n*2+1),l.push(B||[],t+1,r*2+1,n*2),l.push(w||[],t+1,r*2+1,n*2+1)}}};Hg.prototype.getTile=function(e,t,r){var n=this.options,i=n.extent,a=n.debug;if(e<0||e>24)return null;var s=1<<e;t=(t%s+s)%s;var l=Pb(e,t,r);if(this.tiles[l])return aN(this.tiles[l],i);a>1&&console.log("drilling down to z%d-%d-%d",e,t,r);for(var c=e,d=t,p=r,h;!h&&c>0;)c--,d=Math.floor(d/2),p=Math.floor(p/2),h=this.tiles[Pb(c,d,p)];return!h||!h.source?null:(a>1&&console.log("found parent tile z%d-%d-%d",c,d,p),a>1&&console.time("drilling down"),this.splitTile(h.source,c,d,p,e,t,r),a>1&&console.timeEnd("drilling down"),this.tiles[l]?aN(this.tiles[l],i):null)};function Pb(e,t,r){return((1<<e)*r+t)*32+e}function eG(e,t){for(var r in t)e[r]=t[r];return e}var rv=class{constructor(t,r,n,i){this.vectorLayerCache={},this.x=r,this.y=n,this.z=i,this.vectorTile=t}getTileData(t){return!t||!this.vectorTile.layers[t]?[]:this.vectorLayerCache[t]?this.vectorLayerCache[t]:this.vectorTile.layers[t].features}getFeatureById(){throw new Error("Method not implemented.")}},tG=Object.defineProperty,rG=Object.defineProperties,nG=Object.getOwnPropertyDescriptors,sN=Object.getOwnPropertySymbols,iG=Object.prototype.hasOwnProperty,aG=Object.prototype.propertyIsEnumerable,uN=(e,t,r)=>t in e?tG(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,B0=(e,t)=>{for(var r in t||(t={}))iG.call(t,r)&&uN(e,r,t[r]);if(sN)for(var r of sN(t))aG.call(t,r)&&uN(e,r,t[r]);return e},oG=(e,t)=>rG(e,nG(t)),sG=(e,t,r)=>new Promise((n,i)=>{var a=c=>{try{l(r.next(c))}catch(d){i(d)}},s=c=>{try{l(r.throw(c))}catch(d){i(d)}},l=c=>c.done?n(c.value):Promise.resolve(c.value).then(a,s);l((r=r.apply(e,t)).next())}),uG={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0};function lG(e){let t=0;for(let r=0,n=e.length,i=n-1,a,s;r<n;i=r++)a=e[r],s=e[i],t+=(s.x-a.x)*(a.y+s.y);return t}function cG(e){const t=e.length;if(t<=1)return[e];const r=[];let n,i;for(let a=0;a<t;a++){const s=lG(e[a]);s!==0&&(i===void 0&&(i=s<0),i===s<0?(n&&r.push(n),n=[e[a]]):n.push(e[a]))}return n&&r.push(n),r}var fG=["Unknown","Point","LineString","Polygon"];function dG(e,t,r,n,i){let a=i.geometry;const s=i.type,l=i.tags,c=i.id,d=e*Math.pow(2,n),p=e*t,h=e*r;let m=fG[s],_,y;function E(A){for(let b=0;b<A.length;b++){const R=A[b];if(R[3])break;const M=180-(R[1]+h)*360/d,B=(R[0]+p)*360/d-180,w=360/Math.PI*Math.atan(Math.exp(M*Math.PI/180))-90;A[b]=[B,w,0,1]}}switch(s){case 1:const A=[];for(_=0;_<a.length;_++)A[_]=a[_][0];a=A,E(a);break;case 2:for(_=0;_<a.length;_++)E(a[_]);break;case 3:for(a=cG(a),_=0;_<a.length;_++)for(y=0;y<a[_].length;y++)E(a[_][y]);break}return a.length===1?a=a[0]:m="Multi"+m,{type:"Feature",geometry:{type:m,coordinates:a},properties:l,id:c,relativeOrigin:[0,0],coord:""}}var hG=(e,t,r,n)=>sG(void 0,null,function*(){return new Promise(i=>{const a=t.getTile(e.z,e.x,e.y),l={layers:{defaultLayer:{features:a?a.features.map(d=>dG(n,r.x,r.y,r.z,d)):[]}}},c=new rv(l,e.x,e.y,e.z);i(c)})});function pG(e){const t={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!0,debug:0};return e===void 0||typeof e.geojsonvtOptions>"u"?t:B0(B0({},t),e.geojsonvtOptions)}function vG(e,t){const r=pG(t),n=r.extent||4096,i=JX(e,r),a=(l,c)=>hG(c,i,l,n),s=oG(B0(B0({},uG),t),{getTileData:a});return{data:e,dataArray:[],tilesetOptions:s,isTile:!0}}var mG=Object.defineProperty,_G=Object.defineProperties,gG=Object.getOwnPropertyDescriptors,lN=Object.getOwnPropertySymbols,yG=Object.prototype.hasOwnProperty,EG=Object.prototype.propertyIsEnumerable,cN=(e,t,r)=>t in e?mG(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,fN=(e,t)=>{for(var r in t||(t={}))yG.call(t,r)&&cN(e,r,t[r]);if(lN)for(var r of lN(t))EG.call(t,r)&&cN(e,r,t[r]);return e},dN=(e,t)=>_G(e,gG(t));function bB(e,t){const{extent:r=[121.168,30.2828,121.384,30.4219],coordinates:n,requestParameters:i={}}=t,a=new Promise(c=>{e instanceof HTMLImageElement||FV(e)?c([e]):TG(e,i,d=>{c(d)})}),s=ih(n,r);return{originData:e,images:a,_id:1,dataArray:[{_id:0,coordinates:s}]}}function TG(e,t,r){const n=[];if(typeof e=="string")xb(dN(fN({},t),{url:e}),(i,a)=>{a&&(n.push(a),r(n))});else{const i=e.length;let a=0;e.forEach(s=>{xb(dN(fN({},t),{url:s}),(l,c)=>{a++,c&&n.push(c),a===i&&r(n)})})}return bB}var SG=Object.defineProperty,AG=Object.defineProperties,bG=Object.getOwnPropertyDescriptors,hN=Object.getOwnPropertySymbols,xG=Object.prototype.hasOwnProperty,RG=Object.prototype.propertyIsEnumerable,pN=(e,t,r)=>t in e?SG(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,xB=(e,t)=>{for(var r in t||(t={}))xG.call(t,r)&&pN(e,r,t[r]);if(hN)for(var r of hN(t))RG.call(t,r)&&pN(e,r,t[r]);return e},RB=(e,t)=>AG(e,bG(t)),CG=(e,t,r)=>new Promise((n,i)=>{var a=c=>{try{l(r.next(c))}catch(d){i(d)}},s=c=>{try{l(r.throw(c))}catch(d){i(d)}},l=c=>c.done?n(c.value):Promise.resolve(c.value).then(a,s);l((r=r.apply(e,t)).next())}),OG=(e,t,r,n)=>CG(void 0,null,function*(){const i={x:t.x,y:t.y,z:t.z},a=Md(e,i);return new Promise(s=>{n?n(i,(l,c)=>{if(l||!c){const d={layers:{defaultLayer:{features:[]}}},p=new rv(d,t.x,t.y,t.z);s(p)}else{const d={layers:{defaultLayer:{features:c.features}}},p=new rv(d,t.x,t.y,t.z);s(p)}}):K9(RB(xB({},r),{url:a}),(l,c)=>{if(l||!c){const d={layers:{defaultLayer:{features:[]}}},p=new rv(d,t.x,t.y,t.z);s(p)}else{const p={layers:{defaultLayer:{features:JSON.parse(c)}}},h=new rv(p,t.x,t.y,t.z);s(h)}})})});function MG(e,t){const r=(i,a)=>OG(e,a,t?.requestParameters,t.getCustomData),n=RB(xB({},t),{getTileData:r});return{dataArray:[],tilesetOptions:n,isTile:!0}}var Rp={},mA,vN;function wG(){if(vN)return mA;vN=1,mA=e;function e(t,r){this.x=t,this.y=r}return e.prototype={clone:function(){return new e(this.x,this.y)},add:function(t){return this.clone()._add(t)},sub:function(t){return this.clone()._sub(t)},multByPoint:function(t){return this.clone()._multByPoint(t)},divByPoint:function(t){return this.clone()._divByPoint(t)},mult:function(t){return this.clone()._mult(t)},div:function(t){return this.clone()._div(t)},rotate:function(t){return this.clone()._rotate(t)},rotateAround:function(t,r){return this.clone()._rotateAround(t,r)},matMult:function(t){return this.clone()._matMult(t)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(t){return this.x===t.x&&this.y===t.y},dist:function(t){return Math.sqrt(this.distSqr(t))},distSqr:function(t){var r=t.x-this.x,n=t.y-this.y;return r*r+n*n},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(t){return Math.atan2(this.y-t.y,this.x-t.x)},angleWith:function(t){return this.angleWithSep(t.x,t.y)},angleWithSep:function(t,r){return Math.atan2(this.x*r-this.y*t,this.x*t+this.y*r)},_matMult:function(t){var r=t[0]*this.x+t[1]*this.y,n=t[2]*this.x+t[3]*this.y;return this.x=r,this.y=n,this},_add:function(t){return this.x+=t.x,this.y+=t.y,this},_sub:function(t){return this.x-=t.x,this.y-=t.y,this},_mult:function(t){return this.x*=t,this.y*=t,this},_div:function(t){return this.x/=t,this.y/=t,this},_multByPoint:function(t){return this.x*=t.x,this.y*=t.y,this},_divByPoint:function(t){return this.x/=t.x,this.y/=t.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var t=this.y;return this.y=this.x,this.x=-t,this},_rotate:function(t){var r=Math.cos(t),n=Math.sin(t),i=r*this.x-n*this.y,a=n*this.x+r*this.y;return this.x=i,this.y=a,this},_rotateAround:function(t,r){var n=Math.cos(t),i=Math.sin(t),a=r.x+n*(this.x-r.x)-i*(this.y-r.y),s=r.y+i*(this.x-r.x)+n*(this.y-r.y);return this.x=a,this.y=s,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},e.convert=function(t){return t instanceof e?t:Array.isArray(t)?new e(t[0],t[1]):t},mA}var _A,mN;function CB(){if(mN)return _A;mN=1;var e=wG();_A=t;function t(s,l,c,d,p){this.properties={},this.extent=c,this.type=0,this._pbf=s,this._geometry=-1,this._keys=d,this._values=p,s.readFields(r,this,l)}function r(s,l,c){s==1?l.id=c.readVarint():s==2?n(c,l):s==3?l.type=c.readVarint():s==4&&(l._geometry=c.pos)}function n(s,l){for(var c=s.readVarint()+s.pos;s.pos<c;){var d=l._keys[s.readVarint()],p=l._values[s.readVarint()];l.properties[d]=p}}t.types=["Unknown","Point","LineString","Polygon"],t.prototype.loadGeometry=function(){var s=this._pbf;s.pos=this._geometry;for(var l=s.readVarint()+s.pos,c=1,d=0,p=0,h=0,m=[],_;s.pos<l;){if(d<=0){var y=s.readVarint();c=y&7,d=y>>3}if(d--,c===1||c===2)p+=s.readSVarint(),h+=s.readSVarint(),c===1&&(_&&m.push(_),_=[]),_.push(new e(p,h));else if(c===7)_&&_.push(_[0].clone());else throw new Error("unknown command "+c)}return _&&m.push(_),m},t.prototype.bbox=function(){var s=this._pbf;s.pos=this._geometry;for(var l=s.readVarint()+s.pos,c=1,d=0,p=0,h=0,m=1/0,_=-1/0,y=1/0,E=-1/0;s.pos<l;){if(d<=0){var T=s.readVarint();c=T&7,d=T>>3}if(d--,c===1||c===2)p+=s.readSVarint(),h+=s.readSVarint(),p<m&&(m=p),p>_&&(_=p),h<y&&(y=h),h>E&&(E=h);else if(c!==7)throw new Error("unknown command "+c)}return[m,y,_,E]},t.prototype.toGeoJSON=function(s,l,c){var d=this.extent*Math.pow(2,c),p=this.extent*s,h=this.extent*l,m=this.loadGeometry(),_=t.types[this.type],y,E;function T(R){for(var M=0;M<R.length;M++){var B=R[M],w=180-(B.y+h)*360/d;R[M]=[(B.x+p)*360/d-180,360/Math.PI*Math.atan(Math.exp(w*Math.PI/180))-90]}}switch(this.type){case 1:var A=[];for(y=0;y<m.length;y++)A[y]=m[y][0];m=A,T(m);break;case 2:for(y=0;y<m.length;y++)T(m[y]);break;case 3:for(m=i(m),y=0;y<m.length;y++)for(E=0;E<m[y].length;E++)T(m[y][E]);break}m.length===1?m=m[0]:_="Multi"+_;var b={type:"Feature",geometry:{type:_,coordinates:m},properties:this.properties};return"id"in this&&(b.id=this.id),b};function i(s){var l=s.length;if(l<=1)return[s];for(var c=[],d,p,h=0;h<l;h++){var m=a(s[h]);m!==0&&(p===void 0&&(p=m<0),p===m<0?(d&&c.push(d),d=[s[h]]):d.push(s[h]))}return d&&c.push(d),c}function a(s){for(var l=0,c=0,d=s.length,p=d-1,h,m;c<d;p=c++)h=s[c],m=s[p],l+=(m.x-h.x)*(h.y+m.y);return l}return _A}var gA,_N;function OB(){if(_N)return gA;_N=1;var e=CB();gA=t;function t(i,a){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=i,this._keys=[],this._values=[],this._features=[],i.readFields(r,this,a),this.length=this._features.length}function r(i,a,s){i===15?a.version=s.readVarint():i===1?a.name=s.readString():i===5?a.extent=s.readVarint():i===2?a._features.push(s.pos):i===3?a._keys.push(s.readString()):i===4&&a._values.push(n(s))}function n(i){for(var a=null,s=i.readVarint()+i.pos;i.pos<s;){var l=i.readVarint()>>3;a=l===1?i.readString():l===2?i.readFloat():l===3?i.readDouble():l===4?i.readVarint64():l===5?i.readVarint():l===6?i.readSVarint():l===7?i.readBoolean():null}return a}return t.prototype.feature=function(i){if(i<0||i>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[i];var a=this._pbf.readVarint()+this._pbf.pos;return new e(this._pbf,a,this.extent,this._keys,this._values)},gA}var yA,gN;function NG(){if(gN)return yA;gN=1;var e=OB();yA=t;function t(n,i){this.layers=n.readFields(r,{},i)}function r(n,i,a){if(n===3){var s=new e(a,a.readVarint()+a.pos);s.length&&(i[s.name]=s)}}return yA}var yN;function IG(){return yN||(yN=1,Rp.VectorTile=NG(),Rp.VectorTileFeature=CB(),Rp.VectorTileLayer=OB()),Rp}var PG=IG(),D_={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */var EN;function DG(){return EN||(EN=1,D_.read=function(e,t,r,n,i){var a,s,l=i*8-n-1,c=(1<<l)-1,d=c>>1,p=-7,h=r?i-1:0,m=r?-1:1,_=e[t+h];for(h+=m,a=_&(1<<-p)-1,_>>=-p,p+=l;p>0;a=a*256+e[t+h],h+=m,p-=8);for(s=a&(1<<-p)-1,a>>=-p,p+=n;p>0;s=s*256+e[t+h],h+=m,p-=8);if(a===0)a=1-d;else{if(a===c)return s?NaN:(_?-1:1)*(1/0);s=s+Math.pow(2,n),a=a-d}return(_?-1:1)*s*Math.pow(2,a-n)},D_.write=function(e,t,r,n,i,a){var s,l,c,d=a*8-i-1,p=(1<<d)-1,h=p>>1,m=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,_=n?0:a-1,y=n?1:-1,E=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(l=isNaN(t)?1:0,s=p):(s=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-s))<1&&(s--,c*=2),s+h>=1?t+=m/c:t+=m*Math.pow(2,1-h),t*c>=2&&(s++,c/=2),s+h>=p?(l=0,s=p):s+h>=1?(l=(t*c-1)*Math.pow(2,i),s=s+h):(l=t*Math.pow(2,h-1)*Math.pow(2,i),s=0));i>=8;e[r+_]=l&255,_+=y,l/=256,i-=8);for(s=s<<i|l,d+=i;d>0;e[r+_]=s&255,_+=y,s/=256,d-=8);e[r+_-y]|=E*128}),D_}var EA,TN;function LG(){if(TN)return EA;TN=1,EA=t;var e=DG();function t(x){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(x)?x:new Uint8Array(x||0),this.pos=0,this.type=0,this.length=this.buf.length}t.Varint=0,t.Fixed64=1,t.Bytes=2,t.Fixed32=5;var r=65536*65536,n=1/r,i=12,a=typeof TextDecoder>"u"?null:new TextDecoder("utf-8");t.prototype={destroy:function(){this.buf=null},readFields:function(x,P,H){for(H=H||this.length;this.pos<H;){var pe=this.readVarint(),O=pe>>3,F=this.pos;this.type=pe&7,x(O,P,this),this.pos===F&&this.skip(pe)}return P},readMessage:function(x,P){return this.readFields(x,P,this.readVarint()+this.pos)},readFixed32:function(){var x=w(this.buf,this.pos);return this.pos+=4,x},readSFixed32:function(){var x=U(this.buf,this.pos);return this.pos+=4,x},readFixed64:function(){var x=w(this.buf,this.pos)+w(this.buf,this.pos+4)*r;return this.pos+=8,x},readSFixed64:function(){var x=w(this.buf,this.pos)+U(this.buf,this.pos+4)*r;return this.pos+=8,x},readFloat:function(){var x=e.read(this.buf,this.pos,!0,23,4);return this.pos+=4,x},readDouble:function(){var x=e.read(this.buf,this.pos,!0,52,8);return this.pos+=8,x},readVarint:function(x){var P=this.buf,H,pe;return pe=P[this.pos++],H=pe&127,pe<128||(pe=P[this.pos++],H|=(pe&127)<<7,pe<128)||(pe=P[this.pos++],H|=(pe&127)<<14,pe<128)||(pe=P[this.pos++],H|=(pe&127)<<21,pe<128)?H:(pe=P[this.pos],H|=(pe&15)<<28,s(H,x,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var x=this.readVarint();return x%2===1?(x+1)/-2:x/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var x=this.readVarint()+this.pos,P=this.pos;return this.pos=x,x-P>=i&&a?Q(this.buf,P,x):ae(this.buf,P,x)},readBytes:function(){var x=this.readVarint()+this.pos,P=this.buf.subarray(this.pos,x);return this.pos=x,P},readPackedVarint:function(x,P){if(this.type!==t.Bytes)return x.push(this.readVarint(P));var H=l(this);for(x=x||[];this.pos<H;)x.push(this.readVarint(P));return x},readPackedSVarint:function(x){if(this.type!==t.Bytes)return x.push(this.readSVarint());var P=l(this);for(x=x||[];this.pos<P;)x.push(this.readSVarint());return x},readPackedBoolean:function(x){if(this.type!==t.Bytes)return x.push(this.readBoolean());var P=l(this);for(x=x||[];this.pos<P;)x.push(this.readBoolean());return x},readPackedFloat:function(x){if(this.type!==t.Bytes)return x.push(this.readFloat());var P=l(this);for(x=x||[];this.pos<P;)x.push(this.readFloat());return x},readPackedDouble:function(x){if(this.type!==t.Bytes)return x.push(this.readDouble());var P=l(this);for(x=x||[];this.pos<P;)x.push(this.readDouble());return x},readPackedFixed32:function(x){if(this.type!==t.Bytes)return x.push(this.readFixed32());var P=l(this);for(x=x||[];this.pos<P;)x.push(this.readFixed32());return x},readPackedSFixed32:function(x){if(this.type!==t.Bytes)return x.push(this.readSFixed32());var P=l(this);for(x=x||[];this.pos<P;)x.push(this.readSFixed32());return x},readPackedFixed64:function(x){if(this.type!==t.Bytes)return x.push(this.readFixed64());var P=l(this);for(x=x||[];this.pos<P;)x.push(this.readFixed64());return x},readPackedSFixed64:function(x){if(this.type!==t.Bytes)return x.push(this.readSFixed64());var P=l(this);for(x=x||[];this.pos<P;)x.push(this.readSFixed64());return x},skip:function(x){var P=x&7;if(P===t.Varint)for(;this.buf[this.pos++]>127;);else if(P===t.Bytes)this.pos=this.readVarint()+this.pos;else if(P===t.Fixed32)this.pos+=4;else if(P===t.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+P)},writeTag:function(x,P){this.writeVarint(x<<3|P)},realloc:function(x){for(var P=this.length||16;P<this.pos+x;)P*=2;if(P!==this.length){var H=new Uint8Array(P);H.set(this.buf),this.buf=H,this.length=P}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(x){this.realloc(4),D(this.buf,x,this.pos),this.pos+=4},writeSFixed32:function(x){this.realloc(4),D(this.buf,x,this.pos),this.pos+=4},writeFixed64:function(x){this.realloc(8),D(this.buf,x&-1,this.pos),D(this.buf,Math.floor(x*n),this.pos+4),this.pos+=8},writeSFixed64:function(x){this.realloc(8),D(this.buf,x&-1,this.pos),D(this.buf,Math.floor(x*n),this.pos+4),this.pos+=8},writeVarint:function(x){if(x=+x||0,x>268435455||x<0){d(x,this);return}this.realloc(4),this.buf[this.pos++]=x&127|(x>127?128:0),!(x<=127)&&(this.buf[this.pos++]=(x>>>=7)&127|(x>127?128:0),!(x<=127)&&(this.buf[this.pos++]=(x>>>=7)&127|(x>127?128:0),!(x<=127)&&(this.buf[this.pos++]=x>>>7&127)))},writeSVarint:function(x){this.writeVarint(x<0?-x*2-1:x*2)},writeBoolean:function(x){this.writeVarint(!!x)},writeString:function(x){x=String(x),this.realloc(x.length*4),this.pos++;var P=this.pos;this.pos=X(this.buf,x,this.pos);var H=this.pos-P;H>=128&&m(P,H,this),this.pos=P-1,this.writeVarint(H),this.pos+=H},writeFloat:function(x){this.realloc(4),e.write(this.buf,x,this.pos,!0,23,4),this.pos+=4},writeDouble:function(x){this.realloc(8),e.write(this.buf,x,this.pos,!0,52,8),this.pos+=8},writeBytes:function(x){var P=x.length;this.writeVarint(P),this.realloc(P);for(var H=0;H<P;H++)this.buf[this.pos++]=x[H]},writeRawMessage:function(x,P){this.pos++;var H=this.pos;x(P,this);var pe=this.pos-H;pe>=128&&m(H,pe,this),this.pos=H-1,this.writeVarint(pe),this.pos+=pe},writeMessage:function(x,P,H){this.writeTag(x,t.Bytes),this.writeRawMessage(P,H)},writePackedVarint:function(x,P){P.length&&this.writeMessage(x,_,P)},writePackedSVarint:function(x,P){P.length&&this.writeMessage(x,y,P)},writePackedBoolean:function(x,P){P.length&&this.writeMessage(x,A,P)},writePackedFloat:function(x,P){P.length&&this.writeMessage(x,E,P)},writePackedDouble:function(x,P){P.length&&this.writeMessage(x,T,P)},writePackedFixed32:function(x,P){P.length&&this.writeMessage(x,b,P)},writePackedSFixed32:function(x,P){P.length&&this.writeMessage(x,R,P)},writePackedFixed64:function(x,P){P.length&&this.writeMessage(x,M,P)},writePackedSFixed64:function(x,P){P.length&&this.writeMessage(x,B,P)},writeBytesField:function(x,P){this.writeTag(x,t.Bytes),this.writeBytes(P)},writeFixed32Field:function(x,P){this.writeTag(x,t.Fixed32),this.writeFixed32(P)},writeSFixed32Field:function(x,P){this.writeTag(x,t.Fixed32),this.writeSFixed32(P)},writeFixed64Field:function(x,P){this.writeTag(x,t.Fixed64),this.writeFixed64(P)},writeSFixed64Field:function(x,P){this.writeTag(x,t.Fixed64),this.writeSFixed64(P)},writeVarintField:function(x,P){this.writeTag(x,t.Varint),this.writeVarint(P)},writeSVarintField:function(x,P){this.writeTag(x,t.Varint),this.writeSVarint(P)},writeStringField:function(x,P){this.writeTag(x,t.Bytes),this.writeString(P)},writeFloatField:function(x,P){this.writeTag(x,t.Fixed32),this.writeFloat(P)},writeDoubleField:function(x,P){this.writeTag(x,t.Fixed64),this.writeDouble(P)},writeBooleanField:function(x,P){this.writeVarintField(x,!!P)}};function s(x,P,H){var pe=H.buf,O,F;if(F=pe[H.pos++],O=(F&112)>>4,F<128||(F=pe[H.pos++],O|=(F&127)<<3,F<128)||(F=pe[H.pos++],O|=(F&127)<<10,F<128)||(F=pe[H.pos++],O|=(F&127)<<17,F<128)||(F=pe[H.pos++],O|=(F&127)<<24,F<128)||(F=pe[H.pos++],O|=(F&1)<<31,F<128))return c(x,O,P);throw new Error("Expected varint not more than 10 bytes")}function l(x){return x.type===t.Bytes?x.readVarint()+x.pos:x.pos+1}function c(x,P,H){return H?P*4294967296+(x>>>0):(P>>>0)*4294967296+(x>>>0)}function d(x,P){var H,pe;if(x>=0?(H=x%4294967296|0,pe=x/4294967296|0):(H=~(-x%4294967296),pe=~(-x/4294967296),H^4294967295?H=H+1|0:(H=0,pe=pe+1|0)),x>=18446744073709552e3||x<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");P.realloc(10),p(H,pe,P),h(pe,P)}function p(x,P,H){H.buf[H.pos++]=x&127|128,x>>>=7,H.buf[H.pos++]=x&127|128,x>>>=7,H.buf[H.pos++]=x&127|128,x>>>=7,H.buf[H.pos++]=x&127|128,x>>>=7,H.buf[H.pos]=x&127}function h(x,P){var H=(x&7)<<4;P.buf[P.pos++]|=H|((x>>>=3)?128:0),x&&(P.buf[P.pos++]=x&127|((x>>>=7)?128:0),x&&(P.buf[P.pos++]=x&127|((x>>>=7)?128:0),x&&(P.buf[P.pos++]=x&127|((x>>>=7)?128:0),x&&(P.buf[P.pos++]=x&127|((x>>>=7)?128:0),x&&(P.buf[P.pos++]=x&127)))))}function m(x,P,H){var pe=P<=16383?1:P<=2097151?2:P<=268435455?3:Math.floor(Math.log(P)/(Math.LN2*7));H.realloc(pe);for(var O=H.pos-1;O>=x;O--)H.buf[O+pe]=H.buf[O]}function _(x,P){for(var H=0;H<x.length;H++)P.writeVarint(x[H])}function y(x,P){for(var H=0;H<x.length;H++)P.writeSVarint(x[H])}function E(x,P){for(var H=0;H<x.length;H++)P.writeFloat(x[H])}function T(x,P){for(var H=0;H<x.length;H++)P.writeDouble(x[H])}function A(x,P){for(var H=0;H<x.length;H++)P.writeBoolean(x[H])}function b(x,P){for(var H=0;H<x.length;H++)P.writeFixed32(x[H])}function R(x,P){for(var H=0;H<x.length;H++)P.writeSFixed32(x[H])}function M(x,P){for(var H=0;H<x.length;H++)P.writeFixed64(x[H])}function B(x,P){for(var H=0;H<x.length;H++)P.writeSFixed64(x[H])}function w(x,P){return(x[P]|x[P+1]<<8|x[P+2]<<16)+x[P+3]*16777216}function D(x,P,H){x[H]=P,x[H+1]=P>>>8,x[H+2]=P>>>16,x[H+3]=P>>>24}function U(x,P){return(x[P]|x[P+1]<<8|x[P+2]<<16)+(x[P+3]<<24)}function ae(x,P,H){for(var pe="",O=P;O<H;){var F=x[O],z=null,re=F>239?4:F>223?3:F>191?2:1;if(O+re>H)break;var oe,_e,ye;re===1?F<128&&(z=F):re===2?(oe=x[O+1],(oe&192)===128&&(z=(F&31)<<6|oe&63,z<=127&&(z=null))):re===3?(oe=x[O+1],_e=x[O+2],(oe&192)===128&&(_e&192)===128&&(z=(F&15)<<12|(oe&63)<<6|_e&63,(z<=2047||z>=55296&&z<=57343)&&(z=null))):re===4&&(oe=x[O+1],_e=x[O+2],ye=x[O+3],(oe&192)===128&&(_e&192)===128&&(ye&192)===128&&(z=(F&15)<<18|(oe&63)<<12|(_e&63)<<6|ye&63,(z<=65535||z>=1114112)&&(z=null))),z===null?(z=65533,re=1):z>65535&&(z-=65536,pe+=String.fromCharCode(z>>>10&1023|55296),z=56320|z&1023),pe+=String.fromCharCode(z),O+=re}return pe}function Q(x,P,H){return a.decode(x.subarray(P,H))}function X(x,P,H){for(var pe=0,O,F;pe<P.length;pe++){if(O=P.charCodeAt(pe),O>55295&&O<57344)if(F)if(O<56320){x[H++]=239,x[H++]=191,x[H++]=189,F=O;continue}else O=F-55296<<10|O-56320|65536,F=null;else{O>56319||pe+1===P.length?(x[H++]=239,x[H++]=191,x[H++]=189):F=O;continue}else F&&(x[H++]=239,x[H++]=191,x[H++]=189,F=null);O<128?x[H++]=O:(O<2048?x[H++]=O>>6|192:(O<65536?x[H++]=O>>12|224:(x[H++]=O>>18|240,x[H++]=O>>12&63|128),x[H++]=O>>6&63|128),x[H++]=O&63|128)}return H}return EA}var BG=LG();const FG=Pr(BG);var UG=Object.defineProperty,kG=Object.defineProperties,zG=Object.getOwnPropertyDescriptors,SN=Object.getOwnPropertySymbols,jG=Object.prototype.hasOwnProperty,HG=Object.prototype.propertyIsEnumerable,AN=(e,t,r)=>t in e?UG(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,bN=(e,t)=>{for(var r in t||(t={}))jG.call(t,r)&&AN(e,r,t[r]);if(SN)for(var r of SN(t))HG.call(t,r)&&AN(e,r,t[r]);return e},VG=(e,t)=>kG(e,zG(t)),xN=class{constructor(e,t,r,n){this.vectorLayerCache={},this.x=t,this.y=r,this.z=n,this.vectorTile=new PG.VectorTile(new FG(e))}getTileData(e){if(!e||!this.vectorTile.layers[e])return[];if(this.vectorLayerCache[e])return this.vectorLayerCache[e];const t=this.vectorTile.layers[e];if(Array.isArray(t.features))return this.vectorLayerCache[e]=t.features,t.features;const r=[];for(let n=0;n<t.length;n++){const a=t.feature(n).toGeoJSON(this.x,this.y,this.z);r.push(VG(bN({},a),{properties:bN({id:a.id},a.properties)}))}return this.vectorLayerCache[e]=r,r}getFeatureById(){throw new Error("Method not implemented.")}},XG=Object.defineProperty,GG=Object.defineProperties,qG=Object.getOwnPropertyDescriptors,RN=Object.getOwnPropertySymbols,WG=Object.prototype.hasOwnProperty,YG=Object.prototype.propertyIsEnumerable,CN=(e,t,r)=>t in e?XG(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Db=(e,t)=>{for(var r in t||(t={}))WG.call(t,r)&&CN(e,r,t[r]);if(RN)for(var r of RN(t))YG.call(t,r)&&CN(e,r,t[r]);return e},MB=(e,t)=>GG(e,qG(t)),$G=(e,t,r)=>new Promise((n,i)=>{var a=c=>{try{l(r.next(c))}catch(d){i(d)}},s=c=>{try{l(r.throw(c))}catch(d){i(d)}},l=c=>c.done?n(c.value):Promise.resolve(c.value).then(a,s);l((r=r.apply(e,t)).next())}),ZG={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,warp:!0},KG=(e,t,r,n,i)=>$G(void 0,null,function*(){const a=Md(e,t);return new Promise(s=>{if(i)i({x:r.x,y:r.y,z:r.z},(l,c)=>{if(l||!c)s(void 0);else{const d=new xN(c,r.x,r.y,r.z);s(d)}});else{const l=Wx(MB(Db({},n),{url:a}),(c,d)=>{if(c||!d)s(void 0);else{const p=new xN(d,r.x,r.y,r.z);s(p)}});r.xhrCancel=()=>l.cancel()}})});function QG(e,t){const r=Array.isArray(e)?e[0]:e,n=(a,s)=>KG(r,a,s,t?.requestParameters,t?.getCustomData),i=MB(Db(Db({},ZG),t),{getTileData:n});return{data:r,dataArray:[],tilesetOptions:i,isTile:!0}}function JG(e,t,r){switch(e){case"+":return t+r;case"-":return t-r;case"*":return t*r;case"/":return t/r;case"%":return t%r;case"^":return Math.pow(t,r);case"abs":return Math.abs(t);case"floor":return Math.floor(t);case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"sin":return Math.sin(t);case"cos":return Math.cos(t);case"atan":return r===-1?Math.atan(t):Math.atan2(t,r);case"min":return Math.min(t,r);case"max":return Math.max(t,r);case"log10":return Math.log(t);case"log2":return Math.log2(t);default:return console.warn("Calculate symbol err! Return default 0"),0}}function gv(e,t){const{width:r,height:n}=t[0],i=t.map(c=>c.rasterData),a=r*n,s=[],l=JSON.stringify(e);for(let c=0;c<a;c++){const d=JSON.parse(l),p=wB(d,i,c);if(typeof p=="number")s.push(p);else{const h=Lb(d);s.push(h)}}return s}function wB(e,t,r){if(e.length===2&&e[0]==="band"&&typeof e[1]=="number")try{return t[e[1]][r]}catch{return console.warn("Raster Data err!"),0}e.map((n,i)=>{if(Array.isArray(n)&&n.length>0)switch(n[0]){case"band":try{e[i]=t[n[1]][r]}catch{console.warn("Raster Data err!"),e[i]=0}break;default:wB(n,t,r)}})}function eq(e){const[t,r=-1,n=-1]=e;return t===void 0?(console.warn("Express err!"),["+",0,0]):[t.replace(/\s+/g,""),r,n]}function Lb(e){const t=eq(e),r=t[0];let n=t[1],i=t[2];return Array.isArray(n)&&(n=Lb(e[1])),Array.isArray(i)&&(i=Lb(e[2])),JG(r,n,i)}var tq={nd:{type:"operation",expression:["/",["-",["band",1],["band",0]],["+",["band",1],["band",0]]]},rgb:{type:"function",method:rq}};function rq(e,t){const r=e[0].rasterData,n=e[1].rasterData,i=e[2].rasterData,a=[],[s,l]=t?.countCut||[2,98],c=t?.RMinMax||wd(r,s,l),d=t?.GMinMax||wd(n,s,l),p=t?.BMinMax||wd(i,s,l);for(let h=0;h<r.length;h++)a.push(Math.max(0,r[h]-c[0])),a.push(Math.max(0,n[h]-d[0])),a.push(Math.max(0,i[h]-p[0]));return{rasterData:a,rMinMax:c,gMinMax:d,bMinMax:p}}function wd(e,t,r){const n=e.slice().sort((l,c)=>l-c),i=n.length,a=n[Math.ceil(i*t/100)],s=n[Math.ceil(i*r/100)];return[a,s]}var nq=Object.defineProperty,iq=Object.defineProperties,aq=Object.getOwnPropertyDescriptors,ON=Object.getOwnPropertySymbols,oq=Object.prototype.hasOwnProperty,sq=Object.prototype.propertyIsEnumerable,MN=(e,t,r)=>t in e?nq(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,uq=(e,t)=>{for(var r in t||(t={}))oq.call(t,r)&&MN(e,r,t[r]);if(ON)for(var r of ON(t))sq.call(t,r)&&MN(e,r,t[r]);return e},lq=(e,t)=>iq(e,aq(t)),NB=(e,t,r)=>new Promise((n,i)=>{var a=c=>{try{l(r.next(c))}catch(d){i(d)}},s=c=>{try{l(r.throw(c))}catch(d){i(d)}},l=c=>c.done?n(c.value):Promise.resolve(c.value).then(a,s);l((r=r.apply(e,t)).next())});function hR(e,t,r){return NB(this,null,function*(){if(e.length===0)return{rasterData:[0],width:1,heigh:1};const n=yield Promise.all(e.map(({data:c,bands:d=[0]})=>t(c,d))),i=[];n.forEach(c=>{Array.isArray(c)?i.push(...c):i.push(c)});const{width:a,height:s}=i[0];let l;switch(typeof r){case"function":l=r(i);break;case"object":Array.isArray(r)?l={rasterData:gv(r,i)}:l=cq(r,i);break;default:l={rasterData:i[0].rasterData}}return lq(uq({},l),{width:a,height:s})})}function cq(e,t){const r=tq[e.type];if(r.type==="function")return r.method(t,e?.options);if(r.type==="operation")return e.type==="rgb"?fq(r.expression,t):{rasterData:gv(r.expression,t)}}function fq(e,t){e.r===void 0&&console.warn("Channel R lost in Operation! Use band[0] to fill!"),e.g===void 0&&console.warn("Channel G lost in Operation! Use band[0] to fill!"),e.b===void 0&&console.warn("Channel B lost in Operation! Use band[0] to fill!");const r=gv(e.r||["band",0],t),n=gv(e.g||["band",0],t),i=gv(e.b||["band",0],t);return[r,n,i]}function Bb(e,t,r,n){return NB(this,null,function*(){const i=yield hR(e,t,r);n(null,{data:i})})}function dq(e,t){const{extent:r=[121.168,30.2828,121.384,30.4219],coordinates:n,width:i,height:a,min:s,max:l,format:c,operation:d}=t;let p,h,m;if(c===void 0||yB(e))p=Array.from(e),h=i,m=a;else{const E=Array.isArray(e)?e:[e];p=hR(E,c,d)}const _=ih(n,r);return{_id:1,dataArray:[{_id:1,data:p,width:h,height:m,min:s,max:l,coordinates:_}]}}function Vd(e){"@babel/helpers - typeof";return Vd=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vd(e)}function hq(e,t){if(Vd(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(Vd(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function IB(e){var t=hq(e,"string");return Vd(t)=="symbol"?t:t+""}function L(e,t,r){return(t=IB(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function wN(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),r.push.apply(r,n)}return r}function Ge(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?wN(Object(r),!0).forEach(function(n){L(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wN(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}let Wv=(function(e){return e.Normal="normal",e.PostProcessing="post-processing",e})({}),N=(function(e){return e[e.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",e[e.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",e[e.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN",e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.SRC_COLOR=768]="SRC_COLOR",e[e.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",e[e.SRC_ALPHA=770]="SRC_ALPHA",e[e.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",e[e.DST_ALPHA=772]="DST_ALPHA",e[e.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",e[e.DST_COLOR=774]="DST_COLOR",e[e.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",e[e.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",e[e.FUNC_ADD=32774]="FUNC_ADD",e[e.BLEND_EQUATION=32777]="BLEND_EQUATION",e[e.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",e[e.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",e[e.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",e[e.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",e[e.MAX_EXT=32776]="MAX_EXT",e[e.MIN_EXT=32775]="MIN_EXT",e[e.BLEND_DST_RGB=32968]="BLEND_DST_RGB",e[e.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",e[e.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",e[e.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",e[e.CONSTANT_COLOR=32769]="CONSTANT_COLOR",e[e.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",e[e.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",e[e.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",e[e.BLEND_COLOR=32773]="BLEND_COLOR",e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",e[e.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",e[e.STREAM_DRAW=35040]="STREAM_DRAW",e[e.STATIC_DRAW=35044]="STATIC_DRAW",e[e.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",e[e.BUFFER_SIZE=34660]="BUFFER_SIZE",e[e.BUFFER_USAGE=34661]="BUFFER_USAGE",e[e.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",e[e.FRONT=1028]="FRONT",e[e.BACK=1029]="BACK",e[e.FRONT_AND_BACK=1032]="FRONT_AND_BACK",e[e.CULL_FACE=2884]="CULL_FACE",e[e.BLEND=3042]="BLEND",e[e.DITHER=3024]="DITHER",e[e.STENCIL_TEST=2960]="STENCIL_TEST",e[e.DEPTH_TEST=2929]="DEPTH_TEST",e[e.SCISSOR_TEST=3089]="SCISSOR_TEST",e[e.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",e[e.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",e[e.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",e[e.NO_ERROR=0]="NO_ERROR",e[e.INVALID_ENUM=1280]="INVALID_ENUM",e[e.INVALID_VALUE=1281]="INVALID_VALUE",e[e.INVALID_OPERATION=1282]="INVALID_OPERATION",e[e.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",e[e.CW=2304]="CW",e[e.CCW=2305]="CCW",e[e.LINE_WIDTH=2849]="LINE_WIDTH",e[e.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",e[e.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",e[e.CULL_FACE_MODE=2885]="CULL_FACE_MODE",e[e.FRONT_FACE=2886]="FRONT_FACE",e[e.DEPTH_RANGE=2928]="DEPTH_RANGE",e[e.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",e[e.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",e[e.DEPTH_FUNC=2932]="DEPTH_FUNC",e[e.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",e[e.STENCIL_FUNC=2962]="STENCIL_FUNC",e[e.STENCIL_FAIL=2964]="STENCIL_FAIL",e[e.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",e[e.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",e[e.STENCIL_REF=2967]="STENCIL_REF",e[e.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",e[e.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",e[e.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",e[e.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",e[e.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",e[e.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",e[e.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",e[e.VIEWPORT=2978]="VIEWPORT",e[e.SCISSOR_BOX=3088]="SCISSOR_BOX",e[e.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",e[e.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",e[e.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",e[e.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",e[e.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",e[e.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",e[e.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",e[e.RED_BITS=3410]="RED_BITS",e[e.GREEN_BITS=3411]="GREEN_BITS",e[e.BLUE_BITS=3412]="BLUE_BITS",e[e.ALPHA_BITS=3413]="ALPHA_BITS",e[e.DEPTH_BITS=3414]="DEPTH_BITS",e[e.STENCIL_BITS=3415]="STENCIL_BITS",e[e.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",e[e.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",e[e.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",e[e.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",e[e.SAMPLES=32937]="SAMPLES",e[e.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",e[e.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",e[e.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",e[e.DONT_CARE=4352]="DONT_CARE",e[e.FASTEST=4353]="FASTEST",e[e.NICEST=4354]="NICEST",e[e.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",e[e.BYTE=5120]="BYTE",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.SHORT=5122]="SHORT",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.INT=5124]="INT",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.FLOAT=5126]="FLOAT",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.ALPHA=6406]="ALPHA",e[e.RGB=6407]="RGB",e[e.RGBA=6408]="RGBA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.RED=6403]="RED",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",e[e.VERTEX_SHADER=35633]="VERTEX_SHADER",e[e.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",e[e.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",e[e.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",e[e.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",e[e.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",e[e.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",e[e.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",e[e.SHADER_TYPE=35663]="SHADER_TYPE",e[e.DELETE_STATUS=35712]="DELETE_STATUS",e[e.LINK_STATUS=35714]="LINK_STATUS",e[e.VALIDATE_STATUS=35715]="VALIDATE_STATUS",e[e.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",e[e.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",e[e.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",e[e.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",e[e.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",e[e.NEVER=512]="NEVER",e[e.LESS=513]="LESS",e[e.EQUAL=514]="EQUAL",e[e.LEQUAL=515]="LEQUAL",e[e.GREATER=516]="GREATER",e[e.NOTEQUAL=517]="NOTEQUAL",e[e.GEQUAL=518]="GEQUAL",e[e.ALWAYS=519]="ALWAYS",e[e.KEEP=7680]="KEEP",e[e.REPLACE=7681]="REPLACE",e[e.INCR=7682]="INCR",e[e.DECR=7683]="DECR",e[e.INVERT=5386]="INVERT",e[e.INCR_WRAP=34055]="INCR_WRAP",e[e.DECR_WRAP=34056]="DECR_WRAP",e[e.VENDOR=7936]="VENDOR",e[e.RENDERER=7937]="RENDERER",e[e.VERSION=7938]="VERSION",e[e.NEAREST=9728]="NEAREST",e[e.LINEAR=9729]="LINEAR",e[e.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",e[e.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",e[e.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",e[e.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",e[e.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",e[e.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",e[e.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",e[e.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE=5890]="TEXTURE",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e[e.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",e[e.TEXTURE0=33984]="TEXTURE0",e[e.TEXTURE1=33985]="TEXTURE1",e[e.TEXTURE2=33986]="TEXTURE2",e[e.TEXTURE3=33987]="TEXTURE3",e[e.TEXTURE4=33988]="TEXTURE4",e[e.TEXTURE5=33989]="TEXTURE5",e[e.TEXTURE6=33990]="TEXTURE6",e[e.TEXTURE7=33991]="TEXTURE7",e[e.TEXTURE8=33992]="TEXTURE8",e[e.TEXTURE9=33993]="TEXTURE9",e[e.TEXTURE10=33994]="TEXTURE10",e[e.TEXTURE11=33995]="TEXTURE11",e[e.TEXTURE12=33996]="TEXTURE12",e[e.TEXTURE13=33997]="TEXTURE13",e[e.TEXTURE14=33998]="TEXTURE14",e[e.TEXTURE15=33999]="TEXTURE15",e[e.TEXTURE16=34e3]="TEXTURE16",e[e.TEXTURE17=34001]="TEXTURE17",e[e.TEXTURE18=34002]="TEXTURE18",e[e.TEXTURE19=34003]="TEXTURE19",e[e.TEXTURE20=34004]="TEXTURE20",e[e.TEXTURE21=34005]="TEXTURE21",e[e.TEXTURE22=34006]="TEXTURE22",e[e.TEXTURE23=34007]="TEXTURE23",e[e.TEXTURE24=34008]="TEXTURE24",e[e.TEXTURE25=34009]="TEXTURE25",e[e.TEXTURE26=34010]="TEXTURE26",e[e.TEXTURE27=34011]="TEXTURE27",e[e.TEXTURE28=34012]="TEXTURE28",e[e.TEXTURE29=34013]="TEXTURE29",e[e.TEXTURE30=34014]="TEXTURE30",e[e.TEXTURE31=34015]="TEXTURE31",e[e.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",e[e.REPEAT=10497]="REPEAT",e[e.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e[e.FLOAT_VEC2=35664]="FLOAT_VEC2",e[e.FLOAT_VEC3=35665]="FLOAT_VEC3",e[e.FLOAT_VEC4=35666]="FLOAT_VEC4",e[e.INT_VEC2=35667]="INT_VEC2",e[e.INT_VEC3=35668]="INT_VEC3",e[e.INT_VEC4=35669]="INT_VEC4",e[e.BOOL=35670]="BOOL",e[e.BOOL_VEC2=35671]="BOOL_VEC2",e[e.BOOL_VEC3=35672]="BOOL_VEC3",e[e.BOOL_VEC4=35673]="BOOL_VEC4",e[e.FLOAT_MAT2=35674]="FLOAT_MAT2",e[e.FLOAT_MAT3=35675]="FLOAT_MAT3",e[e.FLOAT_MAT4=35676]="FLOAT_MAT4",e[e.SAMPLER_2D=35678]="SAMPLER_2D",e[e.SAMPLER_CUBE=35680]="SAMPLER_CUBE",e[e.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",e[e.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",e[e.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",e[e.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",e[e.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",e[e.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",e[e.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",e[e.COMPILE_STATUS=35713]="COMPILE_STATUS",e[e.LOW_FLOAT=36336]="LOW_FLOAT",e[e.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",e[e.HIGH_FLOAT=36338]="HIGH_FLOAT",e[e.LOW_INT=36339]="LOW_INT",e[e.MEDIUM_INT=36340]="MEDIUM_INT",e[e.HIGH_INT=36341]="HIGH_INT",e[e.FRAMEBUFFER=36160]="FRAMEBUFFER",e[e.RENDERBUFFER=36161]="RENDERBUFFER",e[e.RGBA4=32854]="RGBA4",e[e.RGB5_A1=32855]="RGB5_A1",e[e.RGB565=36194]="RGB565",e[e.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",e[e.STENCIL_INDEX=6401]="STENCIL_INDEX",e[e.STENCIL_INDEX8=36168]="STENCIL_INDEX8",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e[e.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",e[e.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",e[e.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",e[e.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",e[e.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",e[e.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",e[e.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",e[e.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",e[e.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",e[e.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",e[e.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",e[e.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",e[e.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",e[e.NONE=0]="NONE",e[e.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",e[e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",e[e.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",e[e.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",e[e.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",e[e.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",e[e.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",e[e.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",e[e.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",e[e.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",e[e.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",e[e.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",e})({});const pq=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,{camelCase:vq,isNil:mq,upperFirst:_q}=yn;class cu{constructor(){L(this,"shaderModuleService",void 0),L(this,"rendererService",void 0),L(this,"config",void 0),L(this,"quad",pq),L(this,"enabled",!0),L(this,"renderToScreen",!1),L(this,"model",void 0),L(this,"name",void 0),L(this,"optionsToUpdate",{})}getName(){return this.name}setName(t){this.name=t}getType(){return Wv.PostProcessing}init(t,r){this.config=r,this.rendererService=t.getContainer().rendererService,this.shaderModuleService=t.getContainer().shaderModuleService;const{createAttribute:n,createBuffer:i,createModel:a}=this.rendererService,{vs:s,fs:l,uniforms:c}=this.setupShaders();this.model=a({vs:s,fs:l,attributes:{a_Position:n({buffer:i({data:[-4,-4,4,-4,0,4],type:N.FLOAT}),size:2})},uniforms:Ge(Ge({u_Texture:null},c),this.config&&this.convertOptionsToUniforms(this.config)),depth:{enable:!1},count:3,blend:{enable:this.getName()==="copy"}})}render(t,r){const n=t.multiPassRenderer.getPostProcessor(),{useFramebuffer:i,getViewportSize:a,clear:s}=this.rendererService,{width:l,height:c}=a();i(this.renderToScreen?null:n.getWriteFBO(),()=>{s({framebuffer:n.getWriteFBO(),color:[0,0,0,0],depth:1,stencil:0});const d=Ge({u_BloomFinal:0,u_Texture:n.getReadFBO(),u_ViewportSize:[l,c]},this.convertOptionsToUniforms(this.optionsToUpdate));r&&(d.u_BloomFinal=1,d.u_Texture2=r),this.model.draw({uniforms:d})})}isEnabled(){return this.enabled}setEnabled(t){this.enabled=t}setRenderToScreen(t){this.renderToScreen=t}updateOptions(t){this.optionsToUpdate=Ge(Ge({},this.optionsToUpdate),t)}setupShaders(){throw new Error("Method not implemented.")}convertOptionsToUniforms(t){const r={};return Object.keys(t).forEach(n=>{mq(t[n])||(r[`u_${_q(vq(n))}`]=t[n])}),r}}function gq(e){let t=0;switch(e){case"vec2":case"ivec2":t=2;break;case"vec3":case"ivec3":t=3;break;case"vec4":case"ivec4":case"mat2":t=4;break;case"mat3":t=9;break;case"mat4":t=16;break}return t}const PB=/uniform\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\s+([\s\S]*?);/g;function NN(e,t=!1){const r={};return e=e.replace(PB,(n,i,a)=>{const s=a.split(":"),l=s[0].trim();let c="";switch(s.length>1&&(c=s[1].trim()),i){case"bool":c=c==="true";break;case"float":case"int":c=Number(c);break;case"vec2":case"vec3":case"vec4":case"ivec2":case"ivec3":case"ivec4":case"mat2":case"mat3":case"mat4":c?c=c.replace("[","").replace("]","").split(",").reduce((d,p)=>(d.push(Number(p.trim())),d),[]):c=new Array(gq(i)).fill(0);break}return r[l]=c,`${t?"uniform ":""}${i} ${l};
`}),{content:e,uniforms:r}}function TA(e){let{content:t,uniforms:r}=NN(e,!0);return t=t.replace(/(\s*uniform\s*.*\s*){((?:\s*.*\s*)*?)};/g,(n,i,a)=>{a=a.trim().replace(/^.*$/gm,c=>`uniform ${c}`);const{content:s,uniforms:l}=NN(a);return Object.assign(r,l),`${i}{
${s}
};`}),{content:t,uniforms:r}}function IN(e){const t={};return e.replace(PB,(r,n,i)=>{const a=i.trim();return t[a]?"":(t[a]=!0,`uniform ${n} ${a};
`)})}const{clamp:lde}=yn,xc={ProjectionMatrix:"u_ProjectionMatrix",ViewMatrix:"u_ViewMatrix",ViewProjectionMatrix:"u_ViewProjectionMatrix",Zoom:"u_Zoom",ZoomScale:"u_ZoomScale",FocalDistance:"u_FocalDistance",CameraPosition:"u_CameraPosition"};let F0=(function(e){return e.TOPRIGHT="topright",e.TOPLEFT="topleft",e.BOTTOMRIGHT="bottomright",e.BOTTOMLEFT="bottomleft",e.TOPCENTER="topcenter",e.BOTTOMCENTER="bottomcenter",e.LEFTCENTER="leftcenter",e.RIGHTCENTER="rightcenter",e.LEFTTOP="lefttop",e.RIGHTTOP="righttop",e.LEFTBOTTOM="leftbottom",e.RIGHTBOTTOM="rightbottom",e})({}),U0=(function(e){return e[e.LNGLAT=1]="LNGLAT",e[e.LNGLAT_OFFSET=2]="LNGLAT_OFFSET",e[e.VECTOR_TILE=3]="VECTOR_TILE",e[e.IDENTITY=4]="IDENTITY",e[e.METER_OFFSET=5]="METER_OFFSET",e})({});const ld={CoordinateSystem:"u_CoordinateSystem",ViewportCenter:"u_ViewportCenter",ViewportCenterProjection:"u_ViewportCenterProjection",PixelsPerDegree:"u_PixelsPerDegree",PixelsPerDegree2:"u_PixelsPerDegree2",PixelsPerMeter:"u_PixelsPerMeter"};var ri={LayerInitStart:"layerInitStart",LayerInitEnd:"layerInitEnd",SourceInitStart:"sourceInitStart",SourceInitEnd:"sourceInitEnd",ScaleInitStart:"scaleInitStart",ScaleInitEnd:"scaleInitEnd",MappingStart:"mappingStart",MappingEnd:"mappingEnd",BuildModelStart:"buildModelStart",BuildModelEnd:"buildModelEnd"};let ia=(function(e){return e.Hover="hover",e.Click="click",e.Select="select",e.Active="active",e.Drag="drag",e})({}),ml=(function(e){return e.normal="normal",e.additive="additive",e.subtractive="subtractive",e.min="min",e.max="max",e.none="none",e})({}),Mc=(function(e){return e.MULTIPLE="MULTIPLE",e.SINGLE="SINGLE",e})({}),Vg=(function(e){return e.AND="and",e.OR="or",e})({}),Ti=(function(e){return e.INIT="init",e.UPDATE="update",e})({}),Vr=(function(e){return e.LINEAR="linear",e.SEQUENTIAL="sequential",e.POWER="power",e.LOG="log",e.IDENTITY="identity",e.TIME="time",e.QUANTILE="quantile",e.QUANTIZE="quantize",e.THRESHOLD="threshold",e.CAT="cat",e.DIVERGING="diverging",e.CUSTOM="threshold",e})({}),cd=(function(e){return e.CONSTANT="constant",e.VARIABLE="variable",e})({}),Dt=(function(e){return e[e.Attribute=0]="Attribute",e[e.InstancedAttribute=1]="InstancedAttribute",e[e.Uniform=2]="Uniform",e})({});const PN=["mapload","mapchange","mapAfterFrameChange"];var L_={exports:{}},DN;function yq(){if(DN)return L_.exports;DN=1,L_.exports=t,L_.exports.default=t;var e=1e20;function t(s,l,c,d,p,h){this.fontSize=s||24,this.buffer=l===void 0?3:l,this.cutoff=d||.25,this.fontFamily=p||"sans-serif",this.fontWeight=h||"normal",this.radius=c||8;var m=this.size=this.fontSize+this.buffer*2,_=m+this.buffer*2;this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=m,this.ctx=this.canvas.getContext("2d"),this.ctx.font=this.fontWeight+" "+this.fontSize+"px "+this.fontFamily,this.ctx.textAlign="left",this.ctx.fillStyle="black",this.gridOuter=new Float64Array(_*_),this.gridInner=new Float64Array(_*_),this.f=new Float64Array(_),this.z=new Float64Array(_+1),this.v=new Uint16Array(_),this.useMetrics=this.ctx.measureText("A").actualBoundingBoxLeft!==void 0,this.middle=Math.round(m/2*(navigator.userAgent.indexOf("Gecko/")>=0?1.2:1))}function r(s,l,c,d,p,h,m){h.fill(e,0,l*c),m.fill(0,0,l*c);for(var _=(l-d)/2,y=0;y<p;y++)for(var E=0;E<d;E++){var T=(y+_)*l+E+_,A=s.data[4*(y*d+E)+3]/255;if(A===1)h[T]=0,m[T]=e;else if(A===0)h[T]=e,m[T]=0;else{var b=Math.max(0,.5-A),R=Math.max(0,A-.5);h[T]=b*b,m[T]=R*R}}}function n(s,l,c,d,p,h,m){for(var _=0;_<l*c;_++){var y=Math.sqrt(d[_])-Math.sqrt(p[_]);s[_]=Math.round(255-255*(y/h+m))}}t.prototype._draw=function(s,l){var c=this.ctx.measureText(s),d=c.width,p=2*this.buffer,h,m,_,y,E,T,A,b;l&&this.useMetrics?(E=Math.floor(c.actualBoundingBoxAscent),b=this.buffer+Math.ceil(c.actualBoundingBoxAscent),T=this.buffer,A=this.buffer,m=Math.min(this.size,Math.ceil(c.actualBoundingBoxRight-c.actualBoundingBoxLeft)),y=Math.min(this.size-T,Math.ceil(c.actualBoundingBoxAscent+c.actualBoundingBoxDescent)),h=m+p,_=y+p,this.ctx.textBaseline="alphabetic"):(h=m=this.size,_=y=this.size,E=19*this.fontSize/24,T=A=0,b=this.middle,this.ctx.textBaseline="middle");var R;m&&y&&(this.ctx.clearRect(A,T,m,y),this.ctx.fillText(s,this.buffer,b),R=this.ctx.getImageData(A,T,m,y));var M=new Uint8ClampedArray(h*_);return r(R,h,_,m,y,this.gridOuter,this.gridInner),i(this.gridOuter,h,_,this.f,this.v,this.z),i(this.gridInner,h,_,this.f,this.v,this.z),n(M,h,_,this.gridOuter,this.gridInner,this.radius,this.cutoff),{data:M,metrics:{width:m,height:y,sdfWidth:h,sdfHeight:_,top:E,left:0,advance:d}}},t.prototype.draw=function(s){return this._draw(s,!1).data},t.prototype.drawWithMetrics=function(s){return this._draw(s,!0)};function i(s,l,c,d,p,h){for(var m=0;m<l;m++)a(s,m,l,c,d,p,h);for(var _=0;_<c;_++)a(s,_*l,1,l,d,p,h)}function a(s,l,c,d,p,h,m){var _,y,E,T;for(h[0]=0,m[0]=-e,m[1]=e,_=0;_<d;_++)p[_]=s[l+_*c];for(_=1,y=0,E=0;_<d;_++){do T=h[y],E=(p[_]-p[T]+_*_-T*T)/(_-T)/2;while(E<=m[y]&&--y>-1);y++,h[y]=_,m[y]=E,m[y+1]=e}for(_=0,y=0;_<d;_++){for(;m[y+1]<_;)y++;T=h[y],s[l+_*c]=p[T]+(_-T)*(_-T)}}return L_.exports}var Eq=yq();const Tq=Pr(Eq),Cp=30;function Sq({characterSet:e,getFontWidth:t,fontHeight:r,buffer:n,maxCanvasWidth:i,mapping:a={},xOffset:s=0,yOffset:l=0}){let c=0,d=s;Array.from(e).forEach((h,m)=>{if(!a[h]){const _=t(h,m);d+Cp>i&&(d=0,c++),a[h]={x:d,y:l+c*Cp,width:Cp,height:Cp,advance:_},d+=Cp}});const p=r+n*2;return{mapping:a,xOffset:d,yOffset:l+c*p,canvasHeight:DB(l+(c+1)*p)}}function Aq(e,t,r){let n=0,i=0,a=0,s=[];const l={};for(const d of e)if(!l[d.id]){const{size:p}=d;n+p+t>r&&(LN(l,s,i),n=0,i=a+i+t,a=0,s=[]),s.push({icon:d,xOffset:n}),n=n+p+t,a=Math.max(a,p)}s.length>0&&LN(l,s,i);const c=DB(a+i+t);return{mapping:l,canvasHeight:c}}function LN(e,t,r){for(const n of t){const{icon:i,xOffset:a}=n;e[i.id]=Ge(Ge({},i),{},{x:a,y:r,image:i.image,width:i.width,height:i.height})}}function DB(e){return Math.pow(2,Math.ceil(Math.log2(e)))}const bq=Pq(),xq="sans-serif",Rq="normal",Cq=24,Oq=3,Mq=.25,wq=8,BN=1024,Nq=1,FN=1,Iq=3;function Pq(){const e=[];for(let t=32;t<128;t++)e.push(String.fromCharCode(t));return e}function UN(e,t,r,n){e.font=`${n} ${r}px ${t}`,e.fillStyle="black",e.textBaseline="middle"}function kN(e,t){for(let r=0;r<e.length;r++)t.data[4*r+3]=e[r]}class Dq extends Oa.EventEmitter{constructor(...t){super(...t),L(this,"fontAtlas",void 0),L(this,"iconFontMap",void 0),L(this,"iconFontGlyphs",{}),L(this,"fontOptions",void 0),L(this,"key",void 0),L(this,"cache",new YV(Iq))}get scale(){return FN}get canvas(){const t=this.cache.get(this.key);return t&&t.data}get mapping(){const t=this.cache.get(this.key);return t&&t.mapping||{}}getCanvasByKey(t){const r=this.cache.get(t);return r&&r.data}getMappingByKey(t){const r=this.cache.get(t);return r&&r.mapping||{}}init(){this.cache.clear(),this.fontOptions={fontFamily:xq,fontWeight:Rq,characterSet:bq,fontSize:Cq,buffer:Oq,sdf:!0,cutoff:Mq,radius:wq,iconfont:!1},this.key="",this.iconFontMap=new Map}addIconGlyphs(t){t.forEach(r=>{this.iconFontGlyphs[r.name]=r.unicode})}addIconFont(t,r){this.iconFontMap.set(t,r)}getIconFontKey(t){return this.iconFontMap.get(t)||t}getGlyph(t){return this.iconFontGlyphs[t]?String.fromCharCode(parseInt(this.iconFontGlyphs[t],16)):""}setFontOptions(t){this.fontOptions=Ge(Ge({},this.fontOptions),t),this.key=this.getKey();const r=this.getNewChars(this.key,this.fontOptions.characterSet),n=this.cache.get(this.key);if(n&&r.length===0)return;const i=this.generateFontAtlas(this.key,r,n);this.fontAtlas=i,this.cache.set(this.key,i)}addFontFace(t,r){const n=document.createElement("style");n.type="text/css",n.innerText=`
        @font-face{
            font-family: '${t}';
            src: url('${r}') format('woff2'),
            url('${r}') format('woff'),
            url('${r}') format('truetype');
        }`,n.onload=()=>{if(document.fonts)try{document.fonts.load(`24px ${t}`,"L7text"),document.fonts.ready.then(()=>{this.emit("fontloaded",{fontFamily:t})})}catch(i){console.warn("当前环境不支持 document.fonts !"),console.warn("当前环境不支持 iconfont !"),console.warn(i)}},document.getElementsByTagName("head")[0].appendChild(n)}destroy(){this.cache.clear(),this.iconFontMap.clear()}generateFontAtlas(t,r,n){const{fontFamily:i,fontWeight:a,fontSize:s,buffer:l,sdf:c,radius:d,cutoff:p,iconfont:h}=this.fontOptions;let m=n&&n.data;m||(m=window.document.createElement("canvas"),m.width=BN);const _=m.getContext("2d",{willReadFrequently:!0});UN(_,i,s,a);const{mapping:y,canvasHeight:E,xOffset:T,yOffset:A}=Sq(Ge({getFontWidth:R=>_.measureText(R).width,fontHeight:s*FN,buffer:l,characterSet:r,maxCanvasWidth:BN},n&&{mapping:n.mapping,xOffset:n.xOffset,yOffset:n.yOffset})),b=_.getImageData(0,0,m.width,m.height);if(m.height=E,_.putImageData(b,0,0),UN(_,i,s,a),c){const R=new Tq(s,l,d,p,i,a),M=_.getImageData(0,0,R.size,R.size);for(const B of r){if(h){const w=String.fromCharCode(parseInt(B.replace("&#x","").replace(";",""),16)),D=R.draw(w);kN(D,M)}else kN(R.draw(B),M);_.putImageData(M,y[B].x,y[B].y)}}else for(const R of r)_.fillText(R,y[R].x,y[R].y+s*Nq);return{xOffset:T,yOffset:A,mapping:y,data:m,width:m.width,height:m.height}}getKey(){const{fontFamily:t,fontWeight:r}=this.fontOptions;return`${t}_${r}`}getNewChars(t,r){const n=this.cache.get(t);if(!n)return r;const i=[],a=n.mapping,s=new Set(Object.keys(a));return new Set(r).forEach(c=>{s.has(c)||i.push(c)}),i}}function zN(e,t,r,n,i,a,s){try{var l=e[a](s),c=l.value}catch(d){return void r(d)}l.done?t(c):Promise.resolve(c).then(n,i)}function Ze(e){return function(){var t=this,r=arguments;return new Promise(function(n,i){var a=e.apply(t,r);function s(c){zN(a,n,i,s,l,"next",c)}function l(c){zN(a,n,i,s,l,"throw",c)}s(void 0)})}}const Lq=3,jN=1024,Op=64;class Bq extends Oa.EventEmitter{constructor(...t){super(...t),L(this,"canvasHeight",128),L(this,"texture",void 0),L(this,"canvas",void 0),L(this,"iconData",void 0),L(this,"iconMap",void 0),L(this,"ctx",void 0),L(this,"loadingImageCount",0)}isLoading(){return this.loadingImageCount===0}init(){this.iconData=[],this.iconMap={},this.canvas=window.document.createElement("canvas"),this.canvas.width=128,this.canvas.height=128,this.ctx=this.canvas.getContext("2d")}addImage(t,r){var n=this;return Ze(function*(){let i=new Image;n.loadingImageCount++,n.hasImage(t)?console.warn("Image Id already exists"):n.iconData.push({id:t,size:Op}),n.updateIconMap(),i=yield n.loadImage(r);const a=n.iconData.find(s=>s.id===t);a&&(a.image=i,a.width=i.width,a.height=i.height),n.update()})()}addImageMini(t,r,n){const i=n.getSceneConfig().canvas;let a=i.createImage();if(this.loadingImageCount++,this.hasImage(t))throw new Error("Image Id already exists");this.iconData.push({id:t,size:Op}),this.updateIconMap(),this.loadImageMini(r,i).then(s=>{a=s;const l=this.iconData.find(c=>c.id===t);l&&(l.image=a,l.width=a.width,l.height=a.height),this.update()})}getTexture(){return this.texture}getIconMap(){return this.iconMap}getCanvas(){return this.canvas}hasImage(t){return this.iconMap.hasOwnProperty(t)}removeImage(t){this.hasImage(t)&&(this.iconData=this.iconData.filter(r=>r.id!==t),delete this.iconMap[t],this.update())}destroy(){this.removeAllListeners("imageUpdate"),this.iconData=[],this.iconMap={}}loadImage(t){return new Promise((r,n)=>{if(t instanceof HTMLImageElement){r(t);return}const i=new Image;i.crossOrigin="anonymous",i.onload=()=>{r(i)},i.onerror=()=>{n(new Error("Could not load image at "+t))},i.src=t instanceof File?URL.createObjectURL(t):t})}update(){this.updateIconMap(),this.updateIconAtlas(),this.loadingImageCount--,this.loadingImageCount===0&&this.emit("imageUpdate")}updateIconAtlas(){this.canvas.width=jN,this.canvas.height=this.canvasHeight,Object.keys(this.iconMap).forEach(t=>{const{x:r,y:n,image:i,width:a=64,height:s=64}=this.iconMap[t],c=Math.max(a,s)/Op,d=s/c,p=a/c;i&&this.ctx.drawImage(i,r+(Op-p)/2,n+(Op-d)/2,p,d)})}updateIconMap(){const{mapping:t,canvasHeight:r}=Aq(this.iconData,Lq,jN);this.iconMap=t,this.canvasHeight=r}loadImageMini(t,r){return new Promise((n,i)=>{const a=r.createImage();a.crossOrigin="anonymous",a.onload=()=>{n(a)},a.onerror=()=>{i(new Error("Could not load image at "+t))},a.src=t})}}var Mi=1e-6,Ka=typeof Float32Array<"u"?Float32Array:Array;function pR(){var e=new Ka(16);return Ka!=Float32Array&&(e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0),e[0]=1,e[5]=1,e[10]=1,e[15]=1,e}function Fq(e,t,r,n,i,a,s,l,c,d,p,h,m,_,y,E){var T=new Ka(16);return T[0]=e,T[1]=t,T[2]=r,T[3]=n,T[4]=i,T[5]=a,T[6]=s,T[7]=l,T[8]=c,T[9]=d,T[10]=p,T[11]=h,T[12]=m,T[13]=_,T[14]=y,T[15]=E,T}function LB(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],s=t[4],l=t[5],c=t[6],d=t[7],p=t[8],h=t[9],m=t[10],_=t[11],y=t[12],E=t[13],T=t[14],A=t[15],b=r*l-n*s,R=r*c-i*s,M=r*d-a*s,B=n*c-i*l,w=n*d-a*l,D=i*d-a*c,U=p*E-h*y,ae=p*T-m*y,Q=p*A-_*y,X=h*T-m*E,x=h*A-_*E,P=m*A-_*T,H=b*P-R*x+M*X+B*Q-w*ae+D*U;return H?(H=1/H,e[0]=(l*P-c*x+d*X)*H,e[1]=(i*x-n*P-a*X)*H,e[2]=(E*D-T*w+A*B)*H,e[3]=(m*w-h*D-_*B)*H,e[4]=(c*Q-s*P-d*ae)*H,e[5]=(r*P-i*Q+a*ae)*H,e[6]=(T*M-y*D-A*R)*H,e[7]=(p*D-m*M+_*R)*H,e[8]=(s*x-l*Q+d*U)*H,e[9]=(n*Q-r*x-a*U)*H,e[10]=(y*w-E*M+A*b)*H,e[11]=(h*M-p*w-_*b)*H,e[12]=(l*ae-s*X-c*U)*H,e[13]=(r*X-n*ae+i*U)*H,e[14]=(E*R-y*B-T*b)*H,e[15]=(p*B-h*R+m*b)*H,e):null}function Nd(e,t,r){var n=t[0],i=t[1],a=t[2],s=t[3],l=t[4],c=t[5],d=t[6],p=t[7],h=t[8],m=t[9],_=t[10],y=t[11],E=t[12],T=t[13],A=t[14],b=t[15],R=r[0],M=r[1],B=r[2],w=r[3];return e[0]=R*n+M*l+B*h+w*E,e[1]=R*i+M*c+B*m+w*T,e[2]=R*a+M*d+B*_+w*A,e[3]=R*s+M*p+B*y+w*b,R=r[4],M=r[5],B=r[6],w=r[7],e[4]=R*n+M*l+B*h+w*E,e[5]=R*i+M*c+B*m+w*T,e[6]=R*a+M*d+B*_+w*A,e[7]=R*s+M*p+B*y+w*b,R=r[8],M=r[9],B=r[10],w=r[11],e[8]=R*n+M*l+B*h+w*E,e[9]=R*i+M*c+B*m+w*T,e[10]=R*a+M*d+B*_+w*A,e[11]=R*s+M*p+B*y+w*b,R=r[12],M=r[13],B=r[14],w=r[15],e[12]=R*n+M*l+B*h+w*E,e[13]=R*i+M*c+B*m+w*T,e[14]=R*a+M*d+B*_+w*A,e[15]=R*s+M*p+B*y+w*b,e}function k0(e,t,r){var n=r[0],i=r[1],a=r[2],s,l,c,d,p,h,m,_,y,E,T,A;return t===e?(e[12]=t[0]*n+t[4]*i+t[8]*a+t[12],e[13]=t[1]*n+t[5]*i+t[9]*a+t[13],e[14]=t[2]*n+t[6]*i+t[10]*a+t[14],e[15]=t[3]*n+t[7]*i+t[11]*a+t[15]):(s=t[0],l=t[1],c=t[2],d=t[3],p=t[4],h=t[5],m=t[6],_=t[7],y=t[8],E=t[9],T=t[10],A=t[11],e[0]=s,e[1]=l,e[2]=c,e[3]=d,e[4]=p,e[5]=h,e[6]=m,e[7]=_,e[8]=y,e[9]=E,e[10]=T,e[11]=A,e[12]=s*n+p*i+y*a+t[12],e[13]=l*n+h*i+E*a+t[13],e[14]=c*n+m*i+T*a+t[14],e[15]=d*n+_*i+A*a+t[15]),e}function z0(e,t,r){var n=r[0],i=r[1],a=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*a,e[9]=t[9]*a,e[10]=t[10]*a,e[11]=t[11]*a,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function vR(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[4],s=t[5],l=t[6],c=t[7],d=t[8],p=t[9],h=t[10],m=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=a*i+d*n,e[5]=s*i+p*n,e[6]=l*i+h*n,e[7]=c*i+m*n,e[8]=d*i-a*n,e[9]=p*i-s*n,e[10]=h*i-l*n,e[11]=m*i-c*n,e}function BB(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[0],s=t[1],l=t[2],c=t[3],d=t[8],p=t[9],h=t[10],m=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i-d*n,e[1]=s*i-p*n,e[2]=l*i-h*n,e[3]=c*i-m*n,e[8]=a*n+d*i,e[9]=s*n+p*i,e[10]=l*n+h*i,e[11]=c*n+m*i,e}function FB(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[0],s=t[1],l=t[2],c=t[3],d=t[4],p=t[5],h=t[6],m=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i+d*n,e[1]=s*i+p*n,e[2]=l*i+h*n,e[3]=c*i+m*n,e[4]=d*i-a*n,e[5]=p*i-s*n,e[6]=h*i-l*n,e[7]=m*i-c*n,e}function Uq(e,t,r,n,i){var a=1/Math.tan(t/2);if(e[0]=a/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[11]=-1,e[12]=0,e[13]=0,e[15]=0,i!=null&&i!==1/0){var s=1/(n-i);e[10]=(i+n)*s,e[14]=2*i*n*s}else e[10]=-1,e[14]=-2*n;return e}var kq=Uq;function HN(e,t){var r=e[0],n=e[1],i=e[2],a=e[3],s=e[4],l=e[5],c=e[6],d=e[7],p=e[8],h=e[9],m=e[10],_=e[11],y=e[12],E=e[13],T=e[14],A=e[15],b=t[0],R=t[1],M=t[2],B=t[3],w=t[4],D=t[5],U=t[6],ae=t[7],Q=t[8],X=t[9],x=t[10],P=t[11],H=t[12],pe=t[13],O=t[14],F=t[15];return Math.abs(r-b)<=Mi*Math.max(1,Math.abs(r),Math.abs(b))&&Math.abs(n-R)<=Mi*Math.max(1,Math.abs(n),Math.abs(R))&&Math.abs(i-M)<=Mi*Math.max(1,Math.abs(i),Math.abs(M))&&Math.abs(a-B)<=Mi*Math.max(1,Math.abs(a),Math.abs(B))&&Math.abs(s-w)<=Mi*Math.max(1,Math.abs(s),Math.abs(w))&&Math.abs(l-D)<=Mi*Math.max(1,Math.abs(l),Math.abs(D))&&Math.abs(c-U)<=Mi*Math.max(1,Math.abs(c),Math.abs(U))&&Math.abs(d-ae)<=Mi*Math.max(1,Math.abs(d),Math.abs(ae))&&Math.abs(p-Q)<=Mi*Math.max(1,Math.abs(p),Math.abs(Q))&&Math.abs(h-X)<=Mi*Math.max(1,Math.abs(h),Math.abs(X))&&Math.abs(m-x)<=Mi*Math.max(1,Math.abs(m),Math.abs(x))&&Math.abs(_-P)<=Mi*Math.max(1,Math.abs(_),Math.abs(P))&&Math.abs(y-H)<=Mi*Math.max(1,Math.abs(y),Math.abs(H))&&Math.abs(E-pe)<=Mi*Math.max(1,Math.abs(E),Math.abs(pe))&&Math.abs(T-O)<=Mi*Math.max(1,Math.abs(T),Math.abs(O))&&Math.abs(A-F)<=Mi*Math.max(1,Math.abs(A),Math.abs(F))}function nv(){var e=new Ka(3);return Ka!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0),e}function Co(e,t,r){var n=new Ka(3);return n[0]=e,n[1]=t,n[2]=r,n}function zq(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e}function jq(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e}function iv(e,t){var r=t[0],n=t[1],i=t[2],a=r*r+n*n+i*i;return a>0&&(a=1/Math.sqrt(a)),e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a,e}function Hq(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Vq(e,t,r){var n=t[0],i=t[1],a=t[2],s=r[0],l=r[1],c=r[2];return e[0]=i*c-a*l,e[1]=a*s-n*c,e[2]=n*l-i*s,e}function B_(e,t,r){var n=t[0],i=t[1],a=t[2],s=r[3]*n+r[7]*i+r[11]*a+r[15];return s=s||1,e[0]=(r[0]*n+r[4]*i+r[8]*a+r[12])/s,e[1]=(r[1]*n+r[5]*i+r[9]*a+r[13])/s,e[2]=(r[2]*n+r[6]*i+r[10]*a+r[14])/s,e}function VN(e,t){var r=e[0],n=e[1],i=e[2],a=t[0],s=t[1],l=t[2],c=Math.sqrt((r*r+n*n+i*i)*(a*a+s*s+l*l)),d=c&&Hq(e,t)/c;return Math.acos(Math.min(Math.max(d,-1),1))}var XN=zq;(function(){var e=nv();return function(t,r,n,i,a,s){var l,c;for(r||(r=3),n||(n=0),i?c=Math.min(i*r+n,t.length):c=t.length,l=n;l<c;l+=r)e[0]=t[l],e[1]=t[l+1],e[2]=t[l+2],a(e,e,s),t[l]=e[0],t[l+1]=e[1],t[l+2]=e[2];return t}})();function UB(){var e=new Ka(4);return Ka!=Float32Array&&(e[0]=0,e[1]=0,e[2]=0,e[3]=0),e}function Xq(e,t,r,n){var i=new Ka(4);return i[0]=e,i[1]=t,i[2]=r,i[3]=n,i}function Gq(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e}function mR(e,t,r){var n=t[0],i=t[1],a=t[2],s=t[3];return e[0]=r[0]*n+r[4]*i+r[8]*a+r[12]*s,e[1]=r[1]*n+r[5]*i+r[9]*a+r[13]*s,e[2]=r[2]*n+r[6]*i+r[10]*a+r[14]*s,e[3]=r[3]*n+r[7]*i+r[11]*a+r[15]*s,e}(function(){var e=UB();return function(t,r,n,i,a,s){var l,c;for(r||(r=4),n||(n=0),i?c=Math.min(i*r+n,t.length):c=t.length,l=n;l<c;l+=r)e[0]=t[l],e[1]=t[l+1],e[2]=t[l+2],e[3]=t[l+3],a(e,e,s),t[l]=e[0],t[l+1]=e[1],t[l+2]=e[2],t[l+3]=e[3];return t}})();function oa(){var e=new Ka(2);return Ka!=Float32Array&&(e[0]=0,e[1]=0),e}function Fb(e,t){var r=new Ka(2);return r[0]=e,r[1]=t,r}function SA(e,t){return e[0]=t[0],e[1]=t[1],e}function qq(e,t,r){return e[0]=t,e[1]=r,e}function _l(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e}function Ub(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e}function Wq(e,t){return e[0]=-t[0],e[1]=-t[1],e}function j0(e,t){var r=t[0],n=t[1],i=r*r+n*n;return i>0&&(i=1/Math.sqrt(i)),e[0]=t[0]*i,e[1]=t[1]*i,e}function kb(e,t){return e[0]*t[0]+e[1]*t[1]}function Yq(e,t,r,n){var i=t[0],a=t[1];return e[0]=i+n*(r[0]-i),e[1]=a+n*(r[1]-a),e}var kB=Ub;(function(){var e=oa();return function(t,r,n,i,a,s){var l,c;for(r||(r=2),n||(n=0),i?c=Math.min(i*r+n,t.length):c=t.length,l=n;l<c;l+=r)e[0]=t[l],e[1]=t[l+1],a(e,e,s),t[l]=e[0],t[l+1]=e[1];return t}})();class $q{constructor(){L(this,"viewport",void 0),L(this,"overridedViewProjectionMatrix",void 0),L(this,"viewMatrixInverse",void 0),L(this,"cameraPosition",void 0)}init(){}update(t){this.viewport=t,this.viewMatrixInverse=pR(),LB(this.viewMatrixInverse,t.getViewMatrix()),this.cameraPosition=[this.viewMatrixInverse[12],this.viewMatrixInverse[13],this.viewMatrixInverse[14]]}getProjectionMatrix(){return this.viewport.getProjectionMatrix()}getModelMatrix(){return this.viewport.getModelMatrix()}getViewMatrix(){return this.viewport.getViewMatrix()}getViewMatrixUncentered(){return this.viewport.getViewMatrixUncentered()}getViewProjectionMatrixUncentered(){return this.viewport.getViewProjectionMatrixUncentered()}getViewProjectionMatrix(){return this.overridedViewProjectionMatrix||this.viewport.getViewProjectionMatrix()}getZoom(){return this.viewport.getZoom()}getZoomScale(){return this.viewport.getZoomScale()}getCenter(){const[t,r]=this.viewport.getCenter();return[t,r]}getFocalDistance(){return this.viewport.getFocalDistance()}getCameraPosition(){return this.cameraPosition}projectFlat(t,r){return this.viewport.projectFlat(t,r)}setViewProjectionMatrix(t){this.overridedViewProjectionMatrix=t}}const Zq={topleft:"column",topright:"column",bottomright:"column",bottomleft:"column",leftcenter:"column",rightcenter:"column",topcenter:"row",bottomcenter:"row",lefttop:"row",righttop:"row",leftbottom:"row",rightbottom:"row"};class Kq{constructor(){L(this,"container",void 0),L(this,"controlCorners",void 0),L(this,"controlContainer",void 0),L(this,"scene",void 0),L(this,"mapsService",void 0),L(this,"controls",[]),L(this,"unAddControls",[])}init(t,r){this.container=t.container,this.scene=r,this.mapsService=r.mapService,this.initControlPos()}addControl(t,r){r.mapService.map?(t.addTo(this.scene),this.controls.push(t)):this.unAddControls.push(t)}getControlByName(t){return this.controls.find(r=>r.controlOption.name===t)}removeControl(t){const r=this.controls.indexOf(t);return r>-1&&this.controls.splice(r,1),t.remove(),this}addControls(){this.unAddControls.forEach(t=>{t.addTo(this.scene),this.controls.push(t)}),this.unAddControls=[]}destroy(){for(const t of this.controls)t.remove();this.controls=[],this.clearControlPos()}initControlPos(){const t=this.controlCorners={},r="l7-",n=this.controlContainer=ba("div",r+"control-container",this.container);function i(s=[]){const l=s.map(c=>r+c).join(" ");t[s.filter(c=>!["row","column"].includes(c)).join("")]=ba("div",l,n)}function a(s){return[...s.replace(/^(top|bottom|left|right|center)/,"$1-").split("-"),Zq[s]]}Object.values(F0).forEach(s=>{i(a(s))}),this.checkCornerOverlap()}clearControlPos(){for(const t in this.controlCorners)this.controlCorners[t]&&D0(this.controlCorners[t]);this.controlContainer&&D0(this.controlContainer)}checkCornerOverlap(){const t=window.MutationObserver;if(t)for(const r of Object.keys(this.controlCorners)){const n=r.match(/^(top|bottom)(left|right)$/);if(n){const[,i,a]=n,s=this.controlCorners[`${i}${a}`];new t(([{target:c}])=>{s&&(s.style[i]=c.clientHeight+"px")}).observe(this.controlCorners[`${a}${i}`],{childList:!0,attributes:!0})}}}}class Qq{constructor(){L(this,"container",void 0),L(this,"scene",void 0),L(this,"mapsService",void 0),L(this,"markers",[]),L(this,"markerLayers",[]),L(this,"unAddMarkers",[]),L(this,"unAddMarkerLayers",[])}addMarkerLayer(t){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markerLayers.push(t),t.addTo(this.scene)):this.unAddMarkerLayers.push(t)}removeMarkerLayer(t){t.destroy(),this.markerLayers.indexOf(t);const r=this.markerLayers.indexOf(t);r>-1&&this.markerLayers.splice(r,1)}addMarker(t){this.mapsService.map&&this.mapsService.getMarkerContainer()?(this.markers.push(t),t.addTo(this.scene)):this.unAddMarkers.push(t)}addMarkers(){this.unAddMarkers.forEach(t=>{t.addTo(this.scene),this.markers.push(t)}),this.unAddMarkers=[]}addMarkerLayers(){this.unAddMarkerLayers.forEach(t=>{this.markerLayers.push(t),t.addTo(this.scene)}),this.unAddMarkers=[]}removeMarker(t){t.remove(),this.markers.indexOf(t);const r=this.markers.indexOf(t);r>-1&&this.markers.splice(r,1)}removeAllMarkers(){this.destroy()}init(t){this.scene=t,this.mapsService=t.mapService}destroy(){this.markers.forEach(t=>{t.remove()}),this.markers=[],this.markerLayers.forEach(t=>{t.destroy()}),this.markerLayers=[]}removeMakerLayerMarker(t){t.destroy()}}class Jq{constructor(){L(this,"scene",void 0),L(this,"mapsService",void 0),L(this,"popups",[]),L(this,"unAddPopups",[])}get isMarkerReady(){return this.mapsService.map&&this.mapsService.getMarkerContainer()}removePopup(t){t!=null&&t.isOpen()&&t.remove();const r=this.popups.indexOf(t);r>-1&&this.popups.splice(r,1);const n=this.unAddPopups.indexOf(t);n>-1&&this.unAddPopups.splice(n,1)}destroy(){this.popups.forEach(t=>t.remove())}addPopup(t){t&&t.getOptions().autoClose&&[...this.popups,...this.unAddPopups].forEach(r=>{r.getOptions().autoClose&&this.removePopup(r)}),this.isMarkerReady?(t.addTo(this.scene),this.popups.push(t)):this.unAddPopups.push(t),t.on("close",()=>{this.removePopup(t)})}initPopup(){this.unAddPopups.length&&this.unAddPopups.forEach(t=>{this.addPopup(t),this.unAddPopups=[]})}init(t){this.scene=t,this.mapsService=t.mapService}}const eW={MapToken:"您正在使用 Demo 测试 Token, 生产环境务必自行注册 Token 确保服务稳定 高德地图申请地址 https://lbs.amap.com/api/javascript-api/guide/abc/prepare  Mapbox地图申请地址 https://docs.mapbox.com/help/glossary/access-token/",SDK:"请确认引入了mapbox-gl api且在L7之前引入"},{merge:tW}=yn,rW={id:"map",logoPosition:"bottomleft",logoVisible:!0,antialias:!0,stencil:!0,preserveDrawingBuffer:!1,pickBufferScale:1,fitBoundsOptions:{animate:!1}},nW={colors:["rgb(103,0,31)","rgb(178,24,43)","rgb(214,96,77)","rgb(244,165,130)","rgb(253,219,199)","rgb(247,247,247)","rgb(209,229,240)","rgb(146,197,222)","rgb(67,147,195)","rgb(33,102,172)","rgb(5,48,97)"],size:10,shape:"circle",scales:{},shape2d:["circle","triangle","square","pentagon","hexagon","octogon","hexagram","rhombus","vesica"],shape3d:["cylinder","triangleColumn","hexagonColumn","squareColumn"],minZoom:-1,maxZoom:24,visible:!0,autoFit:!1,pickingBuffer:0,enablePropagation:!1,zIndex:0,blend:"normal",maskLayers:[],enableMask:!0,maskOperation:Vg.AND,pickedFeatureID:-1,enableMultiPassRenderer:!1,enablePicking:!0,active:!1,activeColor:"#2f54eb",enableHighlight:!1,enableSelect:!1,highlightColor:"#2f54eb",activeMix:0,selectColor:"blue",selectMix:0,enableLighting:!1,animateOption:{enable:!1,interval:.2,duration:4,trailLength:.15},forward:!0};class iW{constructor(){L(this,"sceneConfigCache",{}),L(this,"layerConfigCache",{}),L(this,"layerAttributeConfigCache",{})}getSceneConfig(t){return this.sceneConfigCache[t]}getSceneWarninfo(t){return eW[t]}setSceneConfig(t,r){this.sceneConfigCache[t]=Ge(Ge({},rW),r)}getLayerConfig(t){return this.layerConfigCache[t]}setLayerConfig(t,r,n){this.layerConfigCache[r]=Ge({},tW({},this.sceneConfigCache[t],nW,n))}getAttributeConfig(t){return this.layerAttributeConfigCache[t]}setAttributeConfig(t,r){this.layerAttributeConfigCache[t]=Ge(Ge({},this.layerAttributeConfigCache[t]),r)}clean(){this.sceneConfigCache={},this.layerConfigCache={}}}const AA=Math.PI/180,aW=512,GN=4003e4;function qN({latitude:e=0,zoom:t=0,scale:r,highPrecision:n=!1,flipY:i=!1}){r=r!==void 0?r:Math.pow(2,t);const a={},s=aW*r,l=Math.cos(e*AA),c=s/360,d=c/l,p=s/GN/l;if(a.pixelsPerMeter=[p,-p,p],a.metersPerPixel=[1/p,-1/p,1/p],a.pixelsPerDegree=[c,-d,p],a.degreesPerPixel=[1/c,-1/d,1/p],n){const h=AA*Math.tan(e*AA)/l,m=c*h/2,_=s/GN*h,y=_/d*p;a.pixelsPerDegree2=[0,-m,_],a.pixelsPerMeter2=[y,0,y],i&&(a.pixelsPerDegree2[1]=-a.pixelsPerDegree2[1],a.pixelsPerMeter2[1]=-a.pixelsPerMeter2[1])}return i&&(a.pixelsPerMeter[1]=-a.pixelsPerMeter[1],a.metersPerPixel[1]=-a.metersPerPixel[1],a.pixelsPerDegree[1]=-a.pixelsPerDegree[1],a.degreesPerPixel[1]=-a.degreesPerPixel[1]),a}const oW=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];class sW{constructor(t){L(this,"needRefresh",!0),L(this,"coordinateSystem",void 0),L(this,"viewportCenter",void 0),L(this,"viewportCenterProjection",void 0),L(this,"pixelsPerDegree",void 0),L(this,"pixelsPerDegree2",void 0),L(this,"pixelsPerMeter",void 0),this.cameraService=t}refresh(t){const r=this.cameraService.getZoom(),n=t||this.cameraService.getCenter(),{pixelsPerMeter:i,pixelsPerDegree:a}=qN({latitude:n[1],zoom:r});this.viewportCenter=n,this.viewportCenterProjection=[0,0,0,0],this.pixelsPerMeter=i,this.pixelsPerDegree=a,this.pixelsPerDegree2=[0,0,0],this.coordinateSystem===U0.LNGLAT?this.cameraService.setViewProjectionMatrix(void 0):this.coordinateSystem===U0.LNGLAT_OFFSET&&this.calculateLnglatOffset(n,r),this.needRefresh=!1}getCoordinateSystem(){return this.coordinateSystem}setCoordinateSystem(t){this.coordinateSystem=t}getViewportCenter(){return this.viewportCenter}setViewportCenter(t){this.refresh(t)}getViewportCenterProjection(){return this.viewportCenterProjection}getPixelsPerDegree(){return this.pixelsPerDegree}getPixelsPerDegree2(){return this.pixelsPerDegree2}getPixelsPerMeter(){return this.pixelsPerMeter}calculateLnglatOffset(t,r,n,i){const{pixelsPerMeter:a,pixelsPerDegree:s,pixelsPerDegree2:l}=qN({latitude:t[1],zoom:r,scale:n,flipY:i,highPrecision:!0});let c=this.cameraService.getViewMatrix();const d=this.cameraService.getProjectionMatrix();let p=Nd([],d,c);const h=this.cameraService.projectFlat([Math.fround(t[0]),Math.fround(t[1])],Math.pow(2,r));this.viewportCenterProjection=mR([],[h[0],h[1],0,1],p),c=this.cameraService.getViewMatrixUncentered()||c,p=Nd([],d,c),p=Nd([],p,oW),this.cameraService.setViewProjectionMatrix(p),this.pixelsPerMeter=a,this.pixelsPerDegree=s,this.pixelsPerDegree2=l}}class uW extends Oa.EventEmitter{constructor(...t){super(...t),L(this,"renderMap",new Map),L(this,"enable",!1),L(this,"renderEnable",!1),L(this,"cacheLogs",{})}setEnable(t){this.enable=!!t}log(t,r){if(!this.enable)return;const n=t.split(".");let i=null;n.forEach((a,s)=>{i!==null?(i[a]||(i[a]={}),s!==n.length-1&&(i=i[a])):(this.cacheLogs[a]||(this.cacheLogs[a]={}),s!==n.length-1&&(i=this.cacheLogs[a])),s===n.length-1&&(i[a]=Ge(Ge({time:Date.now()},i[a]),r))})}getLog(t){switch(typeof t){case"string":return this.cacheLogs[t];case"object":return t.map(r=>this.cacheLogs[r]).filter(r=>r!==void 0);case"undefined":return this.cacheLogs}}removeLog(t){delete this.cacheLogs[t]}generateRenderUid(){return this.renderEnable?WV():""}renderDebug(t){this.renderEnable=t}renderStart(t){if(!this.renderEnable||!this.enable)return;const r=this.renderMap.get(t)||{};this.renderMap.set(t,Ge(Ge({},r),{},{renderUid:t,renderStart:Date.now()}))}renderEnd(t){if(!this.renderEnable||!this.enable)return;const r=this.renderMap.get(t);if(r){const n=r.renderStart,i=Date.now();this.emit("renderEnd",Ge(Ge({},r),{},{renderEnd:i,renderDuration:i-n})),this.renderMap.delete(t)}}destroy(){this.cacheLogs=null,this.renderMap.clear()}}var bA={exports:{}};/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */var WN;function lW(){return WN||(WN=1,(function(e){(function(t,r,n,i){var a=["","webkit","Moz","MS","ms","o"],s=r.createElement("div"),l="function",c=Math.round,d=Math.abs,p=Date.now;function h(j,Z,fe){return setTimeout(R(j,fe),Z)}function m(j,Z,fe){return Array.isArray(j)?(_(j,fe[Z],fe),!0):!1}function _(j,Z,fe){var Fe;if(j)if(j.forEach)j.forEach(Z,fe);else if(j.length!==i)for(Fe=0;Fe<j.length;)Z.call(fe,j[Fe],Fe,j),Fe++;else for(Fe in j)j.hasOwnProperty(Fe)&&Z.call(fe,j[Fe],Fe,j)}function y(j,Z,fe){var Fe="DEPRECATED METHOD: "+Z+`
`+fe+` AT 
`;return function(){var pt=new Error("get-stack-trace"),Nt=pt&&pt.stack?pt.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",pr=t.console&&(t.console.warn||t.console.log);return pr&&pr.call(t.console,Fe,Nt),j.apply(this,arguments)}}var E;typeof Object.assign!="function"?E=function(Z){if(Z===i||Z===null)throw new TypeError("Cannot convert undefined or null to object");for(var fe=Object(Z),Fe=1;Fe<arguments.length;Fe++){var pt=arguments[Fe];if(pt!==i&&pt!==null)for(var Nt in pt)pt.hasOwnProperty(Nt)&&(fe[Nt]=pt[Nt])}return fe}:E=Object.assign;var T=y(function(Z,fe,Fe){for(var pt=Object.keys(fe),Nt=0;Nt<pt.length;)(!Fe||Fe&&Z[pt[Nt]]===i)&&(Z[pt[Nt]]=fe[pt[Nt]]),Nt++;return Z},"extend","Use `assign`."),A=y(function(Z,fe){return T(Z,fe,!0)},"merge","Use `assign`.");function b(j,Z,fe){var Fe=Z.prototype,pt;pt=j.prototype=Object.create(Fe),pt.constructor=j,pt._super=Fe,fe&&E(pt,fe)}function R(j,Z){return function(){return j.apply(Z,arguments)}}function M(j,Z){return typeof j==l?j.apply(Z&&Z[0]||i,Z):j}function B(j,Z){return j===i?Z:j}function w(j,Z,fe){_(Q(Z),function(Fe){j.addEventListener(Fe,fe,!1)})}function D(j,Z,fe){_(Q(Z),function(Fe){j.removeEventListener(Fe,fe,!1)})}function U(j,Z){for(;j;){if(j==Z)return!0;j=j.parentNode}return!1}function ae(j,Z){return j.indexOf(Z)>-1}function Q(j){return j.trim().split(/\s+/g)}function X(j,Z,fe){if(j.indexOf&&!fe)return j.indexOf(Z);for(var Fe=0;Fe<j.length;){if(fe&&j[Fe][fe]==Z||!fe&&j[Fe]===Z)return Fe;Fe++}return-1}function x(j){return Array.prototype.slice.call(j,0)}function P(j,Z,fe){for(var Fe=[],pt=[],Nt=0;Nt<j.length;){var pr=j[Nt][Z];X(pt,pr)<0&&Fe.push(j[Nt]),pt[Nt]=pr,Nt++}return Fe=Fe.sort(function(Tn,Mn){return Tn[Z]>Mn[Z]}),Fe}function H(j,Z){for(var fe,Fe,pt=Z[0].toUpperCase()+Z.slice(1),Nt=0;Nt<a.length;){if(fe=a[Nt],Fe=fe?fe+pt:Z,Fe in j)return Fe;Nt++}return i}var pe=1;function O(){return pe++}function F(j){var Z=j.ownerDocument||j;return Z.defaultView||Z.parentWindow||t}var z=/mobile|tablet|ip(ad|hone|od)|android/i,re="ontouchstart"in t,oe=H(t,"PointerEvent")!==i,_e=re&&z.test(navigator.userAgent),ye="touch",Ie="pen",Je="mouse",We="kinect",Ct=25,Ve=1,yt=2,Ue=4,ge=8,nt=1,Ce=2,zt=4,jt=8,_t=16,Ot=Ce|zt,xt=jt|_t,Xt=Ot|xt,Or=["x","y"],qr=["clientX","clientY"];function Tr(j,Z){var fe=this;this.manager=j,this.callback=Z,this.element=j.element,this.target=j.options.inputTarget,this.domHandler=function(Fe){M(j.options.enable,[j])&&fe.handler(Fe)},this.init()}Tr.prototype={handler:function(){},init:function(){this.evEl&&w(this.element,this.evEl,this.domHandler),this.evTarget&&w(this.target,this.evTarget,this.domHandler),this.evWin&&w(F(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&D(this.element,this.evEl,this.domHandler),this.evTarget&&D(this.target,this.evTarget,this.domHandler),this.evWin&&D(F(this.element),this.evWin,this.domHandler)}};function zr(j){var Z,fe=j.options.inputClass;return fe?Z=fe:oe?Z=Ul:_e?Z=On:re?Z=hu:Z=fu,new Z(j,V)}function V(j,Z,fe){var Fe=fe.pointers.length,pt=fe.changedPointers.length,Nt=Z&Ve&&Fe-pt===0,pr=Z&(Ue|ge)&&Fe-pt===0;fe.isFirst=!!Nt,fe.isFinal=!!pr,Nt&&(j.session={}),fe.eventType=Z,jr(j,fe),j.emit("hammer.input",fe),j.recognize(fe),j.session.prevInput=fe}function jr(j,Z){var fe=j.session,Fe=Z.pointers,pt=Fe.length;fe.firstInput||(fe.firstInput=un(Z)),pt>1&&!fe.firstMultiple?fe.firstMultiple=un(Z):pt===1&&(fe.firstMultiple=!1);var Nt=fe.firstInput,pr=fe.firstMultiple,Pn=pr?pr.center:Nt.center,Tn=Z.center=tn(Fe);Z.timeStamp=p(),Z.deltaTime=Z.timeStamp-Nt.timeStamp,Z.angle=ii(Pn,Tn),Z.distance=pi(Pn,Tn),en(fe,Z),Z.offsetDirection=Yn(Z.deltaX,Z.deltaY);var Mn=yr(Z.deltaTime,Z.deltaX,Z.deltaY);Z.overallVelocityX=Mn.x,Z.overallVelocityY=Mn.y,Z.overallVelocity=d(Mn.x)>d(Mn.y)?Mn.x:Mn.y,Z.scale=pr?Cn(pr.pointers,Fe):1,Z.rotation=pr?Wr(pr.pointers,Fe):0,Z.maxPointers=fe.prevInput?Z.pointers.length>fe.prevInput.maxPointers?Z.pointers.length:fe.prevInput.maxPointers:Z.pointers.length,Hn(fe,Z);var bi=j.element;U(Z.srcEvent.target,bi)&&(bi=Z.srcEvent.target),Z.target=bi}function en(j,Z){var fe=Z.center,Fe=j.offsetDelta||{},pt=j.prevDelta||{},Nt=j.prevInput||{};(Z.eventType===Ve||Nt.eventType===Ue)&&(pt=j.prevDelta={x:Nt.deltaX||0,y:Nt.deltaY||0},Fe=j.offsetDelta={x:fe.x,y:fe.y}),Z.deltaX=pt.x+(fe.x-Fe.x),Z.deltaY=pt.y+(fe.y-Fe.y)}function Hn(j,Z){var fe=j.lastInterval||Z,Fe=Z.timeStamp-fe.timeStamp,pt,Nt,pr,Pn;if(Z.eventType!=ge&&(Fe>Ct||fe.velocity===i)){var Tn=Z.deltaX-fe.deltaX,Mn=Z.deltaY-fe.deltaY,bi=yr(Fe,Tn,Mn);Nt=bi.x,pr=bi.y,pt=d(bi.x)>d(bi.y)?bi.x:bi.y,Pn=Yn(Tn,Mn),j.lastInterval=Z}else pt=fe.velocity,Nt=fe.velocityX,pr=fe.velocityY,Pn=fe.direction;Z.velocity=pt,Z.velocityX=Nt,Z.velocityY=pr,Z.direction=Pn}function un(j){for(var Z=[],fe=0;fe<j.pointers.length;)Z[fe]={clientX:c(j.pointers[fe].clientX),clientY:c(j.pointers[fe].clientY)},fe++;return{timeStamp:p(),pointers:Z,center:tn(Z),deltaX:j.deltaX,deltaY:j.deltaY}}function tn(j){var Z=j.length;if(Z===1)return{x:c(j[0].clientX),y:c(j[0].clientY)};for(var fe=0,Fe=0,pt=0;pt<Z;)fe+=j[pt].clientX,Fe+=j[pt].clientY,pt++;return{x:c(fe/Z),y:c(Fe/Z)}}function yr(j,Z,fe){return{x:Z/j||0,y:fe/j||0}}function Yn(j,Z){return j===Z?nt:d(j)>=d(Z)?j<0?Ce:zt:Z<0?jt:_t}function pi(j,Z,fe){fe||(fe=Or);var Fe=Z[fe[0]]-j[fe[0]],pt=Z[fe[1]]-j[fe[1]];return Math.sqrt(Fe*Fe+pt*pt)}function ii(j,Z,fe){fe||(fe=Or);var Fe=Z[fe[0]]-j[fe[0]],pt=Z[fe[1]]-j[fe[1]];return Math.atan2(pt,Fe)*180/Math.PI}function Wr(j,Z){return ii(Z[1],Z[0],qr)+ii(j[1],j[0],qr)}function Cn(j,Z){return pi(Z[0],Z[1],qr)/pi(j[0],j[1],qr)}var Yi={mousedown:Ve,mousemove:yt,mouseup:Ue},Ma="mousedown",to="mousemove mouseup";function fu(){this.evEl=Ma,this.evWin=to,this.pressed=!1,Tr.apply(this,arguments)}b(fu,Tr,{handler:function(Z){var fe=Yi[Z.type];fe&Ve&&Z.button===0&&(this.pressed=!0),fe&yt&&Z.which!==1&&(fe=Ue),this.pressed&&(fe&Ue&&(this.pressed=!1),this.callback(this.manager,fe,{pointers:[Z],changedPointers:[Z],pointerType:Je,srcEvent:Z}))}});var Qc={pointerdown:Ve,pointermove:yt,pointerup:Ue,pointercancel:ge,pointerout:ge},Jc={2:ye,3:Ie,4:Je,5:We},Es="pointerdown",ro="pointermove pointerup pointercancel";t.MSPointerEvent&&!t.PointerEvent&&(Es="MSPointerDown",ro="MSPointerMove MSPointerUp MSPointerCancel");function Ul(){this.evEl=Es,this.evWin=ro,Tr.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}b(Ul,Tr,{handler:function(Z){var fe=this.store,Fe=!1,pt=Z.type.toLowerCase().replace("ms",""),Nt=Qc[pt],pr=Jc[Z.pointerType]||Z.pointerType,Pn=pr==ye,Tn=X(fe,Z.pointerId,"pointerId");Nt&Ve&&(Z.button===0||Pn)?Tn<0&&(fe.push(Z),Tn=fe.length-1):Nt&(Ue|ge)&&(Fe=!0),!(Tn<0)&&(fe[Tn]=Z,this.callback(this.manager,Nt,{pointers:fe,changedPointers:[Z],pointerType:pr,srcEvent:Z}),Fe&&fe.splice(Tn,1))}});var ef={touchstart:Ve,touchmove:yt,touchend:Ue,touchcancel:ge},ai="touchstart",kl="touchstart touchmove touchend touchcancel";function du(){this.evTarget=ai,this.evWin=kl,this.started=!1,Tr.apply(this,arguments)}b(du,Tr,{handler:function(Z){var fe=ef[Z.type];if(fe===Ve&&(this.started=!0),!!this.started){var Fe=tf.call(this,Z,fe);fe&(Ue|ge)&&Fe[0].length-Fe[1].length===0&&(this.started=!1),this.callback(this.manager,fe,{pointers:Fe[0],changedPointers:Fe[1],pointerType:ye,srcEvent:Z})}}});function tf(j,Z){var fe=x(j.touches),Fe=x(j.changedTouches);return Z&(Ue|ge)&&(fe=P(fe.concat(Fe),"identifier")),[fe,Fe]}var ch={touchstart:Ve,touchmove:yt,touchend:Ue,touchcancel:ge},wa="touchstart touchmove touchend touchcancel";function On(){this.evTarget=wa,this.targetIds={},Tr.apply(this,arguments)}b(On,Tr,{handler:function(Z){var fe=ch[Z.type],Fe=oi.call(this,Z,fe);Fe&&this.callback(this.manager,fe,{pointers:Fe[0],changedPointers:Fe[1],pointerType:ye,srcEvent:Z})}});function oi(j,Z){var fe=x(j.touches),Fe=this.targetIds;if(Z&(Ve|yt)&&fe.length===1)return Fe[fe[0].identifier]=!0,[fe,fe];var pt,Nt,pr=x(j.changedTouches),Pn=[],Tn=this.target;if(Nt=fe.filter(function(Mn){return U(Mn.target,Tn)}),Z===Ve)for(pt=0;pt<Nt.length;)Fe[Nt[pt].identifier]=!0,pt++;for(pt=0;pt<pr.length;)Fe[pr[pt].identifier]&&Pn.push(pr[pt]),Z&(Ue|ge)&&delete Fe[pr[pt].identifier],pt++;if(Pn.length)return[P(Nt.concat(Pn),"identifier"),Pn]}var Fo=2500,Ts=25;function hu(){Tr.apply(this,arguments);var j=R(this.handler,this);this.touch=new On(this.manager,j),this.mouse=new fu(this.manager,j),this.primaryTouch=null,this.lastTouches=[]}b(hu,Tr,{handler:function(Z,fe,Fe){var pt=Fe.pointerType==ye,Nt=Fe.pointerType==Je;if(!(Nt&&Fe.sourceCapabilities&&Fe.sourceCapabilities.firesTouchEvents)){if(pt)an.call(this,fe,Fe);else if(Nt&&Ss.call(this,Fe))return;this.callback(Z,fe,Fe)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function an(j,Z){j&Ve?(this.primaryTouch=Z.changedPointers[0].identifier,zl.call(this,Z)):j&(Ue|ge)&&zl.call(this,Z)}function zl(j){var Z=j.changedPointers[0];if(Z.identifier===this.primaryTouch){var fe={x:Z.clientX,y:Z.clientY};this.lastTouches.push(fe);var Fe=this.lastTouches,pt=function(){var Nt=Fe.indexOf(fe);Nt>-1&&Fe.splice(Nt,1)};setTimeout(pt,Fo)}}function Ss(j){for(var Z=j.srcEvent.clientX,fe=j.srcEvent.clientY,Fe=0;Fe<this.lastTouches.length;Fe++){var pt=this.lastTouches[Fe],Nt=Math.abs(Z-pt.x),pr=Math.abs(fe-pt.y);if(Nt<=Ts&&pr<=Ts)return!0}return!1}var pu=H(s.style,"touchAction"),no=pu!==i,io="compute",Uo="auto",Na="manipulation",Zr="none",ko="pan-x",zo="pan-y",$i=rf();function Ia(j,Z){this.manager=j,this.set(Z)}Ia.prototype={set:function(j){j==io&&(j=this.compute()),no&&this.manager.element.style&&$i[j]&&(this.manager.element.style[pu]=j),this.actions=j.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var j=[];return _(this.manager.recognizers,function(Z){M(Z.options.enable,[Z])&&(j=j.concat(Z.getTouchAction()))}),fh(j.join(" "))},preventDefaults:function(j){var Z=j.srcEvent,fe=j.offsetDirection;if(this.manager.session.prevented){Z.preventDefault();return}var Fe=this.actions,pt=ae(Fe,Zr)&&!$i[Zr],Nt=ae(Fe,zo)&&!$i[zo],pr=ae(Fe,ko)&&!$i[ko];if(pt){var Pn=j.pointers.length===1,Tn=j.distance<2,Mn=j.deltaTime<250;if(Pn&&Tn&&Mn)return}if(!(pr&&Nt)&&(pt||Nt&&fe&Ot||pr&&fe&xt))return this.preventSrc(Z)},preventSrc:function(j){this.manager.session.prevented=!0,j.preventDefault()}};function fh(j){if(ae(j,Zr))return Zr;var Z=ae(j,ko),fe=ae(j,zo);return Z&&fe?Zr:Z||fe?Z?ko:zo:ae(j,Na)?Na:Uo}function rf(){if(!no)return!1;var j={},Z=t.CSS&&t.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(fe){j[fe]=Z?t.CSS.supports("touch-action",fe):!0}),j}var As=1,Si=2,da=4,Di=8,Un=Di,ao=16,Li=32;function si(j){this.options=E({},this.defaults,j||{}),this.id=O(),this.manager=null,this.options.enable=B(this.options.enable,!0),this.state=As,this.simultaneous={},this.requireFail=[]}si.prototype={defaults:{},set:function(j){return E(this.options,j),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(j){if(m(j,"recognizeWith",this))return this;var Z=this.simultaneous;return j=_u(j,this),Z[j.id]||(Z[j.id]=j,j.recognizeWith(this)),this},dropRecognizeWith:function(j){return m(j,"dropRecognizeWith",this)?this:(j=_u(j,this),delete this.simultaneous[j.id],this)},requireFailure:function(j){if(m(j,"requireFailure",this))return this;var Z=this.requireFail;return j=_u(j,this),X(Z,j)===-1&&(Z.push(j),j.requireFailure(this)),this},dropRequireFailure:function(j){if(m(j,"dropRequireFailure",this))return this;j=_u(j,this);var Z=X(this.requireFail,j);return Z>-1&&this.requireFail.splice(Z,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(j){return!!this.simultaneous[j.id]},emit:function(j){var Z=this,fe=this.state;function Fe(pt){Z.manager.emit(pt,j)}fe<Di&&Fe(Z.options.event+vu(fe)),Fe(Z.options.event),j.additionalEvent&&Fe(j.additionalEvent),fe>=Di&&Fe(Z.options.event+vu(fe))},tryEmit:function(j){if(this.canEmit())return this.emit(j);this.state=Li},canEmit:function(){for(var j=0;j<this.requireFail.length;){if(!(this.requireFail[j].state&(Li|As)))return!1;j++}return!0},recognize:function(j){var Z=E({},j);if(!M(this.options.enable,[this,Z])){this.reset(),this.state=Li;return}this.state&(Un|ao|Li)&&(this.state=As),this.state=this.process(Z),this.state&(Si|da|Di|ao)&&this.tryEmit(Z)},process:function(j){},getTouchAction:function(){},reset:function(){}};function vu(j){return j&ao?"cancel":j&Di?"end":j&da?"move":j&Si?"start":""}function mu(j){return j==_t?"down":j==jt?"up":j==Ce?"left":j==zt?"right":""}function _u(j,Z){var fe=Z.manager;return fe?fe.get(j):j}function Ai(){si.apply(this,arguments)}b(Ai,si,{defaults:{pointers:1},attrTest:function(j){var Z=this.options.pointers;return Z===0||j.pointers.length===Z},process:function(j){var Z=this.state,fe=j.eventType,Fe=Z&(Si|da),pt=this.attrTest(j);return Fe&&(fe&ge||!pt)?Z|ao:Fe||pt?fe&Ue?Z|Di:Z&Si?Z|da:Si:Li}});function $n(){Ai.apply(this,arguments),this.pX=null,this.pY=null}b($n,Ai,{defaults:{event:"pan",threshold:10,pointers:1,direction:Xt},getTouchAction:function(){var j=this.options.direction,Z=[];return j&Ot&&Z.push(zo),j&xt&&Z.push(ko),Z},directionTest:function(j){var Z=this.options,fe=!0,Fe=j.distance,pt=j.direction,Nt=j.deltaX,pr=j.deltaY;return pt&Z.direction||(Z.direction&Ot?(pt=Nt===0?nt:Nt<0?Ce:zt,fe=Nt!=this.pX,Fe=Math.abs(j.deltaX)):(pt=pr===0?nt:pr<0?jt:_t,fe=pr!=this.pY,Fe=Math.abs(j.deltaY))),j.direction=pt,fe&&Fe>Z.threshold&&pt&Z.direction},attrTest:function(j){return Ai.prototype.attrTest.call(this,j)&&(this.state&Si||!(this.state&Si)&&this.directionTest(j))},emit:function(j){this.pX=j.deltaX,this.pY=j.deltaY;var Z=mu(j.direction);Z&&(j.additionalEvent=this.options.event+Z),this._super.emit.call(this,j)}});function oo(){Ai.apply(this,arguments)}b(oo,Ai,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Zr]},attrTest:function(j){return this._super.attrTest.call(this,j)&&(Math.abs(j.scale-1)>this.options.threshold||this.state&Si)},emit:function(j){if(j.scale!==1){var Z=j.scale<1?"in":"out";j.additionalEvent=this.options.event+Z}this._super.emit.call(this,j)}});function gu(){si.apply(this,arguments),this._timer=null,this._input=null}b(gu,si,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Uo]},process:function(j){var Z=this.options,fe=j.pointers.length===Z.pointers,Fe=j.distance<Z.threshold,pt=j.deltaTime>Z.time;if(this._input=j,!Fe||!fe||j.eventType&(Ue|ge)&&!pt)this.reset();else if(j.eventType&Ve)this.reset(),this._timer=h(function(){this.state=Un,this.tryEmit()},Z.time,this);else if(j.eventType&Ue)return Un;return Li},reset:function(){clearTimeout(this._timer)},emit:function(j){this.state===Un&&(j&&j.eventType&Ue?this.manager.emit(this.options.event+"up",j):(this._input.timeStamp=p(),this.manager.emit(this.options.event,this._input)))}});function jo(){Ai.apply(this,arguments)}b(jo,Ai,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Zr]},attrTest:function(j){return this._super.attrTest.call(this,j)&&(Math.abs(j.rotation)>this.options.threshold||this.state&Si)}});function yu(){Ai.apply(this,arguments)}b(yu,Ai,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:Ot|xt,pointers:1},getTouchAction:function(){return $n.prototype.getTouchAction.call(this)},attrTest:function(j){var Z=this.options.direction,fe;return Z&(Ot|xt)?fe=j.overallVelocity:Z&Ot?fe=j.overallVelocityX:Z&xt&&(fe=j.overallVelocityY),this._super.attrTest.call(this,j)&&Z&j.offsetDirection&&j.distance>this.options.threshold&&j.maxPointers==this.options.pointers&&d(fe)>this.options.velocity&&j.eventType&Ue},emit:function(j){var Z=mu(j.offsetDirection);Z&&this.manager.emit(this.options.event+Z,j),this.manager.emit(this.options.event,j)}});function Bi(){si.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}b(Bi,si,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Na]},process:function(j){var Z=this.options,fe=j.pointers.length===Z.pointers,Fe=j.distance<Z.threshold,pt=j.deltaTime<Z.time;if(this.reset(),j.eventType&Ve&&this.count===0)return this.failTimeout();if(Fe&&pt&&fe){if(j.eventType!=Ue)return this.failTimeout();var Nt=this.pTime?j.timeStamp-this.pTime<Z.interval:!0,pr=!this.pCenter||pi(this.pCenter,j.center)<Z.posThreshold;this.pTime=j.timeStamp,this.pCenter=j.center,!pr||!Nt?this.count=1:this.count+=1,this._input=j;var Pn=this.count%Z.taps;if(Pn===0)return this.hasRequireFailures()?(this._timer=h(function(){this.state=Un,this.tryEmit()},Z.interval,this),Si):Un}return Li},failTimeout:function(){return this._timer=h(function(){this.state=Li},this.options.interval,this),Li},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==Un&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function Zi(j,Z){return Z=Z||{},Z.recognizers=B(Z.recognizers,Zi.defaults.preset),new Eu(j,Z)}Zi.VERSION="2.0.7",Zi.defaults={domEvents:!1,touchAction:io,enable:!0,inputTarget:null,inputClass:null,preset:[[jo,{enable:!1}],[oo,{enable:!1},["rotate"]],[yu,{direction:Ot}],[$n,{direction:Ot},["swipe"]],[Bi],[Bi,{event:"doubletap",taps:2},["tap"]],[gu]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var vi=1,Ho=2;function Eu(j,Z){this.options=E({},Zi.defaults,Z||{}),this.options.inputTarget=this.options.inputTarget||j,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=j,this.input=zr(this),this.touchAction=new Ia(this,this.options.touchAction),Tu(this,!0),_(this.options.recognizers,function(fe){var Fe=this.add(new fe[0](fe[1]));fe[2]&&Fe.recognizeWith(fe[2]),fe[3]&&Fe.requireFailure(fe[3])},this)}Eu.prototype={set:function(j){return E(this.options,j),j.touchAction&&this.touchAction.update(),j.inputTarget&&(this.input.destroy(),this.input.target=j.inputTarget,this.input.init()),this},stop:function(j){this.session.stopped=j?Ho:vi},recognize:function(j){var Z=this.session;if(!Z.stopped){this.touchAction.preventDefaults(j);var fe,Fe=this.recognizers,pt=Z.curRecognizer;(!pt||pt&&pt.state&Un)&&(pt=Z.curRecognizer=null);for(var Nt=0;Nt<Fe.length;)fe=Fe[Nt],Z.stopped!==Ho&&(!pt||fe==pt||fe.canRecognizeWith(pt))?fe.recognize(j):fe.reset(),!pt&&fe.state&(Si|da|Di)&&(pt=Z.curRecognizer=fe),Nt++}},get:function(j){if(j instanceof si)return j;for(var Z=this.recognizers,fe=0;fe<Z.length;fe++)if(Z[fe].options.event==j)return Z[fe];return null},add:function(j){if(m(j,"add",this))return this;var Z=this.get(j.options.event);return Z&&this.remove(Z),this.recognizers.push(j),j.manager=this,this.touchAction.update(),j},remove:function(j){if(m(j,"remove",this))return this;if(j=this.get(j),j){var Z=this.recognizers,fe=X(Z,j);fe!==-1&&(Z.splice(fe,1),this.touchAction.update())}return this},on:function(j,Z){if(j!==i&&Z!==i){var fe=this.handlers;return _(Q(j),function(Fe){fe[Fe]=fe[Fe]||[],fe[Fe].push(Z)}),this}},off:function(j,Z){if(j!==i){var fe=this.handlers;return _(Q(j),function(Fe){Z?fe[Fe]&&fe[Fe].splice(X(fe[Fe],Z),1):delete fe[Fe]}),this}},emit:function(j,Z){this.options.domEvents&&Vo(j,Z);var fe=this.handlers[j]&&this.handlers[j].slice();if(!(!fe||!fe.length)){Z.type=j,Z.preventDefault=function(){Z.srcEvent.preventDefault()};for(var Fe=0;Fe<fe.length;)fe[Fe](Z),Fe++}},destroy:function(){this.element&&Tu(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function Tu(j,Z){var fe=j.element;if(fe.style){var Fe;_(j.options.cssProps,function(pt,Nt){Fe=H(fe.style,Nt),Z?(j.oldCssProps[Fe]=fe.style[Fe],fe.style[Fe]=pt):fe.style[Fe]=j.oldCssProps[Fe]||""}),Z||(j.oldCssProps={})}}function Vo(j,Z){var fe=r.createEvent("Event");fe.initEvent(j,!0,!0),fe.gesture=Z,Z.target.dispatchEvent(fe)}E(Zi,{INPUT_START:Ve,INPUT_MOVE:yt,INPUT_END:Ue,INPUT_CANCEL:ge,STATE_POSSIBLE:As,STATE_BEGAN:Si,STATE_CHANGED:da,STATE_ENDED:Di,STATE_RECOGNIZED:Un,STATE_CANCELLED:ao,STATE_FAILED:Li,DIRECTION_NONE:nt,DIRECTION_LEFT:Ce,DIRECTION_RIGHT:zt,DIRECTION_UP:jt,DIRECTION_DOWN:_t,DIRECTION_HORIZONTAL:Ot,DIRECTION_VERTICAL:xt,DIRECTION_ALL:Xt,Manager:Eu,Input:Tr,TouchAction:Ia,TouchInput:On,MouseInput:fu,PointerEventInput:Ul,TouchMouseInput:hu,SingleTouchInput:du,Recognizer:si,AttrRecognizer:Ai,Tap:Bi,Pan:$n,Swipe:yu,Pinch:oo,Rotate:jo,Press:gu,on:w,off:D,each:_,merge:A,extend:T,assign:E,inherit:b,bindFn:R,prefixed:H});var nf=typeof t<"u"?t:typeof self<"u"?self:{};nf.Hammer=Zi,e.exports?e.exports=Zi:t[n]=Zi})(window,document,"Hammer")})(bA)),bA.exports}var cW=lW();const Mp=Pr(cW),fW={panstart:"dragstart",panmove:"dragging",panend:"dragend",pancancel:"dragcancel"};class dW extends fR{get mapService(){return this.container.mapService}constructor(t){super(),L(this,"indragging",!1),L(this,"hammertime",void 0),L(this,"lastClickTime",0),L(this,"lastClickXY",[-1,-1]),L(this,"clickTimer",void 0),L(this,"$containter",void 0),L(this,"onDrag",r=>{const n=this.interactionEvent(r);n.type=fW[n.type],n.type==="dragging"?this.indragging=!0:this.indragging=!1,this.emit(ia.Drag,n)}),L(this,"onHammer",r=>{r.srcEvent.stopPropagation();const n=this.interactionEvent(r);this.emit(ia.Hover,n)}),L(this,"onTouch",r=>{const n=r.touches[0];this.onHover({clientX:n.clientX,clientY:n.clientY,type:"touchstart"})}),L(this,"onTouchEnd",r=>{if(r.changedTouches.length>0){const n=r.changedTouches[0];this.onHover({clientX:n.clientX,clientY:n.clientY,type:"touchend"})}}),L(this,"onTouchMove",r=>{const n=r.changedTouches[0];this.onHover({clientX:n.clientX,clientY:n.clientY,type:"touchmove"})}),L(this,"onHover",r=>{const{clientX:n,clientY:i}=r;let a=n,s=i;const l=r.type,c=this.mapService.getMapContainer();if(c){const{top:p,left:h}=c.getBoundingClientRect();a=a-h-c.clientLeft,s=s-p-c.clientTop}const d=this.mapService.containerToLngLat([a,s]);if(l==="click"){this.isDoubleTap(a,s,d);return}if(l==="touch"){this.isDoubleTap(a,s,d);return}l!=="click"&&l!=="dblclick"&&this.emit(ia.Hover,{x:a,y:s,lngLat:d,type:l,target:r})}),this.container=t}init(){this.addEventListenerOnMap(),this.$containter=this.mapService.getMapContainer()}destroy(){this.hammertime&&this.hammertime.destroy(),this.removeEventListenerOnMap(),this.off(ia.Hover)}triggerHover({x:t,y:r}){this.emit(ia.Hover,{x:t,y:r})}triggerSelect(t){this.emit(ia.Select,{featureId:t})}triggerActive(t){this.emit(ia.Active,{featureId:t})}addEventListenerOnMap(){const t=this.mapService.getMapContainer();if(t){const r=new Mp.Manager(t);r.add(new Mp.Tap({event:"dblclick",taps:2})),r.add(new Mp.Tap({event:"click"})),r.add(new Mp.Pan({threshold:0,pointers:0})),r.add(new Mp.Press({})),r.on("dblclick click",this.onHammer),r.on("panstart panmove panend pancancel",this.onDrag),t.addEventListener("touchstart",this.onTouch),t.addEventListener("touchend",this.onTouchEnd),t.addEventListener("mousemove",this.onHover),t.addEventListener("touchmove",this.onTouchMove),t.addEventListener("mousedown",this.onHover,!0),t.addEventListener("mouseup",this.onHover),t.addEventListener("contextmenu",this.onHover),this.hammertime=r}}removeEventListenerOnMap(){const t=this.mapService.getMapContainer();t&&(t.removeEventListener("mousemove",this.onHover),this.hammertime.off("dblclick click",this.onHammer),this.hammertime.off("panstart panmove panend pancancel",this.onDrag),t.removeEventListener("touchstart",this.onTouch),t.removeEventListener("touchend",this.onTouchEnd),t.removeEventListener("mousedown",this.onHover),t.removeEventListener("mouseup",this.onHover),t.removeEventListener("contextmenu",this.onHover))}interactionEvent(t){const{type:r,pointerType:n}=t;let i,a;n==="touch"?(a=Math.floor(t.pointers[0].clientY),i=Math.floor(t.pointers[0].clientX)):(a=Math.floor(t.srcEvent.y),i=Math.floor(t.srcEvent.x));const s=this.mapService.getMapContainer();if(s){const{top:c,left:d}=s.getBoundingClientRect();i-=d,a-=c}const l=this.mapService.containerToLngLat([i,a]);return{x:i,y:a,lngLat:l,type:r,target:t.srcEvent}}isDoubleTap(t,r,n){const i=new Date().getTime();let a="click";i-this.lastClickTime<400&&Math.abs(this.lastClickXY[0]-t)<10&&Math.abs(this.lastClickXY[1]-r)<10?(this.lastClickTime=0,this.lastClickXY=[-1,-1],this.clickTimer&&clearTimeout(this.clickTimer),a="dblclick",this.emit(ia.Hover,{x:t,y:r,lngLat:n,type:a})):(this.lastClickTime=i,this.lastClickXY=[t,r],this.clickTimer=setTimeout(()=>{a="click",this.emit(ia.Hover,{x:t,y:r,lngLat:n,type:a})},400))}}let hW=0;function pW(e){let t=e;if(typeof e=="string"&&(t=document.getElementById(e)),t){const r=document.createElement("div");return r.style.cssText+=`
      position: absolute;
      z-index:2;
      height: 100%;
      width: 100%;
      pointer-events: none;
    `,r.id=`l7-scene-${hW++}`,r.classList.add("l7-scene"),t.appendChild(r),r}return null}function vW(e){var t;let r=!0;if((e==null||(t=e.target)===null||t===void 0?void 0:t.target)instanceof HTMLElement){var n;let a=e==null||(n=e.target)===null||n===void 0?void 0:n.target;for(;a;){var i;const s=Array.from(a.classList);if(s.includes("l7-marker")||s.includes("l7-popup")){r=!1;break}a=(i=a)===null||i===void 0?void 0:i.parentElement}}return r}let Ov=(function(e){return e[e.SAMPLED=0]="SAMPLED",e[e.RENDER_TARGET=1]="RENDER_TARGET",e})({});class mW{constructor(t){var r=this;L(this,"pickedColors",void 0),L(this,"pickedTileLayers",[]),L(this,"pickingFBO",void 0),L(this,"width",0),L(this,"height",0),L(this,"alreadyInPicking",!1),L(this,"pickBufferScale",1),L(this,"pickFromPickingFBO",(function(){var n=Ze(function*(i,{x:a,y:s,lngLat:l,type:c,target:d}){var p;let h=!1;const{readPixels:m,readPixelsAsync:_,getViewportSize:y,queryVerdorInfo:E}=r.rendererService,{width:T,height:A}=y(),{enableHighlight:b,enableSelect:R}=i.getLayerConfig(),M=a*na,B=s*na;if(M>T-1*na||M<0||B>A-1*na||B<0)return!1;let w;if(E()==="WebGPU"?w=yield _({x:Math.floor(M/r.pickBufferScale),y:Math.floor((A-(s+1)*na)/r.pickBufferScale),width:1,height:1,data:new Uint8Array(4),framebuffer:r.pickingFBO}):w=m({x:Math.floor(M/r.pickBufferScale),y:Math.floor((A-(s+1)*na)/r.pickBufferScale),width:1,height:1,data:new Uint8Array(4),framebuffer:r.pickingFBO}),r.pickedColors=w,w[0]!==0||w[1]!==0||w[2]!==0){const U=Dc(w),ae=i.layerPickService.getFeatureById(U);U!==i.getCurrentPickId()&&c==="mousemove"&&(c="mouseenter");const Q={x:a,y:s,type:c,lngLat:l,featureId:U,feature:ae,target:d};ae&&(h=!0,i.setCurrentPickId(U),r.triggerHoverOnLayer(i,Q))}else{const U={x:a,y:s,lngLat:l,type:i.getCurrentPickId()!==null&&c==="mousemove"?"mouseout":"un"+c,featureId:null,target:d,feature:null};r.triggerHoverOnLayer(i,Ge(Ge({},U),{},{type:"unpick"})),r.triggerHoverOnLayer(i,U),i.setCurrentPickId(null)}if(b&&i.layerPickService.highlightPickedFeature(w),R&&c==="click"&&((p=w)===null||p===void 0?void 0:p.toString())!==[0,0,0,0].toString()){const U=Dc(w);i.getCurrentSelectedId()===null||U!==i.getCurrentSelectedId()?(i.layerPickService.selectFeature(w),i.setCurrentSelectedId(U)):(i.layerPickService.selectFeature(new Uint8Array([0,0,0,0])),i.setCurrentSelectedId(null))}return h});return function(i,a){return n.apply(this,arguments)}})()),this.container=t}get mapService(){return this.container.mapService}get rendererService(){return this.container.rendererService}get configService(){return this.container.globalConfigService}get interactionService(){return this.container.interactionService}get layerService(){return this.container.layerService}init(t){const{createTexture2D:r,createFramebuffer:n,getViewportSize:i}=this.rendererService;let{width:a,height:s}=i();this.pickBufferScale=this.configService.getSceneConfig(t).pickBufferScale||1,a=Math.round(a/this.pickBufferScale),s=Math.round(s/this.pickBufferScale);const l=r({width:a,height:s,usage:Ov.RENDER_TARGET,label:"Picking Texture"});this.pickingFBO=n({color:l,depth:!0,width:a,height:s}),this.interactionService.on(ia.Hover,this.pickingAllLayer.bind(this))}boxPickLayer(t,r,n){var i=this;return Ze(function*(){const{useFramebufferAsync:a,clear:s}=i.rendererService;i.resizePickingFBO(),t.hooks.beforePickingEncode.call(),yield a(i.pickingFBO,Ze(function*(){s({framebuffer:i.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),t.renderModels({ispick:!0})})),t.hooks.afterPickingEncode.call();const l=yield i.pickBox(t,r);n(l)})()}pickBox(t,r){var n=this;return Ze(function*(){const[i,a,s,l]=r.map(A=>{const b=A<0?0:A;return Math.floor(b*na/n.pickBufferScale)}),{readPixelsAsync:c,getViewportSize:d}=n.rendererService,{width:p,height:h}=d();if(i>(p-1)*na/n.pickBufferScale||s<0||a>(h-1)*na/n.pickBufferScale||l<0)return[];const m=Math.min(p/n.pickBufferScale,s)-i,_=Math.min(h/n.pickBufferScale,l)-a,y=yield c({x:i,y:Math.floor(h/n.pickBufferScale-(l+1)),width:m,height:_,data:new Uint8Array(m*_*4),framebuffer:n.pickingFBO}),E=[],T={};for(let A=0;A<y.length/4;A=A+1){const b=y.slice(A*4,A*4+4),R=Dc(b);if(R!==-1&&!T[R]){const M=t.layerPickService.getFeatureById(R);E.push(Ge(Ge({},M),{},{pickedFeatureIdx:R})),T[R]=!0}}return E})()}handleCursor(t,r){const{cursor:n="",cursorEnabled:i}=t.getLayerConfig();if(i){const s=this.mapService.getType()==="amap"?this.mapService.getMapContainer():this.mapService.getMarkerContainer(),l=s?.style.getPropertyValue("cursor");r==="unmousemove"&&l!==""?s?.style.setProperty("cursor",""):r==="mousemove"&&s?.style.setProperty("cursor",n)}}destroy(){this.pickingFBO.destroy(),this.pickingFBO=null}pickingAllLayer(t){var r=this;return Ze(function*(){!r.layerService.needPick(t.type)||!r.isPickingAllLayer()||(r.alreadyInPicking=!0,yield r.pickingLayers(t),r.layerService.renderLayers(),r.alreadyInPicking=!1)})()}isPickingAllLayer(){return!(this.alreadyInPicking||this.layerService.alreadyInRendering||this.interactionService.indragging||!this.layerService.getShaderPickStat())}resizePickingFBO(){const{getViewportSize:t}=this.rendererService,{width:r,height:n}=t();(this.width!==r||this.height!==n)&&(this.pickingFBO.resize({width:Math.round(r/this.pickBufferScale),height:Math.round(n/this.pickBufferScale)}),this.width=r,this.height=n)}pickingLayers(t){var r=this;return Ze(function*(){const{clear:n,useFramebufferAsync:i}=r.rendererService;r.resizePickingFBO();const a=r.layerService.getRenderList();for(const s of a.filter(l=>l.needPick(t.type)).reverse()){yield i(r.pickingFBO,Ze(function*(){n({framebuffer:r.pickingFBO,color:[0,0,0,0],stencil:0,depth:1}),s.layerPickService.pickRender(t)}));const l=yield r.pickFromPickingFBO(s,t);if(r.layerService.pickedLayerId=l?+s.id:-1,l&&!s.getLayerConfig().enablePropagation)break}})()}triggerHoverOnLayer(t,r){vW(r)&&(this.handleCursor(t,r.type),t.emit(r.type,r))}}class _W{constructor(t=!0){L(this,"autoStart",void 0),L(this,"startTime",0),L(this,"oldTime",0),L(this,"running",!1),L(this,"elapsedTime",0),this.autoStart=t}start(){this.startTime=(typeof performance>"u"?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const r=(typeof performance>"u"?Date:performance).now();t=(r-this.oldTime)/1e3,this.oldTime=r,this.elapsedTime+=t}return t}}const{throttle:YN}=yn;class gW extends Oa.EventEmitter{get renderService(){return this.container.rendererService}get mapService(){return this.container.mapService}get debugService(){return this.container.debugService}constructor(t){super(),L(this,"pickedLayerId",-1),L(this,"clock",new _W),L(this,"alreadyInRendering",!1),L(this,"layers",[]),L(this,"layerList",[]),L(this,"layerRenderID",void 0),L(this,"sceneInited",!1),L(this,"animateInstanceCount",0),L(this,"shaderPicking",!0),L(this,"enableRender",!0),L(this,"reRender",YN(()=>{this.renderLayers()},32)),L(this,"throttleRenderLayers",YN(()=>{this.renderLayers()},16)),this.container=t}needPick(t){return this.updateLayerRenderList(),this.layerList.some(r=>r.needPick(t))}add(t){this.layers.push(t),this.sceneInited&&t.init().then(()=>{this.renderLayers()})}addMask(t){this.sceneInited&&t.init().then(()=>{this.renderLayers()})}initLayers(){var t=this;return Ze(function*(){t.sceneInited=!0,t.layers.forEach((function(){var r=Ze(function*(n){n.startInit||(yield n.init(),t.updateLayerRenderList())});return function(n){return r.apply(this,arguments)}})())})()}getSceneInited(){return this.sceneInited}getRenderList(){return this.layerList}getLayers(){return this.layers}getLayer(t){return this.layers.find(r=>r.id===t)}getLayerByName(t){return this.layers.find(r=>r.name===t)}remove(t,r){var n=this;return Ze(function*(){if(r){r.layerChildren||(r.layerChildren=[]);const i=r.layerChildren.findIndex(a=>a.id===t.id);i>-1&&r.layerChildren.splice(i,1)}else{const i=n.layers.findIndex(a=>a.id===t.id);i>-1&&n.layers.splice(i,1)}t.destroy(),n.reRender(),n.emit("layerChange",n.layers)})()}removeAllLayers(){var t=this;return Ze(function*(){t.destroy(),t.reRender()})()}setEnableRender(t){this.enableRender=t}renderLayers(){var t=this;return Ze(function*(){if(t.alreadyInRendering||!t.enableRender)return;t.updateLayerRenderList();const r=t.debugService.generateRenderUid();t.debugService.renderStart(r),t.alreadyInRendering=!0,t.clear();for(const n of t.layerList)n.prerender();t.renderService.beginFrame();for(const n of t.layerList){const{enableMask:i}=n.getLayerConfig();n.masks.filter(a=>a.inited).length>0&&i&&t.renderMask(n.masks),n.getLayerConfig().enableMultiPassRenderer?yield n.renderMultiPass():n.render()}t.renderService.endFrame(),t.debugService.renderEnd(r),t.alreadyInRendering=!1})()}renderMask(t){let r=0;this.renderService.clear({stencil:0,depth:1,framebuffer:null});const n=t.length>1?Mc.MULTIPLE:Mc.SINGLE;for(const i of t)i.render({isStencil:!0,stencilType:n,stencilIndex:r++})}beforeRenderData(t){var r=this;return Ze(function*(){(yield t.hooks.beforeRenderData.promise())&&r.renderLayers()})()}renderTileLayerMask(t){let r=0;const{enableMask:n=!0}=t.getLayerConfig();let i=t.tileMask?1:0;const a=t.masks.filter(l=>l.inited);i=i+(n?a.length:1);const s=i>1?Mc.MULTIPLE:Mc.SINGLE;if((t.tileMask||a.length&&n)&&this.renderService.clear({stencil:0,depth:1,framebuffer:null}),a.length&&n)for(const l of a)l.render({isStencil:!0,stencilType:s,stencilIndex:r++});t.tileMask&&t.tileMask.render({isStencil:!0,stencilType:s,stencilIndex:r++,stencilOperation:Vg.OR})}renderTileLayer(t){var r=this;return Ze(function*(){r.renderTileLayerMask(t),t.getLayerConfig().enableMultiPassRenderer?yield t.renderMultiPass():yield t.render()})()}updateLayerRenderList(){this.layerList=[],this.layers.filter(t=>t.inited).filter(t=>t.isVisible()).sort((t,r)=>t.zIndex-r.zIndex).forEach(t=>{this.layerList.push(t)})}destroy(){this.layers.forEach(t=>{t.destroy()}),this.layers=[],this.layerList=[],this.emit("layerChange",this.layers)}startAnimate(){this.animateInstanceCount++===0&&(this.clock.start(),this.runRender())}stopAnimate(){--this.animateInstanceCount===0&&(this.stopRender(),this.clock.stop())}getOESTextureFloat(){return this.renderService.extensionObject.OES_texture_float}enableShaderPick(){this.shaderPicking=!0}disableShaderPick(){this.shaderPicking=!1}getShaderPickStat(){return this.shaderPicking}clear(){const t=$r(this.mapService.bgColor);this.renderService.clear({color:t,depth:1,stencil:0,framebuffer:null})}runRender(){this.renderLayers(),this.layerRenderID=window.requestAnimationFrame(this.runRender.bind(this))}stopRender(){window.cancelAnimationFrame(this.layerRenderID)}}function yW(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function ms(e,t){if(e==null)return{};var r,n,i=yW(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(n=0;n<a.length;n++)r=a[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}const{isNil:EW}=yn;class TW{constructor(t){L(this,"name",void 0),L(this,"type",void 0),L(this,"scale",void 0),L(this,"descriptor",void 0),L(this,"featureBufferLayout",[]),L(this,"needRescale",!1),L(this,"needRemapping",!1),L(this,"needRegenerateVertices",!1),L(this,"featureRange",{startIndex:0,endIndex:1/0}),L(this,"vertexAttribute",void 0),L(this,"defaultCallback",r=>{if(r.length===0){var n;return((n=this.scale)===null||n===void 0?void 0:n.defaultValues)||[]}return r.map((i,a)=>{var s;return((s=this.scale)===null||s===void 0?void 0:s.scalers[a].func)(i)})}),this.setProps(t)}setProps(t){Object.assign(this,t)}mapping(t){var r;if((r=this.scale)!==null&&r!==void 0&&r.callback){var n;const i=(n=this.scale)===null||n===void 0?void 0:n.callback(...t);if(!EW(i))return[i]}return this.defaultCallback(t)}resetDescriptor(){this.descriptor&&(this.descriptor.buffer.data=[])}}const SW=["buffer","update","name"],AW=["buffer","update","name"],bW={[N.FLOAT]:4,[N.UNSIGNED_BYTE]:1,[N.UNSIGNED_SHORT]:2};class xW{constructor(t){L(this,"attributesAndIndices",void 0),L(this,"attributes",[]),L(this,"triangulation",void 0),L(this,"featureLayout",{sizePerElement:0,elements:[]}),this.rendererService=t}registerStyleAttribute(t){let r=this.getLayerStyleAttribute(t.name||"");return r?r.setProps(t):(r=new TW(t),this.attributes.push(r)),r}unRegisterStyleAttribute(t){const r=this.attributes.findIndex(n=>n.name===t);r>-1&&this.attributes.splice(r,1)}updateScaleAttribute(t){this.attributes.forEach(r=>{var n;const i=r.name,a=(n=r.scale)===null||n===void 0?void 0:n.field;(t[i]||a&&t[a])&&(r.needRescale=!0,r.needRemapping=!0,r.needRegenerateVertices=!0)})}updateStyleAttribute(t,r,n){let i=this.getLayerStyleAttribute(t);i||(i=this.registerStyleAttribute(Ge(Ge({},r),{},{name:t})));const{scale:a}=r;a&&i&&(i.scale=a,i.needRescale=!0,i.needRemapping=!0,i.needRegenerateVertices=!0,n&&n.featureRange&&(i.featureRange=n.featureRange))}getLayerStyleAttributes(){return this.attributes}getLayerStyleAttribute(t){return this.attributes.find(r=>r.name===t)}getLayerAttributeScale(t){var r;const n=this.getLayerStyleAttribute(t),i=n==null||(r=n.scale)===null||r===void 0?void 0:r.scalers;return i&&i[0]?i[0].func:null}updateAttributeByFeatureRange(t,r,n=0,i,a){const s=this.attributes.find(l=>l.name===t);if(s&&s.descriptor){const{descriptor:l}=s,{update:c,buffer:d,size:p=0}=l,h=bW[d.type||N.FLOAT];if(c){const{elements:m,sizePerElement:_}=this.featureLayout,y=m.slice(n,i);if(!y.length)return;const{offset:E}=y[0],T=E*p*h,A=y.map(({featureIdx:b,vertices:R,normals:M},B)=>{const w=R.length/_,D=[];for(let U=0;U<w;U++){const ae=M?M.slice(U*3,U*3+3):[];D.push(...c(r[b],b,R.slice(U*_,U*_+_),B,ae))}return D}).flat();s.vertexAttribute.updateBuffer({data:A,offset:T}),a?.emit(`legend:${t}`,a.getLegend(t))}}}createAttributesAndIndices(t,r,n,i){this.featureLayout={sizePerElement:0,elements:[]},r&&(this.triangulation=r);const a=this.attributes.map(E=>(E.resetDescriptor(),E.descriptor));let s=0,l=0;const c=[];let d=3;t.forEach((E,T)=>{const{indices:A,vertices:b,normals:R,size:M,indexes:B,count:w}=this.triangulation(E,n);typeof w=="number"&&(l+=w),A.forEach(U=>{c.push(U+s)}),d=M;const D=b.length/M;this.featureLayout.sizePerElement=d,this.featureLayout.elements.push({featureIdx:T,vertices:b,normals:R,offset:s}),s+=D;for(let U=0;U<D;U++){const ae=R?.slice(U*3,U*3+3)||[],Q=b.slice(U*M,U*M+M);let X=0;B&&B[U]!==void 0&&(X=B[U]),a.forEach((x,P)=>{x&&x.update&&x.buffer.data.push(...x.update(E,T,Q,U,ae,X))})}});const{createAttribute:p,createBuffer:h,createElements:m}=this.rendererService,_={};a.forEach((E,T)=>{if(E){const{buffer:A,update:b,name:R}=E,M=ms(E,SW),B=p(Ge({buffer:h(A)},M));_[E.name||""]=B,this.attributes[T].vertexAttribute=B}});const y=m({data:c,type:N.UNSIGNED_INT,count:c.length});return this.attributesAndIndices={attributes:_,elements:y,count:l},Object.values(this.attributes).filter(E=>E.scale).forEach(E=>{const T=E.name;i?.emit(`legend:${T}`,i.getLegend(T))}),this.attributesAndIndices}createAttributes(t,r){this.featureLayout={sizePerElement:0,elements:[]},r&&(this.triangulation=r);const n=this.attributes.map(d=>(d.resetDescriptor(),d.descriptor));let i=0,a=3;t.forEach((d,p)=>{const{indices:h,vertices:m,normals:_,size:y,indexes:E}=this.triangulation(d);h.forEach(A=>{}),a=y;const T=m.length/y;this.featureLayout.sizePerElement=a,this.featureLayout.elements.push({featureIdx:p,vertices:m,normals:_,offset:i}),i+=T;for(let A=0;A<T;A++){const b=_?.slice(A*3,A*3+3)||[],R=m.slice(A*y,A*y+y);let M=0;E&&E[A]!==void 0&&(M=E[A]),n.forEach((B,w)=>{B&&B.update&&B.buffer.data.push(...B.update(d,p,R,A,b,M))})}});const{createAttribute:s,createBuffer:l}=this.rendererService,c={};return n.forEach((d,p)=>{if(d){const{buffer:h,update:m,name:_}=d,y=ms(d,AW),E=s(Ge({buffer:l(h)},y));c[d.name||""]=E,this.attributes[p].vertexAttribute=E}}),{attributes:c}}clearAllAttributes(){var t;this.attributes.forEach(r=>{r.vertexAttribute&&r.vertexAttribute.destroy()}),(t=this.attributesAndIndices)===null||t===void 0||t.elements.destroy(),this.attributes=[]}}function zB(e,t,r,n){function i(a){return a instanceof r?a:new r(function(s){s(a)})}return new(r||(r=Promise))(function(a,s){function l(p){try{d(n.next(p))}catch(h){s(h)}}function c(p){try{d(n.throw(p))}catch(h){s(h)}}function d(p){p.done?a(p.value):i(p.value).then(l,c)}d((n=n.apply(e,[])).next())})}function jB(e,t){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,s;return s={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function l(d){return function(p){return c([d,p])}}function c(d){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(a=d[0]&2?i.return:d[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,d[1])).done)return a;switch(i=0,a&&(d=[d[0]&2,a.value]),d[0]){case 0:case 1:a=d;break;case 4:return r.label++,{value:d[1],done:!1};case 5:r.label++,i=d[1],d=[0];continue;case 7:d=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(d[0]===6||d[0]===2)){r=0;continue}if(d[0]===3&&(!a||d[1]>a[0]&&d[1]<a[3])){r.label=d[1];break}if(d[0]===6&&r.label<a[1]){r.label=a[1],a=d;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(d);break}a[2]&&r.ops.pop(),r.trys.pop();continue}d=t.call(e,r)}catch(p){d=[6,p],i=0}finally{n=a=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}function _R(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),i,a=[],s;try{for(;(t===void 0||t-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(l){s={error:l}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(s)throw s.error}}return a}function gR(e,t,r){if(arguments.length===2)for(var n=0,i=t.length,a;n<i;n++)(a||!(n in t))&&(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))}function HB(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var zb={exports:{}},H0={exports:{}},Mv={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;function r(n){return n&&typeof n.length=="number"&&n.length>=0&&n.length%1===0}e.exports=t.default})(Mv,Mv.exports);var fa={},jb={exports:{}},Hb={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(r){return function(){for(var n=[],i=arguments.length;i--;)n[i]=arguments[i];var a=n.pop();return r.call(this,n,a)}},e.exports=t.default})(Hb,Hb.exports);var Dl={};Object.defineProperty(Dl,"__esModule",{value:!0});Dl.fallback=VB;Dl.wrap=XB;var RW=Dl.hasQueueMicrotask=typeof queueMicrotask=="function"&&queueMicrotask,CW=Dl.hasSetImmediate=typeof setImmediate=="function"&&setImmediate,OW=Dl.hasNextTick=typeof process=="object"&&typeof process.nextTick=="function";function VB(e){setTimeout(e,0)}function XB(e){return function(t){for(var r=[],n=arguments.length-1;n-- >0;)r[n]=arguments[n+1];return e(function(){return t.apply(void 0,r)})}}var av;RW?av=queueMicrotask:CW?av=setImmediate:OW?av=process.nextTick:av=VB;Dl.default=XB(av);(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=c;var r=Hb.exports,n=l(r),i=Dl,a=l(i),s=fa;function l(h){return h&&h.__esModule?h:{default:h}}function c(h){return(0,s.isAsync)(h)?function(){for(var m=[],_=arguments.length;_--;)m[_]=arguments[_];var y=m.pop(),E=h.apply(this,m);return d(E,y)}:(0,n.default)(function(m,_){var y;try{y=h.apply(this,m)}catch(E){return _(E)}if(y&&typeof y.then=="function")return d(y,_);_(null,y)})}function d(h,m){return h.then(function(_){p(m,null,_)},function(_){p(m,_&&_.message?_:new Error(_))})}function p(h,m,_){try{h(m,_)}catch(y){(0,a.default)(function(E){throw E},y)}}e.exports=t.default})(jb,jb.exports);Object.defineProperty(fa,"__esModule",{value:!0});fa.isAsyncIterable=fa.isAsyncGenerator=fa.isAsync=void 0;var MW=jb.exports,wW=NW(MW);function NW(e){return e&&e.__esModule?e:{default:e}}function GB(e){return e[Symbol.toStringTag]==="AsyncFunction"}function IW(e){return e[Symbol.toStringTag]==="AsyncGenerator"}function PW(e){return typeof e[Symbol.asyncIterator]=="function"}function DW(e){if(typeof e!="function")throw new Error("expected a function");return GB(e)?(0,wW.default)(e):e}fa.default=DW;fa.isAsync=GB;fa.isAsyncGenerator=IW;fa.isAsyncIterable=PW;var Uc={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;function r(n,i){if(i===void 0&&(i=n.length),!i)throw new Error("arity is undefined");function a(){for(var s=this,l=[],c=arguments.length;c--;)l[c]=arguments[c];return typeof l[i-1]=="function"?n.apply(this,l):new Promise(function(d,p){l[i-1]=function(h){for(var m=[],_=arguments.length-1;_-- >0;)m[_]=arguments[_+1];if(h)return p(h);d(m.length>1?m:m[0])},n.apply(s,l)})}return a}e.exports=t.default})(Uc,Uc.exports);(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Mv.exports,n=c(r),i=fa,a=c(i),s=Uc.exports,l=c(s);function c(d){return d&&d.__esModule?d:{default:d}}t.default=(0,l.default)(function(d,p,h){var m=(0,n.default)(p)?[]:{};d(p,function(_,y,E){(0,a.default)(_)(function(T){for(var A,b=[],R=arguments.length-1;R-- >0;)b[R]=arguments[R+1];b.length<2&&(A=b,b=A[0]),m[y]=b,E(T)})},function(_){return h(_,m)})},3),e.exports=t.default})(H0,H0.exports);var Vb={exports:{}},V0={exports:{}},Xb={exports:{}},wv={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;function r(n){function i(){for(var a=[],s=arguments.length;s--;)a[s]=arguments[s];if(n!==null){var l=n;n=null,l.apply(this,a)}}return Object.assign(i,n),i}e.exports=t.default})(wv,wv.exports);var Gb={exports:{}},qb={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(r){return r[Symbol.iterator]&&r[Symbol.iterator]()},e.exports=t.default})(qb,qb.exports);(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=p;var r=Mv.exports,n=s(r),i=qb.exports,a=s(i);function s(h){return h&&h.__esModule?h:{default:h}}function l(h){var m=-1,_=h.length;return function(){return++m<_?{value:h[m],key:m}:null}}function c(h){var m=-1;return function(){var y=h.next();return y.done?null:(m++,{value:y.value,key:m})}}function d(h){var m=h?Object.keys(h):[],_=-1,y=m.length;return function E(){var T=m[++_];return T==="__proto__"?E():_<y?{value:h[T],key:T}:null}}function p(h){if((0,n.default)(h))return l(h);var m=(0,a.default)(h);return m?c(m):d(h)}e.exports=t.default})(Gb,Gb.exports);var Nv={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=r;function r(n){return function(){for(var i=[],a=arguments.length;a--;)i[a]=arguments[a];if(n===null)throw new Error("Callback was already called.");var s=n;n=null,s.apply(this,i)}}e.exports=t.default})(Nv,Nv.exports);var Wb={exports:{}},Iv={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r={};t.default=r,e.exports=t.default})(Iv,Iv.exports);(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=a;var r=Iv.exports,n=i(r);function i(s){return s&&s.__esModule?s:{default:s}}function a(s,l,c,d){var p=!1,h=!1,m=!1,_=0,y=0;function E(){_>=l||m||p||(m=!0,s.next().then(function(b){var R=b.value,M=b.done;if(!(h||p)){if(m=!1,M){p=!0,_<=0&&d(null);return}_++,c(R,y,T),y++,E()}}).catch(A))}function T(b,R){if(_-=1,!h){if(b)return A(b);if(b===!1){p=!0,h=!0;return}if(R===n.default||p&&_<=0)return p=!0,d(null);E()}}function A(b){h||(m=!1,p=!0,d(b))}E()}e.exports=t.default})(Wb,Wb.exports);(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=wv.exports,n=_(r),i=Gb.exports,a=_(i),s=Nv.exports,l=_(s),c=fa,d=Wb.exports,p=_(d),h=Iv.exports,m=_(h);function _(y){return y&&y.__esModule?y:{default:y}}t.default=function(y){return function(E,T,A){if(A=(0,n.default)(A),y<=0)throw new RangeError("concurrency limit cannot be less than 1");if(!E)return A(null);if((0,c.isAsyncGenerator)(E))return(0,p.default)(E,y,T,A);if((0,c.isAsyncIterable)(E))return(0,p.default)(E[Symbol.asyncIterator](),y,T,A);var b=(0,a.default)(E),R=!1,M=!1,B=0,w=!1;function D(ae,Q){if(!M)if(B-=1,ae)R=!0,A(ae);else if(ae===!1)R=!0,M=!0;else{if(Q===m.default||R&&B<=0)return R=!0,A(null);w||U()}}function U(){for(w=!0;B<y&&!R;){var ae=b();if(ae===null){R=!0,B<=0&&A(null);return}B+=1,T(ae.value,ae.key,(0,l.default)(D))}w=!1}U()}},e.exports=t.default})(Xb,Xb.exports);(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Xb.exports,n=c(r),i=fa,a=c(i),s=Uc.exports,l=c(s);function c(p){return p&&p.__esModule?p:{default:p}}function d(p,h,m,_){return(0,n.default)(h)(p,(0,a.default)(m),_)}t.default=(0,l.default)(d,4),e.exports=t.default})(V0,V0.exports);(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=V0.exports,n=s(r),i=Uc.exports,a=s(i);function s(c){return c&&c.__esModule?c:{default:c}}function l(c,d,p){return(0,n.default)(c,1,d,p)}t.default=(0,a.default)(l,3),e.exports=t.default})(Vb,Vb.exports);(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=l;var r=H0.exports,n=s(r),i=Vb.exports,a=s(i);function s(c){return c&&c.__esModule?c:{default:c}}function l(c,d){return(0,n.default)(a.default,c,d)}e.exports=t.default})(zb,zb.exports);var Xg=HB(zb.exports),os=(function(){function e(){this.args=[],this.tasks=[]}return e.prototype.call=function(){for(var t=arguments,r=[],n=0;n<arguments.length;n++)r[n]=t[n];return this.args=r,Xg(this.tasks)},e.prototype.tap=function(t,r){var n=this;this.tasks.push(function(i){r.apply(void 0,gR([],_R(n.args),!1)),i(null,t)})},e})(),$N={exports:{}},Yb={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=Mv.exports,n=T(r),i=Iv.exports,a=T(i),s=V0.exports,l=T(s),c=wv.exports,d=T(c),p=Nv.exports,h=T(p),m=fa,_=T(m),y=Uc.exports,E=T(y);function T(M){return M&&M.__esModule?M:{default:M}}function A(M,B,w){w=(0,d.default)(w);var D=0,U=0,ae=M.length,Q=!1;ae===0&&w(null);function X(x,P){x===!1&&(Q=!0),Q!==!0&&(x?w(x):(++U===ae||P===a.default)&&w(null))}for(;D<ae;D++)B(M[D],D,(0,h.default)(X))}function b(M,B,w){return(0,l.default)(M,1/0,B,w)}function R(M,B,w){var D=(0,n.default)(M)?A:b;return D(M,(0,_.default)(B),w)}t.default=(0,E.default)(R,3),e.exports=t.default})(Yb,Yb.exports);(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=l;var r=Yb.exports,n=s(r),i=H0.exports,a=s(i);function s(c){return c&&c.__esModule?c:{default:c}}function l(c,d){return(0,a.default)(n.default,c,d)}e.exports=t.default})($N,$N.exports);var $b={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=wv.exports,n=p(r),i=Nv.exports,a=p(i),s=fa,l=p(s),c=Uc.exports,d=p(c);function p(m){return m&&m.__esModule?m:{default:m}}function h(m,_){if(_=(0,n.default)(_),!Array.isArray(m))return _(new Error("First argument to waterfall must be an array of functions"));if(!m.length)return _();var y=0;function E(A){var b=(0,l.default)(m[y++]);b.apply(void 0,A.concat([(0,a.default)(T)]))}function T(A){for(var b=[],R=arguments.length-1;R-- >0;)b[R]=arguments[R+1];if(A!==!1){if(A||y===m.length)return _.apply(void 0,[A].concat(b));E(b)}}E([])}t.default=(0,d.default)(h),e.exports=t.default})($b,$b.exports);var LW=HB($b.exports),ZN=(function(){function e(){this.tasks=[]}return e.prototype.call=function(){return Xg(this.tasks)},e.prototype.tap=function(t,r){this.tasks.push(function(n){var i=r();n(i,t)})},e})(),BW=(function(){function e(){this.args=[],this.tasks=[]}return e.prototype.promise=function(){for(var t=arguments,r=[],n=0;n<arguments.length;n++)r[n]=t[n];return this.args=r,Xg(this.tasks)},e.prototype.tapPromise=function(t,r){var n=this;this.tasks.push(function(i){return zB(n,void 0,void 0,function(){return jB(this,function(a){switch(a.label){case 0:return[4,r.apply(void 0,gR([],_R(this.args),!1))];case 1:return a.sent(),i(null,t),[2]}})})})},e})(),FW=(function(){function e(){this.args=[],this.tasks=[]}return e.prototype.promise=function(){for(var t=arguments,r=[],n=0;n<arguments.length;n++)r[n]=t[n];return this.args=r,Xg(this.tasks)},e.prototype.tapPromise=function(t,r){var n=this;this.tasks.push(function(i){return zB(n,void 0,void 0,function(){var a;return jB(this,function(s){switch(s.label){case 0:return[4,r.apply(void 0,gR([],_R(this.args),!1))];case 1:return a=s.sent(),i(a,t),[2]}})})})},e})(),UW=(function(){function e(){this.tasks=[]}return e.prototype.promise=function(){return LW(this.tasks)},e.prototype.tapPromise=function(t,r){this.tasks.length===0?this.tasks.push(function(n){r().then(function(i){n(null,i)})}):this.tasks.push(function(n,i){r(n).then(function(a){i(null,a)})})},e})(),xA={exports:{}},KN;function qB(){if(KN)return xA.exports;KN=1;var e=xA.exports={};return e.forEach=function(t,r){for(var n=0;n<t.length;n++){var i=r(t[n]);if(i)return i}},xA.exports}var RA,QN;function kW(){return QN||(QN=1,RA=function(e){var t=e.stateHandler.getState;function r(s){var l=t(s);return l&&!!l.isDetectable}function n(s){t(s).isDetectable=!0}function i(s){return!!t(s).busy}function a(s,l){t(s).busy=!!l}return{isDetectable:r,markAsDetectable:n,isBusy:i,markBusy:a}}),RA}var CA,JN;function zW(){return JN||(JN=1,CA=function(e){var t={};function r(s){var l=e.get(s);return l===void 0?[]:t[l]||[]}function n(s,l){var c=e.get(s);t[c]||(t[c]=[]),t[c].push(l)}function i(s,l){for(var c=r(s),d=0,p=c.length;d<p;++d)if(c[d]===l){c.splice(d,1);break}}function a(s){var l=r(s);l&&(l.length=0)}return{get:r,add:n,removeListener:i,removeAllListeners:a}}),CA}var OA,eI;function jW(){return eI||(eI=1,OA=function(){var e=1;function t(){return e++}return{generate:t}}),OA}var MA,tI;function HW(){return tI||(tI=1,MA=function(e){var t=e.idGenerator,r=e.stateHandler.getState;function n(a){var s=r(a);return s&&s.id!==void 0?s.id:null}function i(a){var s=r(a);if(!s)throw new Error("setId required the element to have a resize detection state.");var l=t.generate();return s.id=l,l}return{get:n,set:i}}),MA}var wA,rI;function VW(){return rI||(rI=1,wA=function(e){function t(){}var r={log:t,warn:t,error:t};if(!e&&window.console){var n=function(i,a){i[a]=function(){var l=console[a];if(l.apply)l.apply(console,arguments);else for(var c=0;c<arguments.length;c++)l(arguments[c])}};n(r,"log"),n(r,"warn"),n(r,"error")}return r}),wA}var NA={exports:{}},nI;function WB(){if(nI)return NA.exports;nI=1;var e=NA.exports={};return e.isIE=function(t){function r(){var i=navigator.userAgent.toLowerCase();return i.indexOf("msie")!==-1||i.indexOf("trident")!==-1||i.indexOf(" edge/")!==-1}if(!r())return!1;if(!t)return!0;var n=(function(){var i,a=3,s=document.createElement("div"),l=s.getElementsByTagName("i");do s.innerHTML="<!--[if gt IE "+ ++a+"]><i></i><![endif]-->";while(l[0]);return a>4?a:i})();return t===n},e.isLegacyOpera=function(){return!!window.opera},NA.exports}var IA={exports:{}},iI;function XW(){if(iI)return IA.exports;iI=1;var e=IA.exports={};e.getOption=t;function t(r,n,i){var a=r[n];return a==null&&i!==void 0?i:a}return IA.exports}var PA,aI;function GW(){if(aI)return PA;aI=1;var e=XW();PA=function(n){n=n||{};var i=n.reporter,a=e.getOption(n,"async",!0),s=e.getOption(n,"auto",!0);s&&!a&&(i&&i.warn("Invalid options combination. auto=true and async=false is invalid. Setting async=true."),a=!0);var l=t(),c,d=!1;function p(T,A){!d&&s&&a&&l.size()===0&&_(),l.add(T,A)}function h(){for(d=!0;l.size();){var T=l;l=t(),T.process()}d=!1}function m(T){d||(T===void 0&&(T=a),c&&(y(c),c=null),T?_():h())}function _(){c=E(h)}function y(T){var A=clearTimeout;return A(T)}function E(T){var A=function(b){return setTimeout(b,0)};return A(T)}return{add:p,force:m}};function t(){var r={},n=0,i=0,a=0;function s(d,p){p||(p=d,d=0),d>i?i=d:d<a&&(a=d),r[d]||(r[d]=[]),r[d].push(p),n++}function l(){for(var d=a;d<=i;d++)for(var p=r[d],h=0;h<p.length;h++){var m=p[h];m()}}function c(){return n}return{add:s,process:l,size:c}}return PA}var DA,oI;function qW(){if(oI)return DA;oI=1;var e="_erd";function t(i){return i[e]={},r(i)}function r(i){return i[e]}function n(i){delete i[e]}return DA={initState:t,getState:r,cleanState:n},DA}var LA,sI;function WW(){if(sI)return LA;sI=1;var e=WB();return LA=function(t){t=t||{};var r=t.reporter,n=t.batchProcessor,i=t.stateHandler.getState;if(!r)throw new Error("Missing required dependency: reporter.");function a(p,h){function m(){h(p)}if(e.isIE(8))i(p).object={proxy:m},p.attachEvent("onresize",m);else{var _=c(p);if(!_)throw new Error("Element is not detectable by this strategy.");_.contentDocument.defaultView.addEventListener("resize",m)}}function s(p){var h=t.important?" !important; ":"; ";return(p.join(h)+h).trim()}function l(p,h,m){m||(m=h,h=p,p=null),p=p||{},p.debug;function _(y,E){var T=s(["display: block","position: absolute","top: 0","left: 0","width: 100%","height: 100%","border: none","padding: 0","margin: 0","opacity: 0","z-index: -1000","pointer-events: none"]),A=!1,b=window.getComputedStyle(y),R=y.offsetWidth,M=y.offsetHeight;i(y).startSize={width:R,height:M};function B(){function w(){if(b.position==="static"){y.style.setProperty("position","relative",p.important?"important":"");var ae=function(Q,X,x,P){function H(O){return O.replace(/[^-\d\.]/g,"")}var pe=x[P];pe!=="auto"&&H(pe)!=="0"&&(Q.warn("An element that is positioned static has style."+P+"="+pe+" which is ignored due to the static positioning. The element will need to be positioned relative, so the style."+P+" will be set to 0. Element: ",X),X.style.setProperty(P,"0",p.important?"important":""))};ae(r,y,b,"top"),ae(r,y,b,"right"),ae(r,y,b,"bottom"),ae(r,y,b,"left")}}function D(){A||w();function ae(X,x){if(!X.contentDocument){var P=i(X);P.checkForObjectDocumentTimeoutId&&window.clearTimeout(P.checkForObjectDocumentTimeoutId),P.checkForObjectDocumentTimeoutId=setTimeout(function(){P.checkForObjectDocumentTimeoutId=0,ae(X,x)},100);return}x(X.contentDocument)}var Q=this;ae(Q,function(x){E(y)})}b.position!==""&&(w(),A=!0);var U=document.createElement("object");U.style.cssText=T,U.tabIndex=-1,U.type="text/html",U.setAttribute("aria-hidden","true"),U.onload=D,e.isIE()||(U.data="about:blank"),i(y)&&(y.appendChild(U),i(y).object=U,e.isIE()&&(U.data="about:blank"))}n?n.add(B):B()}e.isIE(8)?m(h):_(h,m)}function c(p){return i(p).object}function d(p){if(i(p)){var h=c(p);h&&(e.isIE(8)?p.detachEvent("onresize",h.proxy):p.removeChild(h),i(p).checkForObjectDocumentTimeoutId&&window.clearTimeout(i(p).checkForObjectDocumentTimeoutId),delete i(p).object)}}return{makeDetectable:l,addListener:a,uninstall:d}},LA}var BA,uI;function YW(){if(uI)return BA;uI=1;var e=qB().forEach;return BA=function(t){t=t||{};var r=t.reporter,n=t.batchProcessor,i=t.stateHandler.getState;t.stateHandler.hasState;var a=t.idHandler;if(!n)throw new Error("Missing required dependency: batchProcessor");if(!r)throw new Error("Missing required dependency: reporter.");var s=h(),l="erd_scroll_detection_scrollbar_style",c="erd_scroll_detection_container";function d(B){m(B,l,c)}d(window.document);function p(B){var w=t.important?" !important; ":"; ";return(B.join(w)+w).trim()}function h(){var B=500,w=500,D=document.createElement("div");D.style.cssText=p(["position: absolute","width: "+B*2+"px","height: "+w*2+"px","visibility: hidden","margin: 0","padding: 0"]);var U=document.createElement("div");U.style.cssText=p(["position: absolute","width: "+B+"px","height: "+w+"px","overflow: scroll","visibility: none","top: "+-B*3+"px","left: "+-w*3+"px","visibility: hidden","margin: 0","padding: 0"]),U.appendChild(D),document.body.insertBefore(U,document.body.firstChild);var ae=B-U.clientWidth,Q=w-U.clientHeight;return document.body.removeChild(U),{width:ae,height:Q}}function m(B,w,D){function U(x,P){P=P||function(pe){B.head.appendChild(pe)};var H=B.createElement("style");return H.innerHTML=x,H.id=w,P(H),H}if(!B.getElementById(w)){var ae=D+"_animation",Q=D+"_animation_active",X=`/* Created by the element-resize-detector library. */
`;X+="."+D+" > div::-webkit-scrollbar { "+p(["display: none"])+` }

`,X+="."+Q+" { "+p(["-webkit-animation-duration: 0.1s","animation-duration: 0.1s","-webkit-animation-name: "+ae,"animation-name: "+ae])+` }
`,X+="@-webkit-keyframes "+ae+` { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }
`,X+="@keyframes "+ae+" { 0% { opacity: 1; } 50% { opacity: 0; } 100% { opacity: 1; } }",U(X)}}function _(B){B.className+=" "+c+"_animation_active"}function y(B,w,D){if(B.addEventListener)B.addEventListener(w,D);else if(B.attachEvent)B.attachEvent("on"+w,D);else return r.error("[scroll] Don't know how to add event listeners.")}function E(B,w,D){if(B.removeEventListener)B.removeEventListener(w,D);else if(B.detachEvent)B.detachEvent("on"+w,D);else return r.error("[scroll] Don't know how to remove event listeners.")}function T(B){return i(B).container.childNodes[0].childNodes[0].childNodes[0]}function A(B){return i(B).container.childNodes[0].childNodes[0].childNodes[1]}function b(B,w){var D=i(B).listeners;if(!D.push)throw new Error("Cannot add listener to an element that is not detectable.");i(B).listeners.push(w)}function R(B,w,D){D||(D=w,w=B,B=null),B=B||{};function U(){if(B.debug){var ge=Array.prototype.slice.call(arguments);if(ge.unshift(a.get(w),"Scroll: "),r.log.apply)r.log.apply(null,ge);else for(var nt=0;nt<ge.length;nt++)r.log(ge[nt])}}function ae(ge){function nt(Ce){var zt=Ce.getRootNode&&Ce.getRootNode().contains(Ce);return Ce===Ce.ownerDocument.body||Ce.ownerDocument.body.contains(Ce)||zt}return!nt(ge)||window.getComputedStyle(ge)===null}function Q(ge){var nt=i(ge).container.childNodes[0],Ce=window.getComputedStyle(nt);return!Ce.width||Ce.width.indexOf("px")===-1}function X(){var ge=window.getComputedStyle(w),nt={};return nt.position=ge.position,nt.width=w.offsetWidth,nt.height=w.offsetHeight,nt.top=ge.top,nt.right=ge.right,nt.bottom=ge.bottom,nt.left=ge.left,nt.widthCSS=ge.width,nt.heightCSS=ge.height,nt}function x(){var ge=X();i(w).startSize={width:ge.width,height:ge.height},U("Element start size",i(w).startSize)}function P(){i(w).listeners=[]}function H(){if(U("storeStyle invoked."),!i(w)){U("Aborting because element has been uninstalled");return}var ge=X();i(w).style=ge}function pe(ge,nt,Ce){i(ge).lastWidth=nt,i(ge).lastHeight=Ce}function O(ge){return T(ge).childNodes[0]}function F(){return 2*s.width+1}function z(){return 2*s.height+1}function re(ge){return ge+10+F()}function oe(ge){return ge+10+z()}function _e(ge){return ge*2+F()}function ye(ge){return ge*2+z()}function Ie(ge,nt,Ce){var zt=T(ge),jt=A(ge),_t=re(nt),Ot=oe(Ce),xt=_e(nt),Xt=ye(Ce);zt.scrollLeft=_t,zt.scrollTop=Ot,jt.scrollLeft=xt,jt.scrollTop=Xt}function Je(){var ge=i(w).container;if(!ge){ge=document.createElement("div"),ge.className=c,ge.style.cssText=p(["visibility: hidden","display: inline","width: 0px","height: 0px","z-index: -1","overflow: hidden","margin: 0","padding: 0"]),i(w).container=ge,_(ge),w.appendChild(ge);var nt=function(){i(w).onRendered&&i(w).onRendered()};y(ge,"animationstart",nt),i(w).onAnimationStart=nt}return ge}function We(){function ge(){var yr=i(w).style;if(yr.position==="static"){w.style.setProperty("position","relative",B.important?"important":"");var Yn=function(pi,ii,Wr,Cn){function Yi(to){return to.replace(/[^-\d\.]/g,"")}var Ma=Wr[Cn];Ma!=="auto"&&Yi(Ma)!=="0"&&(pi.warn("An element that is positioned static has style."+Cn+"="+Ma+" which is ignored due to the static positioning. The element will need to be positioned relative, so the style."+Cn+" will be set to 0. Element: ",ii),ii.style[Cn]=0)};Yn(r,w,yr,"top"),Yn(r,w,yr,"right"),Yn(r,w,yr,"bottom"),Yn(r,w,yr,"left")}}function nt(yr,Yn,pi,ii){return yr=yr?yr+"px":"0",Yn=Yn?Yn+"px":"0",pi=pi?pi+"px":"0",ii=ii?ii+"px":"0",["left: "+yr,"top: "+Yn,"right: "+ii,"bottom: "+pi]}if(U("Injecting elements"),!i(w)){U("Aborting because element has been uninstalled");return}ge();var Ce=i(w).container;Ce||(Ce=Je());var zt=s.width,jt=s.height,_t=p(["position: absolute","flex: none","overflow: hidden","z-index: -1","visibility: hidden","width: 100%","height: 100%","left: 0px","top: 0px"]),Ot=p(["position: absolute","flex: none","overflow: hidden","z-index: -1","visibility: hidden"].concat(nt(-(1+zt),-(1+jt),-jt,-zt))),xt=p(["position: absolute","flex: none","overflow: scroll","z-index: -1","visibility: hidden","width: 100%","height: 100%"]),Xt=p(["position: absolute","flex: none","overflow: scroll","z-index: -1","visibility: hidden","width: 100%","height: 100%"]),Or=p(["position: absolute","left: 0","top: 0"]),qr=p(["position: absolute","width: 200%","height: 200%"]),Tr=document.createElement("div"),zr=document.createElement("div"),V=document.createElement("div"),jr=document.createElement("div"),en=document.createElement("div"),Hn=document.createElement("div");Tr.dir="ltr",Tr.style.cssText=_t,Tr.className=c,zr.className=c,zr.style.cssText=Ot,V.style.cssText=xt,jr.style.cssText=Or,en.style.cssText=Xt,Hn.style.cssText=qr,V.appendChild(jr),en.appendChild(Hn),zr.appendChild(V),zr.appendChild(en),Tr.appendChild(zr),Ce.appendChild(Tr);function un(){var yr=i(w);yr&&yr.onExpand?yr.onExpand():U("Aborting expand scroll handler: element has been uninstalled")}function tn(){var yr=i(w);yr&&yr.onShrink?yr.onShrink():U("Aborting shrink scroll handler: element has been uninstalled")}y(V,"scroll",un),y(en,"scroll",tn),i(w).onExpandScroll=un,i(w).onShrinkScroll=tn}function Ct(){function ge(xt,Xt,Or){var qr=O(xt),Tr=re(Xt),zr=oe(Or);qr.style.setProperty("width",Tr+"px",B.important?"important":""),qr.style.setProperty("height",zr+"px",B.important?"important":"")}function nt(xt){var Xt=w.offsetWidth,Or=w.offsetHeight,qr=Xt!==i(w).lastWidth||Or!==i(w).lastHeight;U("Storing current size",Xt,Or),pe(w,Xt,Or),n.add(0,function(){if(qr){if(!i(w)){U("Aborting because element has been uninstalled");return}if(!Ce()){U("Aborting because element container has not been initialized");return}if(B.debug){var zr=w.offsetWidth,V=w.offsetHeight;(zr!==Xt||V!==Or)&&r.warn(a.get(w),"Scroll: Size changed before updating detector elements.")}ge(w,Xt,Or)}}),n.add(1,function(){if(!i(w)){U("Aborting because element has been uninstalled");return}if(!Ce()){U("Aborting because element container has not been initialized");return}Ie(w,Xt,Or)}),qr&&xt&&n.add(2,function(){if(!i(w)){U("Aborting because element has been uninstalled");return}if(!Ce()){U("Aborting because element container has not been initialized");return}xt()})}function Ce(){return!!i(w).container}function zt(){function xt(){return i(w).lastNotifiedWidth===void 0}U("notifyListenersIfNeeded invoked");var Xt=i(w);if(xt()&&Xt.lastWidth===Xt.startSize.width&&Xt.lastHeight===Xt.startSize.height)return U("Not notifying: Size is the same as the start size, and there has been no notification yet.");if(Xt.lastWidth===Xt.lastNotifiedWidth&&Xt.lastHeight===Xt.lastNotifiedHeight)return U("Not notifying: Size already notified");U("Current size not notified, notifying..."),Xt.lastNotifiedWidth=Xt.lastWidth,Xt.lastNotifiedHeight=Xt.lastHeight,e(i(w).listeners,function(Or){Or(w)})}function jt(){if(U("startanimation triggered."),Q(w)){U("Ignoring since element is still unrendered...");return}U("Element rendered.");var xt=T(w),Xt=A(w);(xt.scrollLeft===0||xt.scrollTop===0||Xt.scrollLeft===0||Xt.scrollTop===0)&&(U("Scrollbars out of sync. Updating detector elements..."),nt(zt))}function _t(){if(U("Scroll detected."),Q(w)){U("Scroll event fired while unrendered. Ignoring...");return}nt(zt)}if(U("registerListenersAndPositionElements invoked."),!i(w)){U("Aborting because element has been uninstalled");return}i(w).onRendered=jt,i(w).onExpand=_t,i(w).onShrink=_t;var Ot=i(w).style;ge(w,Ot.width,Ot.height)}function Ve(){if(U("finalizeDomMutation invoked."),!i(w)){U("Aborting because element has been uninstalled");return}var ge=i(w).style;pe(w,ge.width,ge.height),Ie(w,ge.width,ge.height)}function yt(){D(w)}function Ue(){U("Installing..."),P(),x(),n.add(0,H),n.add(1,We),n.add(2,Ct),n.add(3,Ve),n.add(4,yt)}U("Making detectable..."),ae(w)?(U("Element is detached"),Je(),U("Waiting until element is attached..."),i(w).onRendered=function(){U("Element is now attached"),Ue()}):Ue()}function M(B){var w=i(B);w&&(w.onExpandScroll&&E(T(B),"scroll",w.onExpandScroll),w.onShrinkScroll&&E(A(B),"scroll",w.onShrinkScroll),w.onAnimationStart&&E(w.container,"animationstart",w.onAnimationStart),w.container&&B.removeChild(w.container))}return{makeDetectable:R,addListener:b,uninstall:M,initDocument:d}},BA}var FA,lI;function $W(){if(lI)return FA;lI=1;var e=qB().forEach,t=kW(),r=zW(),n=jW(),i=HW(),a=VW(),s=WB(),l=GW(),c=qW(),d=WW(),p=YW();function h(E){return Array.isArray(E)||E.length!==void 0}function m(E){if(Array.isArray(E))return E;var T=[];return e(E,function(A){T.push(A)}),T}function _(E){return E&&E.nodeType===1}FA=function(E){E=E||{};var T;if(E.idHandler)T={get:function(F){return E.idHandler.get(F,!0)},set:E.idHandler.set};else{var A=n(),b=i({idGenerator:A,stateHandler:c});T=b}var R=E.reporter;if(!R){var M=R===!1;R=a(M)}var B=y(E,"batchProcessor",l({reporter:R})),w={};w.callOnAdd=!!y(E,"callOnAdd",!0),w.debug=!!y(E,"debug",!1);var D=r(T),U=t({stateHandler:c}),ae,Q=y(E,"strategy","object"),X=y(E,"important",!1),x={reporter:R,batchProcessor:B,stateHandler:c,idHandler:T,important:X};if(Q==="scroll"&&(s.isLegacyOpera()?(R.warn("Scroll strategy is not supported on legacy Opera. Changing to object strategy."),Q="object"):s.isIE(9)&&(R.warn("Scroll strategy is not supported on IE9. Changing to object strategy."),Q="object")),Q==="scroll")ae=p(x);else if(Q==="object")ae=d(x);else throw new Error("Invalid strategy name: "+Q);var P={};function H(F,z,re){function oe(Ct){var Ve=D.get(Ct);e(Ve,function(Ue){Ue(Ct)})}function _e(Ct,Ve,yt){D.add(Ve,yt),Ct&&yt(Ve)}if(re||(re=z,z=F,F={}),!z)throw new Error("At least one element required.");if(!re)throw new Error("Listener required.");if(_(z))z=[z];else if(h(z))z=m(z);else return R.error("Invalid arguments. Must be a DOM element or a collection of DOM elements.");var ye=0,Ie=y(F,"callOnAdd",w.callOnAdd),Je=y(F,"onReady",function(){}),We=y(F,"debug",w.debug);e(z,function(Ve){c.getState(Ve)||(c.initState(Ve),T.set(Ve));var yt=T.get(Ve);if(We&&R.log("Attaching listener to element",yt,Ve),!U.isDetectable(Ve)){if(We&&R.log(yt,"Not detectable."),U.isBusy(Ve)){We&&R.log(yt,"System busy making it detectable"),_e(Ie,Ve,re),P[yt]=P[yt]||[],P[yt].push(function(){ye++,ye===z.length&&Je()});return}return We&&R.log(yt,"Making detectable..."),U.markBusy(Ve,!0),ae.makeDetectable({debug:We,important:X},Ve,function(ge){if(We&&R.log(yt,"onElementDetectable"),c.getState(ge)){U.markAsDetectable(ge),U.markBusy(ge,!1),ae.addListener(ge,oe),_e(Ie,ge,re);var nt=c.getState(ge);if(nt&&nt.startSize){var Ce=ge.offsetWidth,zt=ge.offsetHeight;(nt.startSize.width!==Ce||nt.startSize.height!==zt)&&oe(ge)}P[yt]&&e(P[yt],function(jt){jt()})}else We&&R.log(yt,"Element uninstalled before being detectable.");delete P[yt],ye++,ye===z.length&&Je()})}We&&R.log(yt,"Already detecable, adding listener."),_e(Ie,Ve,re),ye++}),ye===z.length&&Je()}function pe(F){if(!F)return R.error("At least one element is required.");if(_(F))F=[F];else if(h(F))F=m(F);else return R.error("Invalid arguments. Must be a DOM element or a collection of DOM elements.");e(F,function(z){D.removeAllListeners(z),ae.uninstall(z),c.cleanState(z)})}function O(F){ae.initDocument&&ae.initDocument(F)}return{listenTo:H,removeListener:D.removeListener,removeAllListeners:D.removeAllListeners,uninstall:pe,initDocument:O}};function y(E,T,A){var b=E[T];return b==null&&A!==void 0?A:b}return FA}var ZW=$W();const KW=Pr(ZW);let QW=class extends Oa.EventEmitter{get iconService(){return this.container.iconService}get fontService(){return this.container.fontService}get controlService(){return this.container.controlService}get configService(){return this.container.globalConfigService}get map(){return this.container.mapService}get coordinateSystemService(){return this.container.coordinateSystemService}get rendererService(){return this.container.rendererService}get layerService(){return this.container.layerService}get debugService(){return this.container.debugService}get cameraService(){return this.container.cameraService}get interactionService(){return this.container.interactionService}get pickingService(){return this.container.pickingService}get shaderModuleService(){return this.container.shaderModuleService}get markerService(){return this.container.markerService}get popupService(){return this.container.popupService}constructor(t){super(),L(this,"destroyed",!1),L(this,"loaded",!1),L(this,"id",void 0),L(this,"inited",!1),L(this,"rendering",!1),L(this,"$container",void 0),L(this,"canvas",void 0),L(this,"markerContainer",void 0),L(this,"resizeDetector",void 0),L(this,"hooks",void 0),L(this,"handleWindowResized",()=>{this.emit("resize"),this.$container&&(this.initContainer(),this.coordinateSystemService.needRefresh=!0,this.render())}),L(this,"handleMapCameraChanged",r=>{this.cameraService.update(r),this.render()}),this.container=t,this.hooks={init:new BW},this.id=t.id}init(t){var r=this;this.configService.setSceneConfig(this.id,t),this.shaderModuleService.registerBuiltinModules(),this.iconService.init(),this.iconService.on("imageUpdate",()=>this.render()),this.fontService.init(),this.hooks.init.tapPromise("initMap",Ze(function*(){r.debugService.log("map.mapInitStart",{type:r.map.version}),yield new Promise(n=>{r.map.onCameraChanged(i=>{r.cameraService.init(),r.cameraService.update(i),n()}),r.map.init()}),r.map.onCameraChanged(r.handleMapCameraChanged),r.map.addMarkerContainer(),r.markerService.addMarkers(),r.markerService.addMarkerLayers(),r.popupService.initPopup(),r.interactionService.init(),r.interactionService.on(ia.Drag,r.addSceneEvent.bind(r))})),this.hooks.init.tapPromise("initRenderer",Ze(function*(){var n;const i=((n=r.map)===null||n===void 0?void 0:n.getOverlayContainer())||void 0;if(i?r.$container=i:r.$container=pW(r.configService.getSceneConfig(r.id).id||""),r.$container){const{canvas:s}=t;if(r.canvas=s||ba("canvas","",r.$container),r.setCanvas(),yield r.rendererService.init(r.canvas,r.configService.getSceneConfig(r.id),t.gl),r.registerContextLost(),r.initContainer(),r.resizeDetector=KW({strategy:"scroll"}),r.resizeDetector.listenTo(r.$container,r.handleWindowResized),window.matchMedia){var a;(a=window.matchMedia("screen and (-webkit-min-device-pixel-ratio: 1.5)"))===null||a===void 0||a.addListener(r.handleWindowResized.bind("screen"))}}else console.error("容器 id 不存在");r.pickingService.init(r.id)})),this.render()}registerContextLost(){const t=this.rendererService.getCanvas();t&&t.addEventListener("webglcontextlost",()=>this.emit("webglcontextlost"))}addLayer(t){this.layerService.sceneService=this,this.layerService.add(t)}addMask(t){this.layerService.sceneService=this,this.layerService.addMask(t)}render(){var t=this;return Ze(function*(){t.rendering||t.destroyed||(t.rendering=!0,t.inited?(yield t.layerService.initLayers(),yield t.layerService.renderLayers()):(yield t.hooks.init.promise(),t.destroyed&&t.destroy(),yield t.layerService.initLayers(),t.layerService.renderLayers(),t.controlService.addControls(),t.loaded=!0,t.emit("loaded"),t.inited=!0),t.rendering=!1)})()}addFontFace(t,r){this.fontService.addFontFace(t,r)}getSceneContainer(){return this.$container}exportPng(t){var r=this;return Ze(function*(){var n;const i=(n=r.$container)===null||n===void 0?void 0:n.getElementsByTagName("canvas")[0];return yield r.render(),t==="jpg"?i?.toDataURL("image/jpeg"):i?.toDataURL("image/png")})()}getSceneConfig(){return this.configService.getSceneConfig(this.id)}getPointSizeRange(){return this.rendererService.getPointSizeRange()}addMarkerContainer(){const t=this.$container.parentElement;t!==null&&(this.markerContainer=ba("div","l7-marker-container",t))}getMarkerContainer(){return this.markerContainer}destroy(){var t;if(!this.inited){this.destroyed=!0;return}this.resizeDetector.removeListener(this.$container,this.handleWindowResized),this.pickingService.destroy(),this.layerService.destroy(),this.interactionService.destroy(),this.controlService.destroy(),this.markerService.destroy(),this.fontService.destroy(),this.iconService.destroy(),this.removeAllListeners(),this.inited=!1,this.map.destroy(),setTimeout(()=>{var r;(r=this.$container)===null||r===void 0||r.removeChild(this.canvas),this.canvas=null,this.rendererService.destroy()}),(t=this.$container)===null||t===void 0||(t=t.parentNode)===null||t===void 0||t.removeChild(this.$container),this.emit("destroy")}initContainer(){var t,r;const n=na,i=((t=this.$container)===null||t===void 0?void 0:t.clientWidth)||400,a=((r=this.$container)===null||r===void 0?void 0:r.clientHeight)||300,s=this.canvas;s&&(s.width=i*n,s.height=a*n),this.rendererService.viewport({x:0,y:0,width:n*i,height:n*a})}setCanvas(){var t,r;const n=na,i=((t=this.$container)===null||t===void 0?void 0:t.clientWidth)||400,a=((r=this.$container)===null||r===void 0?void 0:r.clientHeight)||300,s=this.canvas;s.width=i*n,s.height=a*n,s.style.width="100%",s.style.height="100%"}addSceneEvent(t){this.emit(t.type,t)}};const{uniq:JW}=yn,cI="#define PI 3.14159265359",eY=`#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2


float calc_lighting(vec4 pos) {

    vec3 worldPos = vec3(pos * u_ModelMatrix);

    vec3 worldNormal = a_Normal;
      // //cal light weight
    vec3 viewDir = normalize(u_CameraPosition - worldPos);

    vec3 lightDir = normalize(vec3(1, -10.5, 12));

    vec3 halfDir = normalize(viewDir+lightDir);
      // //lambert
    float lambert = dot(worldNormal, lightDir);
        //specular
    float specular = pow(max(0.0, dot(worldNormal, halfDir)), 32.0);
        //sum to light weight
    float lightWeight = ambientRatio + diffuseRatio * lambert + specularRatio * specular;

    return lightWeight;
}
`,tY=`#define SHIFT_RIGHT17 1.0 / 131072.0
#define SHIFT_RIGHT18 1.0 / 262144.0
#define SHIFT_RIGHT19 1.0 / 524288.0
#define SHIFT_RIGHT20 1.0 / 1048576.0
#define SHIFT_RIGHT21 1.0 / 2097152.0
#define SHIFT_RIGHT22 1.0 / 4194304.0
#define SHIFT_RIGHT23 1.0 / 8388608.0
#define SHIFT_RIGHT24 1.0 / 16777216.0

#define SHIFT_LEFT17 131072.0
#define SHIFT_LEFT18 262144.0
#define SHIFT_LEFT19 524288.0
#define SHIFT_LEFT20 1048576.0
#define SHIFT_LEFT21 2097152.0
#define SHIFT_LEFT22 4194304.0
#define SHIFT_LEFT23 8388608.0
#define SHIFT_LEFT24 16777216.0

vec2 unpack_float(float packedValue) {
  int packedIntValue = int(packedValue);
  int v0 = packedIntValue / 256;
  return vec2(v0, packedIntValue - v0 * 256);
}

vec4 decode_color(vec2 encodedColor) {
  return vec4(
    unpack_float(encodedColor[0]) / 255.0,
    unpack_float(encodedColor[1]) / 255.0
  );
}
`,rY=`// Blinn-Phong model
// apply lighting in vertex shader instead of fragment shader
// @see https://learnopengl.com/Advanced-Lighting/Advanced-Lighting
uniform float u_Ambient : 1.0;
uniform float u_Diffuse : 1.0;
uniform float u_Specular : 1.0;
uniform int u_NumOfDirectionalLights : 1;
uniform int u_NumOfSpotLights : 0;

#define SHININESS 32.0
#define MAX_NUM_OF_DIRECTIONAL_LIGHTS 3
#define MAX_NUM_OF_SPOT_LIGHTS 3

struct DirectionalLight {
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
};

struct SpotLight {
  vec3 position;
  vec3 direction;
  vec3 ambient;
  vec3 diffuse;
  vec3 specular;
  float constant;
  float linear;
  float quadratic;
  float angle;
  float blur;
  float exponent;
};

uniform DirectionalLight u_DirectionalLights[MAX_NUM_OF_DIRECTIONAL_LIGHTS];
uniform SpotLight u_SpotLights[MAX_NUM_OF_SPOT_LIGHTS];

vec3 calc_directional_light(DirectionalLight light, vec3 normal, vec3 viewDir) {
  vec3 lightDir = normalize(light.direction);
  // diffuse shading
  float diff = max(dot(normal, lightDir), 0.0);
  // Blinn-Phong specular shading
  vec3 halfwayDir = normalize(lightDir + viewDir);
  float spec = pow(max(dot(normal, halfwayDir), 0.0), SHININESS);

  vec3 ambient = light.ambient * u_Ambient;
  vec3 diffuse = light.diffuse * diff * u_Diffuse;
  vec3 specular = light.specular * spec * u_Specular;

  return ambient + diffuse + specular;
}


vec3 calc_lighting(vec3 position, vec3 normal, vec3 viewDir) {
  vec3 weight = vec3(0.0);
  for (int i = 0; i < MAX_NUM_OF_DIRECTIONAL_LIGHTS; i++) {
    if (i >= u_NumOfDirectionalLights) {
      break;
    }
    weight += calc_directional_light(u_DirectionalLights[i], normal, viewDir);
  }
  return weight;
}
`,nY=`
in vec4 v_PickingResult;

#pragma include "picking_uniforms"

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

#define HIGHLIGHT 1.0
#define SELECT 2.0

/*
 * Returns highlight color if this item is selected.
 */
vec4 filterHighlightColor(vec4 color, float weight) {
  float activeType = v_PickingResult.a;
  if(activeType > 0.0) {
    vec4 highLightColor =  activeType > 1.5 ? u_SelectColor : u_HighlightColor;
    highLightColor = highLightColor * COLOR_SCALE;
    float highLightAlpha = highLightColor.a;
    float highLightRatio = highLightAlpha / (highLightAlpha + color.a * (1.0 - highLightAlpha));
    vec3 resultRGB = mix(color.rgb, highLightColor.rgb, highLightRatio);
    return vec4(mix(resultRGB * weight, color.rgb, u_activeMix), color.a);
  }
  else {
    return color;
  }

  
}

/*
 * Returns picking color if picking enabled else unmodified argument.
 */
vec4 filterPickingColor(vec4 color) {
  vec3 pickingColor = v_PickingResult.rgb;
  if (u_PickingStage == PICKING_ENCODE && length(pickingColor) < 0.001) {
    discard;
  }
  return u_PickingStage == PICKING_ENCODE ? vec4(pickingColor, step(0.001,color.a)): color;
}

/*
 * Returns picking color if picking is enabled if not
 * highlight color if this item is selected, otherwise unmodified argument.
 */
vec4 filterColor(vec4 color) {
  // 过滤多余的 shader 计算
  // return color;
  if(u_shaderPick < 0.5) {
    return color; // 暂时去除 直接取消计算在选中时拖拽地图会有问题
  } else {
    return filterPickingColor(filterHighlightColor(color, 1.0));
  }
  
}

vec4 filterColorAlpha(vec4 color, float alpha) {
  // 过滤多余的 shader 计算
  // return color;
  if(u_shaderPick < 0.5) {
    return color; // 暂时去除 直接取消计算在选中时拖拽地图会有问题
  } else {
    return filterPickingColor(filterHighlightColor(color, alpha));
  }
}

`,iY=`layout(location = ATTRIBUTE_LOCATION_PICKING_COLOR) in vec3 a_PickingColor;
out vec4 v_PickingResult;

#pragma include "picking_uniforms"

#define PICKING_NONE 0.0
#define PICKING_ENCODE 1.0
#define PICKING_HIGHLIGHT 2.0
#define COLOR_SCALE 1. / 255.

#define NORMAL 0.0
#define HIGHLIGHT 1.0
#define SELECT 2.0

bool isVertexPicked(vec3 vertexColor) {
  return distance(vertexColor,u_PickingColor.rgb) < 0.01;
}

// 判断当前点是否已经被 select 选中
bool isVertexSelected(vec3 vertexColor) {
  return distance(vertexColor,u_CurrentSelectedId.rgb) < 0.01;
}

void setPickingColor(vec3 pickingColor) {
  if(u_shaderPick < 0.5) {
    return;
  }
  // compares only in highlight stage

  if(u_PickingStage == PICKING_HIGHLIGHT) {
    if(isVertexPicked(pickingColor)) {
       v_PickingResult = vec4(pickingColor.rgb * COLOR_SCALE,HIGHLIGHT);
       return;
    }
    if(isVertexSelected(pickingColor)) {
     v_PickingResult = vec4(u_CurrentSelectedId.rgb * COLOR_SCALE,SELECT);
      return;
    }

  } else {
      v_PickingResult= vec4(pickingColor.rgb * COLOR_SCALE,NORMAL);
      return;
  }

  // // v_PickingResult.a = float((u_PickingStage == PICKING_HIGHLIGHT) && (isVertexPicked(pickingColor) || isVertexPicked(u_CurrentSelectedId)));

  // // Stores the picking color so that the fragment shader can render it during picking
  // v_PickingResult.rgb = pickingColor * COLOR_SCALE;
}

float setPickingSize(float x) {
   return u_PickingStage == PICKING_ENCODE ? x + u_PickingBuffer : x;
}

float setPickingOrder(float z) {
   bool selected = bool(v_PickingResult.a);
   return selected ? z + 1. : 0.;
}
`,fI=`layout(std140) uniform PickingUniforms {
  vec4 u_HighlightColor;
  vec4 u_SelectColor;
  vec3 u_PickingColor;
  float u_PickingStage;
  vec3 u_CurrentSelectedId;
  float u_PickingThreshold;
  float u_PickingBuffer;
  float u_shaderPick;
  float u_activeMix;
};`,aY=`
#define E 2.718281828459045
vec2 ProjectFlat(vec2 lnglat){
  float maxs=85.0511287798;
  float lat=max(min(maxs,lnglat.y),-maxs);
  float scale= 268435456.;
  float d=PI/180.;
  float x=lnglat.x*d;
  float y=lat*d;
  y=log(tan((PI/4.)+(y/2.)));

  float a=.5/PI,
  b=.5,
  c=-.5/PI;
  d=.5;
  x=scale*(a*x+b);
  y=scale*(c*y+d);
  return vec2(x,y);
}

vec2 unProjectFlat(vec2 px){
  float a=.5/PI;
  float b=.5;
  float c=-.5/PI;
  float d=.5;
  float scale = 268435456.;
  float x=(px.x/scale-b)/a;
  float y=(px.y/scale-d)/c;
  y=(atan(pow(E,y))-(PI/4.))*2.;
  d=PI/180.;
  float lat=y/d;
  float lng=x/d;
  return vec2(lng,lat);
}

float pixelDistance(vec2 from, vec2 to) {
 vec2 a1 = ProjectFlat(from);
 vec2 b1 = ProjectFlat(to);
 return distance(a1, b1);
}

// gaode2.0
vec2 customProject(vec2 lnglat) { // 经纬度 => 平面坐标
  float t = lnglat.x;
  float e = lnglat.y;
  float Sm = 180.0 / PI;
  float Tm = 6378137.0;
  float Rm = PI / 180.0;
  float r = 85.0511287798;
  e = max(min(r, e), -r);
  t *= Rm;
  e *= Rm;
  e = log(tan(PI / 4.0 + e / 2.0));
  return vec2(t * Tm, e * Tm);
}

vec2 unProjCustomCoord(vec2 point) { // 平面坐标 => 经纬度
  float Sm = 57.29577951308232; //180 / Math.PI
  float Tm = 6378137.0;
  float t = point.x;
  float e = point.y;
  return vec2(t / Tm * Sm, (2.0 * atan(exp(e / Tm)) - PI / 2.0) * Sm);
}


float customPixelDistance(vec2 from, vec2 to) {
 vec2 a1 = ProjectFlat(from);
 vec2 b1 = ProjectFlat(to);
 return distance(a1, b1);
}`,dI=`#define TILE_SIZE (512.0)
#define PI (3.1415926536)
#define WORLD_SCALE (TILE_SIZE / (PI * 2.0))
#define EARTH_CIRCUMFERENCE (40.03e6)

#define COORDINATE_SYSTEM_LNGLAT (1.0) // mapbox
#define COORDINATE_SYSTEM_LNGLAT_OFFSET (2.0) // mapbox offset
#define COORDINATE_SYSTEM_VECTOR_TILE (3.0)
#define COORDINATE_SYSTEM_IDENTITY (4.0)
#define COORDINATE_SYSTEM_METER_OFFSET (5.0)

#pragma include "scene_uniforms"

const vec2 ZERO_64_XY_LOW = vec2(0.0, 0.0);

// web mercator coords -> world coords
vec2 project_mercator(vec2 lnglat) {
  float x = lnglat.x;
  return vec2(radians(x) + PI, PI - log(tan(PI * 0.25 + radians(lnglat.y) * 0.5)));
}

float project_scale(float meters) {
  return meters * u_PixelsPerMeter.z;
}

// offset coords -> world coords
vec4 project_offset(vec4 offset) {
  float dy = offset.y;
  dy = clamp(dy, -1.0, 1.0);
  vec3 pixels_per_unit = u_PixelsPerDegree + u_PixelsPerDegree2 * dy;
  return vec4(offset.xyz * pixels_per_unit, offset.w);
}

vec3 project_normal(vec3 normal) {
  vec4 normal_modelspace = u_ModelMatrix * vec4(normal, 0.0);
  return normalize(normal_modelspace.xyz * u_PixelsPerMeter);
}

vec3 project_offset_normal(vec3 vector) {
  if (
    u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 &&
      u_CoordinateSystem > COORDINATE_SYSTEM_LNGLAT - 0.01 ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // normals generated by the polygon tesselator are in lnglat offsets instead of meters
    return normalize(vector * u_PixelsPerDegree);
  }
  return project_normal(vector);
}

vec4 project_position(vec4 position, vec2 position64xyLow) {
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float X = position.x - u_ViewportCenter.x;
    float Y = position.y - u_ViewportCenter.y;
    return project_offset(
      vec4(X + position64xyLow.x, Y + position64xyLow.y, position.z, position.w)
    );
  }
  if (
    u_CoordinateSystem < COORDINATE_SYSTEM_LNGLAT + 0.01 &&
    u_CoordinateSystem > COORDINATE_SYSTEM_LNGLAT - 0.01
  ) {
    return vec4(
      project_mercator(position.xy) * WORLD_SCALE * u_ZoomScale,
      project_scale(position.z),
      position.w
    );
  }

  return position;
}

vec4 project_position(vec4 position) {
  return project_position(position, ZERO_64_XY_LOW);
}

vec2 project_pixel_size_to_clipspace(vec2 pixels) {
  vec2 offset = pixels / u_ViewportSize * u_DevicePixelRatio * 2.0;
  return offset * u_FocalDistance;
}

// 适配纹理贴图的等像素大小
float project_pixel_texture(float pixel) {
  // mapbox zoom > 12
  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    return pixel * pow(0.5, u_Zoom) * u_FocalDistance;
  }

  return pixel * 2.0 * u_FocalDistance;
}

// 在不论什么底图下需要统一处理的时候使用
float project_float_pixel(float pixel) {
  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // mapbox 坐标系下，为了和 Web 墨卡托坐标系统一，zoom 默认减1
    return pixel * pow(2.0, 19.0 - u_Zoom) * u_FocalDistance;
  }

  return pixel * u_FocalDistance;
}

// Project meter into the unit of pixel which used in the camera world space
float project_float_meter(float meter) {
  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // Since the zoom level uniform is updated by mapservice and it's alread been subtracted by 1
    // Not sure if we are supposed to do that again
    return meter;
  } else {
    return project_float_pixel(meter);
  }

  // TODO: change the following code to make adaptations for amap
  // return u_FocalDistance * TILE_SIZE * pow(2.0, u_Zoom) * meter / EARTH_CIRCUMFERENCE;

}

float project_pixel(float pixel) {
  return pixel * u_FocalDistance;
}

vec2 project_pixel(vec2 pixel) {
  return pixel * -1.0 * u_FocalDistance;
}

vec3 project_pixel(vec3 pixel) {
  return pixel * -1.0 * u_FocalDistance;
}

vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // Needs to be divided with project_uCommonUnitsPerMeter
    position.w *= u_PixelsPerMeter.z;
  }

  return viewProjectionMatrix * position + center;
}

// Projects from common space coordinates to clip space
vec4 project_common_position_to_clipspace(vec4 position) {
  return project_common_position_to_clipspace(
    position,
    u_ViewProjectionMatrix,
    u_ViewportCenterProjection
  );
}

vec4 unproject_clipspace_to_position(vec4 clipspacePos, mat4 u_InverseViewProjectionMatrix) {
  vec4 pos = u_InverseViewProjectionMatrix * (clipspacePos - u_ViewportCenterProjection);

  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_METER_OFFSET ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // Needs to be divided with project_uCommonUnitsPerMeter
    pos.w = pos.w / u_PixelsPerMeter.z;
  }
  return pos;
}

bool isEqual(float a, float b) {
  return a < b + 0.001 && a > b - 0.001;
}

`,oY=`vec2 rotate_matrix(vec2 v, float a) {
    float b = a / 180.0 * 3.1415926535897932384626433832795;
    float s = sin(b);
    float c = cos(b);
    mat2 m = mat2(c, s, -s, c);
    return m * v;
}`,hI=`layout(std140) uniform SceneUniforms {
  mat4 u_ViewMatrix;
  mat4 u_ProjectionMatrix;
  mat4 u_ViewProjectionMatrix;
  mat4 u_ModelMatrix;
  vec4 u_ViewportCenterProjection;
  vec3 u_PixelsPerDegree;
  float u_Zoom;
  vec3 u_PixelsPerDegree2;
  float u_ZoomScale;
  vec3 u_PixelsPerMeter;
  float u_CoordinateSystem;
  vec3 u_CameraPosition;
  float u_DevicePixelRatio;
  vec2 u_ViewportCenter;
  vec2 u_ViewportSize;
  float u_FocalDistance;
};
`,sY=`/**
 * 2D signed distance field functions
 * @see http://www.iquilezles.org/www/articles/distfunctions2d/distfunctions2d.htm
 */

float ndot(vec2 a, vec2 b ) { return a.x*b.x - a.y*b.y; }

float sdCircle(vec2 p, float r) {
  return length(p) - r;
}

float sdEquilateralTriangle(vec2 p) {
  float k = sqrt(3.0);
  p.x = abs(p.x) - 1.0;
  p.y = p.y + 1.0/k;
  if( p.x + k*p.y > 0.0 ) p = vec2(p.x-k*p.y,-k*p.x-p.y)/2.0;
  p.x -= clamp( p.x, -2.0, 0.0 );
  return -length(p)*sign(p.y);
}

float sdBox(vec2 p, vec2 b) {
  vec2 d = abs(p)-b;
  return length(max(d,vec2(0))) + min(max(d.x,d.y),0.0);
}

float sdPentagon(vec2 p, float r) {
  vec3 k = vec3(0.809016994,0.587785252,0.726542528);
  p.x = abs(p.x);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= vec2(clamp(p.x,-r*k.z,r*k.z),r);
  return length(p)*sign(p.y);
}

float sdHexagon(vec2 p, float r) {
  vec3 k = vec3(-0.866025404,0.5,0.577350269);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdOctogon(vec2 p, float r) {
  vec3 k = vec3(-0.9238795325, 0.3826834323, 0.4142135623 );
  p = abs(p);
  p -= 2.0*min(dot(vec2( k.x,k.y),p),0.0)*vec2( k.x,k.y);
  p -= 2.0*min(dot(vec2(-k.x,k.y),p),0.0)*vec2(-k.x,k.y);
  p -= vec2(clamp(p.x, -k.z*r, k.z*r), r);
  return length(p)*sign(p.y);
}

float sdHexagram(vec2 p, float r) {
  vec4 k=vec4(-0.5,0.8660254038,0.5773502692,1.7320508076);
  p = abs(p);
  p -= 2.0*min(dot(k.xy,p),0.0)*k.xy;
  p -= 2.0*min(dot(k.yx,p),0.0)*k.yx;
  p -= vec2(clamp(p.x,r*k.z,r*k.w),r);
  return length(p)*sign(p.y);
}

float sdRhombus(vec2 p, vec2 b) {
  vec2 q = abs(p);
  float h = clamp((-2.0*ndot(q,b)+ndot(b,b))/dot(b,b),-1.0,1.0);
  float d = length( q - 0.5*b*vec2(1.0-h,1.0+h) );
  return d * sign( q.x*b.y + q.y*b.x - b.x*b.y );
}

float sdVesica(vec2 p, float r, float d) {
  p = abs(p);
  float b = sqrt(r*r-d*d); // can delay this sqrt
  return ((p.y-b)*d>p.x*b)
          ? length(p-vec2(0.0,b))
          : length(p-vec2(-d,0.0))-r;
}
`,pI=/precision\s+(high|low|medium)p\s+float/,vI=`#ifdef GL_FRAGMENT_PRECISION_HIGH
 precision highp float;
 #else
 precision mediump float;
#endif
`,uY=/#pragma include (["^+"]?["[a-zA-Z_0-9](.*)"]*?)/g,lY=/void\s+main\s*\([^)]*\)\s*\{\n?/;class cY{constructor(){L(this,"moduleCache",{}),L(this,"rawContentCache",{})}registerBuiltinModules(){this.destroy(),this.registerModule("common",{vs:cI,fs:cI}),this.registerModule("decode",{vs:tY,fs:""}),this.registerModule("scene_uniforms",{vs:hI,fs:hI}),this.registerModule("picking_uniforms",{vs:fI,fs:fI}),this.registerModule("projection",{vs:dI,fs:dI}),this.registerModule("project",{vs:aY,fs:""}),this.registerModule("sdf_2d",{vs:"",fs:sY}),this.registerModule("lighting",{vs:rY,fs:""}),this.registerModule("light",{vs:eY,fs:""}),this.registerModule("picking",{vs:iY,fs:nY}),this.registerModule("rotation_2d",{vs:oY,fs:""})}registerModule(t,r){r.vs=r.vs.replace(/\r\n/g,`
`),r.fs=r.fs.replace(/\r\n/g,`
`);const{vs:n,fs:i,uniforms:a,defines:s,inject:l}=r,{content:c,uniforms:d}=TA(n),{content:p,uniforms:h}=TA(i);this.rawContentCache[t]={fs:p,defines:s,inject:l,uniforms:Ge(Ge(Ge({},d),h),a),vs:c}}getModule(t){let r=this.rawContentCache[t].vs,n=this.rawContentCache[t].fs;const{defines:i={},inject:a={}}=this.rawContentCache[t];let s={};a["vs:#decl"]&&(r=a["vs:#decl"]+r,s=TA(a["vs:#decl"]).uniforms),a["vs:#main-start"]&&(r=r.replace(lY,E=>E+a["vs:#main-start"])),a["fs:#decl"]&&(n=a["fs:#decl"]+n),r=fY(i)+r;const{content:c,includeList:d}=this.processModule(r,[],"vs"),{content:p,includeList:h}=this.processModule(n,[],"fs"),m=JW(d.concat(h).concat(t)).reduce((E,T)=>Ge(Ge({},E),this.rawContentCache[T].uniforms),Ge({},s)),_=(pI.test(p)?"":vI)+c,y=(pI.test(p)?"":vI)+p;return this.moduleCache[t]={vs:_.trim(),fs:y.trim(),uniforms:m},this.moduleCache[t]}destroy(){this.moduleCache={},this.rawContentCache={}}processModule(t,r,n){return{content:t.replace(uY,(a,s)=>{const c=s.split(" ")[0].replace(/"/g,"");if(r.indexOf(c)>-1)return"";const d=this.rawContentCache[c][n];r.push(c);const{content:p}=this.processModule(d,r,n);return p}),includeList:r}}}function fY(e){return Object.keys(e).reduce((r,n)=>r+`#define ${n.toUpperCase()} ${e[n]}
`,`
`)}class yR{constructor(){L(this,"shaderModuleService",void 0),L(this,"rendererService",void 0),L(this,"cameraService",void 0),L(this,"mapService",void 0),L(this,"interactionService",void 0),L(this,"layerService",void 0),L(this,"config",void 0)}getName(){return""}getType(){return Wv.Normal}init(t,r){this.config=r,this.rendererService=t.getContainer().rendererService,this.cameraService=t.getContainer().cameraService,this.mapService=t.getContainer().mapService,this.interactionService=t.getContainer().interactionService,this.layerService=t.getContainer().layerService,this.shaderModuleService=t.getContainer().shaderModuleService}render(t){}}class dY extends yR{getName(){return"clear"}init(t,r){super.init(t,r)}render(){this.rendererService.clear({color:[0,0,0,0],depth:1,framebuffer:null})}}class hY{constructor(t){L(this,"passes",[]),L(this,"layer",void 0),L(this,"renderFlag",void 0),L(this,"width",0),L(this,"height",0),this.postProcessor=t}setLayer(t){this.layer=t}setRenderFlag(t){this.renderFlag=t}getRenderFlag(){return this.renderFlag}getPostProcessor(){return this.postProcessor}render(){var t=this;return Ze(function*(){for(const r of t.passes)yield r.render(t.layer);yield t.postProcessor.render(t.layer)})()}resize(t,r){(this.width!==t||this.height!==r)&&(this.postProcessor.resize(t,r),this.width=t,this.height=r)}add(t,r){t.getType()===Wv.PostProcessing?this.postProcessor.add(t,this.layer,r):(t.init(this.layer,r),this.passes.push(t))}insert(t,r,n){t.init(this.layer,r),this.passes.splice(n,0,t)}destroy(){this.passes.length=0}}class pY extends yR{constructor(...t){var r;super(...t),r=this,L(this,"pickingFBO",void 0),L(this,"layer",void 0),L(this,"width",0),L(this,"height",0),L(this,"alreadyInRendering",!1),L(this,"pickFromPickingFBO",({x:n,y:i,lngLat:a,type:s})=>{if(!this.layer.isVisible()||!this.layer.needPick(s))return;const{getViewportSize:l,readPixelsAsync:c,useFramebuffer:d}=this.rendererService,{width:p,height:h}=l(),{enableHighlight:m,enableSelect:_}=this.layer.getLayerConfig(),y=n*na,E=i*na;if(y>p||y<0||E>h||E<0)return;let T;d(this.pickingFBO,Ze(function*(){var A;if(T=yield c({x:Math.round(y),y:Math.round(h-(i+1)*na),width:1,height:1,data:new Uint8Array(4),framebuffer:r.pickingFBO}),T[0]!==0||T[1]!==0||T[2]!==0){const b=Dc(T),R=r.layer.getSource().getFeatureById(b),M={x:n,y:i,type:s,lngLat:a,featureId:b,feature:R};R&&(r.layer.setCurrentPickId(b),r.triggerHoverOnLayer(M))}else{const b={x:n,y:i,lngLat:a,type:r.layer.getCurrentPickId()===null?"un"+s:"mouseout",featureId:null,feature:null};r.triggerHoverOnLayer(Ge(Ge({},b),{},{type:"unpick"})),r.triggerHoverOnLayer(b),r.layer.setCurrentPickId(null)}m&&r.highlightPickedFeature(T),_&&s==="click"&&((A=T)===null||A===void 0?void 0:A.toString())!==[0,0,0,0].toString()&&r.selectFeature(T)}))})}getType(){return Wv.Normal}getName(){return"pixelPicking"}init(t,r){super.init(t,r),this.layer=t;const{createTexture2D:n,createFramebuffer:i,getViewportSize:a}=this.rendererService,{width:s,height:l}=a(),c=n({width:s,height:l,wrapS:N.CLAMP_TO_EDGE,wrapT:N.CLAMP_TO_EDGE,label:"Picking Texture"});this.pickingFBO=i({color:c}),this.interactionService.on(ia.Hover,this.pickFromPickingFBO),this.interactionService.on(ia.Select,this.selectFeatureHandle.bind(this)),this.interactionService.on(ia.Active,this.highlightFeatureHandle.bind(this))}render(t){if(this.alreadyInRendering)return;const{getViewportSize:r,useFramebuffer:n,clear:i}=this.rendererService,{width:a,height:s}=r();this.alreadyInRendering=!0,(this.width!==a||this.height!==s)&&(this.pickingFBO.resize({width:a,height:s}),this.width=a,this.height=s),n(this.pickingFBO,()=>{i({framebuffer:this.pickingFBO,color:[0,0,0,0],stencil:0,depth:1});const l=this.layer.multiPassRenderer.getRenderFlag();this.layer.multiPassRenderer.setRenderFlag(!1),t.hooks.beforePickingEncode.call(),t.render(),t.hooks.afterPickingEncode.call(),this.layer.multiPassRenderer.setRenderFlag(l),this.alreadyInRendering=!1})}triggerHoverOnLayer(t){this.layer.emit(t.type,t)}highlightPickedFeature(t){const[r,n,i]=t;this.layer.hooks.beforeHighlight.call([r,n,i]),this.layerService.renderLayers()}selectFeature(t){const[r,n,i]=t;this.layer.hooks.beforeSelect.call([r,n,i]),this.layerService.renderLayers()}selectFeatureHandle({featureId:t}){const r=Hd(t);this.selectFeature(new Uint8Array(r))}highlightFeatureHandle({featureId:t}){const r=Hd(t);this.highlightPickedFeature(new Uint8Array(r))}}class vY{constructor(t){L(this,"passes",[]),L(this,"readFBO",void 0),L(this,"writeFBO",void 0),this.rendererService=t,this.init()}getReadFBO(){return this.readFBO}getWriteFBO(){return this.writeFBO}getCurrentFBOTex(){const{getViewportSize:t,createTexture2D:r}=this.rendererService,{width:n,height:i}=t();return r({x:0,y:0,width:n,height:i,copy:!0})}getReadFBOTex(){var t=this;const{useFramebuffer:r}=this.rendererService;return new Promise(n=>{r(this.readFBO,Ze(function*(){n(t.getCurrentFBOTex())}))})}renderBloomPass(t,r){var n=this;return Ze(function*(){const i=yield n.getReadFBOTex();let a=0;for(;a<4;)yield r.render(t,i),n.swap(),a++})()}render(t){var r=this;return Ze(function*(){for(let n=0;n<r.passes.length;n++){const i=r.passes[n];i.setRenderToScreen(r.isLastEnabledPass(n)),i.getName()==="bloom"?yield r.renderBloomPass(t,i):(yield i.render(t),n!==r.passes.length-1&&r.swap())}})()}resize(t,r){this.readFBO.resize({width:t,height:r}),this.writeFBO.resize({width:t,height:r})}add(t,r,n){t.init(r,n),this.passes.push(t)}insert(t,r,n,i){t.init(n,i),this.passes.splice(r,0,t)}getPostProcessingPassByName(t){return this.passes.find(r=>r.getName()===t)}init(){const{createFramebuffer:t,createTexture2D:r}=this.rendererService;this.readFBO=t({color:r({width:1,height:1,wrapS:N.CLAMP_TO_EDGE,wrapT:N.CLAMP_TO_EDGE,usage:Ov.RENDER_TARGET})}),this.writeFBO=t({color:r({width:1,height:1,wrapS:N.CLAMP_TO_EDGE,wrapT:N.CLAMP_TO_EDGE,usage:Ov.RENDER_TARGET})})}isLastEnabledPass(t){for(let r=t+1;r<this.passes.length;r++)if(this.passes[r].isEnabled())return!1;return!0}swap(){const t=this.readFBO;this.readFBO=this.writeFBO,this.writeFBO=t}}class mY extends yR{getType(){return Wv.Normal}getName(){return"render"}init(t,r){super.init(t,r)}render(t){const{useFramebuffer:r,clear:n}=this.rendererService,i=t.multiPassRenderer.getPostProcessor().getReadFBO();r(i,()=>{n({color:[0,0,0,0],depth:1,stencil:0,framebuffer:i}),t.multiPassRenderer.setRenderFlag(!1),t.models.forEach(a=>{a.draw({uniforms:t.layerModel.getUninforms()})}),t.multiPassRenderer.setRenderFlag(!0)})}}const _Y=`varying vec2 v_UV;

uniform float u_BloomFinal: 0.0;
uniform sampler2D u_Texture;
uniform sampler2D u_Texture2;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform float u_radius: 5.0;
uniform float u_intensity: 0.3;
uniform float u_baseRadio: 0.5;

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

float luminance(vec4 color) {
  return  0.2125 * color.r + 0.7154 * color.g + 0.0721 * color.b;
}

void main() {
  // vec4 baseColor = texture2D(u_Texture, v_UV);

  float r = sqrt(u_radius);

  vec4 c1 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(u_radius, 0.0));
  // c1 *= luminance(c1);
  vec4 c2 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(0.0, u_radius));
  // c2 *= luminance(c2);
  vec4 c3 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(r, r));
  // c3 *= luminance(c3);
  vec4 c4 = blur9(u_Texture, v_UV, u_ViewportSize, vec2(r, -r));
  // c4 *= luminance(c4);
  vec4 inbloomColor = (c1 + c2 + c3 + c4) * 0.25;

  // float lum = luminance(inbloomColor);
  // inbloomColor.rgb *= lum;

  if(u_BloomFinal > 0.0) {
    vec4 baseColor = texture2D(u_Texture2, v_UV);
    float baselum = luminance(baseColor);
    gl_FragColor = mix(inbloomColor, baseColor, u_baseRadio);
    if(baselum <= 0.2) {
      gl_FragColor = inbloomColor * u_intensity;
    }
  } else {
    gl_FragColor = inbloomColor;
  }
}`,gY=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,{isNil:UA}=yn;class yY extends cu{setupShaders(){this.shaderModuleService.registerModule("blur-pass",{vs:gY,fs:_Y});const{vs:t,fs:r,uniforms:n}=this.shaderModuleService.getModule("blur-pass"),{width:i,height:a}=this.rendererService.getViewportSize();return{vs:t,fs:r,uniforms:Ge(Ge({},n),{},{u_ViewportSize:[i,a]})}}convertOptionsToUniforms(t){const r={};return UA(t.bloomRadius)||(r.u_radius=t.bloomRadius),UA(t.bloomIntensity)||(r.u_intensity=t.bloomIntensity),UA(t.bloomBaseRadio)||(r.u_baseRadio=t.bloomBaseRadio),r}}const EY=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,TY=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,{isNil:SY}=yn;class AY extends cu{setupShaders(){this.shaderModuleService.registerModule("blur-pass",{vs:TY,fs:EY});const{vs:t,fs:r,uniforms:n}=this.shaderModuleService.getModule("blur-pass"),{width:i,height:a}=this.rendererService.getViewportSize();return{vs:t,fs:r,uniforms:Ge(Ge({},n),{},{u_ViewportSize:[i,a]})}}convertOptionsToUniforms(t){const r={};return SY(t.blurRadius)||(r.u_BlurDir=[t.blurRadius,0]),r}}const bY=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_BlurDir: [1.0, 0.0];

// https://github.com/Jam3/glsl-fast-gaussian-blur/blob/master/9.glsl
vec4 blur9(sampler2D image, vec2 uv, vec2 resolution, vec2 direction) {
  vec4 color = vec4(0.0);
  vec2 off1 = vec2(1.3846153846) * direction;
  vec2 off2 = vec2(3.2307692308) * direction;
  color += texture2D(image, uv) * 0.2270270270;
  color += texture2D(image, uv + (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv - (off1 / resolution)) * 0.3162162162;
  color += texture2D(image, uv + (off2 / resolution)) * 0.0702702703;
  color += texture2D(image, uv - (off2 / resolution)) * 0.0702702703;
  return color;
}

void main() {
  gl_FragColor = blur9(u_Texture, v_UV, u_ViewportSize, u_BlurDir);
}`,xY=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,{isNil:RY}=yn;class CY extends cu{setupShaders(){this.shaderModuleService.registerModule("blur-pass",{vs:xY,fs:bY});const{vs:t,fs:r,uniforms:n}=this.shaderModuleService.getModule("blur-pass"),{width:i,height:a}=this.rendererService.getViewportSize();return{vs:t,fs:r,uniforms:Ge(Ge({},n),{},{u_ViewportSize:[i,a]})}}convertOptionsToUniforms(t){const r={};return RY(t.blurRadius)||(r.u_BlurDir=[0,t.blurRadius]),r}}const OY=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Angle : 0;
uniform float u_Size : 8;

#pragma include "common"

float scale = PI / u_Size;

float pattern(float u_Angle, vec2 texSize, vec2 texCoord) {
  float s = sin(u_Angle), c = cos(u_Angle);
  vec2 tex = texCoord * texSize - u_Center * texSize;
  vec2 point = vec2(
    c * tex.x - s * tex.y,
    s * tex.x + c * tex.y
  ) * scale;
  return (sin(point.x) * sin(point.y)) * 4.0;
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/colorhalftone.js
vec4 colorHalftone_filterColor(vec4 color, vec2 texSize, vec2 texCoord) {
  vec3 cmy = 1.0 - color.rgb;
  float k = min(cmy.x, min(cmy.y, cmy.z));
  cmy = (cmy - k) / (1.0 - k);
  cmy = clamp(
    cmy * 10.0 - 3.0 + vec3(
      pattern(u_Angle + 0.26179, texSize, texCoord),
      pattern(u_Angle + 1.30899, texSize, texCoord),
      pattern(u_Angle, texSize, texCoord)
    ),
    0.0,
    1.0
  );
  k = clamp(k * 10.0 - 5.0 + pattern(u_Angle + 0.78539, texSize, texCoord), 0.0, 1.0);
  return vec4(1.0 - cmy - k, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = colorHalftone_filterColor(gl_FragColor, u_ViewportSize, v_UV);
}`,MY=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;class wY extends cu{setupShaders(){this.shaderModuleService.registerModule("colorhalftone-pass",{vs:MY,fs:OY});const{vs:t,fs:r,uniforms:n}=this.shaderModuleService.getModule("colorhalftone-pass"),{width:i,height:a}=this.rendererService.getViewportSize();return{vs:t,fs:r,uniforms:Ge(Ge({},n),{},{u_ViewportSize:[i,a]})}}}const NY=`varying vec2 v_UV;

uniform sampler2D u_Texture;

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
}`,IY=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;class PY extends cu{setupShaders(){return this.shaderModuleService.registerModule("copy-pass",{vs:IY,fs:NY}),this.shaderModuleService.getModule("copy-pass")}}const DY=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform vec2 u_Center : [0.5, 0.5];
uniform float u_Scale : 10;

// https://github.com/evanw/glfx.js/blob/master/src/filters/fun/hexagonalpixelate.js
vec4 hexagonalPixelate_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 tex = (texCoord * texSize - u_Center * texSize) / u_Scale;
  tex.y /= 0.866025404;
  tex.x -= tex.y * 0.5;
  vec2 a;
  if (tex.x + tex.y - floor(tex.x) - floor(tex.y) < 1.0) {
    a = vec2(floor(tex.x), floor(tex.y));
  }
  else a = vec2(ceil(tex.x), ceil(tex.y));
  vec2 b = vec2(ceil(tex.x), floor(tex.y));
  vec2 c = vec2(floor(tex.x), ceil(tex.y));
  vec3 TEX = vec3(tex.x, tex.y, 1.0 - tex.x - tex.y);
  vec3 A = vec3(a.x, a.y, 1.0 - a.x - a.y);
  vec3 B = vec3(b.x, b.y, 1.0 - b.x - b.y);
  vec3 C = vec3(c.x, c.y, 1.0 - c.x - c.y);
  float alen = length(TEX - A);
  float blen = length(TEX - B);
  float clen = length(TEX - C);
  vec2 choice;
  if (alen < blen) {
    if (alen < clen) choice = a;
    else choice = c;
  } else {
    if (blen < clen) choice = b;
    else choice = c;
  }
  choice.x += choice.y * 0.5;
  choice.y *= 0.866025404;
  choice *= u_Scale / texSize;
  return texture2D(texture, choice + u_Center);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = hexagonalPixelate_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,LY=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;class BY extends cu{setupShaders(){this.shaderModuleService.registerModule("hexagonalpixelate-pass",{vs:LY,fs:DY});const{vs:t,fs:r,uniforms:n}=this.shaderModuleService.getModule("hexagonalpixelate-pass"),{width:i,height:a}=this.rendererService.getViewportSize();return{vs:t,fs:r,uniforms:Ge(Ge({},n),{},{u_ViewportSize:[i,a]})}}}const FY=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform vec2 u_ViewportSize: [1.0, 1.0];
uniform float u_Strength : 0.6;

vec4 ink_sampleColor(sampler2D texture, vec2 texSize, vec2 texCoord) {
  vec2 dx = vec2(1.0 / texSize.x, 0.0);
  vec2 dy = vec2(0.0, 1.0 / texSize.y);
  vec4 color = texture2D(texture, texCoord);
  float bigTotal = 0.0;
  float smallTotal = 0.0;
  vec3 bigAverage = vec3(0.0);
  vec3 smallAverage = vec3(0.0);
  for (float x = -2.0; x <= 2.0; x += 1.0) {
    for (float y = -2.0; y <= 2.0; y += 1.0) {
      vec3 sample = texture2D(texture, texCoord + dx * x + dy * y).rgb;
      bigAverage += sample;
      bigTotal += 1.0;
      if (abs(x) + abs(y) < 2.0) {
        smallAverage += sample;
        smallTotal += 1.0;
      }
    }
  }
  vec3 edge = max(vec3(0.0), bigAverage / bigTotal - smallAverage / smallTotal);
  float power = u_Strength * u_Strength * u_Strength * u_Strength * u_Strength;
  return vec4(color.rgb - dot(edge, edge) * power * 100000.0, color.a);
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = ink_sampleColor(u_Texture, u_ViewportSize, v_UV);
}`,UY=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;class kY extends cu{setupShaders(){this.shaderModuleService.registerModule("ink-pass",{vs:UY,fs:FY});const{vs:t,fs:r,uniforms:n}=this.shaderModuleService.getModule("ink-pass"),{width:i,height:a}=this.rendererService.getViewportSize();return{vs:t,fs:r,uniforms:Ge(Ge({},n),{},{u_ViewportSize:[i,a]})}}}const zY=`varying vec2 v_UV;

uniform sampler2D u_Texture;
uniform float u_Amount : 0.5;

float rand(vec2 co) {
  return fract(sin(dot(co.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/noise.js
vec4 noise_filterColor(vec4 color, vec2 texCoord) {
  float diff = (rand(texCoord) - 0.5) * u_Amount;
  color.r += diff;
  color.g += diff;
  color.b += diff;
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = noise_filterColor(gl_FragColor, v_UV);
}`,jY=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`;class HY extends cu{setupShaders(){return this.shaderModuleService.registerModule("noise-pass",{vs:jY,fs:zY}),this.shaderModuleService.getModule("noise-pass")}}const VY=`attribute vec2 a_Position;

varying vec2 v_UV;

void main() {
  v_UV = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);
}`,XY=`varying vec2 v_UV;

uniform sampler2D u_Texture;

uniform float u_Amount : 0.5;

// https://github.com/evanw/glfx.js/blob/master/src/filters/adjust/sepia.js
vec4 sepia_filterColor(vec4 color) {
  float r = color.r;
  float g = color.g;
  float b = color.b;
  color.r =
    min(1.0, (r * (1.0 - (0.607 * u_Amount))) + (g * (0.769 * u_Amount)) + (b * (0.189 * u_Amount)));
  color.g = min(1.0, (r * 0.349 * u_Amount) + (g * (1.0 - (0.314 * u_Amount))) + (b * 0.168 * u_Amount));
  color.b = min(1.0, (r * 0.272 * u_Amount) + (g * 0.534 * u_Amount) + (b * (1.0 - (0.869 * u_Amount))));
  return color;
}

void main() {
  gl_FragColor = vec4(texture2D(u_Texture, v_UV));
  gl_FragColor = sepia_filterColor(gl_FragColor);
}`;class GY extends cu{setupShaders(){return this.shaderModuleService.registerModule("sepia-pass",{vs:VY,fs:XY}),this.shaderModuleService.getModule("sepia-pass")}}const YB=new iW;let qY=0;function WY(){const e=new cY,t=new uW,r=new $q,n=new sW(r),i=new Dq,a=new Bq,s=new Qq,l=new Jq,c=new Kq,d={id:`${qY++}`,globalConfigService:YB,shaderModuleService:e,debugService:t,cameraService:r,coordinateSystemService:n,fontService:i,iconService:a,markerService:s,popupService:l,controlService:c,customRenderService:{}},p=new gW(d);d.layerService=p;const h=new QW(d);d.sceneService=h;const m=new dW(d);d.interactionService=m;const _=new mW(d);d.pickingService=_;const y={clear:new dY,pixelPicking:new pY,render:new mY};d.normalPassFactory=T=>y[T];const E={copy:new PY,bloom:new yY,blurH:new AY,blurV:new CY,noise:new HY,sepia:new GY,colorHalftone:new wY,hexagonalPixelate:new BY,ink:new kY};return d.postProcessingPass=E,d.postProcessingPassFactory=T=>E[T],d}function yv(e){const t=Ge({},e);return t.postProcessor=new vY(t.rendererService),t.multiPassRenderer=new hY(t.postProcessor),t.styleAttributeService=new xW(t.rendererService),t}const F_=["loaded","fontloaded","maploaded","resize","destroy","dragstart","dragging","dragend","dragcancel"];let Ei=(function(e){return e.IMAGE="image",e.CUSTOMIMAGE="customImage",e.ARRAYBUFFER="arraybuffer",e.RGB="rgb",e.TERRAINRGB="terrainRGB",e.CUSTOMRGB="customRGB",e.CUSTOMARRAYBUFFER="customArrayBuffer",e.CUSTOMTERRAINRGB="customTerrainRGB",e})({});var $B=(e,t,r)=>new Promise((n,i)=>{var a=c=>{try{l(r.next(c))}catch(d){i(d)}},s=c=>{try{l(r.throw(c))}catch(d){i(d)}},l=c=>c.done?n(c.value):Promise.resolve(c.value).then(a,s);l((r=r.apply(e,t)).next())}),YY=(e,t,r,n)=>$B(void 0,null,function*(){return new Promise((i,a)=>{t({x:e.x,y:e.y,z:e.z},(s,l)=>{if(s||l.length===0){a(s);return}l&&Bb([{data:l,bands:[0]}],r,n,(c,d)=>{c?a(c):d&&i(d)})})})}),$Y=(e,t)=>$B(void 0,null,function*(){return new Promise((r,n)=>{t({x:e.x,y:e.y,z:e.z},(i,a)=>{if(i||!a){n(i);return}a instanceof ArrayBuffer?Q9(a,(s,l)=>{s&&n(s),r(l)}):a instanceof HTMLImageElement?r(a):n(i)})})});function ZY(e,t){return Array.isArray(e)?typeof e[0]=="string"?e.map(r=>Md(r,t)):e.map(r=>({url:Md(r.url,t),bands:r.bands||[0]})):Md(e,t)}function KY(e){return typeof e=="string"?[{url:e,bands:[0]}]:typeof e[0]=="string"?e.map(t=>({url:t,bands:[0]})):e}function mI(e,t){e.xhrCancel=()=>{t.map(r=>{r.abort()})}}var QY=Object.defineProperty,JY=Object.defineProperties,e$=Object.getOwnPropertyDescriptors,_I=Object.getOwnPropertySymbols,t$=Object.prototype.hasOwnProperty,r$=Object.prototype.propertyIsEnumerable,gI=(e,t,r)=>t in e?QY(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,yI=(e,t)=>{for(var r in t||(t={}))t$.call(t,r)&&gI(e,r,t[r]);if(_I)for(var r of _I(t))r$.call(t,r)&&gI(e,r,t[r]);return e},EI=(e,t)=>JY(e,e$(t)),ZB=(e,t,r)=>new Promise((n,i)=>{var a=c=>{try{l(r.next(c))}catch(d){i(d)}},s=c=>{try{l(r.throw(c))}catch(d){i(d)}},l=c=>c.done?n(c.value):Promise.resolve(c.value).then(a,s);l((r=r.apply(e,t)).next())}),n$=(e,t,r,n,i)=>ZB(void 0,null,function*(){const a=KY(t.url);if(a.length>1){const{rasterFiles:s,xhrList:l,errList:c}=yield i$(a,t);if(mI(e,l),c.length>0){r(c,null);return}Bb(s,n,i,r)}else{const s=Wx(t,(l,c)=>{if(l)r(l);else if(c){const d=[{data:c,bands:a[0].bands}];Bb(d,n,i,r)}});mI(e,[s])}});function i$(e,t){return ZB(this,null,function*(){const r=[],n=[],i=[];for(let a=0;a<e.length;a++){const s=e[a],l=EI(yI({},t),{url:s.url}),c=s.bands,{err:d,data:p,xhr:h}=yield $9(EI(yI({},l),{type:"arrayBuffer"}));d&&i.push(d),n.push(h),r.push({data:p,bands:c})}return{rasterFiles:r,xhrList:n,errList:i}})}var a$=Object.defineProperty,o$=Object.defineProperties,s$=Object.getOwnPropertyDescriptors,TI=Object.getOwnPropertySymbols,u$=Object.prototype.hasOwnProperty,l$=Object.prototype.propertyIsEnumerable,SI=(e,t,r)=>t in e?a$(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,c0=(e,t)=>{for(var r in t||(t={}))u$.call(t,r)&&SI(e,r,t[r]);if(TI)for(var r of TI(t))l$.call(t,r)&&SI(e,r,t[r]);return e},KB=(e,t)=>o$(e,s$(t)),QB=(e,t,r)=>new Promise((n,i)=>{var a=c=>{try{l(r.next(c))}catch(d){i(d)}},s=c=>{try{l(r.throw(c))}catch(d){i(d)}},l=c=>c.done?n(c.value):Promise.resolve(c.value).then(a,s);l((r=r.apply(e,t)).next())}),c$=(e,t,r,n)=>QB(void 0,null,function*(){const{format:i=JB,operation:a,requestParameters:s={}}=n,l=KB(c0({},s),{url:ZY(e,t)});return new Promise((c,d)=>{n$(r,l,(p,h)=>{p?d(p):h&&c(h)},i,a)})}),AI=(e,t,r,n)=>QB(void 0,null,function*(){let i;const a=Array.isArray(e)?e[0]:e;return n.wmtsOptions?i=(n?.getURLFromTemplate||SX)(a,c0(c0({},t),n.wmtsOptions)):i=(n?.getURLFromTemplate||Md)(a,t),new Promise((s,l)=>{var c;const d=xb(KB(c0({},n?.requestParameters),{url:i,type:((c=n?.requestParameters)==null?void 0:c.type)||"arrayBuffer"}),(p,h)=>{p?l(p):h&&s(h)},n.transformResponse);r.xhrCancel=()=>d.cancel()})}),JB=()=>({rasterData:new Uint8Array([0]),width:1,height:1}),f$=Object.defineProperty,d$=Object.defineProperties,h$=Object.getOwnPropertyDescriptors,bI=Object.getOwnPropertySymbols,p$=Object.prototype.hasOwnProperty,v$=Object.prototype.propertyIsEnumerable,xI=(e,t,r)=>t in e?f$(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,RI=(e,t)=>{for(var r in t||(t={}))p$.call(t,r)&&xI(e,r,t[r]);if(bI)for(var r of bI(t))v$.call(t,r)&&xI(e,r,t[r]);return e},m$=(e,t)=>d$(e,h$(t)),_$={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0,warp:!0};Ei.ARRAYBUFFER,Ei.RGB;function g$(e){return!!(Array.isArray(e)&&e.length===0||!Array.isArray(e)&&typeof e!="string")}function y$(e,t={}){if(g$(e))throw new Error("tile server url is error");const{extent:r=[1/0,1/0,-1/0,-1/0],coordinates:n}=t;let i=t?.dataType||Ei.IMAGE;i===Ei.RGB&&(i=Ei.ARRAYBUFFER);const a=(c,d)=>{switch(i){case Ei.IMAGE:return AI(e,c,d,t);case Ei.CUSTOMIMAGE:case Ei.CUSTOMTERRAINRGB:return $Y(d,t?.getCustomData);case Ei.ARRAYBUFFER:return c$(e,c,d,t);case Ei.CUSTOMARRAYBUFFER:case Ei.CUSTOMRGB:return YY(d,t?.getCustomData,t?.format||JB,t?.operation);default:return AI(e,c,d,t)}},s=m$(RI(RI({},_$),t),{getTileData:a}),l=ih(n,r);return{data:e,dataArray:[{_id:1,coordinates:l}],tilesetOptions:s,isTile:!0}}var E$=Object.defineProperty,T$=Object.defineProperties,S$=Object.getOwnPropertyDescriptors,X0=Object.getOwnPropertySymbols,e6=Object.prototype.hasOwnProperty,t6=Object.prototype.propertyIsEnumerable,CI=(e,t,r)=>t in e?E$(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,A$=(e,t)=>{for(var r in t||(t={}))e6.call(t,r)&&CI(e,r,t[r]);if(X0)for(var r of X0(t))t6.call(t,r)&&CI(e,r,t[r]);return e},b$=(e,t)=>T$(e,S$(t)),x$=(e,t)=>{var r={};for(var n in e)e6.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&X0)for(var n of X0(e))t.indexOf(n)<0&&t6.call(e,n)&&(r[n]=e[n]);return r};function R$(e,t){const r=t,{extent:n=[121.168,30.2828,121.384,30.4219],coordinates:i,width:a,height:s}=r,l=x$(r,["extent","coordinates","width","height"]);e.length<2&&console.warn("RGB解析需要2个波段的数据");const[c,d]=l.bands||[0,1],p=[e[c],e[d]],h=[];for(let y=0;y<p[0].length;y++)h.push((p[1][y]-p[0][y])/(p[1][y]+p[0][y]));const m=ih(i,n);return{_id:1,dataArray:[b$(A$({_id:1,data:h,width:a,height:s},l),{coordinates:m})]}}var C$=Object.defineProperty,O$=Object.defineProperties,M$=Object.getOwnPropertyDescriptors,G0=Object.getOwnPropertySymbols,r6=Object.prototype.hasOwnProperty,n6=Object.prototype.propertyIsEnumerable,OI=(e,t,r)=>t in e?C$(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,w$=(e,t)=>{for(var r in t||(t={}))r6.call(t,r)&&OI(e,r,t[r]);if(G0)for(var r of G0(t))n6.call(t,r)&&OI(e,r,t[r]);return e},N$=(e,t)=>O$(e,M$(t)),I$=(e,t)=>{var r={};for(var n in e)r6.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&G0)for(var n of G0(e))t.indexOf(n)<0&&n6.call(e,n)&&(r[n]=e[n]);return r};function P$(e,t){const r=t,{extent:n,coordinates:i,width:a,height:s}=r,l=I$(r,["extent","coordinates","width","height"]);e.length<3&&console.warn("RGB解析需要三个波段的数据");const[c,d,p]=l.bands||[0,1,2],h=[e[c],e[d],e[p]],m=[],[_,y]=l?.countCut||[2,98],E=l?.RMinMax||wd(h[0],_,y),T=l?.GMinMax||wd(h[1],_,y),A=l?.BMinMax||wd(h[2],_,y);for(let M=0;M<h[0].length;M++)m.push(Math.max(0,h[0][M]-E[0])),m.push(Math.max(0,h[1][M]-T[0])),m.push(Math.max(0,h[2][M]-A[0]));const b=ih(i,n);return{_id:1,dataArray:[N$(w$({_id:1,data:m,width:a,height:s,rMinMax:E,gMinMax:T,bMinMax:A},l),{coordinates:b})]}}var D$=Object.defineProperty,L$=Object.defineProperties,B$=Object.getOwnPropertyDescriptors,q0=Object.getOwnPropertySymbols,i6=Object.prototype.hasOwnProperty,a6=Object.prototype.propertyIsEnumerable,MI=(e,t,r)=>t in e?D$(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,F$=(e,t)=>{for(var r in t||(t={}))i6.call(t,r)&&MI(e,r,t[r]);if(q0)for(var r of q0(t))a6.call(t,r)&&MI(e,r,t[r]);return e},U$=(e,t)=>L$(e,B$(t)),k$=(e,t)=>{var r={};for(var n in e)i6.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&q0)for(var n of q0(e))t.indexOf(n)<0&&a6.call(e,n)&&(r[n]=e[n]);return r};function z$(e,t){const r=t,{extent:n,coordinates:i,min:a,max:s,width:l,height:c,format:d,operation:p}=r,h=k$(r,["extent","coordinates","min","max","width","height","format","operation"]);let m;if(d===void 0||yB(e))m=Array.from(e);else{const E=Array.isArray(e)?e:[e];m=hR(E,d,p)}const _=ih(i,n);return{_id:1,dataArray:[U$(F$({_id:1,data:m,width:l,height:c},h),{min:a,max:s,coordinates:_})]}}var j$=Object.defineProperty,H$=Object.defineProperties,V$=Object.getOwnPropertyDescriptors,wI=Object.getOwnPropertySymbols,X$=Object.prototype.hasOwnProperty,G$=Object.prototype.propertyIsEnumerable,NI=(e,t,r)=>t in e?j$(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,II=(e,t)=>{for(var r in t||(t={}))X$.call(t,r)&&NI(e,r,t[r]);if(wI)for(var r of wI(t))G$.call(t,r)&&NI(e,r,t[r]);return e},q$=(e,t)=>H$(e,V$(t)),W$=(e,t,r)=>new Promise((n,i)=>{var a=c=>{try{l(r.next(c))}catch(d){i(d)}},s=c=>{try{l(r.throw(c))}catch(d){i(d)}},l=c=>c.done?n(c.value):Promise.resolve(c.value).then(a,s);l((r=r.apply(e,t)).next())}),Y$={tileSize:256,minZoom:0,maxZoom:1/0,zoomOffset:0},$$=e=>W$(void 0,null,function*(){return new Promise(t=>{const[r,n,i,a]=e.bounds,s={layers:{testTile:{features:[{type:"Feature",properties:{key:e.x+"/"+e.y+"/"+e.z,x:(r+i)/2,y:(n+a)/2},geometry:{type:"LineString",coordinates:[[i,a],[i,n],[r,n],[r,n]]}}]}}};t(s)})});function Z$(e,t){const r=i=>$$(i),n=q$(II(II({},Y$),t),{getTileData:r});return{data:e,dataArray:[],tilesetOptions:n,isTile:!0}}var f0={exports:{}},K$=f0.exports,PI;function Q$(){return PI||(PI=1,(function(e,t){(function(r,n){e.exports=n()})(K$,(function(){function r(Q,X,x,P,H,pe){if(!(H-P<=x)){var O=P+H>>1;n(Q,X,O,P,H,pe%2),r(Q,X,x,P,O-1,pe+1),r(Q,X,x,O+1,H,pe+1)}}function n(Q,X,x,P,H,pe){for(;H>P;){if(H-P>600){var O=H-P+1,F=x-P+1,z=Math.log(O),re=.5*Math.exp(2*z/3),oe=.5*Math.sqrt(z*re*(O-re)/O)*(F-O/2<0?-1:1),_e=Math.max(P,Math.floor(x-F*re/O+oe)),ye=Math.min(H,Math.floor(x+(O-F)*re/O+oe));n(Q,X,x,_e,ye,pe)}var Ie=X[2*x+pe],Je=P,We=H;for(i(Q,X,P,x),X[2*H+pe]>Ie&&i(Q,X,P,H);Je<We;){for(i(Q,X,Je,We),Je++,We--;X[2*Je+pe]<Ie;)Je++;for(;X[2*We+pe]>Ie;)We--}X[2*P+pe]===Ie?i(Q,X,P,We):(We++,i(Q,X,We,H)),We<=x&&(P=We+1),x<=We&&(H=We-1)}}function i(Q,X,x,P){a(Q,x,P),a(X,2*x,2*P),a(X,2*x+1,2*P+1)}function a(Q,X,x){var P=Q[X];Q[X]=Q[x],Q[x]=P}function s(Q,X,x,P,H,pe,O){for(var F=[0,Q.length-1,0],z=[],re,oe;F.length;){var _e=F.pop(),ye=F.pop(),Ie=F.pop();if(ye-Ie<=O){for(var Je=Ie;Je<=ye;Je++)re=X[2*Je],oe=X[2*Je+1],re>=x&&re<=H&&oe>=P&&oe<=pe&&z.push(Q[Je]);continue}var We=Math.floor((Ie+ye)/2);re=X[2*We],oe=X[2*We+1],re>=x&&re<=H&&oe>=P&&oe<=pe&&z.push(Q[We]);var Ct=(_e+1)%2;(_e===0?x<=re:P<=oe)&&(F.push(Ie),F.push(We-1),F.push(Ct)),(_e===0?H>=re:pe>=oe)&&(F.push(We+1),F.push(ye),F.push(Ct))}return z}function l(Q,X,x,P,H,pe){for(var O=[0,Q.length-1,0],F=[],z=H*H;O.length;){var re=O.pop(),oe=O.pop(),_e=O.pop();if(oe-_e<=pe){for(var ye=_e;ye<=oe;ye++)c(X[2*ye],X[2*ye+1],x,P)<=z&&F.push(Q[ye]);continue}var Ie=Math.floor((_e+oe)/2),Je=X[2*Ie],We=X[2*Ie+1];c(Je,We,x,P)<=z&&F.push(Q[Ie]);var Ct=(re+1)%2;(re===0?x-H<=Je:P-H<=We)&&(O.push(_e),O.push(Ie-1),O.push(Ct)),(re===0?x+H>=Je:P+H>=We)&&(O.push(Ie+1),O.push(oe),O.push(Ct))}return F}function c(Q,X,x,P){var H=Q-x,pe=X-P;return H*H+pe*pe}var d=function(Q){return Q[0]},p=function(Q){return Q[1]},h=function(X,x,P,H,pe){x===void 0&&(x=d),P===void 0&&(P=p),H===void 0&&(H=64),pe===void 0&&(pe=Float64Array),this.nodeSize=H,this.points=X;for(var O=X.length<65536?Uint16Array:Uint32Array,F=this.ids=new O(X.length),z=this.coords=new pe(X.length*2),re=0;re<X.length;re++)F[re]=re,z[2*re]=x(X[re]),z[2*re+1]=P(X[re]);r(F,z,H,0,F.length-1,0)};h.prototype.range=function(X,x,P,H){return s(this.ids,this.coords,X,x,P,H,this.nodeSize)},h.prototype.within=function(X,x,P){return l(this.ids,this.coords,X,x,P,this.nodeSize)};var m={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:function(Q){return Q}},_=Math.fround||(function(Q){return(function(X){return Q[0]=+X,Q[0]})})(new Float32Array(1)),y=function(X){this.options=D(Object.create(m),X),this.trees=new Array(this.options.maxZoom+1)};y.prototype.load=function(X){var x=this.options,P=x.log,H=x.minZoom,pe=x.maxZoom,O=x.nodeSize;P&&console.time("total time");var F="prepare "+X.length+" points";P&&console.time(F),this.points=X;for(var z=[],re=0;re<X.length;re++)X[re].geometry&&z.push(T(X[re],re));this.trees[pe+1]=new h(z,U,ae,O,Float32Array),P&&console.timeEnd(F);for(var oe=pe;oe>=H;oe--){var _e=+Date.now();z=this._cluster(z,oe),this.trees[oe]=new h(z,U,ae,O,Float32Array),P&&console.log("z%d: %d clusters in %dms",oe,z.length,+Date.now()-_e)}return P&&console.timeEnd("total time"),this},y.prototype.getClusters=function(X,x){var P=((X[0]+180)%360+360)%360-180,H=Math.max(-90,Math.min(90,X[1])),pe=X[2]===180?180:((X[2]+180)%360+360)%360-180,O=Math.max(-90,Math.min(90,X[3]));if(X[2]-X[0]>=360)P=-180,pe=180;else if(P>pe){var F=this.getClusters([P,H,180,O],x),z=this.getClusters([-180,H,pe,O],x);return F.concat(z)}for(var re=this.trees[this._limitZoom(x)],oe=re.range(R(P),M(O),R(pe),M(H)),_e=[],ye=0,Ie=oe;ye<Ie.length;ye+=1){var Je=Ie[ye],We=re.points[Je];_e.push(We.numPoints?A(We):this.points[We.index])}return _e},y.prototype.getChildren=function(X){var x=this._getOriginId(X),P=this._getOriginZoom(X),H="No cluster with the specified id.",pe=this.trees[P];if(!pe)throw new Error(H);var O=pe.points[x];if(!O)throw new Error(H);for(var F=this.options.radius/(this.options.extent*Math.pow(2,P-1)),z=pe.within(O.x,O.y,F),re=[],oe=0,_e=z;oe<_e.length;oe+=1){var ye=_e[oe],Ie=pe.points[ye];Ie.parentId===X&&re.push(Ie.numPoints?A(Ie):this.points[Ie.index])}if(re.length===0)throw new Error(H);return re},y.prototype.getLeaves=function(X,x,P){x=x||10,P=P||0;var H=[];return this._appendLeaves(H,X,x,P,0),H},y.prototype.getTile=function(X,x,P){var H=this.trees[this._limitZoom(X)],pe=Math.pow(2,X),O=this.options,F=O.extent,z=O.radius,re=z/F,oe=(P-re)/pe,_e=(P+1+re)/pe,ye={features:[]};return this._addTileFeatures(H.range((x-re)/pe,oe,(x+1+re)/pe,_e),H.points,x,P,pe,ye),x===0&&this._addTileFeatures(H.range(1-re/pe,oe,1,_e),H.points,pe,P,pe,ye),x===pe-1&&this._addTileFeatures(H.range(0,oe,re/pe,_e),H.points,-1,P,pe,ye),ye.features.length?ye:null},y.prototype.getClusterExpansionZoom=function(X){for(var x=this._getOriginZoom(X)-1;x<=this.options.maxZoom;){var P=this.getChildren(X);if(x++,P.length!==1)break;X=P[0].properties.cluster_id}return x},y.prototype._appendLeaves=function(X,x,P,H,pe){for(var O=this.getChildren(x),F=0,z=O;F<z.length;F+=1){var re=z[F],oe=re.properties;if(oe&&oe.cluster?pe+oe.point_count<=H?pe+=oe.point_count:pe=this._appendLeaves(X,oe.cluster_id,P,H,pe):pe<H?pe++:X.push(re),X.length===P)break}return pe},y.prototype._addTileFeatures=function(X,x,P,H,pe,O){for(var F=0,z=X;F<z.length;F+=1){var re=z[F],oe=x[re],_e=oe.numPoints,ye=void 0,Ie=void 0,Je=void 0;if(_e)ye=b(oe),Ie=oe.x,Je=oe.y;else{var We=this.points[oe.index];ye=We.properties,Ie=R(We.geometry.coordinates[0]),Je=M(We.geometry.coordinates[1])}var Ct={type:1,geometry:[[Math.round(this.options.extent*(Ie*pe-P)),Math.round(this.options.extent*(Je*pe-H))]],tags:ye},Ve=void 0;_e?Ve=oe.id:this.options.generateId?Ve=oe.index:this.points[oe.index].id&&(Ve=this.points[oe.index].id),Ve!==void 0&&(Ct.id=Ve),O.features.push(Ct)}},y.prototype._limitZoom=function(X){return Math.max(this.options.minZoom,Math.min(Math.floor(+X),this.options.maxZoom+1))},y.prototype._cluster=function(X,x){for(var P=[],H=this.options,pe=H.radius,O=H.extent,F=H.reduce,z=H.minPoints,re=pe/(O*Math.pow(2,x)),oe=0;oe<X.length;oe++){var _e=X[oe];if(!(_e.zoom<=x)){_e.zoom=x;for(var ye=this.trees[x+1],Ie=ye.within(_e.x,_e.y,re),Je=_e.numPoints||1,We=Je,Ct=0,Ve=Ie;Ct<Ve.length;Ct+=1){var yt=Ve[Ct],Ue=ye.points[yt];Ue.zoom>x&&(We+=Ue.numPoints||1)}if(We>Je&&We>=z){for(var ge=_e.x*Je,nt=_e.y*Je,Ce=F&&Je>1?this._map(_e,!0):null,zt=(oe<<5)+(x+1)+this.points.length,jt=0,_t=Ie;jt<_t.length;jt+=1){var Ot=_t[jt],xt=ye.points[Ot];if(!(xt.zoom<=x)){xt.zoom=x;var Xt=xt.numPoints||1;ge+=xt.x*Xt,nt+=xt.y*Xt,xt.parentId=zt,F&&(Ce||(Ce=this._map(_e,!0)),F(Ce,this._map(xt)))}}_e.parentId=zt,P.push(E(ge/We,nt/We,zt,We,Ce))}else if(P.push(_e),We>1)for(var Or=0,qr=Ie;Or<qr.length;Or+=1){var Tr=qr[Or],zr=ye.points[Tr];zr.zoom<=x||(zr.zoom=x,P.push(zr))}}}return P},y.prototype._getOriginId=function(X){return X-this.points.length>>5},y.prototype._getOriginZoom=function(X){return(X-this.points.length)%32},y.prototype._map=function(X,x){if(X.numPoints)return x?D({},X.properties):X.properties;var P=this.points[X.index].properties,H=this.options.map(P);return x&&H===P?D({},H):H};function E(Q,X,x,P,H){return{x:_(Q),y:_(X),zoom:1/0,id:x,parentId:-1,numPoints:P,properties:H}}function T(Q,X){var x=Q.geometry.coordinates,P=x[0],H=x[1];return{x:_(R(P)),y:_(M(H)),zoom:1/0,index:X,parentId:-1}}function A(Q){return{type:"Feature",id:Q.id,properties:b(Q),geometry:{type:"Point",coordinates:[B(Q.x),w(Q.y)]}}}function b(Q){var X=Q.numPoints,x=X>=1e4?Math.round(X/1e3)+"k":X>=1e3?Math.round(X/100)/10+"k":X;return D(D({},Q.properties),{cluster:!0,cluster_id:Q.id,point_count:X,point_count_abbreviated:x})}function R(Q){return Q/360+.5}function M(Q){var X=Math.sin(Q*Math.PI/180),x=.5-.25*Math.log((1+X)/(1-X))/Math.PI;return x<0?0:x>1?1:x}function B(Q){return(Q-.5)*360}function w(Q){var X=(180-Q*360)*Math.PI/180;return 360*Math.atan(Math.exp(X))/Math.PI-90}function D(Q,X){for(var x in X)Q[x]=X[x];return Q}function U(Q){return Q.x}function ae(Q){return Q.y}return y}))})(f0)),f0.exports}var J$=Q$();const eZ=Pr(J$);var tZ=Object.defineProperty,DI=Object.getOwnPropertySymbols,rZ=Object.prototype.hasOwnProperty,nZ=Object.prototype.propertyIsEnumerable,LI=(e,t,r)=>t in e?tZ(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,o6=(e,t)=>{for(var r in t||(t={}))rZ.call(t,r)&&LI(e,r,t[r]);if(DI)for(var r of DI(t))nZ.call(t,r)&&LI(e,r,t[r]);return e};function s6(e,t){const{radius:r=40,maxZoom:n=18,minZoom:i=0,zoom:a=2}=t;if(e.pointIndex){const c=e.pointIndex.getClusters(e.extent,Math.floor(a));return e.dataArray=iZ(c),e}const s=new eZ({radius:r,minZoom:i,maxZoom:n}),l={features:[]};return l.features=e.dataArray.map(c=>({type:"Feature",geometry:{type:"Point",coordinates:c.coordinates},properties:o6({},c)})),s.load(l.features),s}function iZ(e){return e.map((t,r)=>o6({coordinates:t.geometry.coordinates,_id:r+1},t.properties))}function aZ(e){if(e.length===0)throw new Error("max requires at least one data point");let t=e[0];for(let r=1;r<e.length;r++)e[r]>t&&(t=e[r]);return t}function oZ(e){if(e.length===0)throw new Error("min requires at least one data point");let t=e[0];for(let r=1;r<e.length;r++)e[r]<t&&(t=e[r]);return t}function u6(e){if(e.length===0)return 0;let t=e[0],r=0,n;for(let i=1;i<e.length;i++)n=t+e[i]*1,Math.abs(t)>=Math.abs(e[i])?r+=t-n+e[i]:r+=e[i]-n+t,t=n;return t+r*1}function sZ(e){if(e.length===0)throw new Error("mean requires at least one data point");return u6(e)/e.length}var uZ={min:oZ,max:aZ,mean:sZ,sum:u6},lZ=Object.defineProperty,BI=Object.getOwnPropertySymbols,cZ=Object.prototype.hasOwnProperty,fZ=Object.prototype.propertyIsEnumerable,FI=(e,t,r)=>t in e?lZ(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,wp=(e,t)=>{for(var r in t||(t={}))cZ.call(t,r)&&FI(e,r,t[r]);if(BI)for(var r of BI(t))fZ.call(t,r)&&FI(e,r,t[r]);return e},UI=(e,t,r)=>new Promise((n,i)=>{var a=c=>{try{l(r.next(c))}catch(d){i(d)}},s=c=>{try{l(r.throw(c))}catch(d){i(d)}},l=c=>c.done?n(c.value):Promise.resolve(c.value).then(a,s);l((r=r.apply(e,t)).next())}),{cloneDeep:dZ,isFunction:kI,isString:hZ,mergeWith:pZ}=yn;function vZ(e,t){if(Array.isArray(t))return t}var mZ=class extends Oa.EventEmitter{constructor(e,t){super(),this.type="source",this.isTile=!1,this.inited=!1,this.hooks={init:new os},this.parser={type:"geojson"},this.transforms=[],this.cluster=!1,this.clusterOptions={enable:!1,radius:40,maxZoom:20,zoom:-99,method:"count"},this.invalidExtent=!1,this.dataArrayChanged=!1,this.cfg={autoRender:!0},this.originData=e,this.initCfg(t),this.init().then(()=>{this.inited=!0,this.emit("update",{type:"inited"})})}getSourceCfg(){return this.cfg}getClusters(e){return this.clusterIndex.getClusters(this.caculClusterExtent(2),e)}getClustersLeaves(e){return this.clusterIndex.getLeaves(e,1/0)}getParserType(){return this.parser.type}updateClusterData(e){const{method:t="sum",field:r}=this.clusterOptions;let n=this.clusterIndex.getClusters(this.caculClusterExtent(2),Math.floor(e));this.clusterOptions.zoom=e,n.forEach(i=>{i.id||(i.properties.point_count=1)}),(r||kI(t))&&(n=n.map(i=>{const a=i.id;if(a){const l=this.clusterIndex.getLeaves(a,1/0).map(d=>d.properties);let c;if(hZ(t)&&r){const d=RX(l,r);c=uZ[t](d)}kI(t)&&(c=t(l)),i.properties.stat=c}else i.properties.point_count=1;return i})),this.data=VC("geojson")({type:"FeatureCollection",features:n}),this.executeTrans()}getFeatureById(e){const{type:t="geojson",geometry:r}=this.parser;if(t==="geojson"&&!this.cluster){const n=e<this.originData.features.length?this.originData.features[e]:"null",i=dZ(n);if(i?.properties&&(this.transforms.length!==0||this.dataArrayChanged)){const a=this.data.dataArray.find(s=>s._id===e);i.properties=a}return i}else return t==="json"&&r?this.data.dataArray.find(n=>n._id===e):e<this.data.dataArray.length?this.data.dataArray[e]:"null"}updateFeaturePropertiesById(e,t){this.data.dataArray=this.data.dataArray.map(r=>r._id===e?wp(wp({},r),t):r),this.dataArrayChanged=!0,this.emit("update",{type:"update"})}getFeatureId(e,t){const r=this.data.dataArray.find(n=>n[e]===t);return r?._id}setData(e,t){this.originData=e,this.dataArrayChanged=!1,this.initCfg(t),this.init().then(()=>{this.emit("update",{type:"update"})})}reloadAllTile(){var e;(e=this.tileset)==null||e.reloadAll()}reloadTilebyId(e,t,r){var n;(n=this.tileset)==null||n.reloadTileById(e,t,r)}reloadTileByLnglat(e,t,r){var n;(n=this.tileset)==null||n.reloadTileByLnglat(e,t,r)}getTileExtent(e,t){var r;return(r=this.tileset)==null?void 0:r.getTileExtent(e,t)}getTileByZXY(e,t,r){var n;return(n=this.tileset)==null?void 0:n.getTileByZXY(e,t,r)}reloadTileByExtent(e,t){var r;(r=this.tileset)==null||r.reloadTileByExtent(e,t)}destroy(){var e;this.removeAllListeners(),this.originData=null,this.clusterIndex=null,this.data=null,(e=this.tileset)==null||e.destroy()}processData(){return UI(this,null,function*(){return new Promise((e,t)=>{try{this.excuteParser(),this.initCluster(),this.executeTrans(),e({})}catch(r){t(r)}})})}initCfg(e){this.cfg=pZ(this.cfg,e,vZ);const t=this.cfg;t&&(t.parser&&(this.parser=t.parser),t.transforms&&(this.transforms=t.transforms),this.cluster=t.cluster||!1,t.clusterOptions&&(this.cluster=!0,this.clusterOptions=wp(wp({},this.clusterOptions),t.clusterOptions)))}init(){return UI(this,null,function*(){this.inited=!1,yield this.processData(),this.inited=!0})}excuteParser(){const e=this.parser,t=e.type||"geojson",r=VC(t);this.data=r(this.originData,e),this.tileset=this.initTileset(),!e.cancelExtent&&(this.extent=kV(this.data.dataArray),this.setCenter(this.extent),this.invalidExtent=this.extent[0]===this.extent[2]||this.extent[1]===this.extent[3])}setCenter(e){this.center=[(e[0]+e[2])/2,(e[1]+e[3])/2],(isNaN(this.center[0])||isNaN(this.center[1]))&&(this.center=[108.92361111111111,34.54083333333333])}initTileset(){const{tilesetOptions:e}=this.data;return e?(this.isTile=!0,this.tileset?(this.tileset.updateOptions(e),this.tileset):new TX(wp({},e))):void 0}executeTrans(){this.transforms.forEach(t=>{const{type:r}=t,n=I9(r)(this.data,t);Object.assign(this.data,n)})}initCluster(){if(!this.cluster)return;const e=this.clusterOptions||{};this.clusterIndex=s6(this.data,e)}caculClusterExtent(e){let t=[[-1/0,-1/0],[1/0,1/0]];return this.invalidExtent||(t=cR(L0(this.extent),e)),t[0].concat(t[1])}};function _Z(e,t){const{callback:r}=t;return r&&(e.dataArray=e.dataArray.filter(r)),e}var ER=6378e3;function gZ(e,t){const r=e.dataArray,{size:n=10}=t,i=n/(2*Math.PI*ER)*(256<<20)/2,{gridHash:a,gridOffset:s}=yZ(r,n),l=AZ(a,s,t);return{yOffset:i,xOffset:i,radius:i,type:"grid",dataArray:l}}function yZ(e,t){let r=1/0,n=-1/0,i;for(const c of e)i=c.coordinates[1],Number.isFinite(i)&&(r=i<r?i:r,n=i>n?i:n);const a=(r+n)/2,s=EZ(t,a);if(s.xOffset<=0||s.yOffset<=0)return{gridHash:{},gridOffset:s};const l={};for(const c of e){const d=c.coordinates[1],p=c.coordinates[0];if(Number.isFinite(d)&&Number.isFinite(p)){const h=Math.floor((d+90)/s.yOffset),m=Math.floor((p+180)/s.xOffset),_=`${h}-${m}`;l[_]=l[_]||{count:0,points:[]},l[_].count+=1,l[_].points.push(c)}}return{gridHash:l,gridOffset:s}}function EZ(e,t){const r=TZ(e),n=SZ(t,e);return{yOffset:r,xOffset:n}}function TZ(e){return e/ER*(180/Math.PI)}function SZ(e,t){return t/ER*(180/Math.PI)/Math.cos(e*Math.PI/180)}function AZ(e,t,r){return Object.keys(e).reduce((n,i,a)=>{const s=i.split("-"),l=parseInt(s[0],10),c=parseInt(s[1],10),d={};if(r.field&&r.method){const p=hB(e[i].points,r.field);d[r.method]=dB[r.method](p)}return Object.assign(d,{_id:a,coordinates:Ya([-180+t.xOffset*(c+.5),-90+t.yOffset*(l+.5)]),rawData:e[i].points,count:e[i].count}),n.push(d),n},[])}var Td=Math.PI/3,bZ=[0,Td,2*Td,3*Td,4*Td,5*Td];function xZ(e){return e[0]}function RZ(e){return e[1]}function CZ(){var e=0,t=0,r=1,n=1,i=xZ,a=RZ,s,l,c;function d(h){var m={},_=[],y,E=h.length;for(y=0;y<E;++y)if(!(isNaN(A=+i.call(null,T=h[y],y,h))||isNaN(b=+a.call(null,T,y,h)))){var T,A,b,R=Math.round(b=b/c),M=Math.round(A=A/l-(R&1)/2),B=b-R;if(Math.abs(B)*3>1){var w=A-M,D=M+(A<M?-1:1)/2,U=R+(b<R?-1:1),ae=A-D,Q=b-U;w*w+B*B>ae*ae+Q*Q&&(M=D+(R&1?1:-1)/2,R=U)}var X=M+"-"+R,x=m[X];x?x.push(T):(_.push(x=m[X]=[T]),x.x=(M+(R&1)/2)*l,x.y=R*c)}return _}function p(h){var m=0,_=0;return bZ.map(function(y){var E=Math.sin(y)*h,T=-Math.cos(y)*h,A=E-m,b=T-_;return m=E,_=T,[A,b]})}return d.hexagon=function(h){return"m"+p(h==null?s:+h).join("l")+"z"},d.centers=function(){for(var h=[],m=Math.round(t/c),_=Math.round(e/l),y=m*c;y<n+s;y+=c,++m)for(var E=_*l+(m&1)*l/2;E<r+l/2;E+=l)h.push([E,y]);return h},d.mesh=function(){var h=p(s).slice(0,4).join("l");return d.centers().map(function(m){return"M"+m+"m"+h}).join("")},d.x=function(h){return arguments.length?(i=h,d):i},d.y=function(h){return arguments.length?(a=h,d):a},d.radius=function(h){return arguments.length?(s=+h,l=s*2*Math.sin(Td),c=s*1.5,d):s},d.size=function(h){return arguments.length?(e=t=0,r=+h[0],n=+h[1],d):[r-e,n-t]},d.extent=function(h){return arguments.length?(e=+h[0][0],t=+h[0][1],r=+h[1][0],n=+h[1][1],d):[[e,t],[r,n]]},d.radius(1)}var OZ=Object.defineProperty,MZ=Object.defineProperties,wZ=Object.getOwnPropertyDescriptors,zI=Object.getOwnPropertySymbols,NZ=Object.prototype.hasOwnProperty,IZ=Object.prototype.propertyIsEnumerable,jI=(e,t,r)=>t in e?OZ(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,PZ=(e,t)=>{for(var r in t||(t={}))NZ.call(t,r)&&jI(e,r,t[r]);if(zI)for(var r of zI(t))IZ.call(t,r)&&jI(e,r,t[r]);return e},DZ=(e,t)=>MZ(e,wZ(t)),LZ=6378e3;function BZ(e,t){const r=e.dataArray,{size:n=10,method:i="sum"}=t,a=n/(2*Math.PI*LZ)*(256<<20)/2,s=r.map(p=>{const[h,m]=Ya(p.coordinates);return DZ(PZ({},p),{coordinates:[h,m]})});return{dataArray:CZ().radius(a).x(p=>p.coordinates[0]).y(p=>p.coordinates[1])(s).map((p,h)=>{if(t.field&&i){const m=hB(p,t.field);p[i]=dB[i](m)}return{[t.method]:p[i],count:p.length,rawData:p,coordinates:[p.x,p.y],_id:h}}),radius:a,xOffset:a,yOffset:a,type:"hexagon"}}var FZ=Object.defineProperty,HI=Object.getOwnPropertySymbols,UZ=Object.prototype.hasOwnProperty,kZ=Object.prototype.propertyIsEnumerable,VI=(e,t,r)=>t in e?FZ(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,XI=(e,t)=>{for(var r in t||(t={}))UZ.call(t,r)&&VI(e,r,t[r]);if(HI)for(var r of HI(t))kZ.call(t,r)&&VI(e,r,t[r]);return e};function zZ(e,t){const{sourceField:r,targetField:n,data:i}=t,a={};return i.forEach(s=>{a[s[r]]=s}),e.dataArray=e.dataArray.map(s=>{const l=s[n];return XI(XI({},s),a[l])}),e}function jZ(e,t){const{callback:r}=t;return r&&(e.dataArray=e.dataArray.map(r)),e}var HZ=Object.defineProperty,VZ=Object.defineProperties,XZ=Object.getOwnPropertyDescriptors,GI=Object.getOwnPropertySymbols,GZ=Object.prototype.hasOwnProperty,qZ=Object.prototype.propertyIsEnumerable,qI=(e,t,r)=>t in e?HZ(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,WZ=(e,t)=>{for(var r in t||(t={}))GZ.call(t,r)&&qI(e,r,t[r]);if(GI)for(var r of GI(t))qZ.call(t,r)&&qI(e,r,t[r]);return e},YZ=(e,t)=>VZ(e,XZ(t));function $Z(e){let t=1/0,r=-1/0,n=1/0,i=-1/0;e.forEach(l=>{const c=l.coordinates;if(!c)return;const d=p=>{if(typeof p[0]=="number"&&typeof p[1]=="number"){const[h,m]=p;t=Math.min(t,h),r=Math.max(r,h),n=Math.min(n,m),i=Math.max(i,m)}else Array.isArray(p[0])&&p.forEach(d)};d(c)});const a=(t+r)/2,s=(n+i)/2;return[a,s]}function ZZ(e,t){const[r,n]=t;return e.map(i=>{if(!i.coordinates)return i;const a=s=>{if(typeof s[0]=="number"&&typeof s[1]=="number"){const l=Number((s[0]-r).toPrecision(15)),c=Number((s[1]-n).toPrecision(15));return[l,c,...s.slice(2)||[]]}else if(Array.isArray(s[0]))return s.map(a);return s};return YZ(WZ({},i),{coordinates:a(i.coordinates)})})}function KZ(e,t={}){const{enableRelativeCoordinates:r=!1,relativeOrigin:n}=t;if(!r)return{dataArray:e,relativeOrigin:[0,0],originalExtent:[0,0,0,0]};let i=1/0,a=-1/0,s=1/0,l=-1/0;e.forEach(h=>{const m=h.coordinates;if(!m)return;const _=y=>{if(typeof y[0]=="number"&&typeof y[1]=="number"){const[E,T]=y;i=Math.min(i,E),a=Math.max(a,E),s=Math.min(s,T),l=Math.max(l,T)}else Array.isArray(y[0])&&y.forEach(_)};_(m)});const c=[i,s,a,l],d=n||$Z(e);return{dataArray:ZZ(e,d),relativeOrigin:d,originalExtent:c}}Ca("rasterTile",y$);Ca("mvt",QG);Ca("geojsonvt",vG);Ca("testTile",Z$);Ca("geojson",HX);Ca("jsonTile",MG);Ca("image",bB);Ca("csv",IX);Ca("json",EB);Ca("raster",dq);Ca("rasterRgb",z$);Ca("rgb",P$);Ca("ndi",R$);rh("cluster",s6);rh("filter",_Z);rh("join",zZ);rh("map",jZ);rh("grid",gZ);rh("hexagon",BZ);var QZ=mZ;const{merge:fde}=yn;window._iconfont_svg_string_3580659='<svg><symbol id="l7-icon-area1" viewBox="0 0 1024 1024"><path d="M796.444444 56.888889a113.777778 113.777778 0 0 1 43.064889 219.136l38.798223 466.261333a113.777778 113.777778 0 1 1-133.518223 145.237334H279.210667a113.777778 113.777778 0 1 1-60.302223-137.272889L697.856 227.555556A113.777778 113.777778 0 0 1 796.444444 56.888889z m56.888889 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-682.666666 0a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m577.592889-534.072889L269.198222 796.444444c4.152889 7.168 7.509333 14.791111 10.012445 22.812445h465.578666a114.119111 114.119111 0 0 1 65.479111-71.224889l-38.798222-466.261333a112.924444 112.924444 0 0 1-23.210666-7.964445zM796.444444 125.155556a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-area" viewBox="0 0 1024 1024"><path d="M796.444444 56.888889a113.777778 113.777778 0 0 1 43.008 219.136l38.855112 466.261333a113.777778 113.777778 0 0 1-16.497778 224.540445L853.333333 967.111111a113.777778 113.777778 0 0 1-108.544-79.644444H279.210667a113.834667 113.834667 0 0 1-100.067556 79.36L170.666667 967.111111a113.777778 113.777778 0 0 1-17.066667-226.304l30.492444-351.175111a113.777778 113.777778 0 0 1 34.986667-218.680889L227.555556 170.666667a113.777778 113.777778 0 0 1 99.896888 59.221333l355.84-71.395556a113.777778 113.777778 0 0 1 104.675556-101.262222L796.444444 56.888889z m56.888889 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-682.666666 0a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m526.051555-582.314666L340.650667 296.903111a113.891556 113.891556 0 0 1-88.462223 98.645333l-30.947555 355.84c27.477333 13.653333 48.64 38.115556 58.026667 67.754667h465.521777a114.119111 114.119111 0 0 1 65.536-71.168l-38.855111-466.261333a113.948444 113.948444 0 0 1-74.752-56.206222zM227.555556 238.933333a45.511111 45.511111 0 1 0 0 91.022223 45.511111 45.511111 0 0 0 0-91.022223z m568.888888-113.777777a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-delete" viewBox="0 0 1024 1024"><path d="M705.422222 85.333333a34.133333 34.133333 0 0 1 34.133334 34.133334V227.555556h136.533333a34.133333 34.133333 0 0 1 0 68.266666h-25.543111l-24.348445 610.076445a34.133333 34.133333 0 0 1-34.133333 32.768H231.936a34.133333 34.133333 0 0 1-34.076444-32.768L173.340444 295.822222H147.911111a34.133333 34.133333 0 1 1 0-68.266666H284.444444V119.466667a34.133333 34.133333 0 0 1 34.133334-34.133334h386.844444zM241.720889 295.822222l22.983111 574.577778h494.535111l23.04-574.577778H241.720889zM671.288889 153.6H352.711111V227.555556h318.577778V153.6z"  ></path></symbol><symbol id="l7-icon-color" viewBox="0 0 1024 1024"><path d="M512 56.888889c9.841778 0 19.626667 0.341333 29.354667 0.910222 69.176889 4.437333 119.068444 62.577778 124.302222 131.072l0.455111 9.386667c0.739556 44.600889 15.303111 84.935111 44.999111 114.631111 27.022222 27.022222 62.805333 41.528889 102.570667 44.430222l12.060444 0.568889c72.476444 1.194667 135.793778 52.451556 140.458667 124.757333 1.137778 18.261333 1.251556 36.807111 0.170667 55.637334-13.198222 233.585778-211.399111 424.220444-445.326223 428.714666L512 967.111111a455.111111 455.111111 0 0 1-455.054222-464.156444c4.551111-233.927111 195.185778-432.128 428.771555-445.326223C494.535111 57.116444 503.296 56.888889 512 56.888889z m0 68.266667a385.706667 385.706667 0 0 0-22.414222 0.625777C291.726222 136.988444 129.080889 305.948444 125.155556 504.263111c-4.152889 212.366222 163.100444 387.185778 372.508444 394.353778l13.425778 0.227555 8.533333-0.113777c198.371556-3.811556 367.331556-166.456889 378.538667-364.373334a396.174222 396.174222 0 0 0-0.170667-47.331555c-1.991111-31.232-29.127111-56.604444-67.128889-60.472889l-8.248889-0.455111-14.051555-0.682667c-56.547556-4.209778-107.406222-25.884444-145.806222-64.284444-38.855111-38.798222-60.416-90.225778-64.284445-145.749334l-0.910222-21.333333c-2.901333-38.001778-28.785778-66.048-60.302222-68.096A433.891556 433.891556 0 0 0 512 125.155556zM438.044444 682.666667a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z m-170.666666-227.555556a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z m142.222222-227.555555a68.266667 68.266667 0 1 1 0 136.533333 68.266667 68.266667 0 0 1 0-136.533333z"  ></path></symbol><symbol id="l7-icon-base-map" viewBox="0 0 1024 1024"><path d="M923.761778 115.029333A34.133333 34.133333 0 0 1 967.111111 147.911111v624.128a34.133333 34.133333 0 0 1-22.186667 32.028445l-278.755555 103.992888a34.133333 34.133333 0 0 1-23.665778 0.056889L381.724444 812.714667a34.133333 34.133333 0 0 0-23.665777 0.113777L102.968889 908.060444a34.133333 34.133333 0 0 1-45.738667-26.965333L56.888889 876.088889V251.960889a34.133333 34.133333 0 0 1 22.186667-32.028445l278.755555-103.992888a34.133333 34.133333 0 0 1 20.992-0.967112l266.183111 72.988445a34.133333 34.133333 0 0 0 18.204445 0zM403.911111 192.625778v555.576889l216.177778 79.075555V251.960889l-216.177778-59.335111z m-68.266667 4.380444L125.155556 275.569778v551.310222l210.432-78.506667V197.006222zM898.844444 192.853333l-210.545777 58.936889v575.089778l210.545777-78.563556V192.853333z"  ></path></symbol><symbol id="l7-icon-dot" viewBox="0 0 1024 1024"><path d="M341.333333 739.555556a113.777778 113.777778 0 0 1 8.533334 227.271111L341.333333 967.111111a113.777778 113.777778 0 0 1-8.533333-227.271111L341.333333 739.555556z m0 68.266666a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM910.222222 341.333333a113.777778 113.777778 0 0 1 8.533334 227.271111L910.222222 568.888889a113.777778 113.777778 0 0 1-8.533333-227.271111L910.222222 341.333333z m0 68.266667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM227.555556 56.888889a113.777778 113.777778 0 0 1 8.533333 227.271111L227.555556 284.444444a113.777778 113.777778 0 0 1-8.533334-227.271111L227.555556 56.888889z m0 68.266667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-display" viewBox="0 0 1024 1024"><path d="M512 170.666667c284.444444 0 455.111111 227.555556 455.111111 341.333333s-170.666667 341.333333-455.111111 341.333333-455.111111-227.555556-455.111111-341.333333 170.666667-341.333333 455.111111-341.333333z m0 68.266666C303.729778 238.933333 125.155556 401.237333 125.155556 512c0 110.762667 178.574222 273.066667 386.844444 273.066667s386.844444-162.304 386.844444-273.066667c0-110.762667-178.574222-273.066667-386.844444-273.066667zM512 341.333333a170.666667 170.666667 0 1 1 0 341.333334 170.666667 170.666667 0 0 1 0-341.333334z m0 68.266667a102.4 102.4 0 1 0 0 204.8 102.4 102.4 0 0 0 0-204.8z"  ></path></symbol><symbol id="l7-icon-enlarge" viewBox="0 0 1024 1024"><path d="M546.133333 147.911111l-0.056889 329.955556H876.088889a34.133333 34.133333 0 0 1 0 68.266666H546.076444v329.955556a34.133333 34.133333 0 0 1-68.266666 0V546.133333H147.911111a34.133333 34.133333 0 1 1 0-68.266666h329.898667V147.911111a34.133333 34.133333 0 0 1 68.266666 0z"  ></path></symbol><symbol id="l7-icon-export-picture" viewBox="0 0 1024 1024"><path d="M883.873684 161.684211a32.336842 32.336842 0 0 1 32.336842 32.336842v582.063158a32.336842 32.336842 0 0 1-32.336842 32.336842H86.231579a32.336842 32.336842 0 0 1-32.336842-32.336842V194.021053a32.336842 32.336842 0 0 1 32.336842-32.336842h797.642105z m-32.336842 64.673684H118.568421v517.389473h170.792421a32.175158 32.175158 0 0 1 0.431158-0.646736l3.772632-4.473264 330.320842-330.374736a32.336842 32.336842 0 0 1 38.588631-5.389474l4.473263 3.018105 184.589474 147.725474V226.357895z m-202.428631 248.131368L379.850105 743.747368H851.536842v-107.304421l-202.428631-161.953684zM323.368421 323.368421a107.789474 107.789474 0 1 1 0 215.578947 107.789474 107.789474 0 0 1 0-215.578947z m0 64.673684a43.115789 43.115789 0 1 0 0 86.231579 43.115789 43.115789 0 0 0 0-86.231579z"  ></path></symbol><symbol id="l7-icon-exit-fullscreen" viewBox="0 0 1024 1024"><path d="M841.955556 591.644444a34.133333 34.133333 0 0 1 5.518222 67.811556l-5.518222 0.455111h-133.745778l192 192.056889a34.133333 34.133333 0 0 1-38.343111 55.182222l-5.176889-2.958222-4.721778-3.982222L659.911111 708.266667V841.955556a34.133333 34.133333 0 0 1-28.615111 33.678222L625.777778 876.088889a34.133333 34.133333 0 0 1-33.678222-28.615111L591.644444 841.955556V625.777778a34.133333 34.133333 0 0 1 28.615112-33.678222L625.777778 591.644444h216.177778z m-443.733334 0a34.133333 34.133333 0 0 1 33.678222 28.615112L432.355556 625.777778v216.177778a34.133333 34.133333 0 0 1-67.811556 5.518222L364.088889 841.955556v-133.745778l-192.056889 192a34.133333 34.133333 0 0 1-52.224-43.52l3.982222-4.721778L315.847111 659.911111H182.044444a34.133333 34.133333 0 0 1-33.678222-28.615111L147.911111 625.777778a34.133333 34.133333 0 0 1 28.615111-33.678222L182.044444 591.644444H398.222222zM167.310222 119.808l4.721778 3.982222L364.088889 315.847111V182.044444a34.133333 34.133333 0 0 1 28.615111-33.678222L398.222222 147.911111a34.133333 34.133333 0 0 1 33.678222 28.615111L432.355556 182.044444V398.222222a34.133333 34.133333 0 0 1-28.615112 33.678222L398.222222 432.355556H182.044444a34.133333 34.133333 0 0 1-5.518222-67.811556L182.044444 364.088889h133.802667L123.790222 172.032a34.133333 34.133333 0 0 1 43.52-52.224z m732.899556 3.982222a34.133333 34.133333 0 0 1 3.982222 43.52l-3.982222 4.721778L708.266667 364.088889H841.955556a34.133333 34.133333 0 0 1 33.678222 28.615111L876.088889 398.222222a34.133333 34.133333 0 0 1-28.615111 33.678222L841.955556 432.355556H625.777778a34.133333 34.133333 0 0 1-33.678222-28.615112L591.644444 398.222222V182.044444a34.133333 34.133333 0 0 1 67.811556-5.518222l0.455111 5.518222v133.802667l192.056889-192.056889a34.133333 34.133333 0 0 1 48.241778 0z"  ></path></symbol><symbol id="l7-icon-line" viewBox="0 0 1024 1024"><path d="M853.333333 56.888889a113.777778 113.777778 0 0 1 8.533334 227.271111L853.333333 284.444444c-19.000889 0-36.864-4.664889-52.622222-12.856888l-529.123555 529.066666a113.777778 113.777778 0 0 1-92.387556 166.115556L170.666667 967.111111a113.777778 113.777778 0 0 1-8.533334-227.271111L170.666667 739.555556c19.000889 0 36.864 4.664889 52.622222 12.856888l529.123555-529.066666a113.777778 113.777778 0 0 1 92.387556-166.115556L853.333333 56.888889zM170.666667 807.822222a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m682.666666-682.666666a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-layer" viewBox="0 0 1024 1024"><path d="M767.089778 625.777778l180.167111 82.773333a34.133333 34.133333 0 0 1 4.892444 59.278222l-4.892444 2.730667-420.977778 193.422222a34.133333 34.133333 0 0 1-22.983111 1.991111l-5.575111-1.991111-420.977778-193.422222a34.133333 34.133333 0 0 1-4.892444-59.278222l4.892444-2.730667L256.853333 625.777778l81.749334 37.546666L172.771556 739.555556 512 895.374222 851.171556 739.555556l-165.831112-76.231112 81.749334-37.546666z m0-227.555556l180.167111 82.773334a34.133333 34.133333 0 0 1 4.892444 59.278222l-4.892444 2.730666-420.977778 193.422223a34.133333 34.133333 0 0 1-22.983111 1.991111l-5.575111-1.991111-420.977778-193.422223a34.133333 34.133333 0 0 1-4.892444-59.278222l4.892444-2.730666L256.853333 398.222222l81.749334 37.546667-165.831111 76.174222L512 667.818667l339.171556-155.875556-165.831112-76.174222L767.089778 398.222222zM497.720889 60.017778a34.133333 34.133333 0 0 1 28.558222 0l420.977778 193.422222a34.133333 34.133333 0 0 1 0 62.008889l-420.977778 193.422222a34.133333 34.133333 0 0 1-28.558222 0l-420.977778-193.422222a34.133333 34.133333 0 0 1 0-62.008889zM512 128.568889L172.771556 284.387556 512 440.263111l339.171556-155.875555L512 128.568889z"  ></path></symbol><symbol id="l7-icon-narrow" viewBox="0 0 1024 1024"><path d="M910.222222 512a34.133333 34.133333 0 0 1-34.133333 34.133333H147.911111a34.133333 34.133333 0 1 1 0-68.266666h728.177778a34.133333 34.133333 0 0 1 34.133333 34.133333z"  ></path></symbol><symbol id="l7-icon-fullscreen" viewBox="0 0 1024 1024"><path d="M645.176889 597.674667l4.721778 3.982222L841.955556 793.6l0.056888-133.688889a34.133333 34.133333 0 0 1 28.615112-33.678222L876.088889 625.777778a34.133333 34.133333 0 0 1 33.678222 28.615111L910.222222 659.911111v216.177778a34.133333 34.133333 0 0 1-28.615111 33.678222L876.088889 910.222222h-216.177778a34.133333 34.133333 0 0 1-5.518222-67.811555l5.518222-0.455111h133.745778l-192-192.056889a34.133333 34.133333 0 0 1 43.52-52.224z m-222.833778 3.982222a34.133333 34.133333 0 0 1 3.982222 43.52l-3.982222 4.721778L230.286222 841.955556H364.088889a34.133333 34.133333 0 0 1 33.678222 28.615111L398.222222 876.088889a34.133333 34.133333 0 0 1-28.615111 33.678222L364.088889 910.222222H147.911111a34.133333 34.133333 0 0 1-33.678222-28.615111L113.777778 876.088889v-216.177778a34.133333 34.133333 0 0 1 67.811555-5.518222l0.455111 5.518222-0.056888 133.745778 192.113777-192a34.133333 34.133333 0 0 1 48.241778 0zM364.088889 113.777778a34.133333 34.133333 0 0 1 5.518222 67.811555L364.088889 182.044444H230.343111l192 192.056889a34.133333 34.133333 0 0 1-43.52 52.224l-4.721778-3.982222-192.113777-192.056889L182.044444 364.088889a34.133333 34.133333 0 0 1-28.615111 33.678222L147.911111 398.222222a34.133333 34.133333 0 0 1-33.678222-28.615111L113.777778 364.088889V147.911111a34.133333 34.133333 0 0 1 28.615111-33.678222L147.911111 113.777778h216.177778z m512 0a34.133333 34.133333 0 0 1 33.678222 28.615111L910.222222 147.911111v216.177778a34.133333 34.133333 0 0 1-67.811555 5.518222L841.955556 364.088889l-0.056889-133.745778-192 192a34.133333 34.133333 0 0 1-52.224-43.52l3.982222-4.721778L793.6 182.044444H659.911111a34.133333 34.133333 0 0 1-33.678222-28.615111L625.777778 147.911111a34.133333 34.133333 0 0 1 28.615111-33.678222L659.911111 113.777778h216.177778z"  ></path></symbol><symbol id="l7-icon-hide" viewBox="0 0 1024 1024"><path d="M875.52 87.836444a34.133333 34.133333 0 0 1 7.281778 43.121778l-3.527111 5.006222-682.666667 796.444445a34.133333 34.133333 0 0 1-55.409778-39.367111l3.527111-5.006222 97.166223-113.379556C123.164444 697.969778 56.888889 582.940444 56.888889 512c0-113.777778 170.666667-341.333333 455.111111-341.333333a496.64 496.64 0 0 1 208.952889 45.112889l106.439111-124.188445a34.133333 34.133333 0 0 1 48.128-3.754667z m-38.684444 202.524445C921.031111 362.951111 967.111111 452.835556 967.111111 512c0 113.777778-170.666667 341.333333-455.111111 341.333333-50.631111 0-97.678222-7.224889-140.8-19.740444l50.232889-58.595556A417.393778 417.393778 0 0 0 512 785.066667c208.270222 0 386.844444-162.304 386.844444-273.066667 0-52.849778-40.675556-117.418667-105.813333-170.496l43.804445-51.2zM512 238.933333C303.729778 238.933333 125.155556 401.237333 125.155556 512c0 66.787556 64.853333 152.291556 162.133333 209.692444L377.173333 616.675556a170.666667 170.666667 0 0 1 217.713778-253.895112l78.620445-91.704888A432.924444 432.924444 0 0 0 512 238.933333z m166.684444 236.088889a170.666667 170.666667 0 0 1-177.664 207.303111l177.607112-207.303111zM512 409.6a102.4 102.4 0 0 0-88.746667 153.486222L548.864 416.426667A102.172444 102.172444 0 0 0 512 409.6z"  ></path></symbol><symbol id="l7-icon-rectangle" viewBox="0 0 1024 1024"><path d="M170.666667 56.888889a113.777778 113.777778 0 0 1 108.544 79.644444H853.333333a34.133333 34.133333 0 0 1 33.678223 28.615111L887.466667 170.666667v574.122666a113.777778 113.777778 0 1 1-142.677334 142.734223L170.666667 887.466667a34.133333 34.133333 0 0 1-33.678223-28.615111L136.533333 853.333333V279.210667A113.777778 113.777778 0 0 1 170.666667 56.888889z m682.666666 750.933333a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z m-34.133333-603.022222H279.210667a114.062222 114.062222 0 0 1-74.353778 74.410667L204.8 819.2h539.989333a114.062222 114.062222 0 0 1 74.410667-74.410667V204.8zM170.666667 125.155556a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-ranging" viewBox="0 0 1024 1024"><path d="M723.171556 50.403556l250.424888 250.424888a31.061333 31.061333 0 0 1 0 43.918223L344.746667 973.596444a31.061333 31.061333 0 0 1-43.918223 0L50.403556 723.171556a31.061333 31.061333 0 0 1 0-43.918223L679.253333 50.403556a31.061333 31.061333 0 0 1 43.918223 0z m-21.959112 74.524444l-39.765333 39.822222 98.986667 98.872889a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-63.886222 63.886222 62.179556 62.122667a34.133333 34.133333 0 0 1-44.088889 51.882667L563.2 387.242667 501.077333 325.063111 437.191111 388.949333l98.986667 98.929778a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-63.886222 63.886222L387.242667 563.2a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.584-62.122667-62.179556-63.886222 63.886222 98.986667 98.929778a34.133333 34.133333 0 0 1-44.088889 51.882667l-4.209778-3.640889-98.929778-98.929778-39.765333 39.822222 197.802667 197.745778 576.284444-576.284444-197.802667-197.745778z"  ></path></symbol><symbol id="l7-icon-reposition" viewBox="0 0 1024 1024"><path d="M512 56.888889a34.133333 34.133333 0 0 1 34.133333 34.133333v24.177778A398.336 398.336 0 0 1 908.856889 477.866667h24.177778a34.133333 34.133333 0 0 1 0 68.266666h-24.177778A398.336 398.336 0 0 1 546.133333 908.856889L546.133333 932.977778a34.133333 34.133333 0 0 1-68.266666 0v-24.177778A398.336 398.336 0 0 1 115.2 546.133333L91.022222 546.133333a34.133333 34.133333 0 1 1 0-68.266666h24.177778A398.336 398.336 0 0 1 477.866667 115.2V91.022222A34.133333 34.133333 0 0 1 512 56.888889z m34.190222 126.862222L546.133333 193.422222a34.133333 34.133333 0 1 1-68.266666 0v-9.671111A330.069333 330.069333 0 0 0 183.751111 477.866667h9.671111a34.133333 34.133333 0 1 1 0 68.266666l-9.671111 0.056889A330.069333 330.069333 0 0 0 477.866667 840.248889V830.577778a34.133333 34.133333 0 0 1 68.266666 0l0.056889 9.671111A330.069333 330.069333 0 0 0 840.248889 546.133333L830.577778 546.133333a34.133333 34.133333 0 0 1 0-68.266666h9.671111A330.069333 330.069333 0 0 0 546.133333 183.751111zM512 341.333333a170.666667 170.666667 0 1 1 0 341.333334 170.666667 170.666667 0 0 1 0-341.333334z m0 68.266667a102.4 102.4 0 1 0 0 204.8 102.4 102.4 0 0 0 0-204.8z"  ></path></symbol><symbol id="l7-icon-round" viewBox="0 0 1024 1024"><path d="M512 56.888889a455.111111 455.111111 0 0 1 391.395556 687.502222 113.777778 113.777778 0 0 1-159.061334 158.890667A455.111111 455.111111 0 0 1 120.604444 279.608889 113.777778 113.777778 0 0 1 279.608889 120.604444 452.835556 452.835556 0 0 1 512 56.888889z m0 68.266667a384.910222 384.910222 0 0 0-191.715556 50.744888A113.777778 113.777778 0 0 1 175.957333 320.284444a386.844444 386.844444 0 0 0 527.815111 527.758223 113.777778 113.777778 0 0 1 144.270223-144.440889A386.844444 386.844444 0 0 0 512 125.155556z m299.406222 640.739555a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222zM212.593778 167.082667a45.511111 45.511111 0 1 0 0 91.022222 45.511111 45.511111 0 0 0 0-91.022222z"  ></path></symbol><symbol id="l7-icon-guanbi" viewBox="0 0 1024 1024"><path d="M576 512l277.333333 277.333333-64 64-277.333333-277.333333L234.666667 853.333333 170.666667 789.333333l277.333333-277.333333L170.666667 234.666667 234.666667 170.666667l277.333333 277.333333L789.333333 170.666667 853.333333 234.666667 576 512z"  ></path></symbol></svg>',(function(e){try{let d=function(){l||(l=!0,a())},p=function(){try{s.documentElement.doScroll("left")}catch{return void setTimeout(p,50)}d()};var r=(r=document.getElementsByTagName("script"))[r.length-1],t=r.getAttribute("data-injectcss"),r=r.getAttribute("data-disable-injectsvg");if(!r){var n,i,a,s,l,c=function(h,m){m.parentNode.insertBefore(h,m)};if(t&&!e.__iconfont__svg__cssinject__){e.__iconfont__svg__cssinject__=!0;try{document.write("<style>.svgfont {display: inline-block;width: 1em;height: 1em;fill: currentColor;vertical-align: -0.1em;font-size:16px;}</style>")}catch(h){console&&console.log(h)}}n=function(){var h,m=document.createElement("div");m.innerHTML=e._iconfont_svg_string_3580659,(m=m.getElementsByTagName("svg")[0])&&(m.setAttribute("aria-hidden","true"),m.style.position="absolute",m.style.width=0,m.style.height=0,m.style.overflow="hidden",m=m,(h=document.body).firstChild?c(m,h.firstChild):h.appendChild(m))},document.addEventListener?~["complete","loaded","interactive"].indexOf(document.readyState)?setTimeout(n,0):(i=function(){document.removeEventListener("DOMContentLoaded",i,!1),n()},document.addEventListener("DOMContentLoaded",i,!1)):document.attachEvent&&(a=n,s=e.document,l=!1,p(),s.onreadystatechange=function(){s.readyState=="complete"&&(s.onreadystatechange=null,d())})}}catch{}})(window);class Pv extends fR{constructor(t){super(),L(this,"controlOption",void 0),L(this,"container",void 0),L(this,"isShow",void 0),L(this,"sceneContainer",void 0),L(this,"scene",void 0),L(this,"mapsService",void 0),L(this,"renderService",void 0),L(this,"layerService",void 0),L(this,"controlService",void 0),L(this,"configService",void 0),Pv.controlCount++,this.controlOption=Ge(Ge({},this.getDefault(t)),t||{})}getOptions(){return this.controlOption}setOptions(t){const r=this.getDefault(t);Object.entries(t).forEach(([n,i])=>{i===void 0&&(t[n]=r[n])}),"position"in t&&this.setPosition(t.position),"className"in t&&this.setClassName(t.className),"style"in t&&this.setStyle(t.style),this.controlOption=Ge(Ge({},this.controlOption),t)}addTo(t){this.mapsService=t.mapService,this.renderService=t.rendererService,this.layerService=t.layerService,this.controlService=t.controlService,this.configService=t.globalConfigService,this.scene=t.sceneService,this.sceneContainer=t,this.isShow=!0,this.container=this.onAdd(),mv(this.container,"l7-control");const{className:r,style:n}=this.controlOption;return r&&this.setClassName(r),n&&this.setStyle(n),this.insertContainer(),this.emit("add",this),this}remove(){if(!this.mapsService)return this;D0(this.container),this.onRemove(),this.emit("remove",this)}onAdd(){return ba("div")}onRemove(){}show(){const t=this.container;Rb(t,"l7-control--hide"),this.isShow=!0,this.emit("show",this)}hide(){const t=this.container;mv(t,"l7-control--hide"),this.isShow=!1,this.emit("hide",this)}getDefault(t){return{position:F0.TOPRIGHT,name:`${Pv.controlCount}`}}getContainer(){return this.container}getIsShow(){return this.isShow}_refocusOnMap(t){if(this.mapsService&&t&&t.screenX>0&&t.screenY>0){const r=this.mapsService.getContainer();r!==null&&r.focus()}}setPosition(t=F0.TOPLEFT){const r=this.controlService;return r&&r.removeControl(this),this.controlOption.position=t,r&&r.addControl(this,this.sceneContainer),this}setClassName(t){const r=this.container,{className:n}=this.controlOption;n&&Rb(r,n),t&&mv(r,t)}setStyle(t){const r=this.container;t?r.setAttribute("style",t):r.removeAttribute("style")}insertContainer(){const t=this.controlOption.position,r=this.container;if(t instanceof Element)t.appendChild(r);else{const n=this.controlService.controlCorners[t];["bottomleft","bottomright","righttop","rightbottom"].includes(t)?n.insertBefore(r,n.firstChild):n.appendChild(r)}}checkUpdateOption(t,r){return r.some(n=>n in t)}}L(Pv,"controlCount",0);class W0 extends Oa.EventEmitter{get buttonRect(){return this.button.getBoundingClientRect()}constructor(t,r){super(),L(this,"popperDOM",void 0),L(this,"contentDOM",void 0),L(this,"button",void 0),L(this,"option",void 0),L(this,"isShow",!1),L(this,"content",void 0),L(this,"timeout",null),L(this,"show",()=>this.isShow||!this.contentDOM.innerHTML?this:(this.resetPopperPosition(),Rb(this.popperDOM,"l7-popper-hide"),this.isShow=!0,this.option.unique&&W0.conflictPopperList.forEach(n=>{n!==this&&n.isShow&&n.hide()}),this.emit("show"),window.addEventListener("pointerdown",this.onPopperUnClick),this)),L(this,"hide",()=>this.isShow?(mv(this.popperDOM,"l7-popper-hide"),this.isShow=!1,this.emit("hide"),window.removeEventListener("pointerdown",this.onPopperUnClick),this):this),L(this,"setHideTimeout",()=>{this.timeout||(this.timeout=window.setTimeout(()=>{this.isShow&&(this.hide(),this.timeout=null)},300))}),L(this,"clearHideTimeout",()=>{this.timeout&&(window.clearTimeout(this.timeout),this.timeout=null)}),L(this,"onBtnClick",()=>{this.isShow?this.hide():this.show()}),L(this,"onPopperUnClick",n=>{BV(n.target,[".l7-button-control",".l7-popper-content"])||this.hide()}),L(this,"onBtnMouseLeave",()=>{this.setHideTimeout()}),L(this,"onBtnMouseMove",()=>{this.clearHideTimeout(),!this.isShow&&this.show()}),this.button=t,this.option=r,this.init(),r.unique&&W0.conflictPopperList.push(this)}getPopperDOM(){return this.popperDOM}getIsShow(){return this.isShow}getContent(){return this.content}setContent(t){typeof t=="string"?this.contentDOM.innerHTML=t:t instanceof HTMLElement&&(uB(this.contentDOM),this.contentDOM.appendChild(t)),this.content=t}init(){const{trigger:t}=this.option;this.popperDOM=this.createPopper(),t==="click"?this.button.addEventListener("click",this.onBtnClick):(this.button.addEventListener("mousemove",this.onBtnMouseMove),this.button.addEventListener("mouseleave",this.onBtnMouseLeave),this.popperDOM.addEventListener("mousemove",this.onBtnMouseMove),this.popperDOM.addEventListener("mouseleave",this.onBtnMouseLeave))}destroy(){this.button.removeEventListener("click",this.onBtnClick),this.button.removeEventListener("mousemove",this.onBtnMouseMove),this.button.removeEventListener("mousemove",this.onBtnMouseLeave),this.popperDOM.removeEventListener("mousemove",this.onBtnMouseMove),this.popperDOM.removeEventListener("mouseleave",this.onBtnMouseLeave),D0(this.popperDOM)}resetPopperPosition(){const t={},{container:r,offset:n=[0,0],placement:i}=this.option,[a,s]=n,l=this.button.getBoundingClientRect(),c=r.getBoundingClientRect(),{left:d,right:p,top:h,bottom:m}=DV(l,c);let _=!1,y=!1;/^(left|right)/.test(i)?(i.includes("left")?t.right=`${l.width+p}px`:i.includes("right")&&(t.left=`${l.width+d}px`),i.includes("start")?t.top=`${h}px`:i.includes("end")?t.bottom=`${m}px`:(t.top=`${h+l.height/2}px`,y=!0,t.transform=`translate(${a}px, calc(${s}px - 50%))`)):/^(top|bottom)/.test(i)&&(i.includes("top")?t.bottom=`${l.height+m}px`:i.includes("bottom")&&(t.top=`${l.height+h}px`),i.includes("start")?t.left=`${d}px`:i.includes("end")?t.right=`${p}px`:(t.left=`${d+l.width/2}px`,_=!0,t.transform=`translate(calc(${a}px - 50%), ${s}px)`)),t.transform=`translate(calc(${a}px - ${_?"50%":"0%"}), calc(${s}px - ${y?"50%":"0%"})`;const E=i.split("-");E.length&&mv(this.popperDOM,E.map(T=>`l7-popper-${T}`).join(" ")),IV(this.popperDOM,PV(t))}createPopper(){const{container:t,className:r="",content:n}=this.option,i=ba("div",`l7-popper l7-popper-hide ${r}`),a=ba("div","l7-popper-content"),s=ba("div","l7-popper-arrow");return i.appendChild(a),i.appendChild(s),t.appendChild(i),this.popperDOM=i,this.contentDOM=a,n&&this.setContent(n),i}}L(W0,"conflictPopperList",[]);const WI=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],nu=(()=>{if(typeof document>"u")return!1;const e=WI[0],t={};for(const r of WI)if(r?.[1]in document){for(const[i,a]of r.entries())t[e[i]]=a;return t}return!1})(),YI={change:nu.fullscreenchange,error:nu.fullscreenerror};let Ga={request(e=document.documentElement,t){return new Promise((r,n)=>{const i=()=>{Ga.off("change",i),r()};Ga.on("change",i);const a=e[nu.requestFullscreen](t);a instanceof Promise&&a.then(i).catch(n)})},exit(){return new Promise((e,t)=>{if(!Ga.isFullscreen){e();return}const r=()=>{Ga.off("change",r),e()};Ga.on("change",r);const n=document[nu.exitFullscreen]();n instanceof Promise&&n.then(r).catch(t)})},toggle(e,t){return Ga.isFullscreen?Ga.exit():Ga.request(e,t)},onchange(e){Ga.on("change",e)},onerror(e){Ga.on("error",e)},on(e,t){const r=YI[e];r&&document.addEventListener(r,t,!1)},off(e,t){const r=YI[e];r&&document.removeEventListener(r,t,!1)},raw:nu};Object.defineProperties(Ga,{isFullscreen:{get:()=>!!document[nu.fullscreenElement]},element:{enumerable:!0,get:()=>{var e;return(e=document[nu.fullscreenElement])!==null&&e!==void 0?e:void 0}},isEnabled:{enumerable:!0,get:()=>!!document[nu.fullscreenEnabled]}});nu||(Ga={isEnabled:!1});class JZ extends Pv{getDefault(){return{position:F0.BOTTOMLEFT,name:"logo",href:"https://l7.antv.antgroup.com/",img:"https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*GRb1TKp4HcMAAAAAAAAAAAAAARQnAQ"}}onAdd(){const t=ba("div","l7-control-logo");return this.setLogoContent(t),t}onRemove(){return null}setOptions(t){super.setOptions(t),this.checkUpdateOption(t,["img","href"])&&(uB(this.container),this.setLogoContent(this.container))}setLogoContent(t){const{href:r,img:n}=this.controlOption,i=ba("img");if(i.setAttribute("src",n),i.setAttribute("aria-label","AntV logo"),LV(i),r){const a=ba("a","l7-control-logo-link");a.target="_blank",a.href=r,a.rel="noopener nofollow",a.setAttribute("rel","noopener nofollow"),a.appendChild(i),t.appendChild(a)}else t.appendChild(i)}}class eK{constructor(){L(this,"mapService",void 0),L(this,"fontService",void 0)}apply(t,{styleAttributeService:r,mapService:n,fontService:i}){var a=this;this.mapService=n,this.fontService=i,t.hooks.init.tapPromise("DataMappingPlugin",Ze(function*(){t.log(ri.MappingStart,Ti.INIT),a.generateMaping(t,{styleAttributeService:r}),t.log(ri.MappingEnd,Ti.INIT)})),t.hooks.beforeRenderData.tapPromise("DataMappingPlugin",(function(){var s=Ze(function*(l){if(!l)return l;t.dataState.dataMappingNeedUpdate=!1,t.log(ri.MappingStart,Ti.UPDATE);const c=a.generateMaping(t,{styleAttributeService:r});return t.log(ri.MappingEnd,Ti.UPDATE),c});return function(l){return s.apply(this,arguments)}})()),t.hooks.beforeRender.tap("DataMappingPlugin",()=>{const s=t.getSource();if(t.layerModelNeedUpdate||!s||!s.inited)return;const l=r.getLayerStyleAttributes()||[],c=r.getLayerStyleAttribute("filter"),{dataArray:d}=s.data;if(Array.isArray(d)&&d.length===0)return;const p=l.filter(m=>m.needRemapping);let h=d;if(c!=null&&c.needRemapping&&c!==null&&c!==void 0&&c.scale&&(h=d.filter(m=>this.applyAttributeMapping(c,m)[0])),p.length){const m=this.mapping(t,p,h,t.getEncodedData());t.setEncodedData(m)}})}generateMaping(t,{styleAttributeService:r}){const n=r.getLayerStyleAttributes()||[],i=r.getLayerStyleAttribute("filter"),{dataArray:a}=t.getSource().data;let s=a;i!=null&&i.scale&&(s=a.filter(c=>this.applyAttributeMapping(i,c)[0])),s=t.processData(s);const l=this.mapping(t,n,s,void 0);return t.setEncodedData(l),t.emit("dataUpdate",null),!0}mapping(t,r,n,i){const a=r.filter(l=>l.scale!==void 0).filter(l=>l.name!=="filter"),s=n.map((l,c)=>{const d=i?i[c]:{},p=Ge({id:l._id,coordinates:l.coordinates},d);return a.forEach(h=>{let m=this.applyAttributeMapping(h,l);(h.name==="color"||h.name==="stroke")&&(m=m.map(_=>$r(_))),p[h.name]=Array.isArray(m)&&m.length===1?m[0]:m,h.name==="shape"&&(p.shape=this.fontService.getIconFontKey(p[h.name]))}),p});return r.forEach(l=>{l.needRemapping=!1}),this.adjustData2SimpleCoordinates(s),s}adjustData2SimpleCoordinates(t){t.length>0&&this.mapService.version==="SIMPLE"&&t.map(r=>{r.simpleCoordinate||(r.coordinates=this.unProjectCoordinates(r.coordinates),r.simpleCoordinate=!0)})}unProjectCoordinates(t){if(typeof t[0]=="number")return this.mapService.simpleMapCoord.unproject(t);if(t[0]&&t[0][0]instanceof Array){const r=[];return t.map(n=>{const i=[];n.map(a=>{i.push(this.mapService.simpleMapCoord.unproject(a))}),r.push(i)}),r}else{const r=[];return t.map(n=>{r.push(this.mapService.simpleMapCoord.unproject(n))}),r}}applyAttributeMapping(t,r){var n;if(!t.scale)return[];const i=(t==null||(n=t.scale)===null||n===void 0?void 0:n.scalers)||[],a=[];return i.forEach(({field:l})=>{var c;(r.hasOwnProperty(l)||((c=t.scale)===null||c===void 0?void 0:c.type)==="variable")&&a.push(r[l])}),t.mapping?t.mapping(a):[]}getArrowPoints(t,r){const n=[r[0]-t[0],r[1]-t[1]],i=VV(n);return[t[0]+i[0]*1e-4,t[1]+i[1]*1e-4]}}class tK{constructor(){L(this,"mapService",void 0)}apply(t){var r=this;this.mapService=t.getContainer().mapService,t.hooks.init.tapPromise("DataSourcePlugin",Ze(function*(){t.log(ri.SourceInitStart,Ti.INIT);let n=t.getSource();if(!n){const{data:i,options:a}=t.sourceOption||t.defaultSourceConfig;n=new QZ(i,a),t.setSource(n)}n.inited?(r.updateClusterData(t),t.log(ri.SourceInitEnd,Ti.INIT)):yield new Promise(i=>{n.on("update",a=>{a.type==="inited"&&(r.updateClusterData(t),t.log(ri.SourceInitEnd,Ti.INIT)),i(null)})})})),t.hooks.beforeRenderData.tapPromise("DataSourcePlugin",Ze(function*(){const n=r.updateClusterData(t),i=t.dataState.dataSourceNeedUpdate;return t.dataState.dataSourceNeedUpdate=!1,n||i}))}updateClusterData(t){if(t.isTileLayer||t.tileLayer||!t.getSource())return!1;const r=t.getSource(),n=r.cluster,{zoom:i=0}=r.clusterOptions,a=this.mapService.getZoom()-1,s=t.dataState.dataSourceNeedUpdate;return n&&s&&r.updateClusterData(Math.floor(a)),n&&Math.abs(t.clusterZoom-a)>=1?(i!==Math.floor(a)&&r.updateClusterData(Math.floor(a)),t.clusterZoom=a,!0):!1}}function $I(e,t){let r,n;for(const i of e)i!=null&&(r===void 0?i>=i&&(r=n=i):(r>i&&(r=i),n<i&&(n=i)));return[r,n]}function rK(e,t,r,n,i){var a=e*e,s=a*e;return((1-3*e+3*a-s)*t+(4-6*a+3*s)*r+(1+3*e+3*a-3*s)*n+s*i)/6}function nK(e){var t=e.length-1;return function(r){var n=r<=0?r=0:r>=1?(r=1,t-1):Math.floor(r*t),i=e[n],a=e[n+1],s=n>0?e[n-1]:2*i-a,l=n<t-1?e[n+2]:2*a-i;return rK((r-n/t)*t,s,i,a,l)}}function TR(e){return function(){return e}}function iK(e,t){return function(r){return e+r*t}}function aK(e,t,r){return e=Math.pow(e,r),t=Math.pow(t,r)-e,r=1/r,function(n){return Math.pow(e+n*t,r)}}function oK(e){return(e=+e)==1?l6:function(t,r){return r-t?aK(t,r,e):TR(isNaN(t)?r:t)}}function l6(e,t){var r=t-e;return r?iK(e,r):TR(isNaN(e)?t:e)}const ZI=(function e(t){var r=oK(t);function n(i,a){var s=r((i=P0(i)).r,(a=P0(a)).r),l=r(i.g,a.g),c=r(i.b,a.b),d=l6(i.opacity,a.opacity);return function(p){return i.r=s(p),i.g=l(p),i.b=c(p),i.opacity=d(p),i+""}}return n.gamma=e,n})(1);function sK(e){return function(t){var r=t.length,n=new Array(r),i=new Array(r),a=new Array(r),s,l;for(s=0;s<r;++s)l=P0(t[s]),n[s]=l.r||0,i[s]=l.g||0,a[s]=l.b||0;return n=e(n),i=e(i),a=e(a),l.opacity=1,function(c){return l.r=n(c),l.g=i(c),l.b=a(c),l+""}}}var uK=sK(nK);function lK(e,t){t||(t=[]);var r=e?Math.min(t.length,e.length):0,n=t.slice(),i;return function(a){for(i=0;i<r;++i)n[i]=e[i]*(1-a)+t[i]*a;return n}}function cK(e){return ArrayBuffer.isView(e)&&!(e instanceof DataView)}function fK(e,t){var r=t?t.length:0,n=e?Math.min(r,e.length):0,i=new Array(n),a=new Array(r),s;for(s=0;s<n;++s)i[s]=SR(e[s],t[s]);for(;s<r;++s)a[s]=t[s];return function(l){for(s=0;s<n;++s)a[s]=i[s](l);return a}}function dK(e,t){var r=new Date;return e=+e,t=+t,function(n){return r.setTime(e*(1-n)+t*n),r}}function Y0(e,t){return e=+e,t=+t,function(r){return e*(1-r)+t*r}}function hK(e,t){var r={},n={},i;(e===null||typeof e!="object")&&(e={}),(t===null||typeof t!="object")&&(t={});for(i in t)i in e?r[i]=SR(e[i],t[i]):n[i]=t[i];return function(a){for(i in r)n[i]=r[i](a);return n}}var Zb=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,kA=new RegExp(Zb.source,"g");function pK(e){return function(){return e}}function vK(e){return function(t){return e(t)+""}}function mK(e,t){var r=Zb.lastIndex=kA.lastIndex=0,n,i,a,s=-1,l=[],c=[];for(e=e+"",t=t+"";(n=Zb.exec(e))&&(i=kA.exec(t));)(a=i.index)>r&&(a=t.slice(r,a),l[s]?l[s]+=a:l[++s]=a),(n=n[0])===(i=i[0])?l[s]?l[s]+=i:l[++s]=i:(l[++s]=null,c.push({i:s,x:Y0(n,i)})),r=kA.lastIndex;return r<t.length&&(a=t.slice(r),l[s]?l[s]+=a:l[++s]=a),l.length<2?c[0]?vK(c[0].x):pK(t):(t=c.length,function(d){for(var p=0,h;p<t;++p)l[(h=c[p]).i]=h.x(d);return l.join("")})}function SR(e,t){var r=typeof t,n;return t==null||r==="boolean"?TR(t):(r==="number"?Y0:r==="string"?(n=jd(t))?(t=n,ZI):mK:t instanceof jd?ZI:t instanceof Date?dK:cK(t)?lK:Array.isArray(t)?fK:typeof t.valueOf!="function"&&typeof t.toString!="function"||isNaN(t)?hK:Y0)(e,t)}function _K(e,t){return e=+e,t=+t,function(r){return Math.round(e*(1-r)+t*r)}}function AR(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function c6(e){return e.length===1&&(e=gK(e)),{left:function(t,r,n,i){for(n==null&&(n=0),i==null&&(i=t.length);n<i;){var a=n+i>>>1;e(t[a],r)<0?n=a+1:i=a}return n},right:function(t,r,n,i){for(n==null&&(n=0),i==null&&(i=t.length);n<i;){var a=n+i>>>1;e(t[a],r)>0?i=a:n=a+1}return n}}}function gK(e){return function(t,r){return AR(e(t),r)}}var yK=c6(AR),Gg=yK.right;function EK(e){return e===null?NaN:+e}var Kb=Math.sqrt(50),Qb=Math.sqrt(10),Jb=Math.sqrt(2);function f6(e,t,r){var n,i=-1,a,s,l;if(t=+t,e=+e,r=+r,e===t&&r>0)return[e];if((n=t<e)&&(a=e,e=t,t=a),(l=d0(e,t,r))===0||!isFinite(l))return[];if(l>0)for(e=Math.ceil(e/l),t=Math.floor(t/l),s=new Array(a=Math.ceil(t-e+1));++i<a;)s[i]=(e+i)*l;else for(e=Math.floor(e*l),t=Math.ceil(t*l),s=new Array(a=Math.ceil(e-t+1));++i<a;)s[i]=(e-i)/l;return n&&s.reverse(),s}function d0(e,t,r){var n=(t-e)/Math.max(0,r),i=Math.floor(Math.log(n)/Math.LN10),a=n/Math.pow(10,i);return i>=0?(a>=Kb?10:a>=Qb?5:a>=Jb?2:1)*Math.pow(10,i):-Math.pow(10,-i)/(a>=Kb?10:a>=Qb?5:a>=Jb?2:1)}function ex(e,t,r){var n=Math.abs(t-e)/Math.max(0,r),i=Math.pow(10,Math.floor(Math.log(n)/Math.LN10)),a=n/i;return a>=Kb?i*=10:a>=Qb?i*=5:a>=Jb&&(i*=2),t<e?-i:i}function TK(e,t,r){if(r==null&&(r=EK),!!(n=e.length)){if((t=+t)<=0||n<2)return+r(e[0],0,e);if(t>=1)return+r(e[n-1],n-1,e);var n,i=(n-1)*t,a=Math.floor(i),s=+r(e[a],a,e),l=+r(e[a+1],a+1,e);return s+(l-s)*(i-a)}}function Ll(e,t){switch(arguments.length){case 0:break;case 1:this.range(e);break;default:this.range(t).domain(e);break}return this}function d6(e,t){switch(arguments.length){case 0:break;case 1:this.interpolator(e);break;default:this.interpolator(t).domain(e);break}return this}var Va="$";function $0(){}$0.prototype=Z0.prototype={constructor:$0,has:function(e){return Va+e in this},get:function(e){return this[Va+e]},set:function(e,t){return this[Va+e]=t,this},remove:function(e){var t=Va+e;return t in this&&delete this[t]},clear:function(){for(var e in this)e[0]===Va&&delete this[e]},keys:function(){var e=[];for(var t in this)t[0]===Va&&e.push(t.slice(1));return e},values:function(){var e=[];for(var t in this)t[0]===Va&&e.push(this[t]);return e},entries:function(){var e=[];for(var t in this)t[0]===Va&&e.push({key:t.slice(1),value:this[t]});return e},size:function(){var e=0;for(var t in this)t[0]===Va&&++e;return e},empty:function(){for(var e in this)if(e[0]===Va)return!1;return!0},each:function(e){for(var t in this)t[0]===Va&&e(this[t],t.slice(1),this)}};function Z0(e,t){var r=new $0;if(e instanceof $0)e.each(function(l,c){r.set(c,l)});else if(Array.isArray(e)){var n=-1,i=e.length,a;if(t==null)for(;++n<i;)r.set(n,e[n]);else for(;++n<i;)r.set(t(a=e[n],n,e),a)}else if(e)for(var s in e)r.set(s,e[s]);return r}function KI(){}var Rc=Z0.prototype;KI.prototype={constructor:KI,has:Rc.has,add:function(e){return e+="",this[Va+e]=e,this},remove:Rc.remove,clear:Rc.clear,values:Rc.keys,size:Rc.size,empty:Rc.empty,each:Rc.each};var h6=Array.prototype,p6=h6.map,kc=h6.slice,QI={name:"implicit"};function K0(){var e=Z0(),t=[],r=[],n=QI;function i(a){var s=a+"",l=e.get(s);if(!l){if(n!==QI)return n;e.set(s,l=t.push(a))}return r[(l-1)%r.length]}return i.domain=function(a){if(!arguments.length)return t.slice();t=[],e=Z0();for(var s=-1,l=a.length,c,d;++s<l;)e.has(d=(c=a[s])+"")||e.set(d,t.push(c));return i},i.range=function(a){return arguments.length?(r=kc.call(a),i):r.slice()},i.unknown=function(a){return arguments.length?(n=a,i):n},i.copy=function(){return K0(t,r).unknown(n)},Ll.apply(i,arguments),i}function SK(e){return function(){return e}}function AK(e){return+e}var JI=[0,1];function Ii(e){return e}function tx(e,t){return(t-=e=+e)?function(r){return(r-e)/t}:SK(isNaN(t)?NaN:.5)}function e4(e){var t=e[0],r=e[e.length-1],n;return t>r&&(n=t,t=r,r=n),function(i){return Math.max(t,Math.min(r,i))}}function bK(e,t,r){var n=e[0],i=e[1],a=t[0],s=t[1];return i<n?(n=tx(i,n),a=r(s,a)):(n=tx(n,i),a=r(a,s)),function(l){return a(n(l))}}function xK(e,t,r){var n=Math.min(e.length,t.length)-1,i=new Array(n),a=new Array(n),s=-1;for(e[n]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++s<n;)i[s]=tx(e[s],e[s+1]),a[s]=r(t[s],t[s+1]);return function(l){var c=Gg(e,l,1,n)-1;return a[c](i[c](l))}}function qg(e,t){return t.domain(e.domain()).range(e.range()).interpolate(e.interpolate()).clamp(e.clamp()).unknown(e.unknown())}function bR(){var e=JI,t=JI,r=SR,n,i,a,s=Ii,l,c,d;function p(){return l=Math.min(e.length,t.length)>2?xK:bK,c=d=null,h}function h(m){return isNaN(m=+m)?a:(c||(c=l(e.map(n),t,r)))(n(s(m)))}return h.invert=function(m){return s(i((d||(d=l(t,e.map(n),Y0)))(m)))},h.domain=function(m){return arguments.length?(e=p6.call(m,AK),s===Ii||(s=e4(e)),p()):e.slice()},h.range=function(m){return arguments.length?(t=kc.call(m),p()):t.slice()},h.rangeRound=function(m){return t=kc.call(m),r=_K,p()},h.clamp=function(m){return arguments.length?(s=m?e4(e):Ii,h):s!==Ii},h.interpolate=function(m){return arguments.length?(r=m,p()):r},h.unknown=function(m){return arguments.length?(a=m,h):a},function(m,_){return n=m,i=_,p()}}function v6(e,t){return bR()(e,t)}function RK(e){return Math.abs(e=Math.round(e))>=1e21?e.toLocaleString("en").replace(/,/g,""):e.toString(10)}function Q0(e,t){if((r=(e=t?e.toExponential(t-1):e.toExponential()).indexOf("e"))<0)return null;var r,n=e.slice(0,r);return[n.length>1?n[0]+n.slice(2):n,+e.slice(r+1)]}function Xd(e){return e=Q0(Math.abs(e)),e?e[1]:NaN}function CK(e,t){return function(r,n){for(var i=r.length,a=[],s=0,l=e[0],c=0;i>0&&l>0&&(c+l+1>n&&(l=Math.max(1,n-c)),a.push(r.substring(i-=l,i+l)),!((c+=l+1)>n));)l=e[s=(s+1)%e.length];return a.reverse().join(t)}}function OK(e){return function(t){return t.replace(/[0-9]/g,function(r){return e[+r]})}}var MK=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function J0(e){if(!(t=MK.exec(e)))throw new Error("invalid format: "+e);var t;return new xR({fill:t[1],align:t[2],sign:t[3],symbol:t[4],zero:t[5],width:t[6],comma:t[7],precision:t[8]&&t[8].slice(1),trim:t[9],type:t[10]})}J0.prototype=xR.prototype;function xR(e){this.fill=e.fill===void 0?" ":e.fill+"",this.align=e.align===void 0?">":e.align+"",this.sign=e.sign===void 0?"-":e.sign+"",this.symbol=e.symbol===void 0?"":e.symbol+"",this.zero=!!e.zero,this.width=e.width===void 0?void 0:+e.width,this.comma=!!e.comma,this.precision=e.precision===void 0?void 0:+e.precision,this.trim=!!e.trim,this.type=e.type===void 0?"":e.type+""}xR.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function wK(e){e:for(var t=e.length,r=1,n=-1,i;r<t;++r)switch(e[r]){case".":n=i=r;break;case"0":n===0&&(n=r),i=r;break;default:if(!+e[r])break e;n>0&&(n=0);break}return n>0?e.slice(0,n)+e.slice(i+1):e}var m6;function NK(e,t){var r=Q0(e,t);if(!r)return e+"";var n=r[0],i=r[1],a=i-(m6=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,s=n.length;return a===s?n:a>s?n+new Array(a-s+1).join("0"):a>0?n.slice(0,a)+"."+n.slice(a):"0."+new Array(1-a).join("0")+Q0(e,Math.max(0,t+a-1))[0]}function t4(e,t){var r=Q0(e,t);if(!r)return e+"";var n=r[0],i=r[1];return i<0?"0."+new Array(-i).join("0")+n:n.length>i+1?n.slice(0,i+1)+"."+n.slice(i+1):n+new Array(i-n.length+2).join("0")}const r4={"%":function(e,t){return(e*100).toFixed(t)},b:function(e){return Math.round(e).toString(2)},c:function(e){return e+""},d:RK,e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},g:function(e,t){return e.toPrecision(t)},o:function(e){return Math.round(e).toString(8)},p:function(e,t){return t4(e*100,t)},r:t4,s:NK,X:function(e){return Math.round(e).toString(16).toUpperCase()},x:function(e){return Math.round(e).toString(16)}};function n4(e){return e}var i4=Array.prototype.map,a4=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"];function IK(e){var t=e.grouping===void 0||e.thousands===void 0?n4:CK(i4.call(e.grouping,Number),e.thousands+""),r=e.currency===void 0?"":e.currency[0]+"",n=e.currency===void 0?"":e.currency[1]+"",i=e.decimal+"",a=e.numerals===void 0?n4:OK(i4.call(e.numerals,String)),s=e.percent===void 0?"%":e.percent+"",l=e.minus+"",c=e.nan===void 0?"NaN":e.nan+"";function d(h){h=J0(h);var m=h.fill,_=h.align,y=h.sign,E=h.symbol,T=h.zero,A=h.width,b=h.comma,R=h.precision,M=h.trim,B=h.type;B==="n"?(b=!0,B="g"):r4[B]||(R===void 0&&(R=12),M=!0,B="g"),(T||m==="0"&&_==="=")&&(T=!0,m="0",_="=");var w=E==="$"?r:E==="#"&&/[boxX]/.test(B)?"0"+B.toLowerCase():"",D=E==="$"?n:/[%p]/.test(B)?s:"",U=r4[B],ae=/[defgprs%]/.test(B);R=R===void 0?6:/[gprs]/.test(B)?Math.max(1,Math.min(21,R)):Math.max(0,Math.min(20,R));function Q(X){var x=w,P=D,H,pe,O;if(B==="c")P=U(X)+P,X="";else{X=+X;var F=X<0||1/X<0;if(X=isNaN(X)?c:U(Math.abs(X),R),M&&(X=wK(X)),F&&+X==0&&y!=="+"&&(F=!1),x=(F?y==="("?y:l:y==="-"||y==="("?"":y)+x,P=(B==="s"?a4[8+m6/3]:"")+P+(F&&y==="("?")":""),ae){for(H=-1,pe=X.length;++H<pe;)if(O=X.charCodeAt(H),48>O||O>57){P=(O===46?i+X.slice(H+1):X.slice(H))+P,X=X.slice(0,H);break}}}b&&!T&&(X=t(X,1/0));var z=x.length+X.length+P.length,re=z<A?new Array(A-z+1).join(m):"";switch(b&&T&&(X=t(re+X,re.length?A-P.length:1/0),re=""),_){case"<":X=x+X+P+re;break;case"=":X=x+re+X+P;break;case"^":X=re.slice(0,z=re.length>>1)+x+X+P+re.slice(z);break;default:X=re+x+X+P;break}return a(X)}return Q.toString=function(){return h+""},Q}function p(h,m){var _=d((h=J0(h),h.type="f",h)),y=Math.max(-8,Math.min(8,Math.floor(Xd(m)/3)))*3,E=Math.pow(10,-y),T=a4[8+y/3];return function(A){return _(E*A)+T}}return{format:d,formatPrefix:p}}var U_,RR,_6;PK({decimal:".",thousands:",",grouping:[3],currency:["$",""],minus:"-"});function PK(e){return U_=IK(e),RR=U_.format,_6=U_.formatPrefix,U_}function DK(e){return Math.max(0,-Xd(Math.abs(e)))}function LK(e,t){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Xd(t)/3)))*3-Xd(Math.abs(e)))}function BK(e,t){return e=Math.abs(e),t=Math.abs(t)-e,Math.max(0,Xd(t)-Xd(e))+1}function FK(e,t,r,n){var i=ex(e,t,r),a;switch(n=J0(n??",f"),n.type){case"s":{var s=Math.max(Math.abs(e),Math.abs(t));return n.precision==null&&!isNaN(a=LK(i,s))&&(n.precision=a),_6(n,s)}case"":case"e":case"g":case"p":case"r":{n.precision==null&&!isNaN(a=BK(i,Math.max(Math.abs(e),Math.abs(t))))&&(n.precision=a-(n.type==="e"));break}case"f":case"%":{n.precision==null&&!isNaN(a=DK(i))&&(n.precision=a-(n.type==="%")*2);break}}return RR(n)}function Yv(e){var t=e.domain;return e.ticks=function(r){var n=t();return f6(n[0],n[n.length-1],r??10)},e.tickFormat=function(r,n){var i=t();return FK(i[0],i[i.length-1],r??10,n)},e.nice=function(r){r==null&&(r=10);var n=t(),i=0,a=n.length-1,s=n[i],l=n[a],c;return l<s&&(c=s,s=l,l=c,c=i,i=a,a=c),c=d0(s,l,r),c>0?(s=Math.floor(s/c)*c,l=Math.ceil(l/c)*c,c=d0(s,l,r)):c<0&&(s=Math.ceil(s*c)/c,l=Math.floor(l*c)/c,c=d0(s,l,r)),c>0?(n[i]=Math.floor(s/c)*c,n[a]=Math.ceil(l/c)*c,t(n)):c<0&&(n[i]=Math.ceil(s*c)/c,n[a]=Math.floor(l*c)/c,t(n)),e},e}function g6(){var e=v6(Ii,Ii);return e.copy=function(){return qg(e,g6())},Ll.apply(e,arguments),Yv(e)}function y6(e,t){e=e.slice();var r=0,n=e.length-1,i=e[r],a=e[n],s;return a<i&&(s=r,r=n,n=s,s=i,i=a,a=s),e[r]=t.floor(i),e[n]=t.ceil(a),e}function o4(e){return Math.log(e)}function s4(e){return Math.exp(e)}function UK(e){return-Math.log(-e)}function kK(e){return-Math.exp(-e)}function zK(e){return isFinite(e)?+("1e"+e):e<0?0:e}function jK(e){return e===10?zK:e===Math.E?Math.exp:function(t){return Math.pow(e,t)}}function HK(e){return e===Math.E?Math.log:e===10&&Math.log10||e===2&&Math.log2||(e=Math.log(e),function(t){return Math.log(t)/e})}function u4(e){return function(t){return-e(-t)}}function VK(e){var t=e(o4,s4),r=t.domain,n=10,i,a;function s(){return i=HK(n),a=jK(n),r()[0]<0?(i=u4(i),a=u4(a),e(UK,kK)):e(o4,s4),t}return t.base=function(l){return arguments.length?(n=+l,s()):n},t.domain=function(l){return arguments.length?(r(l),s()):r()},t.ticks=function(l){var c=r(),d=c[0],p=c[c.length-1],h;(h=p<d)&&(m=d,d=p,p=m);var m=i(d),_=i(p),y,E,T,A=l==null?10:+l,b=[];if(!(n%1)&&_-m<A){if(m=Math.round(m)-1,_=Math.round(_)+1,d>0){for(;m<_;++m)for(E=1,y=a(m);E<n;++E)if(T=y*E,!(T<d)){if(T>p)break;b.push(T)}}else for(;m<_;++m)for(E=n-1,y=a(m);E>=1;--E)if(T=y*E,!(T<d)){if(T>p)break;b.push(T)}}else b=f6(m,_,Math.min(_-m,A)).map(a);return h?b.reverse():b},t.tickFormat=function(l,c){if(c==null&&(c=n===10?".0e":","),typeof c!="function"&&(c=RR(c)),l===1/0)return c;l==null&&(l=10);var d=Math.max(1,n*l/t.ticks().length);return function(p){var h=p/a(Math.round(i(p)));return h*n<n-.5&&(h*=n),h<=d?c(p):""}},t.nice=function(){return r(y6(r(),{floor:function(l){return a(Math.floor(i(l)))},ceil:function(l){return a(Math.ceil(i(l)))}}))},t}function E6(){var e=VK(bR()).domain([1,10]);return e.copy=function(){return qg(e,E6()).base(e.base())},Ll.apply(e,arguments),e}function l4(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function XK(e){return e<0?-Math.sqrt(-e):Math.sqrt(e)}function GK(e){return e<0?-e*e:e*e}function qK(e){var t=e(Ii,Ii),r=1;function n(){return r===1?e(Ii,Ii):r===.5?e(XK,GK):e(l4(r),l4(1/r))}return t.exponent=function(i){return arguments.length?(r=+i,n()):r},Yv(t)}function T6(){var e=qK(bR());return e.copy=function(){return qg(e,T6()).exponent(e.exponent())},Ll.apply(e,arguments),e}function S6(){var e=[],t=[],r=[],n;function i(){var s=0,l=Math.max(1,t.length);for(r=new Array(l-1);++s<l;)r[s-1]=TK(e,s/l);return a}function a(s){return isNaN(s=+s)?n:t[Gg(r,s)]}return a.invertExtent=function(s){var l=t.indexOf(s);return l<0?[NaN,NaN]:[l>0?r[l-1]:e[0],l<r.length?r[l]:e[e.length-1]]},a.domain=function(s){if(!arguments.length)return e.slice();e=[];for(var l=0,c=s.length,d;l<c;++l)d=s[l],d!=null&&!isNaN(d=+d)&&e.push(d);return e.sort(AR),i()},a.range=function(s){return arguments.length?(t=kc.call(s),i()):t.slice()},a.unknown=function(s){return arguments.length?(n=s,a):n},a.quantiles=function(){return r.slice()},a.copy=function(){return S6().domain(e).range(t).unknown(n)},Ll.apply(a,arguments)}function A6(){var e=0,t=1,r=1,n=[.5],i=[0,1],a;function s(c){return c<=c?i[Gg(n,c,0,r)]:a}function l(){var c=-1;for(n=new Array(r);++c<r;)n[c]=((c+1)*t-(c-r)*e)/(r+1);return s}return s.domain=function(c){return arguments.length?(e=+c[0],t=+c[1],l()):[e,t]},s.range=function(c){return arguments.length?(r=(i=kc.call(c)).length-1,l()):i.slice()},s.invertExtent=function(c){var d=i.indexOf(c);return d<0?[NaN,NaN]:d<1?[e,n[0]]:d>=r?[n[r-1],t]:[n[d-1],n[d]]},s.unknown=function(c){return arguments.length&&(a=c),s},s.thresholds=function(){return n.slice()},s.copy=function(){return A6().domain([e,t]).range(i).unknown(a)},Ll.apply(Yv(s),arguments)}function b6(){var e=[.5],t=[0,1],r,n=1;function i(a){return a<=a?t[Gg(e,a,0,n)]:r}return i.domain=function(a){return arguments.length?(e=kc.call(a),n=Math.min(e.length,t.length-1),i):e.slice()},i.range=function(a){return arguments.length?(t=kc.call(a),n=Math.min(e.length,t.length-1),i):t.slice()},i.invertExtent=function(a){var s=t.indexOf(a);return[e[s-1],e[s]]},i.unknown=function(a){return arguments.length?(r=a,i):r},i.copy=function(){return b6().domain(e).range(t).unknown(r)},Ll.apply(i,arguments)}var zA=new Date,jA=new Date;function Wi(e,t,r,n){function i(a){return e(a=arguments.length===0?new Date:new Date(+a)),a}return i.floor=function(a){return e(a=new Date(+a)),a},i.ceil=function(a){return e(a=new Date(a-1)),t(a,1),e(a),a},i.round=function(a){var s=i(a),l=i.ceil(a);return a-s<l-a?s:l},i.offset=function(a,s){return t(a=new Date(+a),s==null?1:Math.floor(s)),a},i.range=function(a,s,l){var c=[],d;if(a=i.ceil(a),l=l==null?1:Math.floor(l),!(a<s)||!(l>0))return c;do c.push(d=new Date(+a)),t(a,l),e(a);while(d<a&&a<s);return c},i.filter=function(a){return Wi(function(s){if(s>=s)for(;e(s),!a(s);)s.setTime(s-1)},function(s,l){if(s>=s)if(l<0)for(;++l<=0;)for(;t(s,-1),!a(s););else for(;--l>=0;)for(;t(s,1),!a(s););})},r&&(i.count=function(a,s){return zA.setTime(+a),jA.setTime(+s),e(zA),e(jA),Math.floor(r(zA,jA))},i.every=function(a){return a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?i.filter(n?function(s){return n(s)%a===0}:function(s){return i.count(0,s)%a===0}):i}),i}var eg=Wi(function(){},function(e,t){e.setTime(+e+t)},function(e,t){return t-e});eg.every=function(e){return e=Math.floor(e),!isFinite(e)||!(e>0)?null:e>1?Wi(function(t){t.setTime(Math.floor(t/e)*e)},function(t,r){t.setTime(+t+r*e)},function(t,r){return(r-t)/e}):eg};eg.range;var tg=1e3,Dv=6e4,c4=36e5,x6=864e5,R6=6048e5,C6=Wi(function(e){e.setTime(e-e.getMilliseconds())},function(e,t){e.setTime(+e+t*tg)},function(e,t){return(t-e)/tg},function(e){return e.getUTCSeconds()});C6.range;var O6=Wi(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*tg)},function(e,t){e.setTime(+e+t*Dv)},function(e,t){return(t-e)/Dv},function(e){return e.getMinutes()});O6.range;var M6=Wi(function(e){e.setTime(e-e.getMilliseconds()-e.getSeconds()*tg-e.getMinutes()*Dv)},function(e,t){e.setTime(+e+t*c4)},function(e,t){return(t-e)/c4},function(e){return e.getHours()});M6.range;var Wg=Wi(function(e){e.setHours(0,0,0,0)},function(e,t){e.setDate(e.getDate()+t)},function(e,t){return(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*Dv)/x6},function(e){return e.getDate()-1});Wg.range;function Yc(e){return Wi(function(t){t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},function(t,r){t.setDate(t.getDate()+r*7)},function(t,r){return(r-t-(r.getTimezoneOffset()-t.getTimezoneOffset())*Dv)/R6})}var CR=Yc(0),rg=Yc(1),WK=Yc(2),YK=Yc(3),Gd=Yc(4),$K=Yc(5),ZK=Yc(6);CR.range;rg.range;WK.range;YK.range;Gd.range;$K.range;ZK.range;var w6=Wi(function(e){e.setDate(1),e.setHours(0,0,0,0)},function(e,t){e.setMonth(e.getMonth()+t)},function(e,t){return t.getMonth()-e.getMonth()+(t.getFullYear()-e.getFullYear())*12},function(e){return e.getMonth()});w6.range;var Ml=Wi(function(e){e.setMonth(0,1),e.setHours(0,0,0,0)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()});Ml.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:Wi(function(t){t.setFullYear(Math.floor(t.getFullYear()/e)*e),t.setMonth(0,1),t.setHours(0,0,0,0)},function(t,r){t.setFullYear(t.getFullYear()+r*e)})};Ml.range;var OR=Wi(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/x6},function(e){return e.getUTCDate()-1});OR.range;function $c(e){return Wi(function(t){t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},function(t,r){t.setUTCDate(t.getUTCDate()+r*7)},function(t,r){return(r-t)/R6})}var N6=$c(0),ng=$c(1),KK=$c(2),QK=$c(3),qd=$c(4),JK=$c(5),eQ=$c(6);N6.range;ng.range;KK.range;QK.range;qd.range;JK.range;eQ.range;var zc=Wi(function(e){e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()});zc.every=function(e){return!isFinite(e=Math.floor(e))||!(e>0)?null:Wi(function(t){t.setUTCFullYear(Math.floor(t.getUTCFullYear()/e)*e),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},function(t,r){t.setUTCFullYear(t.getUTCFullYear()+r*e)})};zc.range;function HA(e){if(0<=e.y&&e.y<100){var t=new Date(-1,e.m,e.d,e.H,e.M,e.S,e.L);return t.setFullYear(e.y),t}return new Date(e.y,e.m,e.d,e.H,e.M,e.S,e.L)}function VA(e){if(0<=e.y&&e.y<100){var t=new Date(Date.UTC(-1,e.m,e.d,e.H,e.M,e.S,e.L));return t.setUTCFullYear(e.y),t}return new Date(Date.UTC(e.y,e.m,e.d,e.H,e.M,e.S,e.L))}function Np(e,t,r){return{y:e,m:t,d:r,H:0,M:0,S:0,L:0}}function tQ(e){var t=e.dateTime,r=e.date,n=e.time,i=e.periods,a=e.days,s=e.shortDays,l=e.months,c=e.shortMonths,d=Ip(i),p=Pp(i),h=Ip(a),m=Pp(a),_=Ip(s),y=Pp(s),E=Ip(l),T=Pp(l),A=Ip(c),b=Pp(c),R={a:F,A:z,b:re,B:oe,c:null,d:m4,e:m4,f:bQ,g:DQ,G:BQ,H:TQ,I:SQ,j:AQ,L:I6,m:xQ,M:RQ,p:_e,q:ye,Q:y4,s:E4,S:CQ,u:OQ,U:MQ,V:wQ,w:NQ,W:IQ,x:null,X:null,y:PQ,Y:LQ,Z:FQ,"%":g4},M={a:Ie,A:Je,b:We,B:Ct,c:null,d:_4,e:_4,f:jQ,g:KQ,G:JQ,H:UQ,I:kQ,j:zQ,L:D6,m:HQ,M:VQ,p:Ve,q:yt,Q:y4,s:E4,S:XQ,u:GQ,U:qQ,V:WQ,w:YQ,W:$Q,x:null,X:null,y:ZQ,Y:QQ,Z:eJ,"%":g4},B={a:Q,A:X,b:x,B:P,c:H,d:p4,e:p4,f:_Q,g:h4,G:d4,H:v4,I:v4,j:hQ,L:mQ,m:dQ,M:pQ,p:ae,q:fQ,Q:yQ,s:EQ,S:vQ,u:oQ,U:sQ,V:uQ,w:aQ,W:lQ,x:pe,X:O,y:h4,Y:d4,Z:cQ,"%":gQ};R.x=w(r,R),R.X=w(n,R),R.c=w(t,R),M.x=w(r,M),M.X=w(n,M),M.c=w(t,M);function w(Ue,ge){return function(nt){var Ce=[],zt=-1,jt=0,_t=Ue.length,Ot,xt,Xt;for(nt instanceof Date||(nt=new Date(+nt));++zt<_t;)Ue.charCodeAt(zt)===37&&(Ce.push(Ue.slice(jt,zt)),(xt=f4[Ot=Ue.charAt(++zt)])!=null?Ot=Ue.charAt(++zt):xt=Ot==="e"?" ":"0",(Xt=ge[Ot])&&(Ot=Xt(nt,xt)),Ce.push(Ot),jt=zt+1);return Ce.push(Ue.slice(jt,zt)),Ce.join("")}}function D(Ue,ge){return function(nt){var Ce=Np(1900,void 0,1),zt=U(Ce,Ue,nt+="",0),jt,_t;if(zt!=nt.length)return null;if("Q"in Ce)return new Date(Ce.Q);if("s"in Ce)return new Date(Ce.s*1e3+("L"in Ce?Ce.L:0));if(ge&&!("Z"in Ce)&&(Ce.Z=0),"p"in Ce&&(Ce.H=Ce.H%12+Ce.p*12),Ce.m===void 0&&(Ce.m="q"in Ce?Ce.q:0),"V"in Ce){if(Ce.V<1||Ce.V>53)return null;"w"in Ce||(Ce.w=1),"Z"in Ce?(jt=VA(Np(Ce.y,0,1)),_t=jt.getUTCDay(),jt=_t>4||_t===0?ng.ceil(jt):ng(jt),jt=OR.offset(jt,(Ce.V-1)*7),Ce.y=jt.getUTCFullYear(),Ce.m=jt.getUTCMonth(),Ce.d=jt.getUTCDate()+(Ce.w+6)%7):(jt=HA(Np(Ce.y,0,1)),_t=jt.getDay(),jt=_t>4||_t===0?rg.ceil(jt):rg(jt),jt=Wg.offset(jt,(Ce.V-1)*7),Ce.y=jt.getFullYear(),Ce.m=jt.getMonth(),Ce.d=jt.getDate()+(Ce.w+6)%7)}else("W"in Ce||"U"in Ce)&&("w"in Ce||(Ce.w="u"in Ce?Ce.u%7:"W"in Ce?1:0),_t="Z"in Ce?VA(Np(Ce.y,0,1)).getUTCDay():HA(Np(Ce.y,0,1)).getDay(),Ce.m=0,Ce.d="W"in Ce?(Ce.w+6)%7+Ce.W*7-(_t+5)%7:Ce.w+Ce.U*7-(_t+6)%7);return"Z"in Ce?(Ce.H+=Ce.Z/100|0,Ce.M+=Ce.Z%100,VA(Ce)):HA(Ce)}}function U(Ue,ge,nt,Ce){for(var zt=0,jt=ge.length,_t=nt.length,Ot,xt;zt<jt;){if(Ce>=_t)return-1;if(Ot=ge.charCodeAt(zt++),Ot===37){if(Ot=ge.charAt(zt++),xt=B[Ot in f4?ge.charAt(zt++):Ot],!xt||(Ce=xt(Ue,nt,Ce))<0)return-1}else if(Ot!=nt.charCodeAt(Ce++))return-1}return Ce}function ae(Ue,ge,nt){var Ce=d.exec(ge.slice(nt));return Ce?(Ue.p=p[Ce[0].toLowerCase()],nt+Ce[0].length):-1}function Q(Ue,ge,nt){var Ce=_.exec(ge.slice(nt));return Ce?(Ue.w=y[Ce[0].toLowerCase()],nt+Ce[0].length):-1}function X(Ue,ge,nt){var Ce=h.exec(ge.slice(nt));return Ce?(Ue.w=m[Ce[0].toLowerCase()],nt+Ce[0].length):-1}function x(Ue,ge,nt){var Ce=A.exec(ge.slice(nt));return Ce?(Ue.m=b[Ce[0].toLowerCase()],nt+Ce[0].length):-1}function P(Ue,ge,nt){var Ce=E.exec(ge.slice(nt));return Ce?(Ue.m=T[Ce[0].toLowerCase()],nt+Ce[0].length):-1}function H(Ue,ge,nt){return U(Ue,t,ge,nt)}function pe(Ue,ge,nt){return U(Ue,r,ge,nt)}function O(Ue,ge,nt){return U(Ue,n,ge,nt)}function F(Ue){return s[Ue.getDay()]}function z(Ue){return a[Ue.getDay()]}function re(Ue){return c[Ue.getMonth()]}function oe(Ue){return l[Ue.getMonth()]}function _e(Ue){return i[+(Ue.getHours()>=12)]}function ye(Ue){return 1+~~(Ue.getMonth()/3)}function Ie(Ue){return s[Ue.getUTCDay()]}function Je(Ue){return a[Ue.getUTCDay()]}function We(Ue){return c[Ue.getUTCMonth()]}function Ct(Ue){return l[Ue.getUTCMonth()]}function Ve(Ue){return i[+(Ue.getUTCHours()>=12)]}function yt(Ue){return 1+~~(Ue.getUTCMonth()/3)}return{format:function(Ue){var ge=w(Ue+="",R);return ge.toString=function(){return Ue},ge},parse:function(Ue){var ge=D(Ue+="",!1);return ge.toString=function(){return Ue},ge},utcFormat:function(Ue){var ge=w(Ue+="",M);return ge.toString=function(){return Ue},ge},utcParse:function(Ue){var ge=D(Ue+="",!0);return ge.toString=function(){return Ue},ge}}}var f4={"-":"",_:" ",0:"0"},hi=/^\s*\d+/,rQ=/^%/,nQ=/[\\^$*+?|[\]().{}]/g;function kr(e,t,r){var n=e<0?"-":"",i=(n?-e:e)+"",a=i.length;return n+(a<r?new Array(r-a+1).join(t)+i:i)}function iQ(e){return e.replace(nQ,"\\$&")}function Ip(e){return new RegExp("^(?:"+e.map(iQ).join("|")+")","i")}function Pp(e){for(var t={},r=-1,n=e.length;++r<n;)t[e[r].toLowerCase()]=r;return t}function aQ(e,t,r){var n=hi.exec(t.slice(r,r+1));return n?(e.w=+n[0],r+n[0].length):-1}function oQ(e,t,r){var n=hi.exec(t.slice(r,r+1));return n?(e.u=+n[0],r+n[0].length):-1}function sQ(e,t,r){var n=hi.exec(t.slice(r,r+2));return n?(e.U=+n[0],r+n[0].length):-1}function uQ(e,t,r){var n=hi.exec(t.slice(r,r+2));return n?(e.V=+n[0],r+n[0].length):-1}function lQ(e,t,r){var n=hi.exec(t.slice(r,r+2));return n?(e.W=+n[0],r+n[0].length):-1}function d4(e,t,r){var n=hi.exec(t.slice(r,r+4));return n?(e.y=+n[0],r+n[0].length):-1}function h4(e,t,r){var n=hi.exec(t.slice(r,r+2));return n?(e.y=+n[0]+(+n[0]>68?1900:2e3),r+n[0].length):-1}function cQ(e,t,r){var n=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(t.slice(r,r+6));return n?(e.Z=n[1]?0:-(n[2]+(n[3]||"00")),r+n[0].length):-1}function fQ(e,t,r){var n=hi.exec(t.slice(r,r+1));return n?(e.q=n[0]*3-3,r+n[0].length):-1}function dQ(e,t,r){var n=hi.exec(t.slice(r,r+2));return n?(e.m=n[0]-1,r+n[0].length):-1}function p4(e,t,r){var n=hi.exec(t.slice(r,r+2));return n?(e.d=+n[0],r+n[0].length):-1}function hQ(e,t,r){var n=hi.exec(t.slice(r,r+3));return n?(e.m=0,e.d=+n[0],r+n[0].length):-1}function v4(e,t,r){var n=hi.exec(t.slice(r,r+2));return n?(e.H=+n[0],r+n[0].length):-1}function pQ(e,t,r){var n=hi.exec(t.slice(r,r+2));return n?(e.M=+n[0],r+n[0].length):-1}function vQ(e,t,r){var n=hi.exec(t.slice(r,r+2));return n?(e.S=+n[0],r+n[0].length):-1}function mQ(e,t,r){var n=hi.exec(t.slice(r,r+3));return n?(e.L=+n[0],r+n[0].length):-1}function _Q(e,t,r){var n=hi.exec(t.slice(r,r+6));return n?(e.L=Math.floor(n[0]/1e3),r+n[0].length):-1}function gQ(e,t,r){var n=rQ.exec(t.slice(r,r+1));return n?r+n[0].length:-1}function yQ(e,t,r){var n=hi.exec(t.slice(r));return n?(e.Q=+n[0],r+n[0].length):-1}function EQ(e,t,r){var n=hi.exec(t.slice(r));return n?(e.s=+n[0],r+n[0].length):-1}function m4(e,t){return kr(e.getDate(),t,2)}function TQ(e,t){return kr(e.getHours(),t,2)}function SQ(e,t){return kr(e.getHours()%12||12,t,2)}function AQ(e,t){return kr(1+Wg.count(Ml(e),e),t,3)}function I6(e,t){return kr(e.getMilliseconds(),t,3)}function bQ(e,t){return I6(e,t)+"000"}function xQ(e,t){return kr(e.getMonth()+1,t,2)}function RQ(e,t){return kr(e.getMinutes(),t,2)}function CQ(e,t){return kr(e.getSeconds(),t,2)}function OQ(e){var t=e.getDay();return t===0?7:t}function MQ(e,t){return kr(CR.count(Ml(e)-1,e),t,2)}function P6(e){var t=e.getDay();return t>=4||t===0?Gd(e):Gd.ceil(e)}function wQ(e,t){return e=P6(e),kr(Gd.count(Ml(e),e)+(Ml(e).getDay()===4),t,2)}function NQ(e){return e.getDay()}function IQ(e,t){return kr(rg.count(Ml(e)-1,e),t,2)}function PQ(e,t){return kr(e.getFullYear()%100,t,2)}function DQ(e,t){return e=P6(e),kr(e.getFullYear()%100,t,2)}function LQ(e,t){return kr(e.getFullYear()%1e4,t,4)}function BQ(e,t){var r=e.getDay();return e=r>=4||r===0?Gd(e):Gd.ceil(e),kr(e.getFullYear()%1e4,t,4)}function FQ(e){var t=e.getTimezoneOffset();return(t>0?"-":(t*=-1,"+"))+kr(t/60|0,"0",2)+kr(t%60,"0",2)}function _4(e,t){return kr(e.getUTCDate(),t,2)}function UQ(e,t){return kr(e.getUTCHours(),t,2)}function kQ(e,t){return kr(e.getUTCHours()%12||12,t,2)}function zQ(e,t){return kr(1+OR.count(zc(e),e),t,3)}function D6(e,t){return kr(e.getUTCMilliseconds(),t,3)}function jQ(e,t){return D6(e,t)+"000"}function HQ(e,t){return kr(e.getUTCMonth()+1,t,2)}function VQ(e,t){return kr(e.getUTCMinutes(),t,2)}function XQ(e,t){return kr(e.getUTCSeconds(),t,2)}function GQ(e){var t=e.getUTCDay();return t===0?7:t}function qQ(e,t){return kr(N6.count(zc(e)-1,e),t,2)}function L6(e){var t=e.getUTCDay();return t>=4||t===0?qd(e):qd.ceil(e)}function WQ(e,t){return e=L6(e),kr(qd.count(zc(e),e)+(zc(e).getUTCDay()===4),t,2)}function YQ(e){return e.getUTCDay()}function $Q(e,t){return kr(ng.count(zc(e)-1,e),t,2)}function ZQ(e,t){return kr(e.getUTCFullYear()%100,t,2)}function KQ(e,t){return e=L6(e),kr(e.getUTCFullYear()%100,t,2)}function QQ(e,t){return kr(e.getUTCFullYear()%1e4,t,4)}function JQ(e,t){var r=e.getUTCDay();return e=r>=4||r===0?qd(e):qd.ceil(e),kr(e.getUTCFullYear()%1e4,t,4)}function eJ(){return"+0000"}function g4(){return"%"}function y4(e){return+e}function E4(e){return Math.floor(+e/1e3)}var fd,B6;tJ({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function tJ(e){return fd=tQ(e),B6=fd.format,fd.parse,fd.utcFormat,fd.utcParse,fd}var ov=1e3,sv=ov*60,uv=sv*60,Lv=uv*24,rJ=Lv*7,T4=Lv*30,XA=Lv*365;function nJ(e){return new Date(e)}function iJ(e){return e instanceof Date?+e:+new Date(+e)}function F6(e,t,r,n,i,a,s,l,c){var d=v6(Ii,Ii),p=d.invert,h=d.domain,m=c(".%L"),_=c(":%S"),y=c("%I:%M"),E=c("%I %p"),T=c("%a %d"),A=c("%b %d"),b=c("%B"),R=c("%Y"),M=[[s,1,ov],[s,5,5*ov],[s,15,15*ov],[s,30,30*ov],[a,1,sv],[a,5,5*sv],[a,15,15*sv],[a,30,30*sv],[i,1,uv],[i,3,3*uv],[i,6,6*uv],[i,12,12*uv],[n,1,Lv],[n,2,2*Lv],[r,1,rJ],[t,1,T4],[t,3,3*T4],[e,1,XA]];function B(D){return(s(D)<D?m:a(D)<D?_:i(D)<D?y:n(D)<D?E:t(D)<D?r(D)<D?T:A:e(D)<D?b:R)(D)}function w(D,U,ae,Q){if(D==null&&(D=10),typeof D=="number"){var X=Math.abs(ae-U)/D,x=c6(function(P){return P[2]}).right(M,X);x===M.length?(Q=ex(U/XA,ae/XA,D),D=e):x?(x=M[X/M[x-1][2]<M[x][2]/X?x-1:x],Q=x[1],D=x[0]):(Q=Math.max(ex(U,ae,D),1),D=l)}return Q==null?D:D.every(Q)}return d.invert=function(D){return new Date(p(D))},d.domain=function(D){return arguments.length?h(p6.call(D,iJ)):h().map(nJ)},d.ticks=function(D,U){var ae=h(),Q=ae[0],X=ae[ae.length-1],x=X<Q,P;return x&&(P=Q,Q=X,X=P),P=w(D,Q,X,U),P=P?P.range(Q,X+1):[],x?P.reverse():P},d.tickFormat=function(D,U){return U==null?B:c(U)},d.nice=function(D,U){var ae=h();return(D=w(D,ae[0],ae[ae.length-1],U))?h(y6(ae,D)):d},d.copy=function(){return qg(d,F6(e,t,r,n,i,a,s,l,c))},d}function aJ(){return Ll.apply(F6(Ml,w6,CR,Wg,M6,O6,C6,eg,B6).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function oJ(){var e=0,t=1,r,n,i,a,s=Ii,l=!1,c;function d(p){return isNaN(p=+p)?c:s(i===0?.5:(p=(a(p)-r)*i,l?Math.max(0,Math.min(1,p)):p))}return d.domain=function(p){return arguments.length?(r=a(e=+p[0]),n=a(t=+p[1]),i=r===n?0:1/(n-r),d):[e,t]},d.clamp=function(p){return arguments.length?(l=!!p,d):l},d.interpolator=function(p){return arguments.length?(s=p,d):s},d.unknown=function(p){return arguments.length?(c=p,d):c},function(p){return a=p,r=p(e),n=p(t),i=r===n?0:1/(n-r),d}}function U6(e,t){return t.domain(e.domain()).interpolator(e.interpolator()).clamp(e.clamp()).unknown(e.unknown())}function k6(){var e=Yv(oJ()(Ii));return e.copy=function(){return U6(e,k6())},d6.apply(e,arguments)}function sJ(){var e=0,t=.5,r=1,n,i,a,s,l,c=Ii,d,p=!1,h;function m(_){return isNaN(_=+_)?h:(_=.5+((_=+d(_))-i)*(_<i?s:l),c(p?Math.max(0,Math.min(1,_)):_))}return m.domain=function(_){return arguments.length?(n=d(e=+_[0]),i=d(t=+_[1]),a=d(r=+_[2]),s=n===i?0:.5/(i-n),l=i===a?0:.5/(a-i),m):[e,t,r]},m.clamp=function(_){return arguments.length?(p=!!_,m):p},m.interpolator=function(_){return arguments.length?(c=_,m):c},m.unknown=function(_){return arguments.length?(h=_,m):h},function(_){return d=_,n=_(e),i=_(t),a=_(r),s=n===i?0:.5/(i-n),l=i===a?0:.5/(a-i),m}}function z6(){var e=Yv(sJ()(Ii));return e.copy=function(){return U6(e,z6())},d6.apply(e,arguments)}function j6(e){let t,r=[];function n(i){return i??t}return n.invert=n,n.domain=n.range=i=>i?(r=i,i):r,n.unknown=i=>i?(t=i,i):t,n.copy=()=>j6().unknown(t),n}const{isNil:GA,isString:uJ,uniq:lJ}=yn,cJ=/^(?:(?!0000)[0-9]{4}([-/.]+)(?:(?:0?[1-9]|1[0-2])\1(?:0?[1-9]|1[0-9]|2[0-8])|(?:0?[13-9]|1[0-2])\1(?:29|30)|(?:0?[13578]|1[02])\1(?:31))|(?:[0-9]{2}(?:0[48]|[2468][048]|[13579][26])|(?:0[48]|[2468][048]|[13579][26])00)([-/.]?)0?2\2(?:29))(\s+([01]|([01][0-9]|2[0-3])):([0-9]|[0-5][0-9]):([0-9]|[0-5][0-9]))?$/,fJ={[Vr.LINEAR]:g6,[Vr.POWER]:T6,[Vr.LOG]:E6,[Vr.IDENTITY]:j6,[Vr.SEQUENTIAL]:k6,[Vr.TIME]:aJ,[Vr.QUANTILE]:S6,[Vr.QUANTIZE]:A6,[Vr.THRESHOLD]:b6,[Vr.CAT]:K0,[Vr.DIVERGING]:z6};class dJ{constructor(){L(this,"scaleOptions",{})}apply(t,{styleAttributeService:r}){var n=this;t.hooks.init.tapPromise("FeatureScalePlugin",Ze(function*(){var i;t.log(ri.ScaleInitStart,Ti.INIT),n.scaleOptions=t.getScaleOptions();const a=r.getLayerStyleAttributes(),s=(i=t.getSource())===null||i===void 0?void 0:i.data.dataArray;Array.isArray(s)&&s.length===0||(n.caculateScalesForAttributes(a||[],s),t.log(ri.ScaleInitEnd,Ti.INIT))})),t.hooks.beforeRenderData.tapPromise("FeatureScalePlugin",(function(){var i=Ze(function*(a){if(!a)return a;t.log(ri.ScaleInitStart,Ti.UPDATE),n.scaleOptions=t.getScaleOptions();const s=r.getLayerStyleAttributes(),l=t.getSource().data.dataArray;return Array.isArray(l)&&l.length===0||(n.caculateScalesForAttributes(s||[],l),t.log(ri.ScaleInitEnd,Ti.UPDATE),t.layerModelNeedUpdate=!0),!0});return function(a){return i.apply(this,arguments)}})()),t.hooks.beforeRender.tap("FeatureScalePlugin",()=>{if(t.layerModelNeedUpdate)return;this.scaleOptions=t.getScaleOptions();const i=r.getLayerStyleAttributes(),a=t.getSource().data.dataArray;if(!(Array.isArray(a)&&a.length===0)&&i){const s=i.filter(l=>l.needRescale);s.length&&this.caculateScalesForAttributes(s,a)}})}isNumber(t){return!isNaN(parseFloat(t))&&isFinite(t)}caculateScalesForAttributes(t,r){t.forEach(n=>{if(n.scale){const i=n.scale,a=n.scale.field;i.names=this.parseFields(GA(a)?[]:a);const s=[];i.names.forEach(l=>{var c;s.push(this.createScale(l,n.name,(c=n.scale)===null||c===void 0?void 0:c.values,r))}),s.some(l=>l.type===cd.VARIABLE)?(i.type=cd.VARIABLE,s.forEach(l=>{if(!i.callback&&i.values!=="text"){var c;switch((c=l.option)===null||c===void 0?void 0:c.type){case Vr.LOG:case Vr.LINEAR:case Vr.POWER:if(i.values&&i.values.length>2){const p=l.scale.ticks(i.values.length);l.scale.domain(p)}i.values?l.scale.range(i.values):l.scale.range(l.option.domain);break;case Vr.QUANTILE:case Vr.QUANTIZE:case Vr.THRESHOLD:l.scale.range(i.values);break;case Vr.IDENTITY:break;case Vr.CAT:i.values?l.scale.range(i.values):l.scale.range(l.option.domain);break;case Vr.DIVERGING:case Vr.SEQUENTIAL:l.scale.interpolator(uK(i.values));break}}if(i.values==="text"){var d;l.scale.range((d=l.option)===null||d===void 0?void 0:d.domain)}})):(i.type=cd.CONSTANT,i.defaultValues=s.map((l,c)=>l.scale(i.names[c]))),i.scalers=s.map(l=>({field:l.field,func:l.scale,option:l.option})),n.needRescale=!1}})}parseFields(t){return Array.isArray(t)?t:uJ(t)?t.split("*"):[t]}createScale(t,r,n,i){var a,s;const l=this.scaleOptions[r]&&((a=this.scaleOptions[r])===null||a===void 0?void 0:a.field)===t?this.scaleOptions[r]:this.scaleOptions[t],c={field:t,scale:void 0,type:cd.VARIABLE,option:l};if(!i||!i.length)return l&&l.type?c.scale=this.createDefaultScale(l):(c.scale=K0([t]),c.type=cd.CONSTANT),c;const d=(s=i.find(p=>!GA(p[t])))===null||s===void 0?void 0:s[t];if(this.isNumber(t)||GA(d)&&!l)c.scale=K0([t]),c.type=cd.CONSTANT;else{let p=l&&l.type||this.getDefaultType(d);n==="text"&&(p=Vr.CAT),n===void 0&&(p=Vr.IDENTITY);const h=this.createScaleConfig(p,t,l,i);c.scale=this.createDefaultScale(h),c.option=h}return c}getDefaultType(t){let r=Vr.LINEAR;return typeof t=="string"&&(r=cJ.test(t)?Vr.TIME:Vr.CAT),r}createScaleConfig(t,r,n,i){const a=Ge(Ge({},n),{},{type:t});if(a!=null&&a.domain)return a;let s=[];if(t===Vr.QUANTILE){const l=new Map;i?.forEach(c=>{l.set(c._id,c[r])}),s=Array.from(l.values())}else s=i?.map(l=>l[r])||[];if(t===Vr.CAT||t===Vr.IDENTITY)a.domain=lJ(s);else if(t===Vr.QUANTILE)a.domain=s;else if(t===Vr.DIVERGING){const l=$I(s),c=n?.neutral!==void 0?n?.neutral:(l[0]+l[1])/2;a.domain=[l[0],c,l[1]]}else a.domain=$I(s);return a}createDefaultScale({type:t,domain:r,unknown:n,clamp:i,nice:a}){const s=fJ[t]();return r&&s.domain&&s.domain(r),n&&s.unknown(n),i!==void 0&&s.clamp&&s.clamp(i),a!==void 0&&s.nice&&s.nice(a),s}}class hJ{apply(t){t.hooks.beforeRender.tap("LayerAnimateStylePlugin",()=>{t.animateStatus&&t.models.forEach(n=>{n.addUniforms(Ge({},t.layerModel.getAnimateUniforms()))})})}}let pJ=class{apply(t){t.hooks.afterInit.tap("LayerMaskPlugin",()=>{const{maskLayers:r,enableMask:n}=t.getLayerConfig();!t.tileLayer&&r&&r.length>0&&t.updateLayerConfig({mask:n})})}};class vJ{build(t){return Ze(function*(){t.prepareBuildModel(),yield t.buildModels()})()}initLayerModel(t){var r=this;return Ze(function*(){yield r.build(t),t.styleNeedUpdate=!1})()}prepareLayerModel(t){var r=this;return Ze(function*(){yield r.build(t),t.styleNeedUpdate=!1})()}apply(t){var r=this;t.hooks.init.tapPromise("LayerModelPlugin",Ze(function*(){if(t.getSource().isTile){t.prepareBuildModel();return}t.log(ri.BuildModelStart,Ti.INIT),yield r.initLayerModel(t),t.log(ri.BuildModelEnd,Ti.INIT)})),t.hooks.beforeRenderData.tapPromise("LayerModelPlugin",(function(){var n=Ze(function*(i){return!i||t.getSource().isTile?!1:(t.log(ri.BuildModelStart,Ti.UPDATE),yield r.prepareLayerModel(t),t.log(ri.BuildModelEnd,Ti.UPDATE),!0)});return function(i){return n.apply(this,arguments)}})())}}class mJ{apply(t){t.hooks.afterInit.tap("LayerStylePlugin",()=>{const{autoFit:r,fitBoundsOptions:n}=t.getLayerConfig();r&&t.fitBounds(n),t.styleNeedUpdate=!1})}}const _J=["type"],S4={directional:{lights:"u_DirectionalLights",num:"u_NumOfDirectionalLights"},spot:{lights:"u_SpotLights",num:"u_NumOfSpotLights"}},gJ={type:"directional",direction:[1,10.5,12],ambient:[.2,.2,.2],diffuse:[.6,.6,.6],specular:[.1,.1,.1]},yJ={direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0]},EJ={position:[0,0,0],direction:[0,0,0],ambient:[0,0,0],diffuse:[0,0,0],specular:[0,0,0],constant:1,linear:0,quadratic:0,angle:14,exponent:40,blur:5};function TJ(e){const t={u_DirectionalLights:new Array(3).fill(Ge({},yJ)),u_NumOfDirectionalLights:0,u_SpotLights:new Array(3).fill(Ge({},EJ)),u_NumOfSpotLights:0};return(!e||!e.length)&&(e=[gJ]),e.forEach(r=>{let{type:n="directional"}=r,i=ms(r,_J);const a=S4[n].lights,s=S4[n].num,l=t[s];t[a][l]=Ge(Ge({},t[a][l]),i),t[s]++}),t}class SJ{apply(t){t.hooks.beforeRender.tap("LightingPlugin",()=>{const{enableLighting:r}=t.getLayerConfig();r&&t.models.forEach(n=>n.addUniforms(Ge({},TJ())))})}}function H6(e){return e.map(t=>(typeof t=="string"&&(t=[t,{}]),t))}function V6(e,t,r,n){const i=e.multiPassRenderer;return i.add(n("render")),H6(t).forEach(a=>{const[s,l]=a;i.add(r(s),l)}),i.add(r("copy")),i}class AJ{constructor(){L(this,"enabled",void 0)}apply(t,{rendererService:r,postProcessingPassFactory:n,normalPassFactory:i}){t.hooks.init.tapPromise("MultiPassRendererPlugin",()=>{const{enableMultiPassRenderer:a,passes:s=[]}=t.getLayerConfig();this.enabled=!!a&&t.getLayerConfig().enableMultiPassRenderer!==!1,this.enabled&&(t.multiPassRenderer=V6(t,s,n,i),t.multiPassRenderer.setRenderFlag(!0))}),t.hooks.beforeRender.tap("MultiPassRendererPlugin",()=>{if(this.enabled){const{width:a,height:s}=r.getViewportSize();t.multiPassRenderer.resize(a,s)}})}}const El={POSITION:0,POSITION_64LOW:1,COLOR:2,PICKING_COLOR:3,STROKE:4,OPACITY:5,OFFSETS:6,ROTATION:7,MAX:8};function bJ(e){switch(e){case"rotation":return{name:"Rotation",type:Dt.Attribute,descriptor:{name:"a_Rotation",shaderLocation:El.ROTATION,buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:1,update:t=>{const{rotation:r=0}=t;return Array.isArray(r)?[r[0]]:[r]}}};case"stroke":return{name:"stroke",type:Dt.Attribute,descriptor:{name:"a_Stroke",shaderLocation:El.STROKE,buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:4,update:t=>{const{stroke:r=[1,1,1,1]}=t;return r}}};case"opacity":return{name:"opacity",type:Dt.Attribute,descriptor:{name:"a_Opacity",shaderLocation:El.OPACITY,buffer:{usage:N.STATIC_DRAW,data:[],type:N.FLOAT},size:1,update:t=>{const{opacity:r=1}=t;return[r]}}};case"offsets":return{name:"offsets",type:Dt.Attribute,descriptor:{name:"a_Offsets",shaderLocation:El.OFFSETS,buffer:{usage:N.STATIC_DRAW,data:[],type:N.FLOAT},size:2,update:t=>{const{offsets:r}=t;return r}}};default:return}}const{isNumber:xJ}=yn,dd={ENCODE:1,HIGHLIGHT:2};class RJ{constructor(){L(this,"pickingUniformMap",void 0)}pickOption2Array(){const t=[];return this.pickingUniformMap.forEach(r=>{xJ(r)?t.push(r):t.push(...r)}),t}updatePickOption(t,r){Object.keys(t).forEach(s=>{this.pickingUniformMap.set(s,t[s])});const n=r.getLayerConfig().pickingBuffer||0,i=Number(r.getShaderPickStat());this.pickingUniformMap.set("u_PickingBuffer",n),this.pickingUniformMap.set("u_shaderPick",i),r.getPickingUniformBuffer().subData({offset:0,data:this.pickOption2Array()})}apply(t,{styleAttributeService:r}){this.pickingUniformMap=new Map([["u_HighlightColor",[1,0,0,1]],["u_SelectColor",[1,0,0,1]],["u_PickingColor",[0,0,0]],["u_PickingStage",0],["u_CurrentSelectedId",[0,0,0]],["u_PickingThreshold",10],["u_PickingBuffer",0],["u_shaderPick",0],["u_activeMix",0]]),t.hooks.init.tapPromise("PixelPickingPlugin",()=>{const{enablePicking:n}=t.getLayerConfig();r.registerStyleAttribute({name:"pickingColor",type:Dt.Attribute,descriptor:{name:"a_PickingColor",shaderLocation:El.PICKING_COLOR,buffer:{data:[],type:N.FLOAT},size:3,update:i=>{const{id:a}=i;return n?Hd(a):[0,0,0]}}})}),t.hooks.beforePickingEncode.tap("PixelPickingPlugin",()=>{const{enablePicking:n}=t.getLayerConfig();n&&t.isVisible()&&(this.updatePickOption({u_PickingStage:dd.ENCODE},t),t.models.forEach(i=>i.addUniforms({u_PickingStage:dd.ENCODE})))}),t.hooks.afterPickingEncode.tap("PixelPickingPlugin",()=>{const{enablePicking:n}=t.getLayerConfig();n&&t.isVisible()&&(this.updatePickOption({u_PickingStage:dd.HIGHLIGHT},t),t.models.forEach(i=>i.addUniforms({u_PickingStage:dd.HIGHLIGHT})))}),t.hooks.beforeHighlight.tap("PixelPickingPlugin",n=>{const{highlightColor:i,activeMix:a=0}=t.getLayerConfig(),s=typeof i=="string"?$r(i):i||[1,0,0,1];t.updateLayerConfig({pickedFeatureID:Dc(new Uint8Array(n))});const l={u_PickingStage:dd.HIGHLIGHT,u_PickingColor:n,u_HighlightColor:s.map(c=>c*255),u_activeMix:a};this.updatePickOption(l,t),t.models.forEach(c=>c.addUniforms(l))}),t.hooks.beforeSelect.tap("PixelPickingPlugin",n=>{const{selectColor:i,selectMix:a=0}=t.getLayerConfig(),s=typeof i=="string"?$r(i):i||[1,0,0,1];t.updateLayerConfig({pickedFeatureID:Dc(new Uint8Array(n))});const l={u_PickingStage:dd.HIGHLIGHT,u_PickingColor:n,u_HighlightColor:s.map(c=>c*255),u_activeMix:a,u_CurrentSelectedId:n,u_SelectColor:s.map(c=>c*255)};this.updatePickOption(l,t),t.models.forEach(c=>c.addUniforms(l))})}}const CJ=["mvt","geojsonvt","testTile"];function OJ(e){const t=e.getSource();return CJ.includes(t.parser.type)}class MJ{apply(t,{styleAttributeService:r}){t.hooks.init.tapPromise("RegisterStyleAttributePlugin",()=>{OJ(t)||this.registerBuiltinAttributes(r,t)})}registerBuiltinAttributes(t,r){if(r.type==="MaskLayer"){this.registerPositionAttribute(t);return}this.registerPositionAttribute(t),this.registerColorAttribute(t)}registerPositionAttribute(t){t.registerStyleAttribute({name:"position",type:Dt.Attribute,descriptor:{name:"a_Position",shaderLocation:El.POSITION,buffer:{data:[],type:N.FLOAT},size:3,update:(r,n,i)=>i.length===2?[i[0],i[1],0]:[i[0],i[1],i[2]]}})}registerColorAttribute(t){t.registerStyleAttribute({name:"color",type:Dt.Attribute,descriptor:{name:"a_Color",shaderLocation:El.COLOR,buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:4,update:r=>{const{color:n}=r;return!n||!n.length?[1,1,1,1]:n}}})}}class wJ{constructor(){L(this,"cameraService",void 0),L(this,"coordinateSystemService",void 0),L(this,"rendererService",void 0),L(this,"mapService",void 0),L(this,"layerService",void 0)}apply(t,{rendererService:r,mapService:n,layerService:i,coordinateSystemService:a,cameraService:s}){this.rendererService=r,this.mapService=n,this.layerService=i,this.coordinateSystemService=a,this.cameraService=s;let l;this.rendererService.uniformBuffers[0]||(l=this.rendererService.createBuffer({data:new Float32Array(96),isUBO:!0,label:"renderUniformBuffer"}),this.rendererService.uniformBuffers[0]=l),t.hooks.beforeRender.tap("ShaderUniformPlugin",()=>{const d=t.getRelativeOrigin&&t.getRelativeOrigin()||[0,0];this.coordinateSystemService.refresh(),d&&(Math.abs(d[0])>1e-4||Math.abs(d[1])>1e-4)&&this.coordinateSystemService.getCoordinateSystem()===2&&this.coordinateSystemService.setViewportCenter(d);const{width:h,height:m}=this.rendererService.getViewportSize(),{data:_,uniforms:y}=this.generateUBO(h,m,d);this.layerService.alreadyInRendering&&this.rendererService.uniformBuffers[0]&&this.rendererService.uniformBuffers[0].subData({offset:0,data:_}),this.rendererService.queryVerdorInfo()==="WebGL1"&&t.models.forEach(T=>{T.addUniforms(Ge(Ge({},y),{},{u_PickingBuffer:t.getLayerConfig().pickingBuffer||0,u_shaderPick:Number(t.getShaderPickStat())}))})})}generateUBO(t,r,n){const i=this.cameraService.getProjectionMatrix(),a=this.cameraService.getViewMatrix(),s=this.cameraService.getViewProjectionMatrix(),l=this.cameraService.getModelMatrix(),c=this.coordinateSystemService.getViewportCenterProjection(),d=this.coordinateSystemService.getPixelsPerDegree(),p=this.cameraService.getZoom(),h=this.coordinateSystemService.getPixelsPerDegree2(),m=this.cameraService.getZoomScale(),_=this.coordinateSystemService.getPixelsPerMeter(),y=this.coordinateSystemService.getCoordinateSystem(),E=this.cameraService.getCameraPosition(),T=window.devicePixelRatio,A=this.coordinateSystemService.getViewportCenter(),b=[t,r],R=this.cameraService.getFocalDistance(),M=n&&n.length>=2?[n[0],n[1]]:[0,0];return{data:[...a,...i,...s,...l,...c,...d,p,...h,m,..._,y,...E,T,...A,...b,R,...M,0],uniforms:{[xc.ProjectionMatrix]:i,[xc.ViewMatrix]:a,[xc.ViewProjectionMatrix]:s,[xc.Zoom]:p,[xc.ZoomScale]:m,[xc.FocalDistance]:R,[xc.CameraPosition]:E,[ld.CoordinateSystem]:y,[ld.ViewportCenter]:A,[ld.ViewportCenterProjection]:c,[ld.PixelsPerDegree]:d,[ld.PixelsPerDegree2]:h,[ld.PixelsPerMeter]:_,u_ViewportSize:b,u_ModelMatrix:l,u_DevicePixelRatio:T,u_RelativeOrigin:M}}}}class NJ{apply(t){t.hooks.beforeRender.tap("UpdateModelPlugin",()=>{t.layerModel&&t.layerModel.needUpdate().then(r=>{r&&t.renderLayers()})}),t.hooks.afterRender.tap("UpdateModelPlugin",()=>{t.layerModelNeedUpdate=!1})}}class IJ{apply(t,{styleAttributeService:r}){t.hooks.init.tapPromise("UpdateStyleAttributePlugin",()=>{this.initStyleAttribute(t,{styleAttributeService:r})}),t.hooks.beforeRender.tap("UpdateStyleAttributePlugin",()=>{t.layerModelNeedUpdate||t.inited&&this.updateStyleAttribute(t,{styleAttributeService:r})})}updateStyleAttribute(t,{styleAttributeService:r}){const n=r.getLayerStyleAttributes()||[],i=r.getLayerStyleAttribute("filter");if(i&&i.needRegenerateVertices){t.layerModelNeedUpdate=!0,n.forEach(a=>a.needRegenerateVertices=!1);return}n.filter(a=>a.needRegenerateVertices).forEach(a=>{r.updateAttributeByFeatureRange(a.name,t.getEncodedData(),a.featureRange.startIndex,a.featureRange.endIndex,t),a.needRegenerateVertices=!1})}initStyleAttribute(t,{styleAttributeService:r}){(r.getLayerStyleAttributes()||[]).filter(i=>i.needRegenerateVertices).forEach(i=>{r.updateAttributeByFeatureRange(i.name,t.getEncodedData(),i.featureRange.startIndex,i.featureRange.endIndex),i.needRegenerateVertices=!1})}}function PJ(){return[new tK,new MJ,new dJ,new eK,new mJ,new pJ,new IJ,new NJ,new AJ,new wJ,new hJ,new SJ,new RJ,new vJ]}const X6={[ml.additive]:{enable:!0,func:{srcRGB:N.ONE,dstRGB:N.ONE,srcAlpha:1,dstAlpha:1}},[ml.none]:{enable:!1},[ml.normal]:{enable:!0,func:{srcRGB:N.SRC_ALPHA,dstRGB:N.ONE_MINUS_SRC_ALPHA,srcAlpha:1,dstAlpha:1}},[ml.subtractive]:{enable:!0,func:{srcRGB:N.ONE,dstRGB:N.ONE,srcAlpha:N.ZERO,dstAlpha:N.ONE_MINUS_SRC_COLOR},equation:{rgb:N.FUNC_SUBTRACT,alpha:N.FUNC_SUBTRACT}},[ml.max]:{enable:!0,func:{srcRGB:N.ONE,dstRGB:N.ONE},equation:{rgb:N.MAX_EXT}},[ml.min]:{enable:!0,func:{srcRGB:N.ONE,dstRGB:N.ONE},equation:{rgb:N.MIN_EXT}}};class DJ{constructor(t){L(this,"layer",void 0),this.layer=t}pickRender(t){const n=this.layer.getContainer().layerService,i=this.layer;if(i.tileLayer)return i.tileLayer.pickRender(t);i.hooks.beforePickingEncode.call(),n.renderTileLayerMask(i),i.renderModels({ispick:!0}),i.hooks.afterPickingEncode.call()}pick(t,r){var n=this;return Ze(function*(){const a=n.layer.getContainer().pickingService;return t.type==="RasterLayer"?n.pickRasterLayer(t,r):(n.pickRender(r),a.pickFromPickingFBO(t,r))})()}pickRasterLayer(t,r,n){const i=this.layer.getContainer(),a=i.pickingService,s=i.mapService,l=this.layer.getSource().extent,c=UV(r.lngLat,l),d={x:r.x,y:r.y,type:r.type,lngLat:r.lngLat,target:r,rasterValue:null},p=n||t;if(c){const h=this.readRasterValue(t,l,s,r.x,r.y);return d.rasterValue=h,a.triggerHoverOnLayer(p,d),!0}else return d.type=r.type==="mousemove"?"mouseout":"un"+r.type,a.triggerHoverOnLayer(p,Ge(Ge({},d),{},{type:"unpick"})),a.triggerHoverOnLayer(p,d),!1}readRasterValue(t,r,n,i,a){const s=t.getSource().data.dataArray[0],[l=0,c=0,d=10,p=-10]=r,h=n.lngLatToContainer([l,c]),m=n.lngLatToContainer([d,p]),_=m.x-h.x,y=h.y-m.y,E=[(i-h.x)/_,(a-m.y)/y],T=s.width||1,A=s.height||1,b=Math.floor(E[0]*T),R=Math.floor(E[1]*A),M=Math.max(0,R-1)*T+b;return s.data[M]}selectFeature(t){const r=this.layer,[n,i,a]=t;r.hooks.beforeSelect.call([n,i,a])}highlightPickedFeature(t){const[r,n,i]=t;this.layer.hooks.beforeHighlight.call([r,n,i])}getFeatureById(t){return this.layer.getSource().getFeatureById(t)}}class LJ{constructor(t){L(this,"layer",void 0),L(this,"rendererService",void 0),L(this,"colorTexture",void 0),L(this,"key",void 0),this.layer=t;const r=this.layer.getContainer();this.rendererService=r.rendererService}getColorTexture(t,r){const n=this.getTextureKey(t,r);return this.key===n?this.colorTexture:(this.createColorTexture(t,r),this.key=n,this.colorTexture)}createColorTexture(t,r){const{createTexture2D:n}=this.rendererService,i=this.getColorRampBar(t,r),a=n({data:new Uint8Array(i.data),width:i.width,height:i.height,flipY:!1,unorm:!0});return this.colorTexture=a,a}setColorTexture(t,r,n){this.key=this.getTextureKey(r,n),this.colorTexture=t}destroy(){var t;(t=this.colorTexture)===null||t===void 0||t.destroy()}getColorRampBar(t,r){switch(t.type){case"cat":return fz(t);case"quantize":return dz(t);case"custom":return hz(t,r);case"linear":return cz(t,r);default:return lz(t)}}getTextureKey(t,r){var n;return`${t.colors.join("_")}_${t==null||(n=t.positions)===null||n===void 0?void 0:n.join("_")}_${t.type}_${r?.join("_")}`}}const BJ=["passes"],FJ=["moduleName","vertexShader","fragmentShader","defines","inject","triangulation","styleOption","pickingEnabled"],{isEqual:qA,isFunction:A4,isNumber:b4,isObject:yi,isPlainObject:UJ,isUndefined:kJ}=yn;let x4=0;class ah extends Oa.EventEmitter{get shaderModuleService(){return this.container.shaderModuleService}get cameraService(){return this.container.cameraService}get coordinateService(){return this.container.coordinateSystemService}get iconService(){return this.container.iconService}get fontService(){return this.container.fontService}get pickingService(){return this.container.pickingService}get rendererService(){return this.container.rendererService}get layerService(){return this.container.layerService}get debugService(){return this.container.debugService}get interactionService(){return this.container.interactionService}get mapService(){var t;return(t=this.container)===null||t===void 0?void 0:t.mapService}get normalPassFactory(){return this.container.normalPassFactory}constructor(t={}){super(),L(this,"id",`${x4++}`),L(this,"name",`${x4}`),L(this,"parent",void 0),L(this,"coordCenter",void 0),L(this,"type",void 0),L(this,"visible",!0),L(this,"zIndex",0),L(this,"minZoom",void 0),L(this,"maxZoom",void 0),L(this,"inited",!1),L(this,"layerModelNeedUpdate",!1),L(this,"pickedFeatureID",null),L(this,"selectedFeatureID",null),L(this,"styleNeedUpdate",!1),L(this,"rendering",void 0),L(this,"forceRender",!1),L(this,"clusterZoom",0),L(this,"layerType",void 0),L(this,"triangulation",void 0),L(this,"layerPickService",void 0),L(this,"textureService",void 0),L(this,"defaultSourceConfig",{data:[],options:{parser:{type:"json"}}}),L(this,"dataState",{dataSourceNeedUpdate:!1,dataMappingNeedUpdate:!1,filterNeedUpdate:!1,featureScaleNeedUpdate:!1,StyleAttrNeedUpdate:!1}),L(this,"hooks",{init:new FW,afterInit:new ZN,beforeRender:new ZN,beforeRenderData:new UW,afterRender:new os,beforePickingEncode:new os,afterPickingEncode:new os,beforeHighlight:new os(["pickedColor"]),afterHighlight:new os,beforeSelect:new os(["pickedColor"]),afterSelect:new os,beforeDestroy:new os,afterDestroy:new os}),L(this,"models",[]),L(this,"multiPassRenderer",void 0),L(this,"plugins",void 0),L(this,"startInit",!1),L(this,"sourceOption",void 0),L(this,"layerModel",void 0),L(this,"shapeOption",void 0),L(this,"tileLayer",void 0),L(this,"layerChildren",[]),L(this,"masks",[]),L(this,"configService",YB),L(this,"styleAttributeService",void 0),L(this,"layerSource",void 0),L(this,"postProcessingPassFactory",void 0),L(this,"animateOptions",{enable:!1}),L(this,"relativeOrigin",[0,0]),L(this,"originalExtent",[0,0,0,0]),L(this,"absoluteDataArray",[]),L(this,"container",void 0),L(this,"encodedData",void 0),L(this,"currentPickId",null),L(this,"rawConfig",void 0),L(this,"needUpdateConfig",void 0),L(this,"encodeStyleAttribute",{}),L(this,"enableShaderEncodeStyles",[]),L(this,"enableDataEncodeStyles",[]),L(this,"pendingStyleAttributes",[]),L(this,"scaleOptions",{}),L(this,"animateStartTime",void 0),L(this,"animateStatus",!1),L(this,"isDestroyed",!1),L(this,"uniformBuffers",[]),L(this,"encodeDataLength",0),L(this,"sourceEvent",()=>{this.dataState.dataSourceNeedUpdate=!0,this.processRelativeCoordinates();const r=this.getLayerConfig();r&&r.autoFit&&this.fitBounds(r.fitBoundsOptions),this.layerSource.getSourceCfg().autoRender&&setTimeout(()=>{this.reRender()},10)}),this.name=t.name||this.id,this.zIndex=t.zIndex||0,this.rawConfig=t,this.masks=t.maskLayers||[]}addMask(t){this.masks.push(t),this.updateLayerConfig({maskLayers:this.masks}),this.enableMask()}removeMask(t){const r=this.masks.indexOf(t);r>-1&&this.masks.splice(r,1),this.updateLayerConfig({maskLayers:this.masks})}disableMask(){this.updateLayerConfig({enableMask:!1})}enableMask(){this.updateLayerConfig({enableMask:!0})}addMaskLayer(t){this.masks.push(t)}removeMaskLayer(t){const r=this.masks.indexOf(t);r>-1&&this.masks.splice(r,1),t.destroy()}getAttribute(t){return this.styleAttributeService.getLayerStyleAttribute(t)}getLayerConfig(){return this.configService.getLayerConfig(this.id)}updateLayerConfig(t){if(Object.keys(t).map(r=>{r in this.rawConfig&&(this.rawConfig[r]=t[r])}),!this.startInit)this.needUpdateConfig=Ge(Ge({},this.needUpdateConfig),t);else{const r=this.container.id;this.configService.setLayerConfig(r,this.id,Ge(Ge(Ge({},this.configService.getLayerConfig(this.id)),this.needUpdateConfig),t)),this.needUpdateConfig={}}}setContainer(t){this.container=t}getContainer(){return this.container}addPlugin(t){return this.plugins.push(t),this}init(){var t=this;return Ze(function*(){const r=t.container.id;t.startInit=!0,t.configService.setLayerConfig(r,t.id,t.rawConfig),t.layerType=t.rawConfig.layerType;const{enableMultiPassRenderer:n,passes:i}=t.getLayerConfig();n&&i!==null&&i!==void 0&&i.length&&i.length>0&&t.mapService.on("mapAfterFrameChange",()=>{t.renderLayers()}),t.postProcessingPassFactory=t.container.postProcessingPassFactory,t.styleAttributeService=t.container.styleAttributeService,n&&(t.multiPassRenderer=t.container.multiPassRenderer,t.multiPassRenderer.setLayer(t)),t.pendingStyleAttributes.forEach(({attributeName:a,attributeField:s,attributeValues:l,updateOptions:c})=>{t.styleAttributeService.updateStyleAttribute(a,{scale:Ge({field:s},t.splitValuesAndCallbackInAttribute(l,s?void 0:t.getLayerConfig()[a]))},c)}),t.pendingStyleAttributes=[],t.plugins=PJ();for(const a of t.plugins)a.apply(t,t.container);t.layerPickService=new DJ(t),t.textureService=new LJ(t),t.log(ri.LayerInitStart),yield t.hooks.init.promise(),t.log(ri.LayerInitEnd),t.inited=!0,t.emit("inited",{target:t,type:"inited"}),t.emit("add",{target:t,type:"add"}),t.hooks.afterInit.call()})()}log(t,r="init"){var n;if(this.tileLayer||this.isTileLayer)return;const i=`${this.id}.${r}.${t}`,a={id:this.id,type:this.type};(n=this.debugService)===null||n===void 0||n.log(i,a)}updateModelData(t){t.attributes&&t.elements?this.models.map(r=>{r.updateAttributesAndElements(t.attributes,t.elements)}):console.warn("data error")}setLayerPickService(t){this.layerPickService=t}prepareBuildModel(){Object.keys(this.needUpdateConfig||{}).length!==0&&this.updateLayerConfig({});const{animateOption:t}=this.getLayerConfig();t!=null&&t.enable&&(this.layerService.startAnimate(),this.animateStatus=!0)}color(t,r,n){return this.updateStyleAttribute("color",t,r,n),this}texture(t,r,n){return this.updateStyleAttribute("texture",t,r,n),this}rotate(t,r,n){return this.updateStyleAttribute("rotate",t,r,n),this}size(t,r,n){return this.updateStyleAttribute("size",t,r,n),this}filter(t,r,n){const i=this.updateStyleAttribute("filter",t,r,n);return this.dataState.dataSourceNeedUpdate=i&&this.inited,this}shape(t,r,n){this.shapeOption={field:t,values:r};const i=this.updateStyleAttribute("shape",t,r,n);return this.dataState.dataSourceNeedUpdate=i&&this.inited,this}label(t,r,n){return this.pendingStyleAttributes.push({attributeName:"label",attributeField:t,attributeValues:r,updateOptions:n}),this}animate(t){let r={};return yi(t)?(r.enable=!0,r=Ge(Ge({},r),t)):r.enable=t,this.updateLayerConfig({animateOption:r}),this}source(t,r){return t?.type==="source"?(this.setSource(t),this):(this.sourceOption={data:t,options:r},this.clusterZoom=0,this)}setData(t,r){return this.inited?(this.dataUpdatelog(),this.layerSource.setData(t,r)):this.on("inited",()=>{this.dataUpdatelog(),this.layerSource.setData(t,r)}),this}dataUpdatelog(){this.log(ri.SourceInitStart,Ti.UPDATE),this.layerSource.once("update",()=>{this.log(ri.SourceInitEnd,Ti.UPDATE)})}style(t){const{passes:r}=t,n=ms(t,BJ);r&&H6(r).forEach(a=>{const s=this.multiPassRenderer.getPostProcessor().getPostProcessingPassByName(a[0]);s&&s.updateOptions(a[1])}),n.borderColor&&(n.stroke=n.borderColor),n.borderWidth&&(n.strokeWidth=n.borderWidth);const i=n;return Object.keys(n).forEach(a=>{const s=n[a];Array.isArray(s)&&s.length===2&&!b4(s[0])&&!b4(s[1])&&(i[a]={field:s[0],value:s[1]})}),this.encodeStyle(i),this.updateLayerConfig(i),this}encodeStyle(t){Object.keys(t).forEach(r=>{[...this.enableShaderEncodeStyles,...this.enableDataEncodeStyles].includes(r)&&UJ(t[r])&&(t[r].field||t[r].value)&&!qA(this.encodeStyleAttribute[r],t[r])?(this.encodeStyleAttribute[r]=t[r],this.updateStyleAttribute(r,t[r].field,t[r].value),this.inited&&(this.dataState.dataMappingNeedUpdate=!0)):this.encodeStyleAttribute[r]&&(delete this.encodeStyleAttribute[r],this.dataState.dataSourceNeedUpdate=!0)})}scale(t,r){const n=Ge({},this.scaleOptions);if(yi(t)?this.scaleOptions=Ge(Ge({},this.scaleOptions),t):this.scaleOptions[t]=r,this.styleAttributeService&&!qA(n,this.scaleOptions)){const i=yi(t)?t:{[t]:r};this.styleAttributeService.updateScaleAttribute(i)}return this}renderLayers(){this.rendering=!0,this.layerService.reRender(),this.rendering=!1}prerender(){}render(t={}){return this.tileLayer?(this.tileLayer.render(),this):(this.layerService.beforeRenderData(this),this.encodeDataLength<=0&&!this.forceRender?this:(this.renderModels(t),this))}renderMultiPass(){var t=this;return Ze(function*(){t.encodeDataLength<=0&&!t.forceRender||(t.multiPassRenderer&&t.multiPassRenderer.getRenderFlag()?yield t.multiPassRenderer.render():t.renderModels())})()}active(t){const r={};return r.enableHighlight=yi(t)?!0:t,yi(t)?(r.enableHighlight=!0,t.color&&(r.highlightColor=t.color),t.mix&&(r.activeMix=t.mix)):r.enableHighlight=!!t,this.updateLayerConfig(r),this}setActive(t,r){if(yi(t)){const{x:n=0,y:i=0}=t;this.updateLayerConfig({highlightColor:yi(r)?r.color:this.getLayerConfig().highlightColor,activeMix:yi(r)?r.mix:this.getLayerConfig().activeMix}),this.pick({x:n,y:i})}else this.updateLayerConfig({pickedFeatureID:t,highlightColor:yi(r)?r.color:this.getLayerConfig().highlightColor,activeMix:yi(r)?r.mix:this.getLayerConfig().activeMix}),this.hooks.beforeHighlight.call(Hd(t)).then(()=>{setTimeout(()=>{this.reRender()},1)})}select(t){const r={};return r.enableSelect=yi(t)?!0:t,yi(t)?(r.enableSelect=!0,t.color&&(r.selectColor=t.color),t.mix&&(r.selectMix=t.mix)):r.enableSelect=!!t,this.updateLayerConfig(r),this}setSelect(t,r){if(yi(t)){const{x:n=0,y:i=0}=t;this.updateLayerConfig({selectColor:yi(r)?r.color:this.getLayerConfig().selectColor,selectMix:yi(r)?r.mix:this.getLayerConfig().selectMix}),this.pick({x:n,y:i})}else this.updateLayerConfig({pickedFeatureID:t,selectColor:yi(r)?r.color:this.getLayerConfig().selectColor,selectMix:yi(r)?r.mix:this.getLayerConfig().selectMix}),this.hooks.beforeSelect.call(Hd(t)).then(()=>{setTimeout(()=>{this.reRender()},1)})}setBlend(t){return this.updateLayerConfig({blend:t}),this.reRender(),this}show(){return this.updateLayerConfig({visible:!0}),this.reRender(),this.emit("show"),this}hide(){return this.updateLayerConfig({visible:!1}),this.reRender(),this.emit("hide"),this}setIndex(t){return this.zIndex=t,this.layerService.updateLayerRenderList(),this.layerService.renderLayers(),this}setCurrentPickId(t){this.currentPickId=t}getCurrentPickId(){return this.currentPickId}setCurrentSelectedId(t){this.selectedFeatureID=t}getCurrentSelectedId(){return this.selectedFeatureID}isVisible(){const t=this.mapService.getZoom(),{visible:r,minZoom:n=-1/0,maxZoom:i=1/0}=this.getLayerConfig();return!!r&&t>=n&&t<i}setMultiPass(t,r){if(this.updateLayerConfig({enableMultiPassRenderer:t}),r&&this.updateLayerConfig({passes:r}),t){const{passes:n=[]}=this.getLayerConfig();this.multiPassRenderer=V6(this,n,this.postProcessingPassFactory,this.normalPassFactory),this.multiPassRenderer.setRenderFlag(!0);const{width:i,height:a}=this.rendererService.getViewportSize();this.multiPassRenderer.resize(i,a)}return this}setMinZoom(t){return this.updateLayerConfig({minZoom:t}),this}getMinZoom(){const{minZoom:t}=this.getLayerConfig();return t}getMaxZoom(){const{maxZoom:t}=this.getLayerConfig();return t}get(t){return this.getLayerConfig()[t]}setMaxZoom(t){return this.updateLayerConfig({maxZoom:t}),this}setAutoFit(t){return this.updateLayerConfig({autoFit:t}),this}fitBounds(t){if(!this.inited)return this.updateLayerConfig({autoFit:!0}),this;const n=this.getSource().extent;return n.some(a=>Math.abs(a)===1/0)?this:(this.mapService.fitBounds([[n[0],n[1]],[n[2],n[3]]],t),this)}destroy(t=!0){var r,n,i,a,s;if(this.isDestroyed)return;(r=this.layerModel)===null||r===void 0||r.uniformBuffers.forEach(c=>{c.destroy()}),this.layerChildren.map(c=>c.destroy(!1)),this.layerChildren=[];const{maskfence:l}=this.getLayerConfig();l&&(this.masks.map(c=>c.destroy(!1)),this.masks=[]),this.hooks.beforeDestroy.call(),this.layerSource.off("update",this.sourceEvent),(n=this.multiPassRenderer)===null||n===void 0||n.destroy(),this.textureService.destroy(),this.styleAttributeService.clearAllAttributes(),this.hooks.afterDestroy.call(),(i=this.layerModel)===null||i===void 0||i.clearModels(t),(a=this.tileLayer)===null||a===void 0||a.destroy(),this.models=[],(s=this.debugService)===null||s===void 0||s.removeLog(this.id),this.emit("remove",{target:this,type:"remove"}),this.emit("destroy",{target:this,type:"destroy"}),this.removeAllListeners(),this.isDestroyed=!0}clear(){this.styleAttributeService.clearAllAttributes()}clearModels(){var t;this.models.forEach(r=>r.destroy()),(t=this.layerModel)===null||t===void 0||t.clearModels(),this.models=[]}isDirty(){return!!(this.styleAttributeService.getLayerStyleAttributes()||[]).filter(t=>t.needRescale||t.needRemapping||t.needRegenerateVertices).length}setSource(t){if(this.layerSource&&this.layerSource.off("update",this.sourceEvent),this.layerSource=t,this.clusterZoom=0,this.inited&&this.layerSource.cluster){const r=this.mapService.getZoom();this.layerSource.updateClusterData(r)}this.layerSource.inited&&this.sourceEvent(),this.layerSource.on("update",({type:r})=>{if(this.coordCenter===void 0){const n=this.layerSource.center;this.coordCenter=n}if(r==="update"){if(this.tileLayer){this.tileLayer.reload();return}this.sourceEvent()}r==="inited"&&this.processRelativeCoordinates()})}getSource(){return this.layerSource}getScaleOptions(){return this.scaleOptions}setEncodedData(t){this.encodedData=t,this.encodeDataLength=t.length}getEncodedData(){return this.encodedData}getScale(t){return this.styleAttributeService.getLayerAttributeScale(t)}getLegend(t){var r,n,i;const a=this.styleAttributeService.getLayerStyleAttribute(t);return{type:(n=((a==null||(r=a.scale)===null||r===void 0?void 0:r.scalers)||[])[0])===null||n===void 0||(n=n.option)===null||n===void 0?void 0:n.type,field:a==null||(i=a.scale)===null||i===void 0?void 0:i.field,items:this.getLegendItems(t)}}getLegendItems(t){const r=this.styleAttributeService.getLayerAttributeScale(t);return r?r.invertExtent?r.range().map(i=>({value:r.invertExtent(i),[t]:i})):r.ticks?r.ticks().map(i=>({value:i,[t]:r(i)})):r!=null&&r.domain?r.domain().filter(i=>!kJ(i)).map(i=>({value:i,[t]:r(i)})):[]:[]}pick({x:t,y:r}){this.interactionService.triggerHover({x:t,y:r})}boxSelect(t,r){this.pickingService.boxPickLayer(this,t,r)}buildLayerModel(t){var r=this;return Ze(function*(){const{moduleName:n,vertexShader:i,fragmentShader:a,defines:s,inject:l,triangulation:c,styleOption:d,pickingEnabled:p=!0}=t,h=ms(t,FJ);r.shaderModuleService.registerModule(n,{vs:i,fs:a,defines:s,inject:l});const{vs:m,fs:_,uniforms:y}=r.shaderModuleService.getModule(n),{createModel:E}=r.rendererService;return new Promise(T=>{const{attributes:A,elements:b,count:R}=r.styleAttributeService.createAttributesAndIndices(r.encodedData,c,d,r),M=[...r.layerModel.uniformBuffers,...r.rendererService.uniformBuffers];p&&M.push(r.getPickingUniformBuffer());const B=Ge({attributes:A,uniforms:y,fs:_,vs:m,elements:b,blend:X6[ml.normal],uniformBuffers:M,textures:r.layerModel.textures},h);R&&(B.count=R);const w=E(B);T(w)})})()}createAttributes(t){const{triangulation:r}=t,{attributes:n}=this.styleAttributeService.createAttributes(this.encodedData,r);return n}getTime(){return this.layerService.clock.getDelta()}setAnimateStartTime(){this.animateStartTime=this.layerService.clock.getElapsedTime()}stopAnimate(){this.animateStatus&&(this.layerService.stopAnimate(),this.animateStatus=!1,this.updateLayerConfig({animateOption:{enable:!1}}))}getLayerAnimateTime(){return this.layerService.clock.getElapsedTime()-this.animateStartTime}needPick(t){const{enableHighlight:r=!0,enableSelect:n=!0}=this.getLayerConfig();let i=this.eventNames().indexOf(t)!==-1||this.eventNames().indexOf("un"+t)!==-1;return(t==="click"||t==="dblclick")&&n&&(i=!0),t==="mousemove"&&(r||this.eventNames().indexOf("mouseenter")!==-1||this.eventNames().indexOf("unmousemove")!==-1||this.eventNames().indexOf("mouseout")!==-1)&&(i=!0),this.isVisible()&&i}buildModels(){return Ze(function*(){throw new Error("Method not implemented.")})()}rebuildModels(){var t=this;return Ze(function*(){yield t.buildModels()})()}renderMulPass(t){return Ze(function*(){yield t.render()})()}renderModels(t={}){return this.encodeDataLength<=0&&!this.forceRender?(this.clearModels(),this):(this.hooks.beforeRender.call(),this.models.forEach(r=>{r.draw({uniforms:this.layerModel.getUninforms(),blend:this.layerModel.getBlend(),stencil:this.layerModel.getStencil(t),textures:this.layerModel.textures},t?.ispick||!1)}),this.hooks.afterRender.call(),this)}updateStyleAttribute(t,r,n,i){const a=this.configService.getAttributeConfig(this.id)||{};return qA(a[t],{field:r,values:n})?!1:(["color","size","texture","rotate","filter","label","shape"].indexOf(t)!==-1&&this.configService.setAttributeConfig(this.id,{[t]:{field:r,values:n}}),this.startInit?this.styleAttributeService.updateStyleAttribute(t,{scale:Ge({field:r},this.splitValuesAndCallbackInAttribute(n,this.getLayerConfig()[r]))},i):this.pendingStyleAttributes.push({attributeName:t,attributeField:r,attributeValues:n,updateOptions:i}),!0)}getLayerAttributeConfig(){return this.configService.getAttributeConfig(this.id)}getShaderPickStat(){return this.layerService.getShaderPickStat()}setEarthTime(t){console.warn("empty fn")}processData(t){return t}getModelType(){throw new Error("Method not implemented.")}getDefaultConfig(){return{}}processRelativeCoordinates(){if(!this.getLayerConfig().enableRelativeCoordinates||!this.layerSource||!this.layerSource.data)return;this.absoluteDataArray=[...this.layerSource.data.dataArray];const n=KZ(this.layerSource.data.dataArray,{enableRelativeCoordinates:!0});this.layerSource.data.dataArray=n.dataArray,this.relativeOrigin=n.relativeOrigin,this.originalExtent=n.originalExtent}getAbsoluteData(){return this.absoluteDataArray}getRelativeOrigin(){return this.relativeOrigin}getOriginalExtent(){return this.originalExtent}initLayerModels(){var t=this;return Ze(function*(){t.models.forEach(n=>n.destroy()),t.models=[],t.uniformBuffers.forEach(n=>{n.destroy()}),t.uniformBuffers=[];const r=t.rendererService.createBuffer({data:new Float32Array(20).fill(0),isUBO:!0,label:"pickingUniforms"});t.uniformBuffers.push(r),t.models=yield t.layerModel.initModels()})()}getPickingUniformBuffer(){return this.uniformBuffers[0]}reRender(){this.inited&&this.layerService.reRender()}splitValuesAndCallbackInAttribute(t){return{values:A4(t)?void 0:t,callback:A4(t)?t:void 0}}}function zJ(e,t){return{enable:e,mask:255,func:{cmp:N.EQUAL,ref:t?1:0,mask:1}}}function R4(e){return e.maskOperation===Vg.OR?{enable:!0,mask:255,func:{cmp:N.ALWAYS,ref:1,mask:255},opFront:{fail:N.KEEP,zfail:N.REPLACE,zpass:N.REPLACE}}:{enable:!0,mask:255,func:{cmp:e.stencilType===Mc.SINGLE||e.stencilIndex===0?N.ALWAYS:N.LESS,ref:e.stencilType===Mc.SINGLE?1:e.stencilIndex===0?2:1,mask:255},opFront:{fail:N.KEEP,zfail:N.REPLACE,zpass:N.REPLACE}}}const jJ={opacity:1,stroke:[1,0,0,1],offsets:[0,0],rotation:0,extrusionBase:0,strokeOpacity:1,thetaOffset:.314},k_={opacity:"float",stroke:"vec4",offsets:"vec2",textOffset:"vec2",rotation:"float",extrusionBase:"float",strokeOpacity:"float",thetaOffset:"float"};var z_={exports:{}},C4;function HJ(){if(C4)return z_.exports;C4=1,z_.exports=e,z_.exports.default=e;function e(O,F,z){z=z||2;var re=F&&F.length,oe=re?F[0]*z:O.length,_e=t(O,0,oe,z,!0),ye=[];if(!_e||_e.next===_e.prev)return ye;var Ie,Je,We,Ct,Ve,yt,Ue;if(re&&(_e=c(O,F,_e,z)),O.length>80*z){Ie=We=O[0],Je=Ct=O[1];for(var ge=z;ge<oe;ge+=z)Ve=O[ge],yt=O[ge+1],Ve<Ie&&(Ie=Ve),yt<Je&&(Je=yt),Ve>We&&(We=Ve),yt>Ct&&(Ct=yt);Ue=Math.max(We-Ie,Ct-Je),Ue=Ue!==0?32767/Ue:0}return n(_e,ye,z,Ie,Je,Ue,0),ye}function t(O,F,z,re,oe){var _e,ye;if(oe===pe(O,F,z,re)>0)for(_e=F;_e<z;_e+=re)ye=x(_e,O[_e],O[_e+1],ye);else for(_e=z-re;_e>=F;_e-=re)ye=x(_e,O[_e],O[_e+1],ye);return ye&&M(ye,ye.next)&&(P(ye),ye=ye.next),ye}function r(O,F){if(!O)return O;F||(F=O);var z=O,re;do if(re=!1,!z.steiner&&(M(z,z.next)||R(z.prev,z,z.next)===0)){if(P(z),z=F=z.prev,z===z.next)break;re=!0}else z=z.next;while(re||z!==F);return F}function n(O,F,z,re,oe,_e,ye){if(O){!ye&&_e&&_(O,re,oe,_e);for(var Ie=O,Je,We;O.prev!==O.next;){if(Je=O.prev,We=O.next,_e?a(O,re,oe,_e):i(O)){F.push(Je.i/z|0),F.push(O.i/z|0),F.push(We.i/z|0),P(O),O=We.next,Ie=We.next;continue}if(O=We,O===Ie){ye?ye===1?(O=s(r(O),F,z),n(O,F,z,re,oe,_e,2)):ye===2&&l(O,F,z,re,oe,_e):n(r(O),F,z,re,oe,_e,1);break}}}}function i(O){var F=O.prev,z=O,re=O.next;if(R(F,z,re)>=0)return!1;for(var oe=F.x,_e=z.x,ye=re.x,Ie=F.y,Je=z.y,We=re.y,Ct=oe<_e?oe<ye?oe:ye:_e<ye?_e:ye,Ve=Ie<Je?Ie<We?Ie:We:Je<We?Je:We,yt=oe>_e?oe>ye?oe:ye:_e>ye?_e:ye,Ue=Ie>Je?Ie>We?Ie:We:Je>We?Je:We,ge=re.next;ge!==F;){if(ge.x>=Ct&&ge.x<=yt&&ge.y>=Ve&&ge.y<=Ue&&A(oe,Ie,_e,Je,ye,We,ge.x,ge.y)&&R(ge.prev,ge,ge.next)>=0)return!1;ge=ge.next}return!0}function a(O,F,z,re){var oe=O.prev,_e=O,ye=O.next;if(R(oe,_e,ye)>=0)return!1;for(var Ie=oe.x,Je=_e.x,We=ye.x,Ct=oe.y,Ve=_e.y,yt=ye.y,Ue=Ie<Je?Ie<We?Ie:We:Je<We?Je:We,ge=Ct<Ve?Ct<yt?Ct:yt:Ve<yt?Ve:yt,nt=Ie>Je?Ie>We?Ie:We:Je>We?Je:We,Ce=Ct>Ve?Ct>yt?Ct:yt:Ve>yt?Ve:yt,zt=E(Ue,ge,F,z,re),jt=E(nt,Ce,F,z,re),_t=O.prevZ,Ot=O.nextZ;_t&&_t.z>=zt&&Ot&&Ot.z<=jt;){if(_t.x>=Ue&&_t.x<=nt&&_t.y>=ge&&_t.y<=Ce&&_t!==oe&&_t!==ye&&A(Ie,Ct,Je,Ve,We,yt,_t.x,_t.y)&&R(_t.prev,_t,_t.next)>=0||(_t=_t.prevZ,Ot.x>=Ue&&Ot.x<=nt&&Ot.y>=ge&&Ot.y<=Ce&&Ot!==oe&&Ot!==ye&&A(Ie,Ct,Je,Ve,We,yt,Ot.x,Ot.y)&&R(Ot.prev,Ot,Ot.next)>=0))return!1;Ot=Ot.nextZ}for(;_t&&_t.z>=zt;){if(_t.x>=Ue&&_t.x<=nt&&_t.y>=ge&&_t.y<=Ce&&_t!==oe&&_t!==ye&&A(Ie,Ct,Je,Ve,We,yt,_t.x,_t.y)&&R(_t.prev,_t,_t.next)>=0)return!1;_t=_t.prevZ}for(;Ot&&Ot.z<=jt;){if(Ot.x>=Ue&&Ot.x<=nt&&Ot.y>=ge&&Ot.y<=Ce&&Ot!==oe&&Ot!==ye&&A(Ie,Ct,Je,Ve,We,yt,Ot.x,Ot.y)&&R(Ot.prev,Ot,Ot.next)>=0)return!1;Ot=Ot.nextZ}return!0}function s(O,F,z){var re=O;do{var oe=re.prev,_e=re.next.next;!M(oe,_e)&&B(oe,re,re.next,_e)&&ae(oe,_e)&&ae(_e,oe)&&(F.push(oe.i/z|0),F.push(re.i/z|0),F.push(_e.i/z|0),P(re),P(re.next),re=O=_e),re=re.next}while(re!==O);return r(re)}function l(O,F,z,re,oe,_e){var ye=O;do{for(var Ie=ye.next.next;Ie!==ye.prev;){if(ye.i!==Ie.i&&b(ye,Ie)){var Je=X(ye,Ie);ye=r(ye,ye.next),Je=r(Je,Je.next),n(ye,F,z,re,oe,_e,0),n(Je,F,z,re,oe,_e,0);return}Ie=Ie.next}ye=ye.next}while(ye!==O)}function c(O,F,z,re){var oe=[],_e,ye,Ie,Je,We;for(_e=0,ye=F.length;_e<ye;_e++)Ie=F[_e]*re,Je=_e<ye-1?F[_e+1]*re:O.length,We=t(O,Ie,Je,re,!1),We===We.next&&(We.steiner=!0),oe.push(T(We));for(oe.sort(d),_e=0;_e<oe.length;_e++)z=p(oe[_e],z);return z}function d(O,F){return O.x-F.x}function p(O,F){var z=h(O,F);if(!z)return F;var re=X(z,O);return r(re,re.next),r(z,z.next)}function h(O,F){var z=F,re=O.x,oe=O.y,_e=-1/0,ye;do{if(oe<=z.y&&oe>=z.next.y&&z.next.y!==z.y){var Ie=z.x+(oe-z.y)*(z.next.x-z.x)/(z.next.y-z.y);if(Ie<=re&&Ie>_e&&(_e=Ie,ye=z.x<z.next.x?z:z.next,Ie===re))return ye}z=z.next}while(z!==F);if(!ye)return null;var Je=ye,We=ye.x,Ct=ye.y,Ve=1/0,yt;z=ye;do re>=z.x&&z.x>=We&&re!==z.x&&A(oe<Ct?re:_e,oe,We,Ct,oe<Ct?_e:re,oe,z.x,z.y)&&(yt=Math.abs(oe-z.y)/(re-z.x),ae(z,O)&&(yt<Ve||yt===Ve&&(z.x>ye.x||z.x===ye.x&&m(ye,z)))&&(ye=z,Ve=yt)),z=z.next;while(z!==Je);return ye}function m(O,F){return R(O.prev,O,F.prev)<0&&R(F.next,O,O.next)<0}function _(O,F,z,re){var oe=O;do oe.z===0&&(oe.z=E(oe.x,oe.y,F,z,re)),oe.prevZ=oe.prev,oe.nextZ=oe.next,oe=oe.next;while(oe!==O);oe.prevZ.nextZ=null,oe.prevZ=null,y(oe)}function y(O){var F,z,re,oe,_e,ye,Ie,Je,We=1;do{for(z=O,O=null,_e=null,ye=0;z;){for(ye++,re=z,Ie=0,F=0;F<We&&(Ie++,re=re.nextZ,!!re);F++);for(Je=We;Ie>0||Je>0&&re;)Ie!==0&&(Je===0||!re||z.z<=re.z)?(oe=z,z=z.nextZ,Ie--):(oe=re,re=re.nextZ,Je--),_e?_e.nextZ=oe:O=oe,oe.prevZ=_e,_e=oe;z=re}_e.nextZ=null,We*=2}while(ye>1);return O}function E(O,F,z,re,oe){return O=(O-z)*oe|0,F=(F-re)*oe|0,O=(O|O<<8)&16711935,O=(O|O<<4)&252645135,O=(O|O<<2)&858993459,O=(O|O<<1)&1431655765,F=(F|F<<8)&16711935,F=(F|F<<4)&252645135,F=(F|F<<2)&858993459,F=(F|F<<1)&1431655765,O|F<<1}function T(O){var F=O,z=O;do(F.x<z.x||F.x===z.x&&F.y<z.y)&&(z=F),F=F.next;while(F!==O);return z}function A(O,F,z,re,oe,_e,ye,Ie){return(oe-ye)*(F-Ie)>=(O-ye)*(_e-Ie)&&(O-ye)*(re-Ie)>=(z-ye)*(F-Ie)&&(z-ye)*(_e-Ie)>=(oe-ye)*(re-Ie)}function b(O,F){return O.next.i!==F.i&&O.prev.i!==F.i&&!U(O,F)&&(ae(O,F)&&ae(F,O)&&Q(O,F)&&(R(O.prev,O,F.prev)||R(O,F.prev,F))||M(O,F)&&R(O.prev,O,O.next)>0&&R(F.prev,F,F.next)>0)}function R(O,F,z){return(F.y-O.y)*(z.x-F.x)-(F.x-O.x)*(z.y-F.y)}function M(O,F){return O.x===F.x&&O.y===F.y}function B(O,F,z,re){var oe=D(R(O,F,z)),_e=D(R(O,F,re)),ye=D(R(z,re,O)),Ie=D(R(z,re,F));return!!(oe!==_e&&ye!==Ie||oe===0&&w(O,z,F)||_e===0&&w(O,re,F)||ye===0&&w(z,O,re)||Ie===0&&w(z,F,re))}function w(O,F,z){return F.x<=Math.max(O.x,z.x)&&F.x>=Math.min(O.x,z.x)&&F.y<=Math.max(O.y,z.y)&&F.y>=Math.min(O.y,z.y)}function D(O){return O>0?1:O<0?-1:0}function U(O,F){var z=O;do{if(z.i!==O.i&&z.next.i!==O.i&&z.i!==F.i&&z.next.i!==F.i&&B(z,z.next,O,F))return!0;z=z.next}while(z!==O);return!1}function ae(O,F){return R(O.prev,O,O.next)<0?R(O,F,O.next)>=0&&R(O,O.prev,F)>=0:R(O,F,O.prev)<0||R(O,O.next,F)<0}function Q(O,F){var z=O,re=!1,oe=(O.x+F.x)/2,_e=(O.y+F.y)/2;do z.y>_e!=z.next.y>_e&&z.next.y!==z.y&&oe<(z.next.x-z.x)*(_e-z.y)/(z.next.y-z.y)+z.x&&(re=!re),z=z.next;while(z!==O);return re}function X(O,F){var z=new H(O.i,O.x,O.y),re=new H(F.i,F.x,F.y),oe=O.next,_e=F.prev;return O.next=F,F.prev=O,z.next=oe,oe.prev=z,re.next=z,z.prev=re,_e.next=re,re.prev=_e,re}function x(O,F,z,re){var oe=new H(O,F,z);return re?(oe.next=re.next,oe.prev=re,re.next.prev=oe,re.next=oe):(oe.prev=oe,oe.next=oe),oe}function P(O){O.next.prev=O.prev,O.prev.next=O.next,O.prevZ&&(O.prevZ.nextZ=O.nextZ),O.nextZ&&(O.nextZ.prevZ=O.prevZ)}function H(O,F,z){this.i=O,this.x=F,this.y=z,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}e.deviation=function(O,F,z,re){var oe=F&&F.length,_e=oe?F[0]*z:O.length,ye=Math.abs(pe(O,0,_e,z));if(oe)for(var Ie=0,Je=F.length;Ie<Je;Ie++){var We=F[Ie]*z,Ct=Ie<Je-1?F[Ie+1]*z:O.length;ye-=Math.abs(pe(O,We,Ct,z))}var Ve=0;for(Ie=0;Ie<re.length;Ie+=3){var yt=re[Ie]*z,Ue=re[Ie+1]*z,ge=re[Ie+2]*z;Ve+=Math.abs((O[yt]-O[ge])*(O[Ue+1]-O[yt+1])-(O[yt]-O[Ue])*(O[ge+1]-O[yt+1]))}return ye===0&&Ve===0?0:Math.abs((Ve-ye)/ye)};function pe(O,F,z,re){for(var oe=0,_e=F,ye=z-re;_e<z;_e+=re)oe+=(O[ye]-O[_e])*(O[_e+1]+O[ye+1]),ye=_e;return oe}return e.flatten=function(O){for(var F=O[0][0].length,z={vertices:[],holes:[],dimensions:F},re=0,oe=0;oe<O.length;oe++){for(var _e=0;_e<O[oe].length;_e++)for(var ye=0;ye<F;ye++)z.vertices.push(O[oe][_e][ye]);oe>0&&(re+=O[oe-1].length,z.holes.push(re))}return z},z_.exports}var VJ=HJ();const Bv=Pr(VJ);function O4(e){return Math.max(Math.ceil(e/4)*4,4)}function G6(e,t,r,n=!0){const i=r===3;if(n){e=e.slice();const s=[];for(let l=0;l<e.length;l+=r){s[0]=e[l],s[1]=e[l+1],i&&(s[2]=e[l+2]);const c=u0(s,!0,{enable:!1,decimal:1});e[l]=c[0],e[l+1]=c[1],i&&(e[l+2]=c[2])}}return Bv(e,t,r)}const q6="ATTRIBUTE_LOCATION_";class nn{get attributeLocation(){return Ge({},El)}constructor(t){L(this,"triangulation",void 0),L(this,"uniformBuffers",[]),L(this,"textures",[]),L(this,"createTexture2D",void 0),L(this,"preStyleAttribute",{}),L(this,"encodeStyleAttribute",{}),L(this,"layer",void 0),L(this,"dataTexture",void 0),L(this,"DATA_TEXTURE_WIDTH",void 0),L(this,"dataTextureTest",void 0),L(this,"configService",void 0),L(this,"shaderModuleService",void 0),L(this,"rendererService",void 0),L(this,"iconService",void 0),L(this,"fontService",void 0),L(this,"styleAttributeService",void 0),L(this,"mapService",void 0),L(this,"cameraService",void 0),L(this,"layerService",void 0),L(this,"pickingService",void 0),L(this,"attributeUnifoms",void 0),L(this,"commonUnifoms",void 0),this.layer=t,this.configService=t.getContainer().globalConfigService,this.rendererService=t.getContainer().rendererService,this.pickingService=t.getContainer().pickingService,this.shaderModuleService=t.getContainer().shaderModuleService,this.styleAttributeService=t.getContainer().styleAttributeService,this.mapService=t.getContainer().mapService,this.iconService=t.getContainer().iconService,this.fontService=t.getContainer().fontService,this.cameraService=t.getContainer().cameraService,this.layerService=t.getContainer().layerService,this.registerStyleAttribute(),this.registerBuiltinAttributes(),this.startModelAnimate();const{createTexture2D:r}=this.rendererService;this.createTexture2D=r}getBlend(){const{blend:t="normal"}=this.layer.getLayerConfig();return X6[ml[t]]}getStencil(t){const{mask:r=!1,maskInside:n=!0,enableMask:i,maskOperation:a=Vg.AND}=this.layer.getLayerConfig();if(this.layer.type==="MaskLayer")return R4({stencilType:Mc.SINGLE});if(t.isStencil)return R4(Ge(Ge({},t),{},{maskOperation:a}));const s=r||i&&this.layer.masks.length!==0||this.layer.tileMask!==void 0;return zJ(s,n)}getDefaultStyle(){return{}}getUninforms(){const t=this.getCommonUniformsInfo(),r=this.getUniformsBufferInfo(this.getStyleAttribute());this.updateStyleUnifoms();const n=Ge(Ge({},r.uniformsOption),t.uniformsOption);return Object.keys(n).forEach(i=>{typeof n[i]=="boolean"&&(n[i]=n[i]?1:0)}),!this.rendererService.hasOwnProperty("device")&&this.textures&&this.textures.length===1&&(n.u_texture=this.textures[0]),n}getAnimateUniforms(){return{}}needUpdate(){return Ze(function*(){return!1})()}buildModels(){return Ze(function*(){throw new Error("Method not implemented.")})()}initModels(){return Ze(function*(){throw new Error("Method not implemented.")})()}clearModels(t=!0){}getAttribute(){throw new Error("Method not implemented.")}prerender(){}render(t){throw new Error("Method not implemented.")}registerBuiltinAttributes(){throw new Error("Method not implemented.")}animateOption2Array(t){return[t.enable?0:1,t.duration||4,t.interval||.2,t.trailLength||.1]}startModelAnimate(){const{animateOption:t}=this.layer.getLayerConfig();t.enable&&this.layer.setAnimateStartTime()}getInject(){return XJ(this.layer.enableShaderEncodeStyles,this.layer.encodeStyleAttribute)}getDefines(){const t=Object.keys(this.attributeLocation).reduce((r,n)=>{const i=q6+n;return r[i]=this.attributeLocation[n],r},{});return Ge({},t)}getStyleAttribute(){const t={};return this.layer.enableShaderEncodeStyles.forEach(r=>{if(!this.layer.encodeStyleAttribute[r]){const n=this.layer.getLayerConfig()[r];let i=typeof n>"u"?jJ[r]:n;r==="stroke"&&(i=$r(i)),t["u_"+r]=i}}),t}registerStyleAttribute(){Object.keys(this.layer.encodeStyleAttribute).forEach(t=>{const r=bJ(t);r&&this.styleAttributeService.registerStyleAttribute(r)})}registerPosition64LowAttribute(t=!0){this.styleAttributeService.registerStyleAttribute({name:"position64Low",type:Dt.Attribute,descriptor:{name:"a_Position64Low",shaderLocation:this.attributeLocation.POSITION_64LOW,buffer:{data:[],type:N.FLOAT},size:2,update:(r,n,i)=>t?[Wn(i[0]),Wn(i[1])]:[0,0]}})}updateEncodeAttribute(t,r){this.encodeStyleAttribute[t]=r}initUniformsBuffer(){const t=this.getUniformsBufferInfo(this.getStyleAttribute()),r=this.getCommonUniformsInfo();t.uniformsLength!==0&&(this.attributeUnifoms=this.rendererService.createBuffer({data:new Float32Array(O4(t.uniformsLength)).fill(0),isUBO:!0,label:"layerModelAttributeUnifoms"}),this.uniformBuffers.push(this.attributeUnifoms)),r.uniformsLength!==0&&(this.commonUnifoms=this.rendererService.createBuffer({data:new Float32Array(O4(r.uniformsLength)).fill(0),isUBO:!0,label:"layerModelCommonUnifoms"}),this.uniformBuffers.push(this.commonUnifoms))}getUniformsBufferInfo(t){let r=0;const n=[];return Object.values(t).forEach(i=>{Array.isArray(i)?(n.push(...i),r+=i.length):typeof i=="number"?(n.push(i),r+=1):typeof i=="boolean"&&(n.push(Number(i)),r+=1)}),{uniformsOption:t,uniformsLength:r,uniformsArray:n}}getCommonUniformsInfo(){return{uniformsLength:0,uniformsArray:[],uniformsOption:{}}}updateStyleUnifoms(){var t,r;const{uniformsArray:n}=this.getUniformsBufferInfo(this.getStyleAttribute()),{uniformsArray:i}=this.getCommonUniformsInfo();(t=this.attributeUnifoms)===null||t===void 0||t.subData({offset:0,data:new Uint8Array(new Float32Array(n).buffer)}),(r=this.commonUnifoms)===null||r===void 0||r.subData({offset:0,data:new Uint8Array(new Float32Array(i).buffer)})}}function XJ(e,t){const r=[];let n="";e.forEach(s=>{const l=s.replace(/([a-z])([A-Z])/g,"$1_$2").toUpperCase(),c=q6+l;t[s]?n+=`#define USE_ATTRIBUTE_${l} 0.0 
`:r.push(`  ${k_[s]} u_${s};`),n+=`
#ifdef USE_ATTRIBUTE_${l}
layout(location = ${c}) in ${k_[s]} a_${s.charAt(0).toUpperCase()+s.slice(1)};
#endif 
`});const i=r.length?`
layout(std140) uniform AttributeUniforms {
  ${r.join(`
`)}
};
`:"";n+=i;let a="";return e.forEach(s=>{const l=s.replace(/([a-z])([A-Z])/g,"$1_$2").toUpperCase();a+=`
  #ifdef USE_ATTRIBUTE_${l}
    ${k_[s]} ${s} = a_${s.charAt(0).toUpperCase()+s.slice(1)};
  #else
    ${k_[s]} ${s} = u_${s};
  #endif
  `}),{"vs:#decl":n,"fs:#decl":i,"vs:#main-start":a}}let M4=(function(e){return e.VERTICAL="vertical",e.HORIZONTAL="horizontal",e})({}),GJ=(function(e){return e.NORMAL="normal",e.REPLACE="replace",e})({}),MR=(function(e){return e[e.pixel=0]="pixel",e[e.meter=1]="meter",e})({});const W6=100;function w4(e){return e/180*Math.acos(-1)}function Y6(e){const t=w4(e[0])+Math.PI/2,r=w4(e[1]),n=W6+Math.random()*.4,i=n*Math.cos(r)*Math.cos(t),a=n*Math.cos(r)*Math.sin(t),s=n*Math.sin(r);return[a,s,i]}const N4=oa();oa();const ja=oa(),Dp=oa(),j_=oa();function I4(e,t,r,n,i){_l(e,r,n),j0(e,e),t=Fb(-e[1],e[0]);const a=Fb(-r[1],r[0]);return[i/kb(t,a),t]}function Lp(e,t){return qq(e,-t[1],t[0])}function H_(e,t,r){return kB(e,t,r),j0(e,e),e}function P4(e,t){return e[0]===t[0]&&e[1]===t[1]}class qJ{constructor(t={}){L(this,"complex",void 0),L(this,"join",void 0),L(this,"cap",void 0),L(this,"miterLimit",void 0),L(this,"thickness",void 0),L(this,"normal",void 0),L(this,"lastFlip",-1),L(this,"miter",Fb(0,0)),L(this,"started",!1),L(this,"dash",!1),L(this,"totalDistance",0),L(this,"currentIndex",0),this.join=t.join||"miter",this.cap=t.cap||"butt",this.miterLimit=t.miterLimit||10,this.thickness=t.thickness||1,this.dash=t.dash||!1,this.complex={positions:[],indices:[],normals:[],startIndex:0,indexes:[]}}simpleExtrude(t){const r=this.complex;if(t.length<=1)return r;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;const n=t.length;let i=r.startIndex;for(let a=1;a<n;a++){const s=t[a-1],l=t[a],c=a<t.length-1?t[a+1]:null,d=this.simpleSegment(r,i,s,l,c);i+=d}if(this.dash)for(let a=0;a<r.positions.length/6;a++)r.positions[a*6+5]=this.totalDistance;return r.startIndex=r.positions.length/6,r}extrude(t){const r=this.complex;if(t.length<=1)return r;this.lastFlip=-1,this.started=!1,this.normal=null,this.totalDistance=0;const n=t.length;let i=r.startIndex;for(let a=1;a<n;a++){const s=t[a-1],l=t[a],c=a<t.length-1?t[a+1]:null,d=this.segment(r,i,s,l,c);i+=d}if(this.dash)for(let a=0;a<r.positions.length/6;a++)r.positions[a*6+5]=this.totalDistance;return r.startIndex=r.positions.length/6,r}simpleSegment(t,r,n,i,a){let s=0;const l=t.indices,c=t.positions,d=t.normals,p=Ya([i[0],i[1]]),h=Ya([n[0],n[1]]);H_(ja,p,h);let m=0;if(this.dash&&(m=this.lineSegmentDistance(p,h),this.totalDistance+=m),this.normal||(this.normal=oa(),Lp(this.normal,ja)),this.started||(this.started=!0,this.extrusions(c,d,n,this.normal,this.thickness,this.totalDistance-m)),l.push(r+0,r+1,r+2),!a)Lp(this.normal,ja),this.extrusions(c,d,i,this.normal,this.thickness,this.totalDistance),l.push(...this.lastFlip===1?[r,r+2,r+3]:[r+2,r+1,r+3]),s+=2;else{const _=Ya([a[0],a[1]]);P4(p,_)&&_l(_,p,j0(_,Ub(_,p,h))),H_(Dp,_,p);const[y,E]=I4(j_,oa(),ja,Dp,this.thickness);let T=kb(j_,this.normal)<0?-1:1;this.extrusions(c,d,i,E,y,this.totalDistance),l.push(...this.lastFlip===1?[r,r+2,r+3]:[r+2,r+1,r+3]),T=-1,SA(this.normal,E),s+=2,this.lastFlip=T}return s}segment(t,r,n,i,a){let s=0;const l=t.indices,c=t.positions,d=t.normals,p=this.cap==="square",h=this.join==="bevel",m=Ya([i[0],i[1]]),_=Ya([n[0],n[1]]);H_(ja,m,_);let y=0;if(this.dash&&(y=this.lineSegmentDistance(m,_),this.totalDistance+=y),this.normal||(this.normal=oa(),Lp(this.normal,ja)),!this.started)if(this.started=!0,p){const E=oa(),T=oa();_l(E,this.normal,ja),_l(T,this.normal,ja),d.push(T[0],T[1],0),d.push(E[0],E[1],0),c.push(n[0],n[1],n[2]|0,this.totalDistance-y,-this.thickness,n[2]|0),this.complex.indexes.push(this.currentIndex),c.push(n[0],n[1],n[2]|0,this.totalDistance-y,this.thickness,n[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(c,d,n,this.normal,this.thickness,this.totalDistance-y);if(l.push(r+0,r+1,r+2),a){const E=Ya([a[0],a[1]]);P4(m,E)&&_l(E,m,j0(E,Ub(E,m,_))),H_(Dp,E,m);const[T,A]=I4(j_,oa(),ja,Dp,this.thickness);let b=kb(j_,this.normal)<0?-1:1,R=h;!R&&this.join==="miter"&&T>this.miterLimit&&(R=!0),R?(d.push(this.normal[0],this.normal[1],0),d.push(A[0],A[1],0),c.push(i[0],i[1],i[2]|0,this.totalDistance,-this.thickness*b,i[2]|0),this.complex.indexes.push(this.currentIndex),c.push(i[0],i[1],i[2]|0,this.totalDistance,this.thickness*b,i[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,l.push(...this.lastFlip!==-b?[r,r+2,r+3]:[r+2,r+1,r+3]),l.push(r+2,r+3,r+4),Lp(N4,Dp),SA(this.normal,N4),d.push(this.normal[0],this.normal[1],0),c.push(i[0],i[1],i[2]|0,this.totalDistance,-this.thickness*b,i[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++,s+=3):(this.extrusions(c,d,i,A,T,this.totalDistance),l.push(...this.lastFlip===1?[r,r+2,r+3]:[r+2,r+1,r+3]),b=-1,SA(this.normal,A),s+=2),this.lastFlip=b}else{if(Lp(this.normal,ja),p){const E=oa(),T=oa();kB(T,ja,this.normal),_l(E,ja,this.normal),d.push(T[0],T[1],0),d.push(E[0],E[1],0),c.push(i[0],i[1],i[2]|0,this.totalDistance,this.thickness,i[2]|0),this.complex.indexes.push(this.currentIndex),c.push(i[0],i[1],i[2]|0,this.totalDistance,this.thickness,i[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}else this.extrusions(c,d,i,this.normal,this.thickness,this.totalDistance);l.push(...this.lastFlip===1?[r,r+2,r+3]:[r+2,r+1,r+3]),s+=2}return s}extrusions(t,r,n,i,a,s){r.push(i[0],i[1],0),r.push(i[0],i[1],0),t.push(n[0],n[1],n[2]|0,s,-a,n[2]|0),this.complex.indexes.push(this.currentIndex),t.push(n[0],n[1],n[2]|0,s,a,n[2]|0),this.complex.indexes.push(this.currentIndex),this.currentIndex++}lineSegmentDistance(t,r){const n=r[0]-t[0],i=r[1]-t[1];return Math.sqrt(n*n+i*i)}}let Bp=(function(e){return e.CYLINDER="cylinder",e.SQUARECOLUMN="squareColumn",e.TRIANGLECOLUMN="triangleColumn",e.HEXAGONCOLUMN="hexagonColumn",e.PENTAGONCOLUMN="pentagonColumn",e})({}),Fp=(function(e){return e.CIRCLE="circle",e.SQUARE="square",e.TRIANGLE="triangle",e.HEXAGON="hexagon",e.PENTAGON="pentagon",e})({});function $v(e,t=0){const r=Math.PI*2/e,n=[];for(let a=0;a<e;a++)n.push(r*a+t*Math.PI/12);return n.map(a=>{const s=Math.sin(a+Math.PI/4),l=Math.cos(a+Math.PI/4);return[s,l,0]})}function rx(){return $v(30)}function D4(){return $v(4)}function L4(){return $v(3)}function B4(){return $v(6,1)}function F4(){return $v(5)}const WA={[Fp.CIRCLE]:rx,[Fp.HEXAGON]:B4,[Fp.TRIANGLE]:L4,[Fp.SQUARE]:D4,[Fp.PENTAGON]:F4,[Bp.CYLINDER]:rx,[Bp.HEXAGONCOLUMN]:B4,[Bp.TRIANGLECOLUMN]:L4,[Bp.SQUARECOLUMN]:D4,[Bp.PENTAGONCOLUMN]:F4};function $6(e,t=!1){const r=e[0][0],n=e[0][e[0].length-1];r[0]===n[0]&&r[1]===n[1]&&(e[0]=e[0].slice(0,e[0].length-1));const i=e[0].length,a=Bv.flatten(e),{vertices:s,dimensions:l,holes:c}=a,d=[],p=[],h=[];for(let _=0;_<s.length/l;_++)d.push(s[_*l],s[_*l+1],1,-1,-1),h.push(0,0,1);const m=G6(s,c,l,t);p.push(...m);for(let _=0;_<i;_++){const y=a.vertices.slice(_*l,(_+1)*l);let E=a.vertices.slice((_+1)*l,(_+2)*l);E.length===0&&(E=a.vertices.slice(0,l));const T=d.length/5;d.push(y[0],y[1],1,0,0,E[0],E[1],1,.1,0,y[0],y[1],0,0,.8,E[0],E[1],0,.1,.8);const A=WJ([E[0],E[1],1],[y[0],y[1],0],[y[0],y[1],1],t);h.push(...A,...A,...A,...A),p.push(...[1,2,0,3,2,1].map(b=>b+T))}return{positions:d,index:p,normals:h}}function WJ(e,t,r,n=!1){const i=nv(),a=nv(),s=nv();n&&(e=u0(e),t=u0(t),r=u0(r));const l=Co(...e),c=Co(...t),d=Co(...r);XN(i,d,c),XN(a,l,c),Vq(s,i,a);const p=nv();return iv(p,s),p}const V_={};function Lc(e){const t=Fc(e.coordinates);return{vertices:[...t,...t,...t,...t],indices:[0,1,2,2,3,0],size:t.length}}function U4(e){const t=Fc(e.coordinates),r=Y6(t);return{vertices:[...r,...r,...r,...r],indices:[0,1,2,2,3,0],size:r.length}}function Z6(e){const{shape:t}=e,{positions:r,index:n,normals:i}=JJ(t,!1);return{vertices:r,indices:n,normals:i,size:5}}function YJ(e){const t=Fc(e.coordinates);return{vertices:[...t],indices:[0],size:t.length}}function nx(e){const{coordinates:t}=e,r=new qJ({dash:!0,join:"bevel"});let n=t;n[0]&&!Array.isArray(n[0][0])&&(n=[t]),n.forEach(a=>{r.extrude(a)});const i=r.complex;return{vertices:i.positions,indices:i.indices,normals:i.normals,indexes:i.indexes,size:6}}function $J(e){const{coordinates:t}=e,r=[];if(!Array.isArray(t[0]))return{vertices:[],indices:[],normals:[],size:6,count:0};const{results:n,totalDistance:i}=ZJ(t);return n.map(a=>{r.push(a[0],a[1],a[2],a[3],0,i)}),{vertices:r,indices:[],normals:[],size:6,count:n.length}}function k4(e,t){const r=t[0]-e[0],n=t[1]-e[1];return Math.sqrt(r*r+n*n)}function YA(e,t){return e.length<3&&e.push(0),t!==void 0&&e.push(t),e}function ZJ(e){let t=e;Array.isArray(t)&&Array.isArray(t[0])&&Array.isArray(t[0][0])&&(t=e.flat());let r=0;if(t.length<2)return{results:t,totalDistance:0};{const n=[],i=YA(t[0],r);n.push(i);for(let s=1;s<t.length-1;s++){const l=k4(Ya(t[s-1]),Ya(t[s]));r+=l;const c=YA(t[s],r);n.push(c),n.push(c)}const a=k4(Ya(t[t.length-2]),Ya(t[t.length-1]));return r+=a,n.push(YA(t[t.length-1],r)),{results:n,totalDistance:r}}}function Zv(e){const{coordinates:t}=e,r=Bv.flatten(t),{vertices:n,dimensions:i,holes:a}=r;return{indices:G6(n,a,i),vertices:n,size:i}}function KJ(e){const{indices:t,vertices:r,size:n}=Zv(e);return{indices:t,vertices:QJ(r),size:n+4}}function QJ(e){const t=[],{center:r,radius:n}=GV(e);for(let i=0;i<e.length;i+=2){const a=e[i],s=e[i+1];t.push(a,s,0,...r,n)}return t}function K6(e){const t=e.coordinates,{positions:r,index:n,normals:i}=$6(t,!0);return{vertices:r,indices:n,normals:i,size:5}}function Yg(e){const t=e.coordinates;return{vertices:[...t[0],0,0,0,...t[1],0,1,0,...t[2],0,1,1,...t[3],0,0,1],indices:[0,1,2,0,2,3],size:5}}function wR(e,t){const{segmentNumber:r=30}=t,n=e.coordinates,i=[],a=[];for(let s=0;s<r;s++)i.push(s,1,s,n[0][0],n[0][1],n[1][0],n[1][1],s,-1,s,n[0][0],n[0][1],n[1][0],n[1][1]),s!==r-1&&a.push(...[0,1,2,1,3,2].map(l=>s*2+l));return{vertices:i,indices:a,size:7}}function JJ(e,t=!1){if(V_&&V_[e])return V_[e];const r=WA[e]?WA[e]():WA.cylinder(),n=$6([r],t);return V_[e]=n,n}function eee(e,t){return{type:e.type,field:"value",items:e.positions.map((r,n)=>({[t]:n>=e.colors.length?null:e.colors[n],value:r}))}}const tee=`uniform sampler2D u_texture;
layout(std140) uniform commonUniforms {
    float u_opacity:1.0;
    float u_brightness:1.0;
    float u_contrast:1.0;
    float u_saturation:1.0;
    float u_gamma:1.0;
};

in vec2 v_texCoord;
out vec4 outputColor;
vec3 setContrast(vec3 rgb, float contrast) {
  vec3 color = mix(vec3(0.5), rgb, contrast);
  color = clamp(color, 0.0, 1.0);
  return color;
}
vec3 setSaturation(vec3 rgb, float adjustment) {
  const vec3 grayVector = vec3(0.2125, 0.7154, 0.0721);
  vec3 intensity = vec3(dot(rgb, grayVector));
  vec3 color = mix(intensity, rgb, adjustment);
  color = clamp(color, 0.0, 1.0);
  return color;
}
void main() {
  vec4 color = texture(SAMPLER_2D(u_texture),vec2(v_texCoord.x,v_texCoord.y));
  //brightness
  color.rgb = mix(vec3(0.0, 0.0, 0.0), color.rgb, u_brightness);
  //contrast
  color.rgb = setContrast(color.rgb, u_contrast);
  // saturation
  color.rgb = setSaturation(color.rgb, u_saturation);
  // gamma
  color.rgb = pow(color.rgb, vec3(u_gamma));
  outputColor = color;
  outputColor.a *= u_opacity;
  if(outputColor.a < 0.01)
    discard;
}
`,ree=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;

layout(std140) uniform commonUniforms {
    float u_opacity:1.0;
    float u_brightness:1.0;
    float u_contrast:1.0;
    float u_saturation:1.0;
    float u_gamma:1.0;
};

out vec2 v_texCoord;
#pragma include "projection"

void main() {
  v_texCoord = a_Uv;
  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0.0, 1.0));
}
`;let nee=class extends nn{constructor(...t){super(...t),L(this,"texture",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9})}getCommonUniformsInfo(){const{opacity:t,brightness:r,contrast:n,saturation:i,gamma:a}=this.layer.getLayerConfig(),s={u_opacity:xp(t,1),u_brightness:xp(r,1),u_contrast:xp(n,1),u_saturation:xp(i,1),u_gamma:xp(a,1)};return this.textures=[this.texture],this.getUniformsBufferInfo(s)}initModels(){var t=this;return Ze(function*(){return yield t.loadTexture(),t.buildModels()})()}clearModels(){var t;(t=this.texture)===null||t===void 0||t.destroy()}loadTexture(){var t=this;return Ze(function*(){const{createTexture2D:r}=t.rendererService,i=yield t.layer.getSource().data.images;t.texture=r({data:i[0],width:i[0].width,height:i[0].height,mag:N.LINEAR,min:N.LINEAR})})()}buildModels(){var t=this;return Ze(function*(){return t.initUniformsBuffer(),[yield t.layer.buildLayerModel({moduleName:"rasterImage",vertexShader:ree,fragmentShader:tee,defines:t.getDefines(),triangulation:Yg,primitive:N.TRIANGLES,blend:{enable:!0},depth:{enable:!1},pickingEnabled:!1})]})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Dt.Attribute,descriptor:{name:"a_Uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:2,update:(t,r,n)=>[n[3],n[4]]}})}};const iee={image:nee};class aee extends ah{constructor(...t){super(...t),L(this,"type","ImageLayer")}buildModels(){var t=this;return Ze(function*(){const r=t.getModelType();t.layerModel=new iee[r](t),yield t.initLayerModels()})()}getDefaultConfig(){const t=this.getModelType();return{image:{}}[t]}getModelType(){return"image"}}const oee=`
#define Animate 0.0
#define LineTexture 1.0
uniform sampler2D u_texture;
layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array;
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float segmentNumber;
  float u_lineDir: 1.0;
  float u_icon_step: 100;
  float u_line_texture: 0.0;
  float u_textureBlend;
  float u_blur : 0.9;
  float u_line_type: 0.0;
  float u_time;
  float u_linearColor: 0.0;
};

in vec4 v_color;
in vec2 v_iconMapUV;
in vec4 v_lineData;
//dash
in vec4 v_dash_array;
in float v_distance_ratio;

out vec4 outputColor;
#pragma include "picking"

void main() {
  if(u_dash_array!=vec4(0.0)){
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(!(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z))) {
      discard;
    };
  }
  float animateSpeed = 0.0; // 运动速度
  outputColor = v_color;
  if(u_animate.x == Animate && u_line_texture != LineTexture) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- v_lineData.b, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      outputColor.a *= alpha;
  }

  // 当存在贴图时在底色上贴上贴图
  if(u_line_texture == LineTexture) { // while load texture
    float arcRadio = smoothstep( 0.0, 1.0, (v_lineData.r / segmentNumber));
    // float arcRadio = smoothstep( 0.0, 1.0, d_distance_ratio);

    float count = v_lineData.g; // 贴图在弧线上重复的数量

    float time = 0.0;
    if(u_animate.x == Animate) {
      time = u_time / u_animate.y;
    }
    float redioCount = arcRadio * count;

    float u = fract(redioCount - time);
    float v = v_lineData.a; // 横向 v
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;

    vec4 pattern = texture(SAMPLER_2D(u_texture), uv);

    if(u_animate.x == Animate) {
      float currentPlane = floor(redioCount - time);
      float textureStep = floor(count * u_animate.z);
      float a = mod(currentPlane, textureStep);
      if(a < textureStep - 1.0) {
        pattern = vec4(0.0);
      }
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      outputColor = filterColor(outputColor + pattern);
    } else { // replace
        pattern.a *= v_color.a;
        if(outputColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        outputColor = filterColor(pattern);
    }
    
  } else {
     outputColor = filterColor(outputColor);
  }
}`,see=`#define Animate (0.0)
#define LineTexture (1.0)

layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_INSTANCE) in vec4 a_Instance;
layout(location = ATTRIBUTE_LOCATION_INSTANCE_64LOW) in vec4 a_Instance64Low;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_iconMapUV;

layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array;
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float segmentNumber;
  float u_lineDir: 1.0;
  float u_icon_step: 100;
  float u_line_texture: 0.0;
  float u_textureBlend;
  float u_blur : 0.9;
  float u_line_type: 0.0;
  float u_time;
  float u_linearColor: 0.0;
};

out vec4 v_color;
out vec2 v_iconMapUV;
out vec4 v_lineData;
//dash
out vec4 v_dash_array;
out float v_distance_ratio;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float bezier3(vec3 arr, float t) {
  float ut = 1.0 - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}
vec2 midPoint(vec2 source, vec2 target, float arcThetaOffset) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = arcThetaOffset;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2 * cos(theta2) + source.x, r2 * sin(theta2) + source.y);
  if (u_lineDir == 1.0) {
    // 正向
    return mid;
  } else {
    // 逆向
    // (mid + vmin)/2 = (s + t)/2
    vec2 vmid = source + target - mid;
    return vmid;
  }
  // return mid;
}
float getSegmentRatio(float index) {
  // dash: index / (segmentNumber - 1.);
  // normal: smoothstep(0.0, 1.0, index / (segmentNumber - 1.));
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
  //  return index / (segmentNumber - 1.);
}
vec2 interpolate(vec2 source, vec2 target, float t, float arcThetaOffset) {
  // if the angularDist is PI, linear interpolation is applied. otherwise, use spherical interpolation
  vec2 mid = midPoint(source, target, arcThetaOffset);
  vec3 x = vec3(source.x, mid.x, target.x);
  vec3 y = vec3(source.y, mid.y, target.y);
  return vec2(bezier3(x, t), bezier3(y, t));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
   dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
   return dir_screenspace.xy * sign(offset_direction);
}

void main() {
  //vs中计算渐变色
  if (u_linearColor == 1.0) {
    float d_segmentIndex = a_Position.x + 1.0; // 当前顶点在弧线中所处的分段位置
    v_color = mix(u_sourceColor, u_targetColor, d_segmentIndex / segmentNumber);
  } else {
    v_color = a_Color;
  }
  v_color.a = v_color.a * opacity;

  vec2 source_world = a_Instance.rg; // 起始点
  vec2 target_world = a_Instance.ba; // 终点

  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);

  // 计算 dashArray 和 distanceRatio 输出到片元
  float total_Distance = pixelDistance(source_world, target_world) / 2.0 * PI;
  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / total_Distance;
  v_distance_ratio = segmentIndex / segmentNumber;

  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));
  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  float d_distance_ratio;

  if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
      if(u_lineDir != 1.0) {
        d_distance_ratio = 1.0 - d_distance_ratio;
      }
  }

  v_lineData.b = d_distance_ratio;

  vec4 source = project_position(vec4(source_world, 0, 1.), a_Instance64Low.xy);
  vec4 target = project_position(vec4(target_world, 0, 1.), a_Instance64Low.zw);

  vec2 currPos = interpolate(source.xy, target.xy, segmentRatio, thetaOffset);
  vec2 nextPos = interpolate(source.xy, target.xy, nextSegmentRatio, thetaOffset);

  vec2 offset = project_pixel(
    getExtrusionOffset((nextPos.xy - currPos.xy) * indexDir, a_Position.y)
  );

  float d_segmentIndex = a_Position.x + 1.0; // 当前顶点在弧线中所处的分段位置
  v_lineData.r = d_segmentIndex;

  if(LineTexture == u_line_texture) { // 开启贴图模式
    float arcDistrance = length(source - target); // 起始点和终点的距离
    arcDistrance = project_pixel(arcDistrance);

    v_iconMapUV = a_iconMapUV;

    float pixelLen = project_pixel_texture(u_icon_step); // 贴图沿弧线方向的长度 - 随地图缩放改变
    float texCount = floor(arcDistrance / pixelLen); // 贴图在弧线上重复的数量
    v_lineData.g = texCount;

    float lineOffsetWidth = length(offset + offset * sign(a_Position.y)); // 线横向偏移的距离
    float linePixelSize = project_pixel(a_Size); // 定点位置偏移
    v_lineData.a = lineOffsetWidth / linePixelSize; // 线图层贴图部分的 v 坐标值
  }

  gl_Position = project_common_position_to_clipspace(vec4(currPos.xy + offset, 0, 1.0));

  setPickingColor(a_PickingColor);
}
`,uee={solid:0,dash:1};class lee extends nn{constructor(...t){super(...t),L(this,"texture",void 0),L(this,"updateTexture",()=>{const{createTexture2D:r}=this.rendererService;if(this.texture){this.texture.update({data:this.iconService.getCanvas()}),this.layer.render();return}this.texture=r({data:this.iconService.getCanvas(),mag:N.NEAREST,min:N.NEAREST,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128}),this.textures=[this.texture]})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,INSTANCE:10,INSTANCE_64LOW:11,UV:12,THETA_OFFSET:13})}getCommonUniformsInfo(){const{sourceColor:t,targetColor:r,textureBlend:n="normal",lineType:i="solid",dashArray:a=[10,5],forward:s=!0,lineTexture:l=!1,iconStep:c=100,segmentNumber:d=30}=this.layer.getLayerConfig(),{animateOption:p}=this.layer.getLayerConfig();let h=a;i!=="dash"&&(h=[0,0]),h.length===2&&h.push(0,0);let m=0,_=[0,0,0,0],y=[0,0,0,0];if(t&&r&&(_=$r(t),y=$r(r),m=1),this.rendererService.getDirty()){var E;(E=this.texture)===null||E===void 0||E.bind()}const T={u_animate:this.animateOption2Array(p),u_dash_array:h,u_sourceColor:_,u_targetColor:y,u_textSize:[1024,this.iconService.canvasHeight||128],segmentNumber:d,u_lineDir:s?1:-1,u_icon_step:c,u_line_texture:l?1:0,u_textureBlend:n==="normal"?0:1,u_blur:.9,u_line_type:uee[i||"solid"],u_time:this.layer.getLayerAnimateTime()||0,u_linearColor:m};return this.getUniformsBufferInfo(T)}initModels(){var t=this;return Ze(function*(){return t.updateTexture(),t.iconService.on("imageUpdate",t.updateTexture),t.buildModels()})()}clearModels(){var t;(t=this.texture)===null||t===void 0||t.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}getShaders(){return{frag:oee,vert:see,type:""}}buildModels(){var t=this;return Ze(function*(){t.initUniformsBuffer();const{segmentNumber:r=30}=t.layer.getLayerConfig(),{frag:n,vert:i,type:a}=t.getShaders();return[yield t.layer.buildLayerModel({moduleName:"lineArc2d"+a,vertexShader:i,fragmentShader:n,defines:t.getDefines(),inject:t.getInject(),triangulation:wR,depth:{enable:!1},styleOption:{segmentNumber:r}})]})()}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Dt.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:1,update:t=>{const{size:r=1}=t;return Array.isArray(r)?[r[0]]:[r]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:Dt.Attribute,descriptor:{name:"a_Instance",shaderLocation:this.attributeLocation.INSTANCE,buffer:{usage:N.STATIC_DRAW,data:[],type:N.FLOAT},size:4,update:(t,r,n)=>[n[3],n[4],n[5],n[6]]}}),this.styleAttributeService.registerStyleAttribute({name:"instance64Low",type:Dt.Attribute,descriptor:{name:"a_Instance64Low",shaderLocation:this.attributeLocation.INSTANCE_64LOW,buffer:{usage:N.STATIC_DRAW,data:[],type:N.FLOAT},size:4,update:(t,r,n)=>[Wn(n[3]),Wn(n[4]),Wn(n[5]),Wn(n[6])]}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Dt.Attribute,descriptor:{name:"a_iconMapUV",shaderLocation:this.attributeLocation.UV,buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:2,update:t=>{const r=this.iconService.getIconMap(),{texture:n}=t,{x:i,y:a}=r[n]||{x:0,y:0};return[i,a]}}}),this.styleAttributeService.registerStyleAttribute({name:"thetaOffset",type:Dt.Attribute,descriptor:{name:"a_ThetaOffset",shaderLocation:this.attributeLocation.THETA_OFFSET,buffer:{usage:N.STATIC_DRAW,data:[],type:N.FLOAT},size:1,update:t=>{const{thetaOffset:r=1}=t;return[r]}}})}}const cee=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

uniform sampler2D u_texture;

layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array: [10.0, 5., 0, 0];
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float u_globel;
  float u_globel_radius;
  float u_global_height: 10;
  float segmentNumber;
  float u_line_type: 0.0;
  float u_icon_step: 100;
  float u_line_texture: 0.0;
  float u_textureBlend;
  float u_time;
  float u_linearColor: 0.0;
};

in vec4 v_color;
in vec4 v_dash_array;
in float v_segmentIndex;
in vec2 v_iconMapUV;
in vec4 v_line_data;

out vec4 outputColor;

#pragma include "picking"

void main() {
  float animateSpeed = 0.0; // 运动速度
  float d_distance_ratio = v_line_data.g; // 当前点位距离占线总长的比例
  outputColor = v_color;

  if(u_line_type == LineTypeDash) {
    float flag = 0.;
    float dashLength = mod(d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      flag = 1.;
    }
    outputColor.a *=flag;
  }

  if(u_animate.x == Animate && u_line_texture != LineTexture) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);

      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      // alpha = smoothstep(0., 1., alpha);
      alpha = clamp(alpha, 0.0, 1.0);
      outputColor.a *= alpha;

      // u_animate
      // x enable
      // y duration
      // z interval
      // w trailLength
  }

  if(u_line_texture == LineTexture && u_line_type != LineTypeDash) { // while load texture
    // float arcRadio = smoothstep( 0.0, 1.0, (v_segmentIndex / segmentNumber));
    float arcRadio = v_segmentIndex / (segmentNumber - 1.0);
    float count = v_line_data.b; // // 贴图在弧线上重复的数量

    float time = 0.0;
    if(u_animate.x == Animate) {
      time = u_time / u_animate.y;
    }
    float redioCount = arcRadio * count;

    float u = fract(redioCount - time);

    float v = v_line_data.a;  // 线图层贴图部分的 v 坐标值
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture(SAMPLER_2D(u_texture), uv);

    if(u_animate.x == Animate) {
      float currentPlane = floor(redioCount - time);
      float textureStep = floor(count * u_animate.z);
      float a = mod(currentPlane, textureStep);
      if(a < textureStep - 1.0) {
        pattern = vec4(0.0);
      }
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      outputColor = filterColor(outputColor + pattern);
    } else { // replace
        pattern.a *= v_color.a;
        if(outputColor.a <= 0.0) {
          pattern.a = 0.0;
          discard;
        } else {
          outputColor = filterColor(pattern);
        }
    }

  } else {
    outputColor = filterColor(outputColor);
  }
}
`,fee=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_INSTANCE) in vec4 a_Instance;
layout(location = ATTRIBUTE_LOCATION_INSTANCE_64LOW) in vec4 a_Instance64Low;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_iconMapUV;


layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array: [10.0, 5., 0, 0];
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float u_globel;
  float u_globel_radius;
  float u_global_height: 10;
  float segmentNumber;
  float u_line_type: 0.0;
  float u_icon_step: 100;
  float u_line_texture: 0.0;
  float u_textureBlend;
  float u_time;
  float u_linearColor: 0.0;
};
out vec4 v_color;
out vec4 v_dash_array;
out float v_segmentIndex;
out vec2 v_iconMapUV;
out vec4 v_line_data;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps (float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return smoothstep(0.0, 1.0, index / (segmentNumber - 1.0));
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(
    mix(source, target, segmentRatio),
    sqrt(max(0.0, vertex_height))
  );
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);

  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;

  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return dir_screenspace.xy * sign(offset_direction);
}

float torad(float deg) {
  return (deg / 180.0) * acos(-1.0);
}

vec3 lglt2xyz(vec2 lnglat) {
  float pi = 3.1415926;
  // + Math.PI/2 是为了对齐坐标
  float lng = torad(lnglat.x) + pi / 2.0;
  float lat = torad(lnglat.y);

  // 手动增加一些偏移，减轻面的冲突
  float radius = u_globel_radius;

  float z = radius * cos(lat) * cos(lng);
  float x = radius * cos(lat) * sin(lng);
  float y = radius * sin(lat);
  return vec3(x, y, z);
}

void main() {
  //vs中计算渐变色
  if(u_linearColor==1.0){
    float d_segmentIndex = a_Position.x + 1.0; // 当前顶点在弧线中所处的分段位置
    v_color = mix(u_sourceColor, u_targetColor, d_segmentIndex/segmentNumber);
  }
  else{
    v_color = a_Color;
  }
  v_color.a = v_color.a * opacity;
  vec2 source = project_position(vec4(a_Instance.rg, 0, 0), a_Instance64Low.xy).xy;
  vec2 target = project_position(vec4(a_Instance.ba, 0, 0), a_Instance64Low.zw).xy;
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  float d_distance_ratio;
   if(u_line_type == LineTypeDash) {
    d_distance_ratio = segmentIndex / segmentNumber;
    float total_Distance = pixelDistance(source, target) / 2.0 * PI;
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / (total_Distance / segmentNumber * segmentIndex);
  }
    if(u_animate.x == Animate) {
      d_distance_ratio = segmentIndex / segmentNumber;
  }
  v_line_data.g = d_distance_ratio; // 当前点位距离占线总长的比例

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  vec3 curr = getPos(source, target, segmentRatio);
  vec3 next = getPos(source, target, nextSegmentRatio);
  vec2 offset = getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y);
  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);


  v_segmentIndex = a_Position.x;
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) { // 开启贴图模式

    float arcDistrance = length(source - target);
    float pixelLen =  project_pixel_texture(u_icon_step);
    v_line_data.b = floor(arcDistrance/pixelLen); // 贴图在弧线上重复的数量

    vec2 projectOffset = project_pixel(offset);
    float lineOffsetWidth = length(projectOffset + projectOffset * sign(a_Position.y)); // 线横向偏移的距离
    float linePixelSize = project_pixel(a_Size);  // 定点位置偏移，按地图等级缩放后的距离
    v_line_data.a = lineOffsetWidth/linePixelSize;  // 线图层贴图部分的 v 坐标值

    v_iconMapUV = a_iconMapUV;
  }


  gl_Position = project_common_position_to_clipspace(vec4(curr.xy + project_pixel(offset), curr.z * thetaOffset, 1.0));

  // 地球模式
  if(u_globel > 0.0) {
    vec3 startLngLat = lglt2xyz(a_Instance.rg);
    vec3 endLngLat = lglt2xyz(a_Instance.ba);
    float globalRadius = length(startLngLat);

    vec3 lineDir = normalize(endLngLat - startLngLat);
    vec3 midPointDir = normalize((startLngLat + endLngLat)/2.0);

    // 线的偏移
    vec3 lnglatOffset = cross(lineDir, midPointDir) * a_Position.y;
    // 计算起始点和终止点的距离
    float lnglatLength = length(a_Instance.rg - a_Instance.ba)/50.0;
    // 计算飞线各个节点相应的高度
    float lineHeight = u_global_height * (-4.0*segmentRatio*segmentRatio + 4.0 * segmentRatio) * lnglatLength;
    // 地球点位
    vec3 globalPoint = normalize(mix(startLngLat, endLngLat, segmentRatio)) * (globalRadius + lineHeight) + lnglatOffset * a_Size;

    gl_Position = u_ViewProjectionMatrix * vec4(globalPoint, 1.0);
  }


  setPickingColor(a_PickingColor);
}
`,dee={solid:0,dash:1};class z4 extends nn{constructor(...t){super(...t),L(this,"texture",void 0),L(this,"updateTexture",()=>{const{createTexture2D:r}=this.rendererService;if(this.texture){this.texture.update({data:this.iconService.getCanvas()}),this.layer.render();return}this.texture=r({data:this.iconService.getCanvas(),mag:N.NEAREST,min:N.NEAREST,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128}),this.textures=[this.texture]})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,INSTANCE:10,INSTANCE_64LOW:11,UV:12,THETA_OFFSET:13})}getCommonUniformsInfo(){const{sourceColor:t,targetColor:r,textureBlend:n="normal",lineType:i="solid",dashArray:a=[10,5],lineTexture:s=!1,iconStep:l=100,segmentNumber:c=30,globalArcHeight:d=10}=this.layer.getLayerConfig(),{animateOption:p}=this.layer.getLayerConfig();a.length===2&&a.push(0,0);let h=0,m=[0,0,0,0],_=[0,0,0,0];if(t&&r&&(m=$r(t),_=$r(r),h=1),this.rendererService.getDirty()){var y;(y=this.texture)===null||y===void 0||y.bind()}const E={u_animate:this.animateOption2Array(p),u_dash_array:a,u_sourceColor:m,u_targetColor:_,u_textSize:[1024,this.iconService.canvasHeight||128],u_globel:this.mapService.version==="GLOBEL"?1:0,u_globel_radius:W6,u_global_height:d,segmentNumber:c,u_line_type:dee[i]||0,u_icon_step:l,u_line_texture:s?1:0,u_textureBlend:n==="normal"?0:1,u_time:this.layer.getLayerAnimateTime()||0,u_linearColor:h};return this.getUniformsBufferInfo(E)}initModels(){var t=this;return Ze(function*(){return t.initUniformsBuffer(),t.updateTexture(),t.iconService.on("imageUpdate",t.updateTexture),t.buildModels()})()}clearModels(){var t;(t=this.texture)===null||t===void 0||t.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}getShaders(){return{frag:cee,vert:fee,type:""}}buildModels(){var t=this;return Ze(function*(){const{segmentNumber:r=30}=t.layer.getLayerConfig(),{frag:n,vert:i,type:a}=t.getShaders();return[yield t.layer.buildLayerModel({moduleName:"lineArc3d"+a,vertexShader:i,fragmentShader:n,defines:t.getDefines(),inject:t.getInject(),triangulation:wR,styleOption:{segmentNumber:r}})]})()}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Dt.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:1,update:t=>{const{size:r=1}=t;return Array.isArray(r)?[r[0]]:[r]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:Dt.Attribute,descriptor:{name:"a_Instance",shaderLocation:this.attributeLocation.INSTANCE,buffer:{usage:N.STATIC_DRAW,data:[],type:N.FLOAT},size:4,update:(t,r,n)=>[n[3],n[4],n[5],n[6]]}}),this.styleAttributeService.registerStyleAttribute({name:"instance64Low",type:Dt.Attribute,descriptor:{name:"a_Instance64Low",shaderLocation:this.attributeLocation.INSTANCE_64LOW,buffer:{usage:N.STATIC_DRAW,data:[],type:N.FLOAT},size:4,update:(t,r,n)=>[Wn(n[3]),Wn(n[4]),Wn(n[5]),Wn(n[6])]}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Dt.Attribute,descriptor:{name:"a_iconMapUV",shaderLocation:this.attributeLocation.UV,buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:2,update:t=>{const r=this.iconService.getIconMap(),{texture:n}=t,{x:i,y:a}=r[n]||{x:0,y:0};return[i,a]}}}),this.styleAttributeService.registerStyleAttribute({name:"thetaOffset",type:Dt.Attribute,descriptor:{name:"a_ThetaOffset",shaderLocation:this.attributeLocation.THETA_OFFSET,buffer:{usage:N.STATIC_DRAW,data:[],type:N.FLOAT},size:1,update:t=>{const{thetaOffset:r=1}=t;return[r]}}})}}const j4={circle:2,triangle:2,diamond:4,rect:2,classic:3,halfTriangle:2,none:0},sa=1/2;function hee(e,t){const{width:r=2,height:n=1}=t;return{vertices:[0,sa*e,1*e*r,-(n+sa)*e,1*e*r,(n-sa)*e,0,sa*e,1*e*r,-(n+sa)*e,1*e*r,(n-sa)*e],indices:[3,4,5],outLineIndices:[0,1,2],normals:[1*e,-2*e,1,-2*e,1.5*e,1,1*e,1.5*e,1,0,0,0,0,0,0,0,0,0],dimensions:2}}function pee(e,t){const{width:r=2,height:n=3}=t;return{vertices:[0,0,1*e*r,1*n,1*e*r,-1*n,0,0,1*e*r,1*n,1*e*r,-1*n],outLineIndices:[0,1,2],indices:[3,4,5],normals:[0,-1.5*e,1,2,1*e,1,-2,1*e,1,0,0,0,0,0,0,0,0,0],dimensions:2}}function vee(e,t){const{width:r=2,height:n=2}=t;return{vertices:[0,n/2,e*r*1,n/2,e*r*1,-n/2,0,-n/2,0,n/2,e*r*1,n/2,e*r*1,-n/2,0,-n/2],dimensions:2,indices:[4,5,6,4,6,7],outLineIndices:[0,1,2,0,2,3],normals:[0,-e,1,1,0,1,0,-e,1,-1,-0,1,0,0,0,0,0,0,0,0,0,0,0,0]}}function mee(e,t){const{width:r=2,height:n=3}=t;return{vertices:[0,0,1*r*e,.5*n,2*r*e,0,1*r*e,-.5*n,0,0,1*r*e,.5*n,2*r*e,0,1*r*e,-.5*n],dimensions:2,indices:[4,5,6,4,6,7],outLineIndices:[0,1,2,0,2,3],normals:[0,-e,1,1,0,1,0,-e,1,-1,-0,1,0,0,0,0,0,0,0,0,0,0,0,0]}}function _ee(e,t){const{width:r=2,height:n=3}=t;return{vertices:[0,0,2*e*r,1*n,1.5*e*r,0,2*e*r,-1*n,0,0,2*e*r,1*n,1.5*e*r,0,2*e*r,-1*n],dimensions:2,indices:[4,5,6,4,6,7],outLineIndices:[0,1,2,0,2,3],normals:[0,-e,1,1,0,1,0,-e,1,-1,-0,1,0,0,0,0,0,0,0,0,0,0,0,0]}}function gee(e,t){const{width:r=2,height:n=2}=t,i=rx(),a=Bv.flatten([i]),s=Bv(a.vertices,a.holes,a.dimensions),l=i.map(c=>[c[0]*r*e,c[1]*n]).flat();return{vertices:[...l,...l],dimensions:2,indices:s.map(c=>c+i.length),outLineIndices:s,normals:[...i.map(c=>[c[1]*n,c[0]*r*e,1]).flat(),...new Array(i.length*3).fill(0)]}}function yee(e,t=0,r){const n=typeof r.source=="object"?r.source.type:r.source,i=typeof r.target=="object"?r.target.type:r.target,{width:a=n?j4[n]:0}=typeof r.source=="object"?r.source:{},{width:s=i?j4[i]:0}=typeof r.target=="object"?r.target:{};return{vertices:[0,sa,1*a,...e,1,sa,-1*s,...e,1,-sa,-1*s,...e,0,-sa,1*a,...e,0,sa,1*a,...e,1,sa,-1*s,...e,1,-sa,-1*s,...e,0,-sa,1*a,...e],outLineIndices:[0,1,2,0,2,3].map(l=>l+t),indices:[4,5,6,4,6,7].map(l=>l+t),normals:[1,-1,1,1,1,1,-1,0,1,-1,0,1,0,0,0,0,0,0,0,0,0,0,0,0],dimensions:2}}function H4(e,t){const r=typeof e=="object"?e.type:e,n=t==="source"?1:-1,i=typeof e=="object"?e:{};switch(r){case"circle":return gee(n,i);case"triangle":return pee(n,i);case"diamond":return mee(n,i);case"rect":return vee(n,i);case"classic":return _ee(n,i);case"halfTriangle":return hee(n,i);default:return{vertices:[],indices:[],normals:[],dimensions:2,outLineIndices:[],outLineNormals:[]}}}function Eee(e){const t=e.coordinates.flat(),r=1;return{vertices:[1,0,0,...t,1,2,-3,...t,1,1,-3,...t,0,1,0,...t,0,0,0,...t,1,0,0,...t,1,2,-3,...t,1,1,-3,...t,0,1,0,...t,0,0,0,...t],normals:[-1,2*r,1,2*r,-r,1,r,-r,1,r,-r,1,-1,-r,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],indices:[0,1,2,0,2,3,0,3,4,5,6,7,5,7,8,5,8,9],size:7}}function Tee(e,t){return t?See(e,t):Eee(e)}function See(e,t){const r=e.coordinates.flat(),{target:n="classic",source:i="circle"}=t,a=V4(H4(i,"source"),r,0,0),s=yee(r,a.vertices.length/7,t),l=V4(H4(n,"target"),r,1,a.vertices.length/7+s.vertices.length/7);return{vertices:[...a.vertices,...s.vertices,...l.vertices],indices:[...a.outLineIndices,...s.outLineIndices,...l.outLineIndices,...a.indices,...s.indices,...l.indices],normals:[...a.normals,...s.normals,...l.normals],size:7}}function V4(e,t,r=1,n=0){const i=[],{vertices:a,indices:s,dimensions:l,outLineIndices:c}=e;for(let d=0;d<a.length;d+=l)i.push(r,a[d+1],a[d],...t);return Ge(Ge({},e),{},{vertices:i,indices:s.map(d=>d+n),outLineIndices:c.map(d=>d+n)})}const Aee=`// #extension GL_OES_standard_derivatives : enable

in vec4 v_color;
out vec4 outputColor;


// line texture

#pragma include "picking"

void main() {
  outputColor = v_color;
  outputColor = filterColor(outputColor);
}
`,bee=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in vec2 a_Size;
layout(location = ATTRIBUTE_LOCATION_INSTANCE) in vec4 a_Instance;
layout(location = ATTRIBUTE_LOCATION_INSTANCE_64LOW) in vec4 a_Instance64Low;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;

layout(std140) uniform commonUniorm {
  float u_gap_width: 1.0;
  float u_stroke_width: 1.0;
  float u_stroke_opacity: 1.0;
};

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

out vec4 v_color;

vec2 project_pixel_offset(vec2 offsets) {
  vec2 data = project_pixel(offsets);

  return vec2(data.x, -data.y);
}

vec2 line_dir(vec2 target, vec2 source) {
  return normalize(ProjectFlat(target) - ProjectFlat(source));
}


void main() {
  // 透明度计算
  vec2 source_world = a_Instance.rg; // 起点
  vec2 target_world = a_Instance.ba; // 终点
  vec2 flowlineDir = line_dir(target_world, source_world);
  vec2 perpendicularDir = vec2(-flowlineDir.y, flowlineDir.x);

  vec2 position = mix(source_world, target_world, a_Position.x);
  vec2 position64Low = mix(a_Instance64Low.rg, a_Instance64Low.ba, a_Position.x);

  float lengthCommon = length(
    project_position(vec4(target_world, 0, 1)) - project_position(vec4(source_world, 0, 1))
  );
  vec2 offsetDistances = a_Size.x * project_pixel_offset(vec2(a_Position.y, a_Position.z)); // Mapbox || 高德
  vec2 limitedOffsetDistances = clamp(
    offsetDistances,
    project_pixel(-lengthCommon * 0.2),
    project_pixel(lengthCommon * 0.2)
  );

  float startOffsetCommon = project_pixel(offsets[0]);
  float endOffsetCommon = project_pixel(offsets[1]);
  float endpointOffset = mix(
    clamp(startOffsetCommon, 0.0, lengthCommon * 0.2),
    -clamp(endOffsetCommon, 0.0, lengthCommon * 0.2),
    a_Position.x
  );

  vec2 normalsCommon = u_stroke_width * project_pixel_offset(vec2(a_Normal.x, a_Normal.y));

  float gapCommon = -1. * project_pixel(u_gap_width);
  vec3 offsetCommon = vec3(
    flowlineDir * (limitedOffsetDistances[1] + normalsCommon.y + endpointOffset * 1.05) -
      perpendicularDir * (limitedOffsetDistances[0] + gapCommon + normalsCommon.x),
    0.0
  );

  vec4 project_pos = project_position(vec4(position.xy, 0, 1.0), position64Low);

  vec4 fillColor = vec4(a_Color.rgb, a_Color.a * opacity);
  v_color = mix(fillColor, vec4(u_stroke.xyz, u_stroke.w * fillColor.w * u_stroke_opacity), a_Normal.z);

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy +  offsetCommon.xy, 0., 1.0));

  setPickingColor(a_PickingColor);
}
`;class xee extends nn{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,INSTANCE:10,INSTANCE_64LOW:11,NORMAL:12})}getCommonUniformsInfo(){const{gapWidth:t=2,strokeWidth:r=1,strokeOpacity:n=1}=this.layer.getLayerConfig(),i={u_gap_width:t,u_stroke_width:r,u_stroke_opacity:n};return this.getUniformsBufferInfo(i)}initModels(){var t=this;return Ze(function*(){return t.initUniformsBuffer(),t.buildModels()})()}buildModels(){var t=this;return Ze(function*(){return[yield t.layer.buildLayerModel({moduleName:"flow_line",vertexShader:bee,fragmentShader:Aee,defines:t.getDefines(),inject:t.getInject(),triangulation:Tee,styleOption:t.layer.getLayerConfig().symbol,primitive:N.TRIANGLES,depth:{enable:!1},pick:!1})]})()}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Dt.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:2,update:t=>{const{size:r=1}=t;return Array.isArray(r)?[r[0],r[1]]:[r,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:Dt.Attribute,descriptor:{name:"a_Instance",shaderLocation:this.attributeLocation.INSTANCE,buffer:{usage:N.STATIC_DRAW,data:[],type:N.FLOAT},size:4,update:(t,r,n)=>[n[3],n[4],n[5],n[6]]}}),this.styleAttributeService.registerStyleAttribute({name:"instance64Low",type:Dt.Attribute,descriptor:{name:"a_Instance64Low",shaderLocation:this.attributeLocation.INSTANCE_64LOW,buffer:{usage:N.STATIC_DRAW,data:[],type:N.FLOAT},size:4,update:(t,r,n)=>[Wn(n[3]),Wn(n[4]),Wn(n[5]),Wn(n[6])]}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Dt.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:N.STATIC_DRAW,data:[],type:N.FLOAT},size:3,update:(t,r,n,i,a)=>a}})}}const Ree=`#define LineTypeSolid 0.0
#define LineTypeDash 1.0
#define Animate 0.0
#define LineTexture 1.0

uniform sampler2D u_texture;
layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array: [10.0, 5., 0, 0];
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float segmentNumber;
  float u_line_type: 0.0;
  float u_icon_step: 100;
  float u_line_texture: 0.0;
  float u_textureBlend;
  float u_time;
  float u_linearColor: 0;
};

in vec4 v_dash_array;
in vec4 v_color;
in vec2 v_iconMapUV;
in vec4 v_line_data;
in float v_distance_ratio;

out vec4 outputColor;
#pragma include "picking"
#pragma include "project"
#pragma include "projection"

void main() {

  float animateSpeed = 0.0;
  float d_segmentIndex = v_line_data.g;

  // 设置弧线的底色
  if(u_linearColor == 1.0) { // 使用渐变颜色
    outputColor = mix(u_sourceColor, u_targetColor, d_segmentIndex/segmentNumber);
    outputColor.a *= v_color.a;
  } else { // 使用 color 方法传入的颜色
    outputColor = v_color;
  }

  // float blur = 1.- smoothstep(u_blur, 1., length(v_normal.xy));
  // float blur = smoothstep(1.0, u_blur, length(v_normal.xy));
  if(u_line_type == LineTypeDash) {
    float dashLength = mod(v_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z)) {
      // 实线部分
    } else {
      // 虚线部分
      discard;
    };
  }

  // 设置弧线的动画模式
  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
      float alpha =1.0 - fract( mod(1.0- v_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + u_time / u_animate.y);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      alpha = smoothstep(0., 1., alpha);
      outputColor.a *= alpha;
  }

  // 设置弧线的贴图
  if(LineTexture == u_line_texture && u_line_type != LineTypeDash) {
    float arcRadio = smoothstep( 0.0, 1.0, (d_segmentIndex / (segmentNumber - 1.0)));
    // float arcRadio = d_segmentIndex / (segmentNumber - 1.0);
    float count = v_line_data.b; // 贴图在弧线上重复的数量
    float u = fract(arcRadio * count - animateSpeed * count);
    // float u = fract(arcRadio * count - animateSpeed);
    if(u_animate.x == Animate) {
      u = outputColor.a/v_color.a;
    }

    float v = v_line_data.a; // 线图层贴图部分的 v 坐标值

    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture(SAMPLER_2D(u_texture), uv);

    // 设置贴图和底色的叠加模式
    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      outputColor = filterColor(outputColor + pattern);
    } else { // replace
        pattern.a *= v_color.a;
        if(outputColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        outputColor = filterColor(pattern);
    }
  } else {
    outputColor = filterColor(outputColor);
  }

  // gl_FragColor = filterColor(gl_FragColor);
}
`,Cee=`#define LineTypeSolid (0.0)
#define LineTypeDash (1.0)
#define Animate (0.0)
#define LineTexture (1.0)

layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_INSTANCE) in vec4 a_Instance;
layout(location = ATTRIBUTE_LOCATION_INSTANCE_64LOW) in vec4 a_Instance64Low;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_iconMapUV;

layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array: [10.0, 5., 0, 0];
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float segmentNumber;
  float u_line_type: 0.0;
  float u_icon_step: 100;
  float u_line_texture: 0.0;
  float u_textureBlend;
  float u_time;
  float u_linearColor: 0;
};

out vec4 v_dash_array;
out vec4 v_color;
out vec2 v_iconMapUV;
out vec4 v_line_data;
out float v_distance_ratio;

#pragma include "projection"
#pragma include "project"
#pragma include "picking"

float maps(float value, float start1, float stop1, float start2, float stop2) {
  return start2 + (stop2 - start2) * ((value - start1) / (stop1 - start1));
}

float getSegmentRatio(float index) {
  return index / (segmentNumber - 1.0);
}

float paraboloid(vec2 source, vec2 target, float ratio) {
  vec2 x = mix(source, target, ratio);
  vec2 center = mix(source, target, 0.5);
  float dSourceCenter = distance(source, center);
  float dXCenter = distance(x, center);
  return (dSourceCenter + dXCenter) * (dSourceCenter - dXCenter);
}

vec3 getPos(vec2 source, vec2 target, float segmentRatio) {
  float vertex_height = paraboloid(source, target, segmentRatio);

  return vec3(mix(source, target, segmentRatio), sqrt(max(0.0, vertex_height)));
}
vec2 getExtrusionOffset(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  vec2 offset = dir_screenspace * offset_direction * setPickingSize(a_Size) / 2.0;
  return offset;
}
vec2 getNormal(vec2 line_clipspace, float offset_direction) {
  // normalized direction of the line
  vec2 dir_screenspace = normalize(line_clipspace);
  // rotate by 90 degrees
  dir_screenspace = vec2(-dir_screenspace.y, dir_screenspace.x);
  return dir_screenspace.xy * sign(offset_direction);
}
float getAngularDist(vec2 source, vec2 target) {
  vec2 delta = source - target;
  vec2 sin_half_delta = sin(delta / 2.0);
  float a =
    sin_half_delta.y * sin_half_delta.y +
    cos(source.y) * cos(target.y) * sin_half_delta.x * sin_half_delta.x;
  return 2.0 * atan(sqrt(a), sqrt(1.0 - a));
}

vec2 midPoint(vec2 source, vec2 target) {
  vec2 center = target - source;
  float r = length(center);
  float theta = atan(center.y, center.x);
  float thetaOffset = 0.314;
  float r2 = r / 2.0 / cos(thetaOffset);
  float theta2 = theta + thetaOffset;
  vec2 mid = vec2(r2 * cos(theta2) + source.x, r2 * sin(theta2) + source.y);
  return mid;
}
float bezier3(vec3 arr, float t) {
  float ut = 1.0 - t;
  return (arr.x * ut + arr.y * t) * ut + (arr.y * ut + arr.z * t) * t;
}

vec2 interpolate(vec2 source, vec2 target, float angularDist, float t) {
  if (abs(angularDist - PI) < 0.001) {
    return (1.0 - t) * source + t * target;
  }
  float a = sin((1.0 - t) * angularDist) / sin(angularDist);
  float b = sin(t * angularDist) / sin(angularDist);
  vec2 sin_source = sin(source);
  vec2 cos_source = cos(source);
  vec2 sin_target = sin(target);
  vec2 cos_target = cos(target);
  float x = a * cos_source.y * cos_source.x + b * cos_target.y * cos_target.x;
  float y = a * cos_source.y * sin_source.x + b * cos_target.y * sin_target.x;
  float z = a * sin_source.y + b * sin_target.y;
  return vec2(atan(y, x), atan(z, sqrt(x * x + y * y)));

}

void main() {
  v_color = a_Color;
  v_color.a = v_color.a * opacity;
  vec2 source = radians(a_Instance.rg);
  vec2 target = radians(a_Instance.ba);
  float angularDist = getAngularDist(source, target);
  float segmentIndex = a_Position.x;
  float segmentRatio = getSegmentRatio(segmentIndex);
  float indexDir = mix(-1.0, 1.0, step(segmentIndex, 0.0));

  if (u_line_type == LineTypeDash) {
    v_distance_ratio = segmentIndex / segmentNumber;
    float total_Distance = pixelDistance(source, target) / 2.0 * PI;
    total_Distance = total_Distance * 16.0; // total_Distance*16.0 调整默认的效果
    v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / total_Distance;
  }

  if (u_animate.x == Animate) {
    v_distance_ratio = segmentIndex / segmentNumber;
  }

  float nextSegmentRatio = getSegmentRatio(segmentIndex + indexDir);
  v_distance_ratio = segmentIndex / segmentNumber;

  vec4 curr = project_position(vec4(degrees(interpolate(source, target, angularDist, segmentRatio)), 0.0, 1.0), a_Instance64Low.xy);
  vec4 next = project_position(vec4(degrees(interpolate(source, target, angularDist, nextSegmentRatio)), 0.0, 1.0), a_Instance64Low.zw);

  // v_normal = getNormal((next.xy - curr.xy) * indexDir, a_Position.y);
  vec2 offset = project_pixel(getExtrusionOffset((next.xy - curr.xy) * indexDir, a_Position.y));
  //  vec4 project_pos = project_position(vec4(curr.xy, 0, 1.0));
  // gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, curr.z, 1.0));

  v_line_data.g = a_Position.x; // 该顶点在弧线上的分段排序
  if (LineTexture == u_line_texture) {
    float d_arcDistrance = length(source - target);
    d_arcDistrance = project_pixel(d_arcDistrance);

    float d_pixelLen = project_pixel(u_icon_step) / 8.0;
    v_line_data.b = floor(d_arcDistrance / d_pixelLen); // 贴图在弧线上重复的数量

    float lineOffsetWidth = length(offset + offset * sign(a_Position.y)); // 线横向偏移的距离
    float linePixelSize = project_pixel(a_Size); // 定点位置偏移，按地图等级缩放后的距离
    v_line_data.a = lineOffsetWidth / linePixelSize; // 线图层贴图部分的 v 坐标值

    v_iconMapUV = a_iconMapUV;
  }

  gl_Position = project_common_position_to_clipspace(vec4(curr.xy + offset, 0, 1.0));
  setPickingColor(a_PickingColor);
}

`,Oee={solid:0,dash:1};class Mee extends nn{constructor(...t){super(...t),L(this,"texture",void 0),L(this,"updateTexture",()=>{const{createTexture2D:r}=this.rendererService;if(this.texture){this.texture.update({data:this.iconService.getCanvas()}),this.layer.render();return}this.texture=r({data:this.iconService.getCanvas(),mag:N.NEAREST,min:N.NEAREST,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128}),this.textures=[this.texture]})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,INSTANCE:10,INSTANCE_64LOW:11,UV:12})}getCommonUniformsInfo(){const{sourceColor:t,targetColor:r,textureBlend:n="normal",lineType:i="solid",dashArray:a=[10,5],lineTexture:s=!1,iconStep:l=100,segmentNumber:c=30}=this.layer.getLayerConfig(),{animateOption:d}=this.layer.getLayerConfig();if(a.length===2&&a.push(0,0),this.rendererService.getDirty()){var p;(p=this.texture)===null||p===void 0||p.bind()}let h=0,m=[0,0,0,0],_=[0,0,0,0];t&&r&&(m=$r(t),_=$r(r),h=1);let y=this.layer.getLayerAnimateTime();isNaN(y)&&(y=0);const E={u_animate:this.animateOption2Array(d),u_dash_array:a,u_sourceColor:m,u_targetColor:_,u_textSize:[1024,this.iconService.canvasHeight||128],segmentNumber:c,u_line_type:Oee[i]||0,u_icon_step:l,u_line_texture:s?1:0,u_textureBlend:n==="normal"?0:1,u_time:y,u_linearColor:h};return this.getUniformsBufferInfo(E)}initModels(){var t=this;return Ze(function*(){return t.initUniformsBuffer(),t.updateTexture(),t.iconService.on("imageUpdate",t.updateTexture),t.buildModels()})()}clearModels(){var t;(t=this.texture)===null||t===void 0||t.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}buildModels(){var t=this;return Ze(function*(){const{segmentNumber:r=30}=t.layer.getLayerConfig();return[yield t.layer.buildLayerModel({moduleName:"lineGreatCircle",vertexShader:Cee,fragmentShader:Ree,triangulation:wR,styleOption:{segmentNumber:r},defines:t.getDefines(),inject:t.getInject(),depth:{enable:!1}})]})()}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Dt.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:1,update:t=>{const{size:r=1}=t;return Array.isArray(r)?[r[0]]:[r]}}}),this.styleAttributeService.registerStyleAttribute({name:"instance",type:Dt.Attribute,descriptor:{name:"a_Instance",shaderLocation:this.attributeLocation.INSTANCE,buffer:{usage:N.STATIC_DRAW,data:[],type:N.FLOAT},size:4,update:(t,r,n)=>[n[3],n[4],n[5],n[6]]}}),this.styleAttributeService.registerStyleAttribute({name:"instance64Low",type:Dt.Attribute,descriptor:{name:"a_Instance64Low",shaderLocation:this.attributeLocation.INSTANCE_64LOW,buffer:{usage:N.STATIC_DRAW,data:[],type:N.FLOAT},size:4,update:(t,r,n)=>[Wn(n[3]),Wn(n[4]),Wn(n[5]),Wn(n[6])]}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Dt.Attribute,descriptor:{name:"a_iconMapUV",shaderLocation:this.attributeLocation.UV,buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:2,update:t=>{const r=this.iconService.getIconMap(),{texture:n}=t,{x:i,y:a}=r[n]||{x:0,y:0};return[i,a]}}})}}const wee=`// #extension GL_OES_standard_derivatives : enable
#define Animate 0.0
#define LineTexture 1.0

uniform sampler2D u_texture;
layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array;
  vec4 u_blur;
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float u_icon_step: 100;
  float u_heightfixed: 0.0;
  float u_vertexScale: 1.0;
  float u_raisingHeight: 0.0;
  float u_strokeWidth: 0.0;
  float u_textureBlend;
  float u_line_texture;
  float u_linearDir: 1.0;
  float u_linearColor: 0;
  float u_time;
};

in vec4 v_color;
in vec4 v_stroke;
// dash
in vec4 v_dash_array;
in float v_d_distance_ratio;
in vec2 v_iconMapUV;
in vec4 v_texture_data;

out vec4 outputColor;
#pragma include "picking"

// [animate, duration, interval, trailLength],
void main() {
  if(u_dash_array!=vec4(0.0)){
    float dashLength = mod(v_d_distance_ratio, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(!(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z))) {
      // 虚线部分
      discard;
    };
  }
  float animateSpeed = 0.0; // 运动速度
  float d_distance_ratio = v_texture_data.r; // 当前点位距离占线总长的比例
  if(u_linearDir < 1.0) {
    d_distance_ratio = v_texture_data.a;
  }
  if(u_linearColor == 1.0) { // 使用渐变颜色
    outputColor = mix(u_sourceColor, u_targetColor, d_distance_ratio);
    outputColor.a *= v_color.a;
  } else { // 使用 color 方法传入的颜色
     outputColor = v_color;
  }
  // anti-alias
  // float blur = 1.0 - smoothstep(u_blur, 1., length(v_normal.xy));
  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
       float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + animateSpeed);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      alpha = smoothstep(0., 1., alpha);
      outputColor.a *= alpha;
  }

  if(u_line_texture == LineTexture) { // while load texture
    float aDistance = v_texture_data.g;      // 当前顶点的距离
    float d_texPixelLen = v_texture_data.b;  // 贴图的像素长度，根据地图层级缩放
    float u = fract(mod(aDistance, d_texPixelLen)/d_texPixelLen - animateSpeed);
    float v = v_texture_data.a;  // 线图层贴图部分的 v 坐标值

    // v = max(smoothstep(0.95, 1.0, v), v);
    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
     vec4 pattern = texture(SAMPLER_2D(u_texture), uv);

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      outputColor += pattern;
    } else { // replace
        pattern.a *= v_color.a;
        if(outputColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        outputColor = pattern;
    }
  } 

  float v = v_texture_data.a;
  float strokeWidth = min(0.5, u_strokeWidth);
  // 绘制 border
  if(strokeWidth > 0.01) {
    float borderOuterWidth = strokeWidth / 2.0;


    if(v >= 1.0 - strokeWidth || v <= strokeWidth) {
      if(v > strokeWidth) { // 外侧
        float linear = smoothstep(0.0, 1.0, (v - (1.0 - strokeWidth))/strokeWidth);
        //  float linear = step(0.0, (v - (1.0 - borderWidth))/borderWidth);
        outputColor.rgb = mix(outputColor.rgb, v_stroke.rgb, linear);
      } else if(v <= strokeWidth) {
        float linear = smoothstep(0.0, 1.0, v/strokeWidth);
        outputColor.rgb = mix(v_stroke.rgb, outputColor.rgb, linear);
      }
    }

    if(v < borderOuterWidth) {
      outputColor.a = mix(0.0, outputColor.a, v/borderOuterWidth);
    } else if(v > 1.0 - borderOuterWidth) {
      outputColor.a = mix(outputColor.a, 0.0, (v - (1.0 - borderOuterWidth))/borderOuterWidth);
    }
  }

  // blur
  float blurV = v_texture_data.a;
  if(blurV < 0.5) {
    outputColor.a *= mix(u_blur.r, u_blur.g, blurV/0.5);
  } else {
    outputColor.a *= mix(u_blur.g, u_blur.b, (blurV - 0.5)/0.5);
  }
  
  outputColor = filterColor(outputColor);
}
`,Nee=`#define Animate (0.0)

layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in vec2 a_Size;
layout(location = ATTRIBUTE_LOCATION_DISTANCE_INDEX) in vec3 a_DistanceAndIndexAndMiter;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec4 a_Normal_Total_Distance;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_iconMapUV;

layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_dash_array;
  vec4 u_blur;
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float u_icon_step: 100;
  float u_heightfixed: 0.0;
  float u_vertexScale: 1.0;
  float u_raisingHeight: 0.0;
  float u_strokeWidth: 0.0;
  float u_textureBlend;
  float u_line_texture;
  float u_linearDir: 1.0;
  float u_linearColor: 0;
  float u_time;
};

out vec4 v_color;
out vec4 v_stroke;
//dash
out vec4 v_dash_array;
out float v_d_distance_ratio;
// texV 线图层 - 贴图部分的 v 坐标（线的宽度方向）
out vec2 v_iconMapUV;
out vec4 v_texture_data;

#pragma include "projection"
#pragma include "picking"

void main() {
  vec2 a_DistanceAndIndex = a_DistanceAndIndexAndMiter.xy;
  float a_Miter = a_DistanceAndIndexAndMiter.z;
  vec3 a_Normal = a_Normal_Total_Distance.xyz;
  float a_Total_Distance = a_Normal_Total_Distance.w;
  //dash输出
  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / a_Total_Distance;
  v_d_distance_ratio = a_DistanceAndIndex.x / a_Total_Distance;

  // cal style mapping - 数据纹理映射部分的计算
  float d_texPixelLen; // 贴图的像素长度，根据地图层级缩放
  v_iconMapUV = a_iconMapUV;
  d_texPixelLen = project_float_pixel(u_icon_step);

  v_color = a_Color;
  v_color.a *= opacity;
  v_stroke = stroke;

  vec3 size = a_Miter * setPickingSize(a_Size.x) * a_Normal;

  vec2 offset = project_pixel(size.xy);

  float lineDistance = a_DistanceAndIndex.x;
  float currentLinePointRatio = lineDistance / a_Total_Distance;

  float lineOffsetWidth = length(offset + offset * sign(a_Miter)); // 线横向偏移的距离（向两侧偏移的和）
  float linePixelSize = project_pixel(a_Size.x) * 2.0; // 定点位置偏移，按地图等级缩放后的距离 单侧 * 2
  float texV = lineOffsetWidth / linePixelSize; // 线图层贴图部分的 v 坐标值

  v_texture_data = vec4(currentLinePointRatio, lineDistance, d_texPixelLen, texV);
  // 设置数据集的参数

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0), a_Position64Low);

  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, a_Size.y, 1.0));

  float h = float(a_Position.z) * u_vertexScale; // 线顶点的高度 - 兼容不存在第三个数值的情况 vertex height
  float lineHeight = a_Size.y; // size 第二个参数代表的高度 [linewidth, lineheight]

  // 兼容 mapbox 在线高度上的效果表现基本一致
  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // mapbox
    // 保持高度相对不变
    float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);
    h *= mapboxZoomScale;
    h += u_raisingHeight * mapboxZoomScale;
    if (u_heightfixed > 0.0) {
      lineHeight *= mapboxZoomScale;
    }
  }

  gl_Position = project_common_position_to_clipspace(
    vec4(project_pos.xy + offset, lineHeight + h, 1.0)
  );

  setPickingColor(a_PickingColor);
}
`;class Q6 extends nn{constructor(...t){super(...t),L(this,"textureEventFlag",!1),L(this,"texture",this.createTexture2D({data:new Uint8Array([0,0,0,0]),width:1,height:1})),L(this,"updateTexture",()=>{const{createTexture2D:r}=this.rendererService;if(this.textures.length===0&&(this.textures=[this.texture]),this.texture){this.texture.update({data:this.iconService.getCanvas()}),this.layer.render();return}this.texture=r({data:this.iconService.getCanvas(),mag:N.NEAREST,min:N.NEAREST,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128})})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,DISTANCE_INDEX:10,NORMAL:11,UV:12})}getCommonUniformsInfo(){const{sourceColor:t,targetColor:r,textureBlend:n="normal",lineType:i="solid",dashArray:a=[10,5,0,0],lineTexture:s=!1,iconStep:l=100,vertexHeightScale:c=20,strokeWidth:d=0,raisingHeight:p=0,heightfixed:h=!1,linearDir:m=M4.VERTICAL,blur:_=[1,1,1,0]}=this.layer.getLayerConfig();let y=a;if(i!=="dash"&&(y=[0,0,0,0]),y.length===2&&y.push(0,0),this.rendererService.getDirty()&&this.texture){var E;(E=this.texture)===null||E===void 0||E.bind()}const{animateOption:T}=this.layer.getLayerConfig();let A=0,b=[0,0,0,0],R=[0,0,0,0];t&&r&&(b=$r(t),R=$r(r),A=1);const M={u_animate:this.animateOption2Array(T),u_dash_array:y,u_blur:_,u_sourceColor:b,u_targetColor:R,u_textSize:[1024,this.iconService.canvasHeight||128],u_icon_step:l,u_heightfixed:Number(h),u_vertexScale:c,u_raisingHeight:Number(p),u_strokeWidth:d,u_textureBlend:n===GJ.NORMAL?0:1,u_line_texture:s?1:0,u_linearDir:m===M4.VERTICAL?1:0,u_linearColor:A,u_time:this.layer.getLayerAnimateTime()||0};return this.getUniformsBufferInfo(M)}initModels(){var t=this;return Ze(function*(){return t.initUniformsBuffer(),t.textureEventFlag||(t.textureEventFlag=!0,t.updateTexture(),t.iconService.on("imageUpdate",t.updateTexture)),t.buildModels()})()}clearModels(){var t;(t=this.texture)===null||t===void 0||t.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}buildModels(){var t=this;return Ze(function*(){const{depth:r=!1}=t.layer.getLayerConfig(),{frag:n,vert:i,type:a}=t.getShaders();return t.layer.triangulation=nx,[yield t.layer.buildLayerModel({moduleName:"line"+a,vertexShader:i,fragmentShader:n,triangulation:nx,defines:t.getDefines(),inject:t.getInject(),depth:{enable:r}})]})()}getShaders(){return{frag:wee,vert:Nee,type:""}}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"distanceAndIndex",type:Dt.Attribute,descriptor:{name:"a_DistanceAndIndexAndMiter",shaderLocation:this.attributeLocation.DISTANCE_INDEX,buffer:{usage:N.STATIC_DRAW,data:[],type:N.FLOAT},size:3,update:(t,r,n,i,a,s)=>s===void 0?[n[3],10,n[4]]:[n[3],s,n[4]]}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Dt.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:2,update:t=>{const{size:r=1}=t;return Array.isArray(r)?[r[0],r[1]]:[r,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal_total_distance",type:Dt.Attribute,descriptor:{name:"a_Normal_Total_Distance",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:N.STATIC_DRAW,data:[],type:N.FLOAT},size:4,update:(t,r,n,i,a)=>[...a,n[5]]}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Dt.Attribute,descriptor:{name:"a_iconMapUV",shaderLocation:this.attributeLocation.UV,buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:2,update:t=>{const r=this.iconService.getIconMap(),{texture:n}=t,{x:i,y:a}=r[n]||{x:0,y:0};return[i,a]}}})}}const Iee=`
layout(std140) uniform commonUniorm {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec4 u_dash_array;
  float u_vertexScale: 1.0;
  float u_linearColor: 0;
};
in float v_distanceScale;
in vec4 v_color;
//dash
in vec4 v_dash_array;

out vec4 outputColor;
void main() {
  if(u_dash_array!=vec4(0.0)){
    float dashLength = mod(v_distanceScale, v_dash_array.x + v_dash_array.y + v_dash_array.z + v_dash_array.w);
    if(!(dashLength < v_dash_array.x || (dashLength > (v_dash_array.x + v_dash_array.y) && dashLength <  v_dash_array.x + v_dash_array.y + v_dash_array.z))) {
      // 虚线部分
      discard;
    };
  }
  if(u_linearColor==1.0){
    outputColor = mix(u_sourceColor, u_targetColor, v_distanceScale);
    outputColor.a *= v_color.a; // 全局透明度
  }
  else{
    outputColor = v_color;
  }
}
`,Pee=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in vec4 a_SizeDistanceAndTotalDistance;

layout(std140) uniform commonUniorm {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec4 u_dash_array;
  float u_vertexScale: 1.0;
  float u_linearColor: 0;
};

#pragma include "projection"
#pragma include "picking"

out vec4 v_color;
out float v_distanceScale;
out vec4 v_dash_array;

void main() {
  //dash输出
  v_dash_array = pow(2.0, 20.0 - u_Zoom) * u_dash_array / a_SizeDistanceAndTotalDistance.a;

  v_color = a_Color;
  v_distanceScale = a_SizeDistanceAndTotalDistance.b / a_SizeDistanceAndTotalDistance.a;
  v_color.a = v_color.a * opacity;
  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0), a_Position64Low);

  float h = float(a_Position.z) * u_vertexScale; // 线顶点的高度 - 兼容不存在第三个数值的情况

  float lineHeight = a_SizeDistanceAndTotalDistance.y;
  // 兼容 mapbox 在线高度上的效果表现基本一致
  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // 保持高度相对不变
    h *= 2.0 / pow(2.0, 20.0 - u_Zoom);
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, lineHeight + h, 1.0));
  gl_PointSize = 10.0;

}
`;class Dee extends nn{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9})}getCommonUniformsInfo(){const{sourceColor:t,targetColor:r,lineType:n="solid",dashArray:i=[10,5,0,0],vertexHeightScale:a=20}=this.layer.getLayerConfig();let s=i;n!=="dash"&&(s=[0,0,0,0]),s.length===2&&s.push(0,0);let l=0,c=[0,0,0,0],d=[0,0,0,0];t&&r&&(c=$r(t),d=$r(r),l=1);const p={u_sourceColor:c,u_targetColor:d,u_dash_array:s,u_vertexScale:a,u_linearColor:l};return this.getUniformsBufferInfo(p)}initModels(){var t=this;return Ze(function*(){return t.buildModels()})()}getShaders(){return{frag:Iee,vert:Pee,type:"lineSimpleNormal"}}buildModels(){var t=this;return Ze(function*(){t.initUniformsBuffer();const{frag:r,vert:n,type:i}=t.getShaders();return[yield t.layer.buildLayerModel({moduleName:i,vertexShader:n,fragmentShader:r,triangulation:$J,defines:t.getDefines(),inject:t.getInject(),primitive:N.LINES,depth:{enable:!1},pick:!1})]})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"sizeDistanceAndTotalDistance",type:Dt.Attribute,descriptor:{name:"a_SizeDistanceAndTotalDistance",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:N.STATIC_DRAW,data:[],type:N.FLOAT},size:4,update:(t,r,n)=>{const{size:i=1}=t,a=Array.isArray(i)?[i[0],i[1]]:[i,0];return[a[0],a[1],n[3],n[5]]}}})}}const Lee=`#define Animate 0.0
#define LineTexture 1.0

// line texture

uniform sampler2D u_texture;
layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float u_icon_step: 100;
  float u_heightfixed;
  float u_linearColor: 0;
  float u_line_texture;
  float u_textureBlend;
  float u_iconStepCount;
  float u_time;
};


in vec2 v_iconMapUV;
in vec4 v_color;
in float v_blur;
in vec4 v_dataset;

out vec4 outputColor;

#pragma include "picking"

void main() {
  float animateSpeed = 0.0; // 运动速度
  float d_distance_ratio = v_dataset.r; // 当前点位距离占线总长的比例
  float v = v_dataset.a;

  if(u_linearColor == 1.0) { // 使用渐变颜色
    outputColor = mix(u_sourceColor, u_targetColor, v);
  } else { // 使用 color 方法传入的颜色
     outputColor = v_color;
  }

  outputColor.a *= v_color.a; // 全局透明度
  if(u_animate.x == Animate) {
      animateSpeed = u_time / u_animate.y;
       float alpha =1.0 - fract( mod(1.0- d_distance_ratio, u_animate.z)* (1.0/ u_animate.z) + animateSpeed);
      alpha = (alpha + u_animate.w -1.0) / u_animate.w;
      alpha = smoothstep(0., 1., alpha);
      outputColor.a *= alpha;
  }

  if(u_line_texture == LineTexture) { // while load texture
    float aDistance = v_dataset.g;      // 当前顶点的距离
    float d_texPixelLen = v_dataset.b;  // 贴图的像素长度，根据地图层级缩放
    float u = fract(mod(aDistance, d_texPixelLen)/d_texPixelLen - animateSpeed);
    float v = v_dataset.a;  // 线图层贴图部分的 v 坐标值

    // 计算纹理间隔 start
    float flag = 0.0;
    if(u > 1.0/u_iconStepCount) {
      flag = 1.0;
    }
    u = fract(u*u_iconStepCount);
    // 计算纹理间隔 end

    vec2 uv= v_iconMapUV / u_textSize + vec2(u, v) / u_textSize * 64.;
    vec4 pattern = texture(SAMPLER_2D(u_texture), uv);

    // Tip: 判断纹理间隔
    if(flag > 0.0) {
      pattern = vec4(0.0);
    }

    if(u_textureBlend == 0.0) { // normal
      pattern.a = 0.0;
      outputColor = filterColor(outputColor + pattern);
    } else { // replace
        pattern.a *= v_color.a;
        if(outputColor.a <= 0.0) {
          pattern.a = 0.0;
        }
        outputColor = filterColor(pattern);
    }
  }


  // blur - AA
  if(v < v_blur) {
    outputColor.a = mix(0.0, outputColor.a, v/v_blur);
  } else if(v > 1.0 - v_blur) {
    outputColor.a = mix(outputColor.a, 0.0, (v - (1.0 - v_blur))/v_blur);
  }

  outputColor = filterColor(outputColor);
}
`,Bee=`#define Animate 0.0
layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in vec2 a_Size;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_iconMapUV;
layout(location = ATTRIBUTE_LOCATION_DISTANCE_MITER_TOTAL) in vec3 a_Distance_Total_Miter;

layout(std140) uniform commonUniorm {
  vec4 u_animate: [ 1., 2., 1.0, 0.2 ];
  vec4 u_sourceColor;
  vec4 u_targetColor;
  vec2 u_textSize;
  float u_icon_step: 100;
  float u_heightfixed;
  float u_linearColor: 0;
  float u_line_texture;
  float u_textureBlend;
  float u_iconStepCount;
  float u_time;
};

// texV 线图层 - 贴图部分的 v 坐标（线的宽度方向）
out vec2 v_iconMapUV;
out vec4 v_color;
out float v_blur;
out vec4 v_dataset;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  float a_Distance = a_Distance_Total_Miter.x;
  float a_Miter = a_Distance_Total_Miter.y;
  float a_Total_Distance = a_Distance_Total_Miter.z;

  float d_distance_ratio; // 当前点位距离占线总长的比例
  float d_texPixelLen; // 贴图的像素长度，根据地图层级缩放

  v_iconMapUV = a_iconMapUV;
  if (u_heightfixed < 1.0) {
    // 高度随 zoom 调整
    d_texPixelLen = project_pixel(u_icon_step);
  } else {
    d_texPixelLen = u_icon_step;
  }

  if (u_animate.x == Animate || u_linearColor == 1.0) {
    d_distance_ratio = a_Distance / a_Total_Distance;
  }

  float miter = (a_Miter + 1.0) / 2.0;
  // 设置数据集的参数
  v_dataset[0] = d_distance_ratio; // 当前点位距离占线总长的比例
  v_dataset[1] = a_Distance; // 当前顶点的距离
  v_dataset[2] = d_texPixelLen; // 贴图的像素长度，根据地图层级缩放
  v_dataset[3] = miter; // 线图层贴图部分的 v 坐标值 0 - 1

  vec4 project_pos = project_position(vec4(a_Position.xy, 0, 1.0), a_Position64Low);

  float originSize = a_Size.x; // 固定高度
  if (u_heightfixed < 1.0) {
    originSize = project_float_meter(a_Size.x); // 高度随 zoom 调整
  }

  float wallHeight = originSize * miter;
  float lightWeight = calc_lighting(vec4(project_pos.xy, wallHeight, 1.0));

  v_blur = min(project_float_pixel(2.0) / originSize, 0.05);
  v_color = vec4(a_Color.rgb * lightWeight, a_Color.w * opacity);

  // 兼容 mapbox 在线高度上的效果表现基本一致
  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    // mapbox
    // 保持高度相对不变
    float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);
    if (u_heightfixed > 0.0) {
      wallHeight *= mapboxZoomScale;
    }
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, wallHeight, 1.0));

  setPickingColor(a_PickingColor);
}
`;class Fee extends nn{constructor(...t){super(...t),L(this,"texture",void 0),L(this,"updateTexture",()=>{const{createTexture2D:r}=this.rendererService;if(this.texture){this.texture.update({data:this.iconService.getCanvas()}),this.layer.render();return}this.texture=r({data:this.iconService.getCanvas(),mag:N.NEAREST,min:N.NEAREST,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128}),this.textures=[this.texture]})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,NORMAL:12,UV:13,DISTANCE_MITER_TOTAL:15})}getCommonUniformsInfo(){const{sourceColor:t,targetColor:r,textureBlend:n="normal",heightfixed:i=!1,lineTexture:a=!1,iconStep:s=100,iconStepCount:l=1}=this.layer.getLayerConfig(),{animateOption:c}=this.layer.getLayerConfig();if(this.rendererService.getDirty()){var d;(d=this.texture)===null||d===void 0||d.bind()}let p=0,h=[0,0,0,0],m=[0,0,0,0];t&&r&&(h=$r(t),m=$r(r),p=1);const _={u_animate:this.animateOption2Array(c),u_sourceColor:h,u_targetColor:m,u_textSize:[1024,this.iconService.canvasHeight||128],u_icon_step:s,u_heightfixed:Number(i),u_linearColor:p,u_line_texture:a?1:0,u_textureBlend:n==="normal"?0:1,u_iconStepCount:l,u_time:this.layer.getLayerAnimateTime()||0};return this.getUniformsBufferInfo(_)}initModels(){var t=this;return Ze(function*(){return t.initUniformsBuffer(),t.updateTexture(),t.iconService.on("imageUpdate",t.updateTexture),t.buildModels()})()}clearModels(){var t;(t=this.texture)===null||t===void 0||t.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}buildModels(){var t=this;return Ze(function*(){return[yield t.layer.buildLayerModel({moduleName:"lineWall",vertexShader:Bee,fragmentShader:Lee,triangulation:nx,defines:t.getDefines(),inject:t.getInject(),depth:{enable:!1},blend:t.getBlend()})]})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"size",type:Dt.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:2,update:t=>{const{size:r=1}=t;return Array.isArray(r)?[r[0],r[1]]:[r,0]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Dt.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:N.STATIC_DRAW,data:[],type:N.FLOAT},size:3,update:(t,r,n,i,a)=>a}}),this.styleAttributeService.registerStyleAttribute({name:"distanceAndTotalAndMiter",type:Dt.Attribute,descriptor:{name:"a_Distance_Total_Miter",shaderLocation:this.attributeLocation.DISTANCE_MITER_TOTAL,buffer:{usage:N.STATIC_DRAW,data:[],type:N.FLOAT},size:3,update:(t,r,n)=>[n[3],n[4],n[5]]}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Dt.Attribute,descriptor:{name:"a_iconMapUV",shaderLocation:this.attributeLocation.UV,buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:2,update:t=>{const r=this.iconService.getIconMap(),{texture:n}=t,{x:i,y:a}=r[n]||{x:0,y:0};return[i,a]}}})}}const Uee={arc:lee,arc3d:z4,greatcircle:Mee,wall:Fee,line:Q6,simple:Dee,flowline:xee,earthArc3d:z4};class J6 extends ah{constructor(...t){super(...t),L(this,"type","LineLayer"),L(this,"enableShaderEncodeStyles",["stroke","offsets","opacity","thetaOffset"]),L(this,"arrowInsertCount",0),L(this,"defaultSourceConfig",{data:[{lng1:100,lat1:30,lng2:130,lat2:30}],options:{parser:{type:"json",x:"lng1",y:"lat1",x1:"lng2",y1:"lat2"}}})}buildModels(){var t=this;return Ze(function*(){const r=t.getModelType();t.layerModel=new Uee[r](t),yield t.initLayerModels()})()}getDefaultConfig(){const t=this.getModelType();return{line:{},linearline:{},simple:{},wall:{},arc3d:{blend:"additive"},arc:{blend:"additive"},greatcircle:{blend:"additive"},tileLine:{},earthArc3d:{},flowline:{},arrow:{}}[t]}getModelType(){var t;if(this.layerType)return this.layerType;const r=this.styleAttributeService.getLayerStyleAttribute("shape");return(r==null||(t=r.scale)===null||t===void 0?void 0:t.field)||"line"}processData(t){if(this.getModelType()!=="simple")return t;const r=[];return t.map(n=>{if(Array.isArray(n.coordinates)&&Array.isArray(n.coordinates[0])&&Array.isArray(n.coordinates[0][0])){const i=Ge({},n);n.coordinates.map(a=>{r.push(Ge(Ge({},i),{},{coordinates:a}))})}else r.push(n)}),r}}const kee=`
layout(std140) uniform commonUniorm {
  vec4 u_stroke_color;
  float u_additive;
  float u_stroke_opacity;
  float u_stroke_width;
};

in vec4 v_color;
in float v_blur;
in float v_innerRadius;

out vec4 outputColor;

#pragma include "picking"
void main() {
  vec2 center = vec2(0.5);

  // Tip: 片元到中心点的距离 0 - 1
  float fragmengTocenter = distance(center, gl_PointCoord) * 2.0;
  // Tip: 片元的剪切成圆形
  float circleClipOpacity = 1.0 - smoothstep(v_blur, 1.0, fragmengTocenter);


  if(v_innerRadius < 0.99) {
    // 当存在 stroke 且 stroke > 0.01
    float blurWidth = (1.0 - v_blur)/2.0;
    vec4 stroke = vec4(u_stroke_color.rgb, u_stroke_opacity);
    if(fragmengTocenter > v_innerRadius + blurWidth) {
      outputColor = stroke;
    } else if(fragmengTocenter > v_innerRadius - blurWidth){
      float mixR = (fragmengTocenter - (v_innerRadius - blurWidth)) / (blurWidth * 2.0);
      outputColor = mix(v_color, stroke, mixR);
    } else {
      outputColor = v_color;
    }
  } else {
    // 当不存在 stroke 或 stroke <= 0.01
    outputColor = v_color;
  }

  outputColor = filterColor(outputColor);
  
  if(u_additive > 0.0) {
    outputColor *= circleClipOpacity;
  } else {
    outputColor.a *= circleClipOpacity;
  }

}
`,zee=`
layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;

layout(std140) uniform commonUniorm {
  vec4 u_stroke_color;
  float u_additive;
  float u_stroke_opacity;
  float u_stroke_width;
};

out vec4 v_color;
out float v_blur;
out float v_innerRadius;

#pragma include "projection"
#pragma include "picking"
#pragma include "project"
void main() {
  v_color = vec4(a_Color.xyz, a_Color.w * opacity);
  v_blur = 1.0 - max(2.0 / a_Size, 0.05);
  v_innerRadius = max((a_Size - u_stroke_width) / a_Size, 0.0);

  vec2 offset = project_pixel(u_offsets);

  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);
  gl_Position = project_common_position_to_clipspace(vec4(vec2(project_pos.xy+offset),project_pos.z,project_pos.w));

  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
  setPickingColor(a_PickingColor);
}
`;function X4(e){const t=e.coordinates;return{vertices:[...t],indices:[0],size:t.length}}class jee extends nn{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9})}getDefaultStyle(){return{blend:"additive"}}getCommonUniformsInfo(){const{blend:t,strokeOpacity:r=1,strokeWidth:n=0,stroke:i="#fff"}=this.layer.getLayerConfig(),a={u_stroke_color:$r(i),u_additive:t==="additive"?1:0,u_stroke_opacity:r,u_stroke_width:n};return this.getUniformsBufferInfo(a)}initModels(){var t=this;return Ze(function*(){return t.buildModels()})()}buildModels(){var t=this;return Ze(function*(){return t.layer.triangulation=X4,t.initUniformsBuffer(),[yield t.layer.buildLayerModel({moduleName:"pointSimple",vertexShader:zee,fragmentShader:kee,defines:t.getDefines(),inject:t.getInject(),triangulation:X4,depth:{enable:!1},primitive:N.POINTS})]})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"size",type:Dt.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:1,update:t=>{const{size:r=1}=t;return Array.isArray(r)?[r[0]]:[r]}}})}}const Hee=`precision highp float;
in vec4 v_color;

#pragma include "picking"

layout(std140) uniform commonUniform {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor: 0;
  float u_heightfixed: 0.0; // 默认不固定
  float u_globel;
  float u_r;
  float u_pickLight: 0.0;
  float u_opacitylinear: 0.0;
  float u_opacitylinear_dir: 1.0;
  float u_lightEnable: 1.0;
};
in float v_lightWeight;
in float v_barLinearZ;
out vec4 outputColor;
void main() {

   outputColor = v_color;

  // 开启透明度渐变
  if(u_opacitylinear > 0.0) {
    outputColor.a *= u_opacitylinear_dir > 0.0 ? (1.0 - v_barLinearZ): v_barLinearZ;
  }

  // picking
  if(u_pickLight > 0.0) {
    outputColor = filterColorAlpha(outputColor, v_lightWeight);
  } else {
    outputColor = filterColor(outputColor);
  }
}
`,Vee=`precision highp float;

#define pi 3.1415926535
#define ambientRatio 0.5
#define diffuseRatio 0.3
#define specularRatio 0.2

layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in vec3 a_Size;
layout(location = ATTRIBUTE_LOCATION_POS) in vec3 a_Pos;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;

layout(std140) uniform commonUniform {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor: 0;
  float u_heightfixed: 0.0; // 默认不固定
  float u_globel;
  float u_r;
  float u_pickLight: 0.0;
  float u_opacitylinear: 0.0;
  float u_opacitylinear_dir: 1.0;
  float u_lightEnable: 1.0;
};

out vec4 v_color;
out float v_lightWeight;
out float v_barLinearZ;
// 用于将在顶点着色器中计算好的样式值传递给片元


#pragma include "projection"
#pragma include "light"
#pragma include "picking"

float getYRadian(float x, float z) {
  if(x > 0.0 && z > 0.0) {
    return atan(x/z);
  } else if(x > 0.0 && z <= 0.0){
    return atan(-z/x) + pi/2.0;
  } else if(x <= 0.0 && z <= 0.0) {
    return  pi + atan(x/z); //atan(x/z) +
  } else {
    return atan(z/-x) + pi*3.0/2.0;
  }
}

float getXRadian(float y, float r) {
  return atan(y/r);
}

void main() {

  // cal style mapping - 数据纹理映射部分的计算
  vec3 size = a_Size * a_Position;

  // a_Position.z 是在构建网格的时候传入的标准值 0 - 1，在插值器插值可以获取 0～1 线性渐变的值
  v_barLinearZ =  a_Position.z;

  vec3 offset = size; // 控制圆柱体的大小 - 从标准单位圆柱体进行偏移
  if(u_heightfixed < 1.0) { // 圆柱体不固定高度
    //
  } else {// 圆柱体固定高度 （ 处理 mapbox ）
    if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      offset *= 4.0/pow(2.0, 21.0 - u_Zoom);
    }
  }


  vec4 project_pos = project_position(vec4(a_Pos.xy, 0., 1.0));

  // u_r 控制圆柱的生长
  vec4 pos = vec4(project_pos.xy + offset.xy, offset.z * u_r, 1.0);

  // 圆柱光照效果
  float lightWeight = 1.0;
  if(u_lightEnable > 0.0) { // 取消三元表达式，增强健壮性
    lightWeight = calc_lighting(pos);
  }
  v_lightWeight = lightWeight;
  // 设置圆柱的底色
  if(u_linearColor == 1.0) { // 使用渐变颜色
    v_color = mix(u_sourceColor, u_targetColor, v_barLinearZ);
    v_color.rgb *= lightWeight;
  } else { // 使用 color 方法传入的颜色
     v_color = a_Color;
  }
  v_color.a *= u_opacity;


  // 在地球模式下，将原本垂直于 xy 平面的圆柱调整姿态到适应圆的角度
  //旋转矩阵mx，创建绕x轴旋转矩阵
  float r = sqrt(a_Pos.z*a_Pos.z + a_Pos.x*a_Pos.x);
  float xRadian = getXRadian(a_Pos.y, r);
  float xcos = cos(xRadian);//求解旋转角度余弦值
  float xsin = sin(xRadian);//求解旋转角度正弦值
  mat4 mx = mat4(
    1,0,0,0,
    0,xcos,-xsin,0,
    0,xsin,xcos,0,
    0,0,0,1);

  //旋转矩阵my，创建绕y轴旋转矩阵
  float yRadian = getYRadian(a_Pos.x, a_Pos.z);
  float ycos = cos(yRadian);//求解旋转角度余弦值
  float ysin = sin(yRadian);//求解旋转角度正弦值
  mat4 my = mat4(
    ycos,0,-ysin,0,
    0,1,0,0,
    ysin,0,ycos,0,
    0,0,0,1);

  gl_Position = u_ViewProjectionMatrix * vec4(( my * mx *  vec4(a_Position * a_Size, 1.0)).xyz + a_Pos, 1.0);


  setPickingColor(a_PickingColor);
}
`,{isNumber:Xee}=yn;let Gee=class extends nn{constructor(...t){super(...t),L(this,"raiseCount",0),L(this,"raiseRepeat",0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,POS:10,NORMAL:11})}getCommonUniformsInfo(){const{animateOption:t={enable:!1,speed:.01,repeat:!1},opacity:r=1,sourceColor:n,targetColor:i,pickLight:a=!1,heightfixed:s=!0,opacityLinear:l={enable:!1,dir:"up"},lightEnable:c=!0}=this.layer.getLayerConfig();let d=0,p=[0,0,0,0],h=[0,0,0,0];if(n&&i&&(p=$r(n),h=$r(i),d=1),this.raiseCount<1&&this.raiseRepeat>0&&t.enable){const{speed:y=.01}=t;this.raiseCount+=y,this.raiseCount>=1&&(this.raiseRepeat>1?(this.raiseCount=0,this.raiseRepeat--):this.raiseCount=1)}const m={u_sourceColor:p,u_targetColor:h,u_linearColor:d,u_pickLight:Number(a),u_heightfixed:Number(s),u_r:t.enable&&this.raiseRepeat>0?this.raiseCount:1,u_opacity:Xee(r)?r:1,u_opacitylinear:Number(l.enable),u_opacitylinear_dir:l.dir==="up"?1:0,u_lightEnable:Number(c)};return this.getUniformsBufferInfo(m)}initModels(){var t=this;return Ze(function*(){return t.initUniformsBuffer(),t.buildModels()})()}buildModels(){var t=this;return Ze(function*(){const{animateOption:{repeat:r=1}}=t.layer.getLayerConfig();return t.raiseRepeat=r,[yield t.layer.buildLayerModel({moduleName:"pointEarthExtrude",vertexShader:Vee,fragmentShader:Hee,triangulation:Z6,depth:{enable:!0},defines:t.getDefines(),inject:t.getInject(),cull:{enable:!0,face:N.FRONT},blend:t.getBlend()})]})()}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Dt.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:3,update:t=>{const{size:r}=t;if(r){let n=[];return Array.isArray(r)&&(n=r.length===2?[r[0],r[0],r[1]]:r),Array.isArray(r)||(n=[r,r,r]),n}else return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Dt.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:N.STATIC_DRAW,data:[],type:N.FLOAT},size:3,update:(t,r,n,i,a)=>a}}),this.styleAttributeService.registerStyleAttribute({name:"pos",type:Dt.Attribute,descriptor:{name:"a_Pos",shaderLocation:this.attributeLocation.POS,buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:3,update:t=>{const r=Fc(t.coordinates);return Y6([r[0],r[1]])}}})}};const qee=`in vec4 v_data;
in vec4 v_color;
in float v_radius;

layout(std140) uniform commonUniform {
  float u_additive;
  float u_stroke_opacity : 1;
  float u_stroke_width : 2;
  float u_blur : 0.0;
};
#pragma include "sdf_2d"
#pragma include "picking"

out vec4 outputColor;

void main() {
  int shape = int(floor(v_data.w + 0.5));

  vec4 strokeColor = u_stroke == vec4(0.0) ? v_color : u_stroke;

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius + u_stroke_width);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  } else if (shape == 1) {
    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  } else if (shape == 2) {
    outer_df = sdBox(v_data.xy, vec2(1.));
    inner_df = sdBox(v_data.xy, vec2(r));
  } else if (shape == 3) {
    outer_df = sdPentagon(v_data.xy, 0.8);
    inner_df = sdPentagon(v_data.xy, r * 0.8);
  } else if (shape == 4) {
    outer_df = sdHexagon(v_data.xy, 0.8);
    inner_df = sdHexagon(v_data.xy, r * 0.8);
  } else if (shape == 5) {
    outer_df = sdOctogon(v_data.xy, 1.0);
    inner_df = sdOctogon(v_data.xy, r);
  } else if (shape == 6) {
    outer_df = sdHexagram(v_data.xy, 0.52);
    inner_df = sdHexagram(v_data.xy, r * 0.52);
  } else if (shape == 7) {
    outer_df = sdRhombus(v_data.xy, vec2(1.0));
    inner_df = sdRhombus(v_data.xy, vec2(r));
  } else if (shape == 8) {
    outer_df = sdVesica(v_data.xy, 1.1, 0.8);
    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  }

  if(outer_df > antialiasblur + 0.018) discard;

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  float color_t = u_stroke_width < 0.01 ? 0.0 : smoothstep(
    antialiasblur,
    0.0,
    inner_df
  );

  if(u_stroke_width < 0.01) {
    outputColor = vec4(v_color.rgb, v_color.a * u_opacity);
  } else {
    outputColor = mix(vec4(v_color.rgb, v_color.a * u_opacity), strokeColor * u_stroke_opacity, color_t);
  }

  if(u_additive > 0.0) {
    outputColor *= opacity_t;
    outputColor = filterColorAlpha(outputColor, outputColor.a);
  } else {
    outputColor.a *= opacity_t;
    outputColor = filterColor(outputColor);
  }
}
`,Wee=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_SHAPE) in float a_Shape;
layout(location = ATTRIBUTE_LOCATION_EXTRUDE) in vec3 a_Extrude;

layout(std140) uniform commonUniform {
  float u_additive;
  float u_stroke_opacity : 1;
  float u_stroke_width : 2;
  float u_blur : 0.0;
};
out vec4 v_data;
out vec4 v_color;
out float v_radius;

#pragma include "projection"
#pragma include "picking"


void main() {
  vec3 extrude = a_Extrude;
  float shape_type = a_Shape;
  /*
  *  setPickingSize 设置拾取大小
  */
  float newSize = setPickingSize(a_Size);
  // float newSize = setPickingSize(a_Size) * 0.00001038445708445579;

  // unpack color(vec2)
  v_color = a_Color;

  // radius(16-bit)
  v_radius = newSize;

  // anti-alias
  //  float antialiased_blur = -max(u_blur, antialiasblur);
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / newSize, u_blur);

  // TODP: /abs(extrude.x) 是为了兼容地球模式
  v_data = vec4(extrude.x/abs(extrude.x), extrude.y/abs(extrude.y), antialiasblur,shape_type);

  gl_Position = u_ViewProjectionMatrix * vec4(a_Position + extrude * newSize * 0.1 + vec3(u_offsets,0.0), 1.0);

  setPickingColor(a_PickingColor);
}
`;let Yee=class extends nn{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,SHAPE:10,EXTRUDE:11})}getCommonUniformsInfo(){const{strokeOpacity:t=1,strokeWidth:r=0,blend:n,blur:i=0}=this.layer.getLayerConfig();this.layer.getLayerConfig();const a={u_additive:n==="additive"?1:0,u_stroke_opacity:t,u_stroke_width:r,u_blur:i};return this.getUniformsBufferInfo(a)}initModels(){var t=this;return Ze(function*(){return t.initUniformsBuffer(),t.buildModels()})()}buildModels(){var t=this;return Ze(function*(){return t.layer.triangulation=U4,[yield t.layer.buildLayerModel({moduleName:"pointEarthFill",vertexShader:Wee,fragmentShader:qee,triangulation:U4,defines:t.getDefines(),inject:t.getInject(),depth:{enable:!0},blend:t.getBlend()})]})()}animateOption2Array(t){return[t.enable?0:1,t.speed||1,t.rings||3,0]}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"extrude",type:Dt.Attribute,descriptor:{name:"a_Extrude",shaderLocation:this.attributeLocation.EXTRUDE,buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:3,update:(t,r,n,i)=>{const[a,s,l]=n,c=Co(0,0,1),d=Co(a,0,l),p=a>=0?VN(c,d):Math.PI*2-VN(c,d),h=Math.PI*2-Math.asin(s/100),m=pR();BB(m,m,p),vR(m,m,h);const _=Co(1,1,0);B_(_,_,m),iv(_,_);const y=Co(-1,1,0);B_(y,y,m),iv(y,y);const E=Co(-1,-1,0);B_(E,E,m),iv(E,E);const T=Co(1,-1,0);B_(T,T,m),iv(T,T);const A=[..._,...y,...E,...T],b=i%4*3;return[A[b],A[b+1],A[b+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Dt.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:1,update:t=>{const{size:r=5}=t;return Array.isArray(r)?[r[0]]:[r]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:Dt.Attribute,descriptor:{name:"a_Shape",shaderLocation:this.attributeLocation.SHAPE,buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:1,update:t=>{const{shape:r=2}=t;return[this.layer.getLayerConfig().shape2d.indexOf(r)]}}})}};const $ee=`
in vec4 v_color;
in float v_lightWeight;
out vec4 outputColor;

layout(std140) uniform commonUniforms {
  float u_pickLight;
  float u_heightfixed;
  float u_r;
  float u_linearColor;
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_opacitylinear;
  float u_opacitylinear_dir;
  float u_lightEnable;
};

#pragma include "scene_uniforms"
#pragma include "picking"

void main() {

  outputColor = v_color;
  // 开启透明度渐变
  // picking
  if(u_pickLight > 0.0) {
    outputColor = filterColorAlpha(outputColor, v_lightWeight);
  } else {
    outputColor = filterColor(outputColor);
  }
}
`,Zee=`#define pi (3.1415926535)

layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in vec3 a_Size;
layout(location = ATTRIBUTE_LOCATION_EXTRUDE) in vec4 a_Extrude;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;

layout(std140) uniform commonUniforms {
  float u_pickLight;
  float u_heightfixed;
  float u_r;
  float u_linearColor;
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_opacitylinear;
  float u_opacitylinear_dir;
  float u_lightEnable;
};
out vec4 v_color;
out float v_lightWeight;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

float getYRadian(float x, float z) {
  if (x > 0.0 && z > 0.0) {
    return atan(x / z);
  } else if (x > 0.0 && z <= 0.0) {
    return atan(-z / x) + pi / 2.0;
  } else if (x <= 0.0 && z <= 0.0) {
    return pi + atan(x / z); //atan(x/z) +
  } else {
    return atan(z / -x) + pi * 3.0 / 2.0;
  }
}

float getXRadian(float y, float r) {
  return atan(y / r);
}

void main() {
  vec3 size = a_Size * a_Position;

  vec3 offset = size; // 控制圆柱体的大小 - 从标准单位圆柱体进行偏移

  if (u_heightfixed < 1.0) {
    // 圆柱体不固定高度
  } else {
    // 圆柱体固定高度 （ 处理 mapbox ）
    if (
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    ) {
      offset *= 4.0 / pow(2.0, 21.0 - u_Zoom);
    }
  }

  vec2 positions = a_Extrude.xy;
  vec2 positions64Low = a_Extrude.zw;
  vec4 project_pos = project_position(vec4(positions, 0.0, 1.0), positions64Low);

  // u_r 控制圆柱的生长
  vec4 pos = vec4(project_pos.xy + offset.xy, offset.z * u_r, 1.0);

  // // 圆柱光照效果
  float lightWeight = 1.0;

  if (u_lightEnable > 0.0) {
    // 取消三元表达式，增强健壮性
    lightWeight = calc_lighting(pos);
  }

  v_lightWeight = lightWeight;

  v_color = a_Color;

  // 设置圆柱的底色
  if (u_linearColor == 1.0) {
    // 使用渐变颜色
    v_color = mix(u_sourceColor, u_targetColor, a_Position.z);
    v_color.a = v_color.a * opacity;
  } else {
    v_color = vec4(a_Color.rgb * lightWeight, a_Color.w * opacity);
  }

  if (u_opacitylinear > 0.0) {
    v_color.a *= u_opacitylinear_dir > 0.0 ? 1.0 - a_Position.z : a_Position.z;
  }

  gl_Position = project_common_position_to_clipspace(pos);

  setPickingColor(a_PickingColor);
}
`;let eF=class extends nn{constructor(...t){super(...t),L(this,"raiseCount",0),L(this,"raiseRepeat",0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,EXTRUDE:10,NORMAL:11})}getCommonUniformsInfo(){const{animateOption:t={enable:!1,speed:.01,repeat:!1},sourceColor:r,targetColor:n,pickLight:i=!1,heightfixed:a=!1,opacityLinear:s={enable:!1,dir:"up"},lightEnable:l=!0}=this.layer.getLayerConfig();let c=0,d=[0,0,0,0],p=[0,0,0,0];if(r&&n&&(d=$r(r),p=$r(n),c=1),this.raiseCount<1&&this.raiseRepeat>0&&t.enable){const{speed:_=.01}=t;this.raiseCount+=_,this.raiseCount>=1&&(this.raiseRepeat>1?(this.raiseCount=0,this.raiseRepeat--):this.raiseCount=1)}const h={u_pickLight:Number(i),u_heightfixed:Number(a),u_r:t.enable&&this.raiseRepeat>0?this.raiseCount:1,u_linearColor:c,u_sourceColor:d,u_targetColor:p,u_opacitylinear:Number(s.enable),u_opacitylinear_dir:s.dir==="up"?1:0,u_lightEnable:Number(l)};return this.getUniformsBufferInfo(h)}initModels(){var t=this;return Ze(function*(){return t.buildModels()})()}buildModels(){var t=this;return Ze(function*(){const{depth:r=!0,animateOption:{repeat:n=1}}=t.layer.getLayerConfig();return t.raiseRepeat=n,t.initUniformsBuffer(),[yield t.layer.buildLayerModel({moduleName:"pointExtrude",vertexShader:Zee,fragmentShader:$ee,triangulation:Z6,defines:t.getDefines(),inject:t.getInject(),cull:{enable:!0,face:N.FRONT},depth:{enable:r}})]})()}registerBuiltinAttributes(){this.styleAttributeService.registerStyleAttribute({name:"size",type:Dt.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:3,update:t=>{const{size:r}=t;if(r){let n=[];return Array.isArray(r)&&(n=r.length===2?[r[0],r[0],r[1]]:r),Array.isArray(r)||(n=[r,r,r]),n}else return[2,2,2]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Dt.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:N.STATIC_DRAW,data:[],type:N.FLOAT},size:3,update:(t,r,n,i,a)=>a}}),this.styleAttributeService.registerStyleAttribute({name:"extrude",type:Dt.Attribute,descriptor:{name:"a_Extrude",shaderLocation:this.attributeLocation.EXTRUDE,buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:4,update:t=>{const r=Fc(t.coordinates);return[r[0],r[1],Wn(r[0]),Wn(r[1])]}}})}};const Kee=`
layout(std140) uniform commonUniforms {
  vec3 u_blur_height_fixed;
  float u_stroke_width;
  float u_additive;
  float u_stroke_opacity;
  float u_size_unit;
  float u_time;
  vec4 u_animate;
};

in vec4 v_color;
in vec4 v_stroke;
in vec4 v_data;
in float v_radius;

#pragma include "scene_uniforms"
#pragma include "sdf_2d"
#pragma include "picking"

out vec4 outputColor;

void main() {
  int shape = int(floor(v_data.w + 0.5));
  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius + u_stroke_width);

  float outer_df;
  float inner_df;
  // 'circle', 'triangle', 'square', 'pentagon', 'hexagon', 'octogon', 'hexagram', 'rhombus', 'vesica'
  if (shape == 0) {
    outer_df = sdCircle(v_data.xy, 1.0);
    inner_df = sdCircle(v_data.xy, r);
  } else if (shape == 1) {
    outer_df = sdEquilateralTriangle(1.1 * v_data.xy);
    inner_df = sdEquilateralTriangle(1.1 / r * v_data.xy);
  } else if (shape == 2) {
    outer_df = sdBox(v_data.xy, vec2(1.));
    inner_df = sdBox(v_data.xy, vec2(r));
  } else if (shape == 3) {
    outer_df = sdPentagon(v_data.xy, 0.8);
    inner_df = sdPentagon(v_data.xy, r * 0.8);
  } else if (shape == 4) {
    outer_df = sdHexagon(v_data.xy, 0.8);
    inner_df = sdHexagon(v_data.xy, r * 0.8);
  } else if (shape == 5) {
    outer_df = sdOctogon(v_data.xy, 1.0);
    inner_df = sdOctogon(v_data.xy, r);
  } else if (shape == 6) {
    outer_df = sdHexagram(v_data.xy, 0.52);
    inner_df = sdHexagram(v_data.xy, r * 0.52);
  } else if (shape == 7) {
    outer_df = sdRhombus(v_data.xy, vec2(1.0));
    inner_df = sdRhombus(v_data.xy, vec2(r));
  } else if (shape == 8) {
    outer_df = sdVesica(v_data.xy, 1.1, 0.8);
    inner_df = sdVesica(v_data.xy, r * 1.1, r * 0.8);
  }

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  float color_t = u_stroke_width < 0.01 ? 0.0 : smoothstep(
    antialiasblur,
    0.0,
    inner_df
  );

  float PI = 3.14159;
  float N_RINGS = 3.0;
  float FREQ = 1.0;

  if(u_stroke_width < 0.01) {
    outputColor = v_color;
  } else {
    outputColor = mix(v_color, v_stroke * u_stroke_opacity, color_t);
  }
  float intensity = 1.0;
  if(u_time!=-1.0){
    //wave相关逻辑
    float d = length(v_data.xy);
    if(d > 0.5) {
      discard;
    }
    intensity = clamp(cos(d * PI), 0.0, 1.0) * clamp(cos(2.0 * PI * (d * 2.0 * u_animate.z - u_animate.y * u_time)), 0.0, 1.0);
  }

  if(u_additive > 0.0) {
    outputColor *= opacity_t;
    outputColor *= intensity;//wave
    outputColor = filterColorAlpha(outputColor, outputColor.a);
  } else {
    outputColor.a *= opacity_t;
    outputColor.a *= intensity;//wave 
    outputColor = filterColor(outputColor);
  }
   // 作为 mask 模板时需要丢弃透明的像素
  if(outputColor.a < 0.01) {
    discard;
  } 
}
`,Qee=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_SHAPE) in float a_Shape;
layout(location = ATTRIBUTE_LOCATION_EXTRUDE) in vec3 a_Extrude;

layout(std140) uniform commonUniforms {
  vec3 u_blur_height_fixed;
  float u_stroke_width;
  float u_additive;
  float u_stroke_opacity;
  float u_size_unit;
  float u_time;
  vec4 u_animate;
};

out vec4 v_color;
out vec4 v_stroke;
out vec4 v_data;
out float v_radius;

#pragma include "projection"
#pragma include "picking"
#pragma include "rotation_2d"

void main() {
  // 透明度计算
   v_stroke = stroke;
  vec3 extrude = a_Extrude;
  float shape_type = a_Shape;
  /*
  *  setPickingSize 设置拾取大小
  *  u_meter2coord 在等面积大小的时候设置单位
  */
  float newSize = setPickingSize(a_Size);
  // float newSize = setPickingSize(a_Size) * 0.00001038445708445579;



  // unpack color(vec2)
  v_color = vec4(a_Color.xyz, a_Color.w * opacity);

  if(u_size_unit == 1.0) {
    newSize = newSize  * u_PixelsPerMeter.z;
  }

   v_radius = newSize;

  // anti-alias
  //  float antialiased_blur = -max(u_blur, antialiasblur);
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / newSize, u_blur_height_fixed.x);

  vec2 offset = (extrude.xy * (newSize + u_stroke_width) + u_offsets);

  offset = project_pixel(offset);
  offset = rotate_matrix(offset,rotation);

  // TODP: /abs(extrude.x) 是为了兼容地球模式
  v_data = vec4(extrude.x/abs(extrude.x), extrude.y/abs(extrude.y), antialiasblur,shape_type);

  vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0), a_Position64Low);
  // gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));

  float raisingHeight = u_blur_height_fixed.y;

  if(u_blur_height_fixed.z < 1.0) { // false
    raisingHeight = project_pixel(u_blur_height_fixed.y);
  } else {
     if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
      float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
      raisingHeight = u_blur_height_fixed.y * mapboxZoomScale;
    }
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, raisingHeight, 1.0));

  setPickingColor(a_PickingColor);
}
`;let tF=class extends nn{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,SHAPE:10,EXTRUDE:11})}getCommonUniformsInfo(){const{strokeOpacity:t=1,strokeWidth:r=0,blend:n,blur:i=0,raisingHeight:a=0,heightfixed:s=!1,unit:l="pixel"}=this.layer.getLayerConfig();let c=this.getAnimateUniforms().u_time;isNaN(c)&&(c=-1);const d={u_blur_height_fixed:[i,Number(a),Number(s)],u_stroke_width:r,u_additive:n==="additive"?1:0,u_stroke_opacity:t,u_size_unit:MR[l],u_time:c,u_animate:this.getAnimateUniforms().u_animate};return this.getUniformsBufferInfo(d)}getAnimateUniforms(){const{animateOption:t={enable:!1}}=this.layer.getLayerConfig();return{u_animate:this.animateOption2Array(t),u_time:this.layer.getLayerAnimateTime()}}getAttribute(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),Lc)}initModels(){var t=this;return Ze(function*(){return t.buildModels()})()}buildModels(){var t=this;return Ze(function*(){const{frag:r,vert:n,type:i}=t.getShaders();return t.layer.triangulation=Lc,t.initUniformsBuffer(),[yield t.layer.buildLayerModel({moduleName:i,vertexShader:n,fragmentShader:r,defines:t.getDefines(),inject:t.getInject(),triangulation:Lc,depth:{enable:!1}})]})()}getShaders(){return{frag:Kee,vert:Qee,type:"pointFill"}}animateOption2Array(t){return[t.enable?0:1,t.speed||1,t.rings||3,0]}registerBuiltinAttributes(){const t=this.layer.getLayerConfig().shape2d;this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"extrude",type:Dt.Attribute,descriptor:{name:"a_Extrude",shaderLocation:this.attributeLocation.EXTRUDE,buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:3,update:(r,n,i,a)=>{const s=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],l=a%4*3;return[s[l],s[l+1],s[l+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Dt.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:1,update:r=>{const{size:n=5}=r;return Array.isArray(n)?[n[0]]:[n]}}}),this.styleAttributeService.registerStyleAttribute({name:"shape",type:Dt.Attribute,descriptor:{name:"a_Shape",shaderLocation:this.attributeLocation.SHAPE,buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:1,update:r=>{const{shape:n=2}=r;return[t.indexOf(n)]}}})}};const Jee=`in vec2 v_uv;// 本身的 uv 坐标
in vec2 v_Iconuv;
in float v_opacity;
out vec4 outputColor;

uniform sampler2D u_texture;
layout(std140) uniform commonUniform {
  vec2 u_textSize;
  float u_heightfixed: 0.0;
  float u_raisingHeight: 0.0;
  float u_size_unit;
};

#pragma include "scene_uniforms"
#pragma include "sdf_2d"
#pragma include "picking"

void main() {
  vec2 pos = v_Iconuv / u_textSize + v_uv / u_textSize * 64.;
  outputColor = texture(SAMPLER_2D(u_texture), pos);
  outputColor.a *= v_opacity;
  outputColor = filterColor(outputColor);
}
`,ete=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_EXTRUDE) in vec3 a_Extrude;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;

layout(std140) uniform commonUniform {
  vec2 u_textSize;
  float u_heightfixed;
  float u_raisingHeight;
  float u_size_unit;
};

out vec2 v_uv;
out vec2 v_Iconuv;
out float v_opacity;

#pragma include "projection"
#pragma include "picking"
#pragma include "rotation_2d"

void main() {
  vec3 extrude = a_Extrude;
  v_uv = (a_Extrude.xy + 1.0) / 2.0;
  v_uv.y = 1.0 - v_uv.y;
  v_Iconuv = a_Uv;
  v_opacity = opacity;
  float newSize = a_Size;
  if (u_size_unit == 1.0) {
    newSize = newSize * u_PixelsPerMeter.z;
  }

  // vec2 offset = (u_RotateMatrix * extrude.xy * (a_Size) + textrueOffsets);
  vec2 offset = extrude.xy * newSize + offsets;

  offset = rotate_matrix(offset, rotation);

  offset = project_pixel(offset);

  vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0), a_Position64Low);
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, 0.0, 1.0));

  setPickingColor(a_PickingColor);
}
`;class tte extends nn{constructor(...t){super(...t),L(this,"meter2coord",1),L(this,"texture",void 0),L(this,"isMeter",!1),L(this,"radian",0),L(this,"updateTexture",()=>{const{createTexture2D:r}=this.rendererService;if(this.texture){this.texture.update({data:this.iconService.getCanvas(),mag:"linear",min:"linear mipmap nearest",mipmap:!0}),this.layerService.throttleRenderLayers();return}this.texture=r({data:this.iconService.getCanvas(),mag:N.LINEAR,min:N.LINEAR_MIPMAP_LINEAR,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128,mipmap:!0}),this.textures=[this.texture]})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,EXTRUDE:10,UV:11})}getCommonUniformsInfo(){const{raisingHeight:t=0,heightfixed:r=!1,unit:n="pixel"}=this.layer.getLayerConfig();if(this.rendererService.getDirty()){var i;(i=this.texture)===null||i===void 0||i.bind()}const a={u_textSize:[1024,this.iconService.canvasHeight||128],u_heightfixed:Number(r),u_raisingHeight:Number(t),u_size_unit:MR[n]};return this.getUniformsBufferInfo(a)}getAttribute(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),Lc)}initModels(){var t=this;return Ze(function*(){return t.iconService.on("imageUpdate",t.updateTexture),t.updateTexture(),t.buildModels()})()}buildModels(){var t=this;return Ze(function*(){return t.initUniformsBuffer(),[yield t.layer.buildLayerModel({moduleName:"pointFillImage",vertexShader:ete,fragmentShader:Jee,triangulation:Lc,depth:{enable:!1},defines:t.getDefines(),inject:t.getInject(),cull:{enable:!0,face:N.FRONT}})]})()}clearModels(){var t;this.iconService.off("imageUpdate",this.updateTexture),(t=this.texture)===null||t===void 0||t.destroy()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Dt.Attribute,descriptor:{name:"a_Uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:2,update:t=>{const r=this.iconService.getIconMap(),{shape:n}=t,{x:i,y:a}=r[n]||{x:-64,y:-64};return[i,a]}}}),this.styleAttributeService.registerStyleAttribute({name:"extrude",type:Dt.Attribute,descriptor:{name:"a_Extrude",shaderLocation:this.attributeLocation.EXTRUDE,buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:3,update:(t,r,n,i)=>{const a=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],s=i%4*3;return[a[s],a[s+1],a[s+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Dt.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:1,update:t=>{const{size:r=5}=t;return Array.isArray(r)?[r[0]]:[r]}}})}}const rte=`layout(std140) uniform commonUniforms {
  vec2 u_textSize;
  float u_raisingHeight;
  float u_heightfixed;
};

uniform sampler2D u_texture;

in vec4 v_color;
in vec2 v_uv;
in float v_opacity;

#pragma include "picking"

out vec4 outputColor;

void main(){
  vec2 pos = v_uv / u_textSize + gl_PointCoord / u_textSize * 64.;
  vec4 textureColor;

  // Y = 0.299R + 0.587G + 0.114B // 亮度提取
  
  textureColor = texture(SAMPLER_2D(u_texture), pos);

  // Tip: 去除边缘部分 mipmap 导致的混合变暗
  float fragmengTocenter = distance(vec2(0.5), gl_PointCoord);
  if(fragmengTocenter >= 0.5) {
        float luma = 0.299 * textureColor.r + 0.587 * textureColor.g + 0.114 * textureColor.b;
        textureColor.a *= luma;
  }
  
  if(all(lessThan(v_color, vec4(1.0+0.00001))) && all(greaterThan(v_color, vec4(1.0-0.00001))) || v_color==vec4(1.0)){
        outputColor= textureColor;
  }else {
        outputColor= step(0.01, textureColor.z) * v_color;
  }
  outputColor.a *= v_opacity;
  if (outputColor.a < 0.01) {
      discard;
  }
  outputColor = filterColor(outputColor);
}
`,nte=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;

layout(std140) uniform commonUniforms {
  vec2 u_textSize;
  float u_raisingHeight;
  float u_heightfixed;
};

out vec4 v_color;
out vec2 v_uv;
out float v_opacity;

#pragma include "projection"
#pragma include "picking"

void main() {
  // cal style mapping - 数据纹理映射部分的计算
  v_color = a_Color;
  v_opacity = opacity;
  v_uv = a_Uv;
  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);

  vec2 offset = project_pixel(offsets);

  float raisingHeight = u_raisingHeight;
  if (u_heightfixed < 1.0) {
    // false
    raisingHeight = project_pixel(u_raisingHeight);
  } else {
    if (
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    ) {
      float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);
      raisingHeight = u_raisingHeight * mapboxZoomScale;
    }
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, raisingHeight, 1.0));

  gl_PointSize = a_Size * 2.0 * u_DevicePixelRatio;
  setPickingColor(a_PickingColor);
}
`;class rF extends nn{constructor(...t){super(...t),L(this,"texture",void 0),L(this,"updateTexture",()=>{const{createTexture2D:r}=this.rendererService;if(this.texture){this.texture.update({data:this.iconService.getCanvas(),mag:"linear",min:"linear mipmap nearest",mipmap:!0}),setTimeout(()=>{this.layerService.throttleRenderLayers()});return}this.texture=r({data:this.iconService.getCanvas(),mag:N.LINEAR,min:N.LINEAR_MIPMAP_LINEAR,premultiplyAlpha:!1,width:1024,height:this.iconService.canvasHeight||128,mipmap:!0})})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,UV:10})}getUninforms(){if(this.rendererService.getDirty()){var t;(t=this.texture)===null||t===void 0||t.bind()}const r=this.getCommonUniformsInfo(),n=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),Ge(Ge({},r.uniformsOption),n.uniformsOption)}getCommonUniformsInfo(){const{raisingHeight:t=0,heightfixed:r=!1}=this.layer.getLayerConfig(),n={u_textSize:[1024,this.iconService.canvasHeight||128],u_raisingHeight:Number(t),u_heightfixed:Number(r),u_texture:this.texture};return this.textures=[this.texture],this.getUniformsBufferInfo(n)}initModels(){var t=this;return Ze(function*(){return t.iconService.on("imageUpdate",t.updateTexture),t.updateTexture(),t.buildModels()})()}clearModels(){var t;(t=this.texture)===null||t===void 0||t.destroy(),this.iconService.off("imageUpdate",this.updateTexture)}buildModels(){var t=this;return Ze(function*(){return t.initUniformsBuffer(),[yield t.layer.buildLayerModel({moduleName:"pointImage",vertexShader:nte,fragmentShader:rte,triangulation:YJ,defines:t.getDefines(),inject:t.getInject(),depth:{enable:!1},primitive:N.POINTS})]})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"size",type:Dt.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:1,update:t=>{const{size:r=5}=t;return Array.isArray(r)?[r[0]]:[r]}}}),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Dt.Attribute,descriptor:{name:"a_Uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:2,update:t=>{const r=this.iconService.getIconMap(),{shape:n}=t,{x:i,y:a}=r[n]||{x:-64,y:-64};return[i,a]}}})}}const ite=`in vec4 v_color;
out vec4 outputColor;
void main() {
  outputColor = v_color;
}`,ate=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;

layout(std140) uniform u_Common {
  float u_size_scale;
};

out vec4 v_color;

#pragma include "projection"
#pragma include "project"

void main() {
  v_color = vec4(a_Color.xyz, a_Color.w * opacity);

  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);
  gl_Position = project_common_position_to_clipspace(project_pos);

  gl_PointSize = a_Size * u_size_scale * 2.0 * u_DevicePixelRatio;
}
`;function G4(e){const t=e.coordinates;return{vertices:[...t],indices:[0],size:t.length}}class nF extends nn{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9})}getDefaultStyle(){return{blend:"additive"}}getCommonUniformsInfo(){const t={u_size_scale:.5};return this.getUniformsBufferInfo(t)}initModels(){var t=this;return Ze(function*(){return t.buildModels()})()}buildModels(){var t=this;return Ze(function*(){return t.layer.triangulation=G4,t.initUniformsBuffer(),[yield t.layer.buildLayerModel({moduleName:"pointNormal",vertexShader:ate,fragmentShader:ite,triangulation:G4,defines:t.getDefines(),inject:t.getInject(),depth:{enable:!1},primitive:N.POINTS,pick:!1})]})()}clearModels(){}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"size",type:Dt.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:1,update:t=>{const{size:r=1}=t;return Array.isArray(r)?[r[0]]:[r]}}})}}const ote=`
layout(std140) uniform commonUniorm{
  float u_additive;
  float u_size_unit;
  float u_speed: 1.0;
  float u_time;
};
in vec4 v_data;
in vec4 v_color;
in float v_radius;
in vec2 v_extrude;
#pragma include "sdf_2d"
#pragma include "picking"

out vec4 outputColor;

void main() {

  lowp float antialiasblur = v_data.z;
  float r = v_radius / (v_radius);

  float outer_df = sdCircle(v_data.xy, 1.0);
  float inner_df = sdCircle(v_data.xy, r);

  float opacity_t = smoothstep(0.0, antialiasblur, outer_df);

  outputColor = vec4(v_color.rgb, v_color.a);

  if(u_additive > 0.0) {
    outputColor *= opacity_t;
  } else {
    outputColor.a *= opacity_t;
  }

  if(outputColor.a > 0.0) {
    outputColor = filterColor(outputColor);
  }

  vec2 extrude =  v_extrude;
  vec2 dir = normalize(extrude);
  vec2 baseDir = vec2(1.0, 0.0);
  float pi = 3.14159265359;
  float flag = sign(dir.y);
  float rades = dot(dir, baseDir);
  float radar_v = (flag - 1.0) * -0.5 * acos(rades)/pi;
  // simple AA
  if(radar_v > 0.99) {
    radar_v = 1.0 - (radar_v - 0.99)/0.01;
  }

  outputColor.a *= radar_v;
}
`,ste=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_EXTRUDE) in vec3 a_Extrude;

layout(std140) uniform commonUniorm {
  float u_additive;
  float u_size_unit;
  float u_speed: 1.0;
  float u_time;
};

out vec4 v_data;
out vec4 v_color;
out float v_radius;
out vec2 v_extrude;

#pragma include "projection"
#pragma include "picking"

void main() {
  float newSize = setPickingSize(a_Size);

  float time = u_time * u_speed;
  mat2 rotateMatrix = mat2(
    cos(time), sin(time),
    -sin(time), cos(time)
  );
  v_extrude = rotateMatrix * a_Extrude.xy;

  v_color = a_Color;
  v_color.a *= opacity;

  float blur = 0.0;
  float antialiasblur = -max(2.0 / u_DevicePixelRatio / a_Size, blur);

  if(u_size_unit == 1.) {
    newSize = newSize  * u_PixelsPerMeter.z;
  }
  v_radius = newSize;

  vec2 offset = (a_Extrude.xy * (newSize));

  offset = project_pixel(offset);

  v_data = vec4(a_Extrude.x, a_Extrude.y, antialiasblur, -1.0);

  vec4 project_pos = project_position(vec4(a_Position.xy, 0.0, 1.0), a_Position64Low);
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy + offset, project_pixel(setPickingOrder(0.0)), 1.0));

  setPickingColor(a_PickingColor);
}
`;class ute extends nn{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,EXTRUDE:10})}getCommonUniformsInfo(){const{blend:t,speed:r=1,unit:n="pixel"}=this.layer.getLayerConfig(),i={u_additive:t==="additive"?1:0,u_size_unit:MR[n],u_speed:r,u_time:this.layer.getLayerAnimateTime()};return this.getUniformsBufferInfo(i)}getAnimateUniforms(){return{}}getAttribute(){return this.styleAttributeService.createAttributesAndIndices(this.layer.getEncodedData(),Lc)}initModels(){var t=this;return Ze(function*(){return t.buildModels()})()}buildModels(){var t=this;return Ze(function*(){return t.initUniformsBuffer(),[yield t.layer.buildLayerModel({moduleName:"pointRadar",vertexShader:ste,fragmentShader:ote,triangulation:Lc,defines:t.getDefines(),inject:t.getInject(),depth:{enable:!1}})]})()}animateOption2Array(t){return[t.enable?0:1,t.speed||1,t.rings||3,0]}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"extrude",type:Dt.Attribute,descriptor:{name:"a_Extrude",shaderLocation:this.attributeLocation.EXTRUDE,buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:3,update:(t,r,n,i)=>{const a=[1,1,0,-1,1,0,-1,-1,0,1,-1,0],s=i%4*3;return[a[s],a[s+1],a[s+2]]}}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Dt.Attribute,descriptor:{shaderLocation:this.attributeLocation.SIZE,name:"a_Size",buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:1,update:t=>{const{size:r=5}=t;return Array.isArray(r)?[r[0]]:[r]}}})}}class lte{constructor(t,r,n){L(this,"boxCells",[]),L(this,"xCellCount",void 0),L(this,"yCellCount",void 0),L(this,"boxKeys",void 0),L(this,"bboxes",void 0),L(this,"width",void 0),L(this,"height",void 0),L(this,"xScale",void 0),L(this,"yScale",void 0),L(this,"boxUid",void 0);const i=this.boxCells;this.xCellCount=Math.ceil(t/n),this.yCellCount=Math.ceil(r/n);for(let a=0;a<this.xCellCount*this.yCellCount;a++)i.push([]);this.boxKeys=[],this.bboxes=[],this.width=t,this.height=r,this.xScale=this.xCellCount/t,this.yScale=this.yCellCount/r,this.boxUid=0}insert(t,r,n,i,a){this.forEachCell(r,n,i,a,this.insertBoxCell,this.boxUid++),this.boxKeys.push(t),this.bboxes.push(r),this.bboxes.push(n),this.bboxes.push(i),this.bboxes.push(a)}query(t,r,n,i,a){return this.queryHitTest(t,r,n,i,!1,a)}hitTest(t,r,n,i,a){return this.queryHitTest(t,r,n,i,!0,a)}insertBoxCell(t,r,n,i,a,s){this.boxCells[a].push(s)}queryHitTest(t,r,n,i,a,s){if(n<0||t>this.width||i<0||r>this.height)return a?!1:[];const l=[];if(t<=0&&r<=0&&this.width<=n&&this.height<=i){if(a)return!0;for(let d=0;d<this.boxKeys.length;d++)l.push({key:this.boxKeys[d],x1:this.bboxes[d*4],y1:this.bboxes[d*4+1],x2:this.bboxes[d*4+2],y2:this.bboxes[d*4+3]});return s?l.filter(s):l}const c={hitTest:a,seenUids:{box:{},circle:{}}};return this.forEachCell(t,r,n,i,this.queryCell,l,c,s),a?l.length>0:l}queryCell(t,r,n,i,a,s,l,c){const d=l.seenUids,p=this.boxCells[a];if(p!==null){const h=this.bboxes;for(const m of p)if(!d.box[m]){d.box[m]=!0;const _=m*4;if(t<=h[_+2]&&r<=h[_+3]&&n>=h[_+0]&&i>=h[_+1]&&(!c||c(this.boxKeys[m]))){if(l.hitTest)return s.push(!0),!0;s.push({key:this.boxKeys[m],x1:h[_],y1:h[_+1],x2:h[_+2],y2:h[_+3]})}}}return!1}forEachCell(t,r,n,i,a,s,l,c){const d=this.convertToXCellCoord(t),p=this.convertToYCellCoord(r),h=this.convertToXCellCoord(n),m=this.convertToYCellCoord(i);for(let _=d;_<=h;_++)for(let y=p;y<=m;y++){const E=this.xCellCount*y+_;if(a.call(this,t,r,n,i,E,s,l,c))return}}convertToXCellCoord(t){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(t*this.xScale)))}convertToYCellCoord(t){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(t*this.yScale)))}}class cte{constructor(t,r){L(this,"width",void 0),L(this,"height",void 0),L(this,"grid",void 0),L(this,"viewportPadding",100),L(this,"screenRightBoundary",void 0),L(this,"screenBottomBoundary",void 0),L(this,"gridRightBoundary",void 0),L(this,"gridBottomBoundary",void 0),this.width=t,this.height=r,this.viewportPadding=Math.max(t,r),this.grid=new lte(t+this.viewportPadding,r+this.viewportPadding,25),this.screenRightBoundary=t+this.viewportPadding,this.screenBottomBoundary=r+this.viewportPadding,this.gridRightBoundary=t+2*this.viewportPadding,this.gridBottomBoundary=r+2*this.viewportPadding}placeCollisionBox(t){const r=t.x1+t.anchorPointX+this.viewportPadding,n=t.y1+t.anchorPointY+this.viewportPadding,i=t.x2+t.anchorPointX+this.viewportPadding,a=t.y2+t.anchorPointY+this.viewportPadding;return!this.isInsideGrid(r,n,i,a)||this.grid.hitTest(r,n,i,a)?{box:[]}:{box:[r,n,i,a]}}insertCollisionBox(t,r){const n={featureIndex:r};this.grid.insert(n,t[0],t[1],t[2],t[3])}project(t,r,n){const i=Xq(r,n,0,1),a=UB(),s=Fq(...t);return mR(a,i,s),{x:(a[0]/a[3]+1)/2*this.width+this.viewportPadding,y:(-a[1]/a[3]+1)/2*this.height+this.viewportPadding}}isInsideGrid(t,r,n,i){return n>=0&&t<this.gridRightBoundary&&i>=0&&r<this.gridBottomBoundary}}function iF(e){let t=.5,r=.5;switch(e){case"right":case"top-right":case"bottom-right":t=1;break;case"left":case"top-left":case"bottom-left":t=0;break;default:t=.5}switch(e){case"bottom":case"bottom-right":case"bottom-left":r=1;break;case"top":case"top-right":case"top-left":r=0;break;default:r=.5}return{horizontalAlign:t,verticalAlign:r}}function aF(e,t,r,n,i,a,s){const l=(t-r)*i,c=(-n*s+.5)*a;for(const d of e)d.x+=l,d.y+=c}function fte(e,t,r,n,i,a,s){let c=0,d=-8,p=0;const h=e.positionedGlyphs,m=0,_=h.length;r.forEach(A=>{if(A.split("").forEach(b=>{const R=t[b];R&&(h.push({glyph:b,x:c,y:d+0,vertical:!1,scale:1,metrics:R}),c+=R.advance+s)}),h.length!==_){const b=c-s;p=Math.max(b,p),h.length-1}c=0,d-=n+5});const{horizontalAlign:y,verticalAlign:E}=iF(i);aF(h,m,y,E,p,n,r.length);const T=d- -8;e.top+=-E*T,e.bottom=e.top-T,e.left+=-y*p,e.right=e.left+p}function dte(e,t,r,n,i,a,s){let c=0,d=-8,p=0;const h=e.positionedGlyphs,m=0,_=h.length;r.forEach(A=>{const b=t[A];if(b&&(h.push({glyph:A,x:b.advance/2,y:d+0,vertical:!1,scale:1,metrics:b}),c+=b.advance+s),h.length!==_){const M=c-s;p=Math.max(M,p),h.length-1}c=0,d-=n+5});const{horizontalAlign:y,verticalAlign:E}=iF(i);aF(h,m,y,E,p,n,r.length);const T=d- -8;e.top+=-E*T,e.bottom=e.top-T,e.left+=-y*p,e.right=e.left+p}function hte(e,t,r,n,i,a,s=[0,0],l){const c=e.split(`
`),d=[],p={positionedGlyphs:d,top:s[1],bottom:s[1],left:s[0],right:s[0],lineCount:c.length,text:e};return l?dte(p,t,c,r,n,i,a):fte(p,t,c,r,n,i,a),d.length?p:!1}function pte(e,t=[0,0],r){const{positionedGlyphs:n=[]}=e,i=[];for(const a of n){const s=a.metrics,l=4,c=s.advance*a.scale/2,d=[0,0],p=[a.x+c+t[0],a.y+t[1]],h=(0-l)*a.scale-c+p[0],m=(0-l)*a.scale+p[1],_=h+s.width*a.scale,y=m+s.height*a.scale,E={x:h,y:m},T={x:_,y:m},A={x:h,y},b={x:_,y};i.push({tl:E,tr:T,bl:A,br:b,tex:s,glyphOffset:d})}return i}const q4=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 48.0

uniform sampler2D u_sdf_map;
layout(std140) uniform commonUniforms {
  vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];
  vec2 u_sdf_map_size;
  float u_raisingHeight: 0.0;
  float u_stroke_width : 2;
  float u_gamma_scale : 0.5;
  float u_halo_blur : 0.5;
};

in vec2 v_uv;
in float v_gamma_scale;
in vec4 v_color;
in vec4 v_stroke_color;
in float v_fontScale;

out vec4 outputColor;

#pragma include "picking"
void main() {
  // get style data mapping

  // get sdf from atlas
  float dist = texture(SAMPLER_2D(u_sdf_map), v_uv).a;

  lowp float buff = (6.0 - u_stroke_width / v_fontScale) / SDF_PX;
  highp float gamma = (u_halo_blur * 1.19 / SDF_PX + EDGE_GAMMA) / (v_fontScale * u_gamma_scale) / 1.0;

  highp float gamma_scaled = gamma * v_gamma_scale;

  highp float alpha = smoothstep(buff - gamma_scaled, buff + gamma_scaled, dist);

  outputColor = mix(v_color, v_stroke_color, smoothstep(0., 0.5, 1.- dist));

  outputColor.a *= alpha;
   // 作为 mask 模板时需要丢弃透明的像素
  if (outputColor.a < 0.01) {
    discard;
  }
  outputColor = filterColor(outputColor);
}
`,W4=`#define SDF_PX 8.0
#define EDGE_GAMMA 0.105
#define FONT_SIZE 24.0

layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_TEXT_OFFSETS) in vec2 a_textOffsets;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_tex;

layout(std140) uniform commonUniforms {
  vec4 u_stroke_color : [0.0, 0.0, 0.0, 0.0];
  vec2 u_sdf_map_size;
  float u_raisingHeight: 0.0;
  float u_stroke_width : 2;
  float u_gamma_scale : 0.5;
  float u_halo_blur : 0.5;
};

out vec2 v_uv;
out float v_gamma_scale;
out vec4 v_color;
out vec4 v_stroke_color;
out float v_fontScale;

#pragma include "projection"
#pragma include "picking"
#pragma include "rotation_2d"

void main() {
  // cal style mapping - 数据纹理映射部分的计算

  v_uv = a_tex / u_sdf_map_size;



  v_color = vec4(a_Color.xyz, a_Color.w * opacity);
  v_stroke_color = vec4(u_stroke_color.xyz, u_stroke_color.w * opacity);

  // 文本缩放比例
  float fontScale = a_Size / FONT_SIZE;
  v_fontScale = fontScale;

  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);
  // vec4 projected_position  = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  vec2 offset = rotate_matrix(a_textOffsets,rotation);

  // gl_Position = vec4(projected_position.xy / projected_position.w + rotation_matrix * a_textOffsets * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);

  float raiseHeight = u_raisingHeight;
  if(u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
    raiseHeight = u_raisingHeight * mapboxZoomScale;
  }

  vec4 projected_position = project_common_position_to_clipspace(vec4(project_pos.xyz + vec3(0.0, 0.0, raiseHeight), 1.0));

  gl_Position = vec4(
    projected_position.xy / projected_position.w + offset * fontScale / u_ViewportSize * 2.0 * u_DevicePixelRatio, 0.0, 1.0);
  v_gamma_scale = gl_Position.w;
  setPickingColor(a_PickingColor);

}
`,{isEqual:Up}=yn;function Y4(e){const t=this,r=e.id,n=[],i=[];if(!t.glyphInfoMap||!t.glyphInfoMap[r])return{vertices:[],indices:[],size:7};const a=t.glyphInfoMap[r].centroid,s=a.length===2?[a[0],a[1],0]:a;return t.glyphInfoMap[r].glyphQuads.forEach((l,c)=>{n.push(...s,l.tex.x,l.tex.y+l.tex.height,l.tl.x,l.tl.y,...s,l.tex.x+l.tex.width,l.tex.y+l.tex.height,l.tr.x,l.tr.y,...s,l.tex.x+l.tex.width,l.tex.y,l.br.x,l.br.y,...s,l.tex.x,l.tex.y,l.bl.x,l.bl.y),i.push(0+c*4,1+c*4,2+c*4,2+c*4,3+c*4,0+c*4)}),{vertices:n,indices:i,size:7}}class oF extends nn{constructor(...t){var r;super(...t),r=this,L(this,"glyphInfo",void 0),L(this,"glyphInfoMap",{}),L(this,"rawEncodeData",void 0),L(this,"texture",void 0),L(this,"currentZoom",-1),L(this,"extent",void 0),L(this,"textureHeight",0),L(this,"textCount",0),L(this,"preTextStyle",{}),L(this,"mapping",Ze(function*(){r.initGlyph(),r.updateTexture(),yield r.reBuildModel()}))}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,TEXT_OFFSETS:10,UV:11})}getUninforms(){const t=this.getCommonUniformsInfo(),r=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),Ge(Ge(Ge({},t.uniformsOption),r.uniformsOption),{u_sdf_map:this.textures[0]})}getCommonUniformsInfo(){const{stroke:t="#fff",strokeWidth:r=0,halo:n=.5,gamma:i=2,raisingHeight:a=0}=this.layer.getLayerConfig(),s=this.getFontServiceMapping(),l=this.getFontServiceCanvas();s&&Object.keys(s).length!==this.textCount&&l&&(this.updateTexture(),this.textCount=Object.keys(s).length),this.preTextStyle=this.getTextStyle();const c={u_stroke_color:$r(t),u_sdf_map_size:[l?.width||1,l?.height||1],u_raisingHeight:Number(a),u_stroke_width:r,u_gamma_scale:i,u_halo_blur:n};return this.getUniformsBufferInfo(c)}initModels(){var t=this;return Ze(function*(){return t.bindEvent(),t.extent=t.textExtent(),t.rawEncodeData=t.layer.getEncodedData(),t.preTextStyle=t.getTextStyle(),t.initUniformsBuffer(),t.buildModels()})()}buildModels(){var t=this;return Ze(function*(){const{textAllowOverlap:r=!1}=t.layer.getLayerConfig();return t.initGlyph(),t.updateTexture(),r||t.filterGlyphs(),[yield t.layer.buildLayerModel({moduleName:"pointText",vertexShader:W4,fragmentShader:q4,defines:t.getDefines(),inject:t.getInject(),triangulation:Y4.bind(t),depth:{enable:!1}})]})()}needUpdate(){var t=this;return Ze(function*(){const{textAllowOverlap:r=!1,textAnchor:n="center",textOffset:i,padding:a,fontFamily:s,fontWeight:l}=t.getTextStyle();if(!Up(a,t.preTextStyle.padding)||!Up(i,t.preTextStyle.textOffset)||!Up(n,t.preTextStyle.textAnchor)||!Up(s,t.preTextStyle.fontFamily)||!Up(l,t.preTextStyle.fontWeight))return yield t.mapping(),!0;if(r)return!1;const c=t.mapService.getZoom(),d=t.mapService.getBounds(),p=cB(t.extent,d);return Math.abs(t.currentZoom-c)>.5||!p||r!==t.preTextStyle.textAllowOverlap?(yield t.reBuildModel(),!0):!1})()}clearModels(){var t;(t=this.texture)===null||t===void 0||t.destroy(),this.layer.off("remapping",this.mapping)}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"textOffsets",type:Dt.Attribute,descriptor:{shaderLocation:this.attributeLocation.TEXT_OFFSETS,name:"a_textOffsets",buffer:{usage:N.STATIC_DRAW,data:[],type:N.FLOAT},size:2,update:(t,r,n)=>[n[5],n[6]]}}),this.styleAttributeService.registerStyleAttribute({name:"textUv",type:Dt.Attribute,descriptor:{name:"a_tex",shaderLocation:this.attributeLocation.UV,buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:2,update:(t,r,n)=>[n[3],n[4]]}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Dt.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:1,update:t=>{const{size:r=12}=t;return Array.isArray(r)?[r[0]]:[r]}}})}bindEvent(){this.layer.isTileLayer||this.layer.on("remapping",this.mapping)}textExtent(){const t=this.mapService.getBounds();return cR(t,.5)}initTextFont(){const{fontWeight:t,fontFamily:r}=this.getTextStyle(),n=this.rawEncodeData,i=[];n.forEach(a=>{let{shape:s=""}=a;s=s.toString();for(const l of s)i.indexOf(l)===-1&&i.push(l)}),this.fontService.setFontOptions({characterSet:i,fontWeight:t,fontFamily:r,iconfont:!1})}initIconFontTex(){const{fontWeight:t,fontFamily:r}=this.getTextStyle(),n=this.rawEncodeData,i=[];n.forEach(a=>{let{shape:s=""}=a;s=`${s}`,i.indexOf(s)===-1&&i.push(s)}),this.fontService.setFontOptions({characterSet:i,fontWeight:t,fontFamily:r,iconfont:!0})}getTextStyle(){const{fontWeight:t="400",fontFamily:r="sans-serif",textAllowOverlap:n=!1,padding:i=[0,0],textAnchor:a="center",textOffset:s=[0,0],opacity:l=1,strokeOpacity:c=1,strokeWidth:d=0,stroke:p="#000"}=this.layer.getLayerConfig();return{fontWeight:t,fontFamily:r,textAllowOverlap:n,padding:i,textAnchor:a,textOffset:s,opacity:l,strokeOpacity:c,strokeWidth:d,stroke:p}}generateGlyphLayout(t){const r=this.getFontServiceMapping(),{spacing:n=2,textAnchor:i="center",textOffset:a}=this.layer.getLayerConfig(),s=this.rawEncodeData;this.glyphInfo=s.map(l=>{const{shape:c="",id:d,size:p=1}=l,h=l.textOffset?l.textOffset:a||[0,0],m=l.textAnchor?l.textAnchor:i||"center",_=hte(c.toString(),r,p,m,"left",n,h,t),y=pte(_,h);return l.shaping=_,l.glyphQuads=y,l.centroid=Fc(l.coordinates),this.glyphInfoMap[d]={shaping:_,glyphQuads:y,centroid:Fc(l.coordinates)},l})}getFontServiceMapping(){const{fontWeight:t="400",fontFamily:r="sans-serif"}=this.layer.getLayerConfig();return this.fontService.getMappingByKey(`${r}_${t}`)}getFontServiceCanvas(){const{fontWeight:t="400",fontFamily:r="sans-serif"}=this.layer.getLayerConfig();return this.fontService.getCanvasByKey(`${r}_${t}`)}filterGlyphs(){const{padding:t=[0,0],textAllowOverlap:r=!1}=this.layer.getLayerConfig();if(r)return;this.glyphInfoMap={},this.currentZoom=this.mapService.getZoom(),this.extent=this.textExtent();const{width:n,height:i}=this.rendererService.getViewportSize(),a=new cte(n,i);this.glyphInfo.filter(l=>{const{shaping:c,id:d=0}=l,p=l.centroid,m=l.size/16,_=this.mapService.lngLatToContainer(p),{box:y}=a.placeCollisionBox({x1:c.left*m-t[0],x2:c.right*m+t[0],y1:c.top*m-t[1],y2:c.bottom*m+t[1],anchorPointX:_.x,anchorPointY:_.y});return y&&y.length?(a.insertCollisionBox(y,d),!0):!1}).forEach(l=>{this.glyphInfoMap[l.id]=l})}initGlyph(){const{iconfont:t=!1}=this.layer.getLayerConfig();t?this.initIconFontTex():this.initTextFont(),this.generateGlyphLayout(t)}updateTexture(){const{createTexture2D:t}=this.rendererService,r=this.getFontServiceCanvas();this.textureHeight=r.height,this.texture&&this.texture.destroy(),this.texture=t({data:r,mag:N.LINEAR,min:N.LINEAR,width:r.width,height:r.height}),this.textures=[this.texture]}reBuildModel(){var t=this;return Ze(function*(){t.filterGlyphs();const r=yield t.layer.buildLayerModel({moduleName:"pointText",vertexShader:W4,fragmentShader:q4,triangulation:Y4.bind(t),defines:t.getDefines(),inject:t.getInject(),depth:{enable:!1}});t.layer.models=[r]})()}}const vte={fillImage:tte,fill:tF,radar:ute,image:rF,normal:nF,simplePoint:jee,extrude:eF,text:oF,earthFill:Yee,earthExtrude:Gee};class ig extends ah{constructor(...t){super(...t),L(this,"type","PointLayer"),L(this,"enableShaderEncodeStyles",["stroke","offsets","opacity","rotation"]),L(this,"enableDataEncodeStyles",["textOffset","textAnchor"]),L(this,"defaultSourceConfig",{data:[],options:{parser:{type:"json",x:"lng",y:"lat"}}})}buildModels(){var t=this;return Ze(function*(){const r=t.getModelType();t.layerModel&&t.layerModel.clearModels(),t.layerModel=new vte[r](t),yield t.initLayerModels()})()}rebuildModels(){var t=this;return Ze(function*(){yield t.buildModels()})()}getModelTypeWillEmptyData(){if(this.shapeOption){const{field:t,values:r}=this.shapeOption,{shape2d:n}=this.getLayerConfig(),i=this.iconService.getIconMap();if(t&&n?.indexOf(t)!==-1)return"fill";if(r==="text")return"text";if(r&&r instanceof Array){for(const a of r)if(typeof a=="string"&&i.hasOwnProperty(a))return"image"}}return"normal"}getDefaultConfig(){const t=this.getModelType();return{fillImage:{},normal:{blend:"additive"},radar:{},simplePoint:{},fill:{blend:"normal"},extrude:{},image:{},text:{blend:"normal"},tile:{},tileText:{},earthFill:{},earthExtrude:{}}[t]}getModelType(){const t=this.getEncodedData(),{shape2d:r,shape3d:n,billboard:i=!0}=this.getLayerConfig(),a=this.iconService.getIconMap(),s=t.find(l=>l.hasOwnProperty("shape"));if(s){const l=s.shape;return l==="dot"?"normal":l==="simple"?"simplePoint":l==="radar"?"radar":this.layerType==="fillImage"||i===!1?"fillImage":r?.indexOf(l)!==-1?this.mapService.version==="GLOBEL"?"earthFill":"fill":n?.indexOf(l)!==-1?this.mapService.version==="GLOBEL"?"earthExtrude":"extrude":a.hasOwnProperty(l)?"image":"text"}else return this.getModelTypeWillEmptyData()}}function mte(e){return ix.apply(this,arguments)}function ix(){return ix=Ze(function*(e){if(window.createImageBitmap){const t=yield fetch(e);return yield createImageBitmap(yield t.blob())}else{const t=new window.Image;return new Promise(r=>{t.onload=()=>r(t),t.src=e,t.crossOrigin="Anonymous"})}}),ix.apply(this,arguments)}const _te=`layout(std140) uniform commonUniforms {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor;
  float u_topsurface;
  float u_sidesurface;
  float u_heightfixed; // 默认不固定
  float u_raisingHeight;
};

in vec4 v_Color;
#pragma include "scene_uniforms"
#pragma include "picking"
out vec4 outputColor;
void main() {

     // top face
    if(u_topsurface < 1.0) {
      discard;
    }

    outputColor = v_Color;
  
  outputColor = filterColor(outputColor);
}
`,gte=`
layout(std140) uniform commonUniforms {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor;
  float u_topsurface;
  float u_sidesurface;
  float u_heightfixed; // 默认不固定
  float u_raisingHeight;
};

in vec4 v_Color;
in vec3 v_uvs;
in vec2 v_texture_data;
out vec4 outputColor;

#pragma include "scene_uniforms"
#pragma include "picking"

void main() {
  float isSide =  v_texture_data.x;
  float sidey = v_uvs[2];
  float lightWeight = v_texture_data.y;

  // Tip: 部分机型 GPU 计算精度兼容
  if(isSide < 0.999) {
    // side face
    if(u_sidesurface < 1.0) {
      discard;
    }
    
    if( u_linearColor == 1.0) {
      // side use linear
      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
      linearColor.rgb *= lightWeight;
      outputColor = linearColor;
    } else {
      // side notuse linear
       outputColor = v_Color;
    }
  } else {
    // top face
    if(u_topsurface < 1.0) {
      discard;
    }
    outputColor = v_Color;
  }

  outputColor = filterColorAlpha(outputColor, lightWeight);
}
`,yte=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;
layout(location = ATTRIBUTE_LOCATION_UV) in vec3 a_uvs;

layout(std140) uniform commonUniforms {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor;
  float u_topsurface;
  float u_sidesurface;
  float u_heightfixed; // 默认不固定
  float u_raisingHeight;
};

out vec4 v_Color;
out vec3 v_uvs;
out vec2 v_texture_data;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  v_uvs = a_uvs;
  // cal style mapping - 数据纹理映射部分的计算
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos, a_Position64Low);

  if (u_heightfixed > 0.0) {
    // 判断几何体是否固定高度
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;
    if (
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    ) {
      float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  float lightWeight = calc_lighting(project_pos);
  v_texture_data = vec2(a_Position.z, lightWeight);

  v_Color = vec4(a_Color.rgb * lightWeight, a_Color.w * opacity);

  setPickingColor(a_PickingColor);
}
`,Ete=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;
layout(location = ATTRIBUTE_LOCATION_UV) in vec3 a_uvs;

layout(std140) uniform commonUniforms {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor;
  float u_topsurface;
  float u_sidesurface;
  float u_heightfixed; // 默认不固定
  float u_raisingHeight;
};

out vec4 v_Color;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  float isSide = a_Position.z;
  float topU = a_uvs[0];
  float topV = 1.0 - a_uvs[1];
  float sidey = a_uvs[2];

  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);

  vec4 project_pos = project_position(pos, a_Position64Low);
  float lightWeight = calc_lighting(project_pos);

  if (u_heightfixed > 0.0) {
    // 判断几何体是否固定高度
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;

    if (
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    ) {
      float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }

 gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  // Tip: 部分机型 GPU 计算精度兼容
  if (isSide < 0.999) {
    // side face
    // if(u_sidesurface < 1.0) {
    //   discard;
    // }

    if (u_linearColor == 1.0) {
      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
      linearColor.rgb *= lightWeight;
      v_Color = linearColor;
    } else {
      v_Color = a_Color;
    }

  } else {
    v_Color = a_Color;
  }

  v_Color = vec4(v_Color.rgb * lightWeight, v_Color.w * opacity);

  setPickingColor(a_PickingColor);
}
`,Tte=`uniform sampler2D u_texture;

layout(std140) uniform commonUniforms {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor;
  float u_topsurface;
  float u_sidesurface;
  float u_heightfixed; // 默认不固定
  float u_raisingHeight;
};

in vec4 v_Color;
in vec3 v_uvs;
in vec2 v_texture_data;

#pragma include "scene_uniforms"
#pragma include "picking"

out vec4 outputColor;

void main() {
  float opacity = u_opacity;
  float isSide = v_texture_data.x;
  float lightWeight = v_texture_data.y;
  float topU = v_uvs[0];
  float topV = 1.0 - v_uvs[1];
  float sidey = v_uvs[2];

  outputColor = texture(SAMPLER_2D(u_texture), vec2(topU, topV));
  // Tip: 部分机型 GPU 计算精度兼容
  if (isSide < 0.999) {// 是否是边缘
    // side face
    if (u_sidesurface < 1.0) {
      discard;
    }

    if (u_linearColor == 1.0) {
      vec4 linearColor = mix(u_targetColor, u_sourceColor, sidey);
      linearColor.rgb *= lightWeight;
      outputColor = linearColor;
    } else {
      outputColor = v_Color;
    }
  } else {
     // top face
    if (u_topsurface < 1.0) {
      discard;
    }
  }
  
  outputColor.a *= opacity;
  outputColor = filterColor(outputColor);
}
`,Ste=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;
layout(location = ATTRIBUTE_LOCATION_UV) in vec3 a_uvs;

layout(std140) uniform commonUniforms {
  vec4 u_sourceColor;
  vec4 u_targetColor;
  float u_linearColor;
  float u_topsurface;
  float u_sidesurface;
  float u_heightfixed; // 默认不固定
  float u_raisingHeight;
};

out vec4 v_Color;
out vec3 v_uvs;
out vec2 v_texture_data;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size, 1.0);
  vec4 project_pos = project_position(pos, a_Position64Low);
  float lightWeight = calc_lighting(project_pos);
  v_uvs = a_uvs;
  v_Color = a_Color;
  v_Color.a *= opacity;

  v_texture_data = vec2(a_Position.z, lightWeight);

  if (u_heightfixed > 0.0) {
    // 判断几何体是否固定高度
    project_pos.z = a_Position.z * a_Size;
    project_pos.z += u_raisingHeight;

    if (
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
      u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
    ) {
      float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);
      project_pos.z *= mapboxZoomScale;
      project_pos.z += u_raisingHeight * mapboxZoomScale;
    }
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  setPickingColor(a_PickingColor);
}
`;class Ate extends nn{constructor(...t){super(...t),L(this,"texture",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,NORMAL:10,UV:11})}getUninforms(){const t=this.getCommonUniformsInfo(),r=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),Ge(Ge({},t.uniformsOption),r.uniformsOption)}getCommonUniformsInfo(){const{mapTexture:t,heightfixed:r=!1,raisingHeight:n=0,topsurface:i=!0,sidesurface:a=!0,sourceColor:s,targetColor:l}=this.layer.getLayerConfig();let c=0,d=[1,1,1,1],p=[1,1,1,1];s&&l&&(d=$r(s),p=$r(l),c=1);const h={u_sourceColor:d,u_targetColor:p,u_linearColor:c,u_topsurface:Number(i),u_sidesurface:Number(a),u_heightfixed:Number(r),u_raisingHeight:Number(n)};return t&&this.texture&&(h.u_texture=this.texture,this.textures=[this.texture]),this.getUniformsBufferInfo(h)}initModels(){var t=this;return Ze(function*(){return yield t.loadTexture(),t.buildModels()})()}buildModels(){var t=this;return Ze(function*(){const{frag:r,vert:n,type:i}=t.getShaders();return t.initUniformsBuffer(),[yield t.layer.buildLayerModel({moduleName:i,vertexShader:n,fragmentShader:r,depth:{enable:!0},defines:t.getDefines(),inject:t.getInject(),triangulation:K6})]})()}getShaders(){const{pickLight:t,mapTexture:r}=this.layer.getLayerConfig();return r?{frag:Tte,vert:Ste,type:"polygonExtrudeTexture"}:t?{frag:gte,vert:yte,type:"polygonExtrudePickLight"}:{frag:_te,vert:Ete,type:"polygonExtrude"}}clearModels(){var t;(t=this.texture)===null||t===void 0||t.destroy(),this.textures=[]}registerBuiltinAttributes(){const t=this.layer.getSource().extent,r=t[2]-t[0],n=t[3]-t[1];this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"uvs",type:Dt.Attribute,descriptor:{name:"a_uvs",shaderLocation:this.attributeLocation.UV,buffer:{usage:N.STATIC_DRAW,data:[],type:N.FLOAT},size:3,update:(i,a,s)=>{const l=s[0],c=s[1];return[(l-t[0])/r,(c-t[1])/n,s[4]]}}}),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Dt.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:N.STATIC_DRAW,data:[],type:N.FLOAT},size:3,update:(i,a,s,l,c)=>c}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Dt.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:1,update:i=>{const{size:a=10}=i;return Array.isArray(a)?[a[0]]:[a]}}})}loadTexture(){var t=this;return Ze(function*(){const{mapTexture:r}=t.layer.getLayerConfig(),{createTexture2D:n}=t.rendererService;if(t.texture=n({height:1,width:1}),r){const i=yield mte(r);t.texture=n({data:i,width:i.width,height:i.height,wrapS:N.CLAMP_TO_EDGE,wrapT:N.CLAMP_TO_EDGE,min:N.LINEAR,mag:N.LINEAR})}})()}}const bte=`
in vec4 v_Color;
#pragma include "scene_uniforms"
#pragma include "picking"
out vec4 outputColor;
void main() {

  outputColor = v_Color;
  outputColor = filterColor(outputColor);
}
`,xte=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_SIZE) in float a_Size;
layout(location = ATTRIBUTE_LOCATION_NORMAL) in vec3 a_Normal;

out vec4 v_Color;

#pragma include "projection"
#pragma include "light"
#pragma include "picking"

void main() {
  vec4 pos = vec4(a_Position.xy, a_Position.z * a_Size + (1.0 - a_Position.z) * extrusionBase, 1.0);

  vec4 project_pos = project_position(pos, a_Position64Low);
  float lightWeight = calc_lighting(project_pos);
  v_Color = a_Color;
  v_Color = vec4(v_Color.rgb * lightWeight, v_Color.w * opacity);

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  setPickingColor(a_PickingColor);
}
`;class Rte extends nn{constructor(...t){super(...t),L(this,"texture",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,SIZE:9,NORMAL:10,EXTRUSION_BASE:11})}getUninforms(){const t=this.getCommonUniformsInfo(),r=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),Ge(Ge({},t.uniformsOption),r.uniformsOption)}getCommonUniformsInfo(){const t={};return this.getUniformsBufferInfo(t)}initModels(){var t=this;return Ze(function*(){return t.buildModels()})()}buildModels(){var t=this;return Ze(function*(){const{frag:r,vert:n,type:i}=t.getShaders();return t.initUniformsBuffer(),[yield t.layer.buildLayerModel({moduleName:i,vertexShader:n,fragmentShader:r,defines:t.getDefines(),inject:t.getInject(),triangulation:K6,depth:{enable:!0}})]})()}getShaders(){return{frag:bte,vert:xte,type:"polygonExtrude"}}clearModels(){var t;(t=this.texture)===null||t===void 0||t.destroy()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"normal",type:Dt.Attribute,descriptor:{name:"a_Normal",shaderLocation:this.attributeLocation.NORMAL,buffer:{usage:N.STATIC_DRAW,data:[],type:N.FLOAT},size:3,update:(t,r,n,i,a)=>a}}),this.styleAttributeService.registerStyleAttribute({name:"size",type:Dt.Attribute,descriptor:{name:"a_Size",shaderLocation:this.attributeLocation.SIZE,buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:1,update:t=>{const{size:r=10}=t;return Array.isArray(r)?[r[0]]:[r]}}}),this.styleAttributeService.registerStyleAttribute({name:"extrusionBase",type:Dt.Attribute,descriptor:{name:"a_ExtrusionBase",shaderLocation:this.attributeLocation.EXTRUSION_BASE,buffer:{usage:N.STATIC_DRAW,data:[],type:N.FLOAT},size:1,update:t=>{const{extrusionBase:r=0}=t;return[r]}}})}}const Cte=`in vec4 v_color;
#pragma include "scene_uniforms"
#pragma include "picking"
out vec4 outputColor;
void main() {
  outputColor = v_color;
  outputColor = filterColor(outputColor);
}
`,Ote=`
layout(std140) uniform commonUniforms {
  float u_raisingHeight;
  float u_opacitylinear;
  float u_dir;
};

in vec4 v_color;
in vec3 v_linear;
in vec2 v_pos;
out vec4 outputColor;
#pragma include "scene_uniforms"
#pragma include "picking"

void main() {
  outputColor = v_color;
  if (u_opacitylinear > 0.0) {
    outputColor.a *= u_dir == 1.0 ? 1.0 - length(v_pos - v_linear.xy)/v_linear.z : length(v_pos - v_linear.xy)/v_linear.z;
  }
  outputColor = filterColor(outputColor);
}
`,Mte=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_LINEAR) in vec3 a_linear;

layout(std140) uniform commonUniforms {
  float u_raisingHeight;
  float u_opacitylinear;
  float u_dir;
};

out vec4 v_color;
out vec3 v_linear;
out vec2 v_pos;

#pragma include "projection"
#pragma include "picking"

void main() {
  if (u_opacitylinear > 0.0) {
    v_linear = a_linear;
    v_pos = a_Position.xy;
  }
  v_color = vec4(a_Color.xyz, a_Color.w * opacity);
  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);
  project_pos.z += u_raisingHeight;

  if (u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT || u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET) {
    float mapboxZoomScale = 4.0/pow(2.0, 21.0 - u_Zoom);
    project_pos.z *= mapboxZoomScale;
    project_pos.z += u_raisingHeight * mapboxZoomScale;
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
  setPickingColor(a_PickingColor);
}
`,wte=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;

layout(std140) uniform commonUniforms {
  float u_raisingHeight;
};

out vec4 v_color;

#pragma include "projection"
#pragma include "picking"

void main() {
  // cal style mapping - 数据纹理映射部分的计算

  v_color = vec4(a_Color.xyz, a_Color.w * opacity);
  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);

  project_pos.z += u_raisingHeight;

  if (
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
    u_CoordinateSystem == COORDINATE_SYSTEM_LNGLAT_OFFSET
  ) {
    float mapboxZoomScale = 4.0 / pow(2.0, 21.0 - u_Zoom);
    project_pos.z *= mapboxZoomScale;
    project_pos.z += u_raisingHeight * mapboxZoomScale;
  }

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));

  setPickingColor(a_PickingColor);
}

`;class Nte extends nn{get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,LINEAR:9})}getUninforms(){const t=this.getCommonUniformsInfo(),r=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),Ge(Ge({},t.uniformsOption),r.uniformsOption)}getCommonUniformsInfo(){const{raisingHeight:t=0,opacityLinear:r={enable:!1,dir:"in"}}=this.layer.getLayerConfig(),n={u_raisingHeight:Number(t),u_opacitylinear:Number(r.enable),u_dir:r.dir==="in"?1:0};return this.getUniformsBufferInfo(n)}initModels(){var t=this;return Ze(function*(){return t.buildModels()})()}buildModels(){var t=this;return Ze(function*(){const{frag:r,vert:n,triangulation:i,type:a}=t.getModelParams();return t.initUniformsBuffer(),t.layer.triangulation=i,[yield t.layer.buildLayerModel({moduleName:a,vertexShader:n,fragmentShader:r,defines:t.getDefines(),inject:t.getInject(),triangulation:i,primitive:N.TRIANGLES,depth:{enable:!1}})]})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute();const{opacityLinear:t={enable:!1,dir:"in"}}=this.layer.getLayerConfig();t.enable&&this.styleAttributeService.registerStyleAttribute({name:"linear",type:Dt.Attribute,descriptor:{name:"a_linear",shaderLocation:this.attributeLocation.LINEAR,buffer:{usage:N.STATIC_DRAW,data:[],type:N.FLOAT},size:3,update:(r,n,i)=>[i[3],i[4],i[5]]}})}getModelParams(){const{opacityLinear:t={enable:!1}}=this.layer.getLayerConfig();return t.enable?{frag:Ote,vert:Mte,type:"polygonLinear",triangulation:KJ}:{frag:Cte,vert:wte,type:"polygonFill",triangulation:Zv}}}const Ite=`
layout(std140) uniform commonUniforms {
  vec4 u_watercolor;
  vec4 u_watercolor2;
  float u_time;
};

in vec2 v_uv;
in float v_opacity;
out vec4 outputColor;

float coast2water_fadedepth = 0.10;
float large_waveheight      = .750; // change to adjust the "heavy" waves
float large_wavesize        = 3.4;  // factor to adjust the large wave size
float small_waveheight      = 0.6;  // change to adjust the small random waves
float small_wavesize        = 0.5;   // factor to ajust the small wave size
float water_softlight_fact  = 15.;  // range [1..200] (should be << smaller than glossy-fact)
float water_glossylight_fact= 120.; // range [1..200]
float particle_amount       = 70.;

vec3 water_specularcolor    = vec3(1.3, 1.3, 0.9);    // specular Color (RGB) of the water-highlights
#define light                 vec3(-0., sin(u_time*0.5)*.5 + .35, 2.8) // position of the sun

uniform sampler2D u_texture1;
uniform sampler2D u_texture2;
uniform sampler2D u_texture3;

  

float hash( float n ) {
    return fract(sin(n)*43758.5453123);
}

// 2d noise function
float noise1( in vec2 x ) {
  vec2 p  = floor(x);
  vec2 f  = smoothstep(0.0, 1.0, fract(x));
  float n = p.x + p.y*57.0;
  return mix(mix( hash(n+  0.0), hash(n+  1.0),f.x),
    mix( hash(n+ 57.0), hash(n+ 58.0),f.x),f.y);
}

float noise(vec2 p) {
    return texture(SAMPLER_2D(u_texture2),p*vec2(1./256.)).x;
}

vec4 highness(vec2 p) {
    vec4 t = texture(SAMPLER_2D(u_texture1),fract(p));
    float clipped = -2.0-smoothstep(3.,10.,t.a)*6.9-smoothstep(10.,100.,t.a)*89.9-smoothstep(0.,10000.,t.a)*10000.0;
    return clamp(t, 0.0,3.0)+clamp(t/3.0-1.0, 0.0,1.0)+clamp(t/16.0-1.0, 0.0,1.0);
}

float height_map( vec2 p ) {
    vec4 height=highness(p);
    /*
    height = -0.5+
        0.5*smoothstep(-100.,0.,-height)+
        2.75*smoothstep(0.,2.,height)+
        1.75*smoothstep(2.,4.,height)+
        2.75*smoothstep(4.,16.,height)+
        1.5*smoothstep(16.,1000.,height);
    */

    mat2 m = mat2( 0.9563*1.4,  -0.2924*1.4,  0.2924*1.4,  0.9563*1.4 );
    //p = p*6.;
    float f = 0.6000*noise1( p ); p = m*p*1.1*6.;
    f += 0.2500*noise( p ); p = m*p*1.32;
    f += 0.1666*noise( p ); p = m*p*1.11;
    f += 0.0834*noise( p ); p = m*p*1.12;
    f += 0.0634*noise( p ); p = m*p*1.13;
    f += 0.0444*noise( p ); p = m*p*1.14;
    f += 0.0274*noise( p ); p = m*p*1.15;
    f += 0.0134*noise( p ); p = m*p*1.16;
    f += 0.0104*noise( p ); p = m*p*1.17;
    f += 0.0084*noise( p );
    f = .25*f+dot(height,vec4(-.03125,-.125,.25,.25))*.5;
        const float FLAT_LEVEL = 0.92525;
        //f = f*0.25+height*0.75;
    if (f<FLAT_LEVEL)
        f = f;
    else
        f = pow((f-FLAT_LEVEL)/(1.-FLAT_LEVEL), 2.)*(1.-FLAT_LEVEL)*2.0+FLAT_LEVEL; // makes a smooth coast-increase
    return clamp(f, 0., 10.);
}

vec3 plasma_quintic( float x ) {
    x = clamp( x, 0.0, 1.0);
    vec4 x1 = vec4( 1.0, x, x * x, x * x * x ); // 1 x x2 x3
    vec4 x2 = x1 * x1.w * x; // x4 x5 x6 x7
    return vec3(
        dot( x1.xyzw, vec4( +0.063861086, +1.992659096, -1.023901152, -0.490832805 ) ) + dot( x2.xy, vec2( +1.308442123, -0.914547012 ) ),
        dot( x1.xyzw, vec4( +0.049718590, -0.791144343, +2.892305078, +0.811726816 ) ) + dot( x2.xy, vec2( -4.686502417, +2.717794514 ) ),
        dot( x1.xyzw, vec4( +0.513275779, +1.580255060, -5.164414457, +4.559573646 ) ) + dot( x2.xy, vec2( -1.916810682, +0.570638854 ) ) );
}

vec4 color(vec2 p){
    vec4 c1 = vec4(1.7,1.6,.9,1);
    vec4 c2 = vec4(.2,.94,.1,1);
    vec4 c3 = vec4(.3,.2,.0,1);
    vec4 c4 = vec4(.99,.99,1.6,1);
    vec4 v = highness(p);
    float los = smoothstep(0.1,1.1,v.b);
    float his = smoothstep(3.5,6.5,v.b);
    float ces = smoothstep(1.,5.,v.a);
    vec4 lo = mix(c1,c2,los);
    vec4 hi = mix(c3,c4,his);
    vec4 ce = mix(lo,hi,ces);

    return vec4(plasma_quintic(ces),1).ragb;
}

vec3 terrain_map( vec2 p )
{
  return color(p).rgb*0.75+0.25*vec3(0.7, .55, .4)+texture(SAMPLER_2D(u_texture3), fract(p*5.)).rgb*.5; // test-terrain is simply 'sandstone'
}

const mat2 m = mat2( 0.72, -1.60,  1.60,  0.72 );

float water_map( vec2 p, float height ) {
    vec2 p2 = p*large_wavesize;
    vec2 shift1 = 0.001*vec2( u_time*160.0*2.0, u_time*120.0*2.0 );
    vec2 shift2 = 0.001*vec2( u_time*190.0*2.0, -u_time*130.0*2.0 );

    // coarse crossing 'ocean' waves...
    float f = 0.6000*noise( p );
    f += 0.2500*noise( p*m );
    f += 0.1666*noise( p*m*m );
    float wave = sin(p2.x*0.622+p2.y*0.622+shift2.x*4.269)*large_waveheight*f*height*height ;

    p *= small_wavesize;
    f = 0.;
    float amp = 1.0, s = .5;
    for (int i=0; i<9; i++)
    { p = m*p*.947; f -= amp*abs(sin((noise( p+shift1*s )-.5)*2.)); amp = amp*.59; s*=-1.329; }
    
    return wave+f*small_waveheight;
}

float nautic(vec2 p) {
    p *= 18.;
    float f = 0.;
    float amp = 1.0, s = .5;
    for (int i=0; i<3; i++)
    { p = m*p*1.2; f += amp*abs(smoothstep(0., 1., noise( p+u_time*s ))-.5); amp = amp*.5; s*=-1.227; }
    return pow(1.-f, 5.);
}

float particles(vec2 p) {
    p *= 200.;
    float f = 0.;
    float amp = 1.0, s = 1.5;
    for (int i=0; i<3; i++)
    { p = m*p*1.2; f += amp*noise( p+u_time*s ); amp = amp*.5; s*=-1.227; }
    return pow(f*.35, 7.)*particle_amount;
}

float test_shadow( vec2 xy, float height) {
    vec3 r0 = vec3(xy, height);
    vec3 rd = normalize( light - r0 );
    
    float hit = 1.0;
    float t   = 0.001;
    for (int j=1; j<25; j++)
    {
        vec3 p = r0 + t*rd;
        float h = height_map( p.xy );
        float height_diff = p.z - h;
        if (height_diff<0.0)
        {
            return 0.0;
        }
        t += 0.01+height_diff*.02;
        hit = min(hit, 2.*height_diff/t); // soft shaddow   
    }
    return hit;
}

vec3 CalcTerrain(vec2 uv, float height) {
    vec3 col = terrain_map( uv );
    vec2 iResolution = vec2(512.);
    float h1 = height_map(uv-vec2(0., 0.5)/ iResolution.xy);
    float h2 = height_map(uv+vec2(0., 0.5)/ iResolution.xy);
    float h3 = height_map(uv-vec2(0.5, 0.)/ iResolution.xy);
    float h4 = height_map(uv+vec2(0.5, 0.)/ iResolution.xy);
    vec3 norm = normalize(vec3(h3-h4, h1-h2, 1.));
    vec3 r0 = vec3(uv, height);
    vec3 rd = normalize( light - r0 );
    float grad = dot(norm, rd);
    col *= grad+pow(grad, 8.);
    float terrainshade = test_shadow( uv, height );
    col = mix(col*.25, col, terrainshade);
    return col;
}


void main() {
  vec3 watercolor = u_watercolor.rgb;
  vec3 watercolor2 = u_watercolor2.rgb;
  vec2 uv = v_uv;
  float WATER_LEVEL = 0.84; // Water level (range: 0.0 - 2.0)
  float deepwater_fadedepth   = 0.4 + coast2water_fadedepth;
  float height = height_map( uv );
  vec3 col;

    float waveheight = clamp(WATER_LEVEL*3.-1.5, 0., 1.);
    float level = WATER_LEVEL + .2*water_map(uv*15. + vec2(u_time*.1), waveheight);
    if (height > level)
    {
        col = CalcTerrain(uv, height);
    }
    if (height <= level)
    {
        vec2 dif = vec2(.0, .01);
        vec2 pos = uv*15. + vec2(u_time*.01);
        float h1 = water_map(pos-dif,waveheight);
        float h2 = water_map(pos+dif,waveheight);
        float h3 = water_map(pos-dif.yx,waveheight);
        float h4 = water_map(pos+dif.yx,waveheight);
        vec3 normwater = normalize(vec3(h3-h4, h1-h2, .125)); // norm-vector of the 'bumpy' water-plane
        uv += normwater.xy*.002*(level-height);
        
        col = CalcTerrain(uv, height);

        float coastfade = clamp((level-height)/coast2water_fadedepth, 0., 1.);
        float coastfade2= clamp((level-height)/deepwater_fadedepth, 0., 1.);
        float intensity = col.r*.2126+col.g*.7152+col.b*.0722;
        watercolor = mix(watercolor*intensity, watercolor2, smoothstep(0., 1., coastfade2));

        vec3 r0 = vec3(uv, WATER_LEVEL);
        vec3 rd = normalize( light - r0 ); // ray-direction to the light from water-position
        float grad     = dot(normwater, rd); // dot-product of norm-vector and light-direction
        float specular = pow(grad, water_softlight_fact);  // used for soft highlights                          
        float specular2= pow(grad, water_glossylight_fact); // used for glossy highlights
        float gradpos  = dot(vec3(0., 0., 1.), rd);
        float specular1= smoothstep(0., 1., pow(gradpos, 5.));  // used for diffusity (some darker corona around light's specular reflections...)                          
        float watershade  = test_shadow( uv, level );
        watercolor *= 2.2+watershade;
        watercolor += (.2+.8*watershade) * ((grad-1.0)*.5+specular) * .25;
        watercolor /= (1.+specular1*1.25);
        watercolor += watershade*specular2*water_specularcolor;
        watercolor += watershade*coastfade*(1.-coastfade2)*(vec3(.5, .6, .7)*nautic(uv)+vec3(1., 1., 1.)*particles(uv));
        
        col = mix(col, watercolor, coastfade);
    }
    
  outputColor = vec4(col, v_opacity);  
}
`,Pte=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_uv;

layout(std140) uniform commonUniforms {
  vec4 u_watercolor;
  vec4 u_watercolor2;
  float u_time;
};

out vec2 v_uv;
out float v_opacity;

#pragma include "projection"

void main() {
  v_uv = a_uv;
  v_opacity = opacity;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
}

`;class Dte extends nn{constructor(...t){super(...t),L(this,"texture1",void 0),L(this,"texture2",void 0),L(this,"texture3",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9})}getUninforms(){const t=this.getCommonUniformsInfo(),r=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),Ge(Ge({},t.uniformsOption),r.uniformsOption)}getCommonUniformsInfo(){const{watercolor:t="#6D99A8",watercolor2:r="#0F121C"}=this.layer.getLayerConfig(),n={u_watercolor:$r(t),u_watercolor2:$r(r),u_time:this.layer.getLayerAnimateTime(),u_texture1:this.texture1,u_texture2:this.texture2,u_texture3:this.texture3};return this.textures=[this.texture1,this.texture2,this.texture3],this.getUniformsBufferInfo(n)}getAnimateUniforms(){return{u_time:this.layer.getLayerAnimateTime()}}initModels(){var t=this;return Ze(function*(){return t.loadTexture(),t.buildModels()})()}buildModels(){var t=this;return Ze(function*(){return t.initUniformsBuffer(),[yield t.layer.buildLayerModel({moduleName:"polygonOcean",vertexShader:Pte,fragmentShader:Ite,defines:t.getDefines(),inject:t.getInject(),triangulation:Zv,primitive:N.TRIANGLES,depth:{enable:!1}})]})()}clearModels(){var t,r,n;(t=this.texture1)===null||t===void 0||t.destroy(),(r=this.texture2)===null||r===void 0||r.destroy(),(n=this.texture3)===null||n===void 0||n.destroy()}registerBuiltinAttributes(){const t=this.layer.getSource().extent,[r,n,i,a]=t,s=i-r,l=a-n;this.styleAttributeService.registerStyleAttribute({name:"oceanUv",type:Dt.Attribute,descriptor:{name:"a_uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:N.STATIC_DRAW,data:[],type:N.FLOAT},size:2,update:(c,d,p)=>{const[h,m]=p;return[(h-r)/s,(m-n)/l]}}})}loadTexture(){const{createTexture2D:t}=this.rendererService,r={height:0,width:0};this.texture1=t(r),this.texture2=t(r),this.texture3=t(r),n(a=>{this.texture1=i(a[0]),this.texture2=i(a[1]),this.texture3=i(a[2]),this.layerService.reRender()});function n(a){let s=0;const l=[];["https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ","https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*MJ22QbpuCzIAAAAAAAAAAAAAARQnAQ","https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*-z2HSIVDsHIAAAAAAAAAAAAAARQnAQ"].map(d=>{const p=new Image;p.crossOrigin="",p.src=d,l.push(p),p.onload=()=>{s++,s===3&&a(l)}})}function i(a){return t({data:a,width:a.width,height:a.height,wrapS:N.MIRRORED_REPEAT,wrapT:N.MIRRORED_REPEAT,min:N.LINEAR,mag:N.LINEAR})}}}const Lte=`uniform sampler2D u_texture;
layout(std140) uniform commonUniforms {
  float u_speed;
  float u_time;
};

out vec4 outputColor;


in vec4 v_Color;
in vec2 v_uv;

float rand(vec2 n) { return 0.5 + 0.5 * fract(sin(dot(n.xy, vec2(12.9898, 78.233)))* 43758.5453); }

float water(vec3 p) {
  float t = u_time * u_speed;
  p.z += t * 2.; p.x += t * 2.;
  vec3 c1 = texture(SAMPLER_2D(u_texture), p.xz / 30.).xyz;
  p.z += t * 3.; p.x += t * 0.52;
  vec3 c2 = texture(SAMPLER_2D(u_texture), p.xz / 30.).xyz;
  p.z += t * 4.; p.x += t * 0.8;
  vec3 c3 = texture(SAMPLER_2D(u_texture), p.xz / 30.).xyz;
  c1 += c2 - c3;
  float z = (c1.x + c1.y + c1.z) / 3.;
  return p.y + z / 4.;
}

float map(vec3 p) {
  float d = 100.0;
  d = water(p);
  return d;
}

float intersect(vec3 ro, vec3 rd) {
  float d = 0.0;
  for (int i = 0; i <= 100; i++) {
    float h = map(ro + rd * d);
    if (h < 0.1) return  d;
    d += h;
  }
  return 0.0;
}

vec3 norm(vec3 p) {
  float eps = .1;
  return normalize(vec3(
    map(p + vec3(eps, 0, 0)) - map(p + vec3(-eps, 0, 0)),
    map(p + vec3(0, eps, 0)) - map(p + vec3(0, -eps, 0)),
    map(p + vec3(0, 0, eps)) - map(p + vec3(0, 0, -eps))
  ));
} 

float calSpc() {
  vec3 l1 = normalize(vec3(1, 1, 1));
  vec3 ro = vec3(-3, 20, -8);
  vec3 rc = vec3(0, 0, 0);
  vec3 ww = normalize(rc - ro);
  vec3 uu = normalize(cross(vec3(0,1,0), ww));
  vec3 vv = normalize(cross(rc - ro, uu));
  vec3 rd = normalize(uu * v_uv.x + vv * v_uv.y + ww);
  float d = intersect(ro, rd);
  vec3 p = ro + rd * d;
  vec3 n = norm(p);
  float spc = pow(max(0.0, dot(reflect(l1, n), rd)), 30.0);
  return spc;
}

void main() {

  outputColor = v_Color;
  float spc = calSpc();
  outputColor += spc * 0.4;
}
`,Bte=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_COLOR) in vec4 a_Color;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_uv;

layout(std140) uniform commonUniforms {
  float u_speed;
  float u_time;
};
out vec4 v_Color;
out vec2 v_uv;

#pragma include "projection"

void main() {
  v_uv = a_uv;
  v_Color = a_Color;
  v_Color.a *= opacity;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));

  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
}

`;class Fte extends nn{constructor(...t){super(...t),L(this,"texture",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9})}getUninforms(){const t=this.getCommonUniformsInfo(),r=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),Ge(Ge({},t.uniformsOption),r.uniformsOption)}getCommonUniformsInfo(){const{speed:t=.5}=this.layer.getLayerConfig(),r={u_speed:t,u_time:this.layer.getLayerAnimateTime(),u_texture:this.texture};return this.textures=[this.texture],this.getUniformsBufferInfo(r)}getAnimateUniforms(){return{u_time:this.layer.getLayerAnimateTime()}}initModels(){var t=this;return Ze(function*(){return t.loadTexture(),t.buildModels()})()}buildModels(){var t=this;return Ze(function*(){return t.initUniformsBuffer(),[yield t.layer.buildLayerModel({moduleName:"polygonWater",vertexShader:Bte,fragmentShader:Lte,triangulation:Zv,defines:t.getDefines(),inject:t.getInject(),primitive:N.TRIANGLES,depth:{enable:!1},pickingEnabled:!1,diagnosticDerivativeUniformityEnabled:!1})]})()}clearModels(){var t;(t=this.texture)===null||t===void 0||t.destroy()}registerBuiltinAttributes(){const t=this.layer.getSource().extent,[r,n,i,a]=t,s=i-r,l=a-n;this.styleAttributeService.registerStyleAttribute({name:"waterUv",type:Dt.Attribute,descriptor:{name:"a_uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:N.STATIC_DRAW,data:[],type:N.FLOAT},size:2,update:(c,d,p)=>{const[h,m]=p;return[(h-r)/s,(m-n)/l]}}})}loadTexture(){const{waterTexture:t}=this.layer.getLayerConfig(),{createTexture2D:r}=this.rendererService;this.texture=r({height:1,width:1});const n=new Image;n.crossOrigin="",t?(console.warn("L7 recommend：https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ"),n.src=t):n.src="https://gw.alipayobjects.com/mdn/rms_816329/afts/img/A*EojwT4VzSiYAAAAAAAAAAAAAARQnAQ",n.onload=()=>{this.texture=r({data:n,width:n.width,height:n.height,wrapS:N.MIRRORED_REPEAT,wrapT:N.MIRRORED_REPEAT,min:N.LINEAR,mag:N.LINEAR}),this.layerService.reRender()}}}const Ute={fill:Nte,line:Q6,extrude:Ate,text:oF,point_fill:tF,point_image:rF,point_normal:nF,point_extrude:eF,water:Fte,ocean:Dte,extrusion:Rte};class sF extends ah{constructor(...t){super(...t),L(this,"type","PolygonLayer"),L(this,"enableShaderEncodeStyles",["opacity","extrusionBase","rotation","offsets","stroke"])}buildModels(){var t=this;return Ze(function*(){const r=t.getModelType();t.layerModel=new Ute[r](t),yield t.initLayerModels()})()}getModelType(){var t;const r=this.styleAttributeService.getLayerStyleAttribute("shape"),n=r==null||(t=r.scale)===null||t===void 0?void 0:t.field;return n==="fill"||!n?"fill":n==="extrude"?"extrude":n==="extrusion"?"extrusion":n==="water"?"water":n==="ocean"?"ocean":n==="line"?"line":this.getPointModelType()}getPointModelType(){const t=this.getEncodedData(),{shape2d:r,shape3d:n}=this.getLayerConfig(),i=this.iconService.getIconMap(),a=t.find(s=>s.hasOwnProperty("shape"));if(a){const s=a.shape;return s==="dot"?"point_normal":r?.indexOf(s)!==-1?"point_fill":n?.indexOf(s)!==-1?"point_extrude":i.hasOwnProperty(s)?"point_image":"text"}else return"fill"}}const kte=`layout(std140) uniform commonUniforms {
  vec2 u_domain;
  float u_opacity;
  float u_noDataValue;
  float u_clampLow;
  float u_clampHigh;
};

uniform sampler2D u_rasterTexture;
uniform sampler2D u_colorTexture;

in vec2 v_texCoord;

bool isnan_emu(float x) { return (x > 0.0 || x < 0.0) ? x != x : x != 0.0; }

out vec4 outputColor;

void main() {
  // Can use any component here since u_rasterTexture is under luminance format.
  float value = texture(SAMPLER_2D(u_rasterTexture), vec2(v_texCoord.x, v_texCoord.y)).r;
  if (value == u_noDataValue || isnan_emu(value)) {
    discard;
  } else if ((u_clampLow < 0.5 && value < u_domain[0]) || (u_clampHigh < 0.5 && value > u_domain[1])) {
    discard;
  } else {
    float normalisedValue =(value - u_domain[0]) / (u_domain[1] - u_domain[0]);
    vec4 color = texture(SAMPLER_2D(u_colorTexture), vec2(normalisedValue, 0));
    
    outputColor = color;
    outputColor.a = outputColor.a * u_opacity ;
    if (outputColor.a < 0.01)
      discard;
  }
}
`,zte=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;

layout(std140) uniform commonUniforms {
  vec2 u_domain;
  float u_opacity;
  float u_noDataValue;
  float u_clampLow;
  float u_clampHigh;
};

out vec2 v_texCoord;

#pragma include "projection"

void main() {
  v_texCoord = a_Uv;
  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0.0, 1.0));
}
`;let $4=class extends nn{constructor(...t){super(...t),L(this,"texture",void 0),L(this,"colorTexture",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9})}getUninforms(){const t=this.getCommonUniformsInfo(),r=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),Ge(Ge({},t.uniformsOption),r.uniformsOption)}getCommonUniformsInfo(){const{opacity:t=1,clampLow:r=!0,clampHigh:n=!0,noDataValue:i=-9999999,domain:a,rampColors:s}=this.layer.getLayerConfig(),l=a||Zx(s);this.colorTexture=this.layer.textureService.getColorTexture(s,l);const c={u_domain:l,u_opacity:t||1,u_noDataValue:i,u_clampLow:r?1:0,u_clampHigh:(typeof n<"u"?n:r)?1:0,u_rasterTexture:this.texture,u_colorTexture:this.colorTexture};return this.textures=[this.texture,this.colorTexture],this.getUniformsBufferInfo(c)}getRasterData(t){return Ze(function*(){if(Array.isArray(t.data))return{data:t.data,width:t.width,height:t.height};{const{rasterData:r,width:n,height:i}=yield t.data;return{data:Array.from(r),width:n,height:i}}})()}initModels(){var t=this;return Ze(function*(){return t.buildModels()})()}buildModels(){var t=this;return Ze(function*(){t.initUniformsBuffer();const r=t.layer.getSource(),{createTexture2D:n,queryVerdorInfo:i}=t.rendererService,a=r.data.dataArray[0],{data:s,width:l,height:c}=yield t.getRasterData(a);return t.texture=n({data:new Float32Array(s),width:l,height:c,format:i()==="WebGL1"?N.LUMINANCE:N.RED,type:N.FLOAT,alignment:1}),[yield t.layer.buildLayerModel({moduleName:"rasterImageData",vertexShader:zte,fragmentShader:kte,defines:t.getDefines(),triangulation:Yg,primitive:N.TRIANGLES,depth:{enable:!1},pickingEnabled:!1})]})()}clearModels(){var t,r;(t=this.texture)===null||t===void 0||t.destroy(),(r=this.colorTexture)===null||r===void 0||r.destroy()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Dt.Attribute,descriptor:{shaderLocation:this.attributeLocation.UV,name:"a_Uv",buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:2,update:(t,r,n)=>[n[3],n[4]]}})}};const jte=["data"],Hte=["rasterData"],Vte=`uniform sampler2D u_texture;
layout(std140) uniform commonUniforms {
 vec2 u_rminmax;
 vec2 u_gminmax;
 vec2 u_bminmax;
 float u_opacity;
 float u_noDataValue;
};

in vec2 v_texCoord;

out vec4 outputColor;

void main() {

  vec3 rgb = texture(SAMPLER_2D(u_texture),vec2(v_texCoord.x,v_texCoord.y)).rgb;

  if(rgb == vec3(u_noDataValue)) {
    outputColor = vec4(0.0, 0, 0, 0.0);
  } else {
    outputColor = vec4(rgb.r / (u_rminmax.y -u_rminmax.x), rgb.g /(u_gminmax.y -u_gminmax.x), rgb.b/ (u_bminmax.y - u_bminmax.x), u_opacity);
  }

  if(outputColor.a < 0.01)
    discard;
 
}`,Xte=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_POSITION_64LOW) in vec2 a_Position64Low;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;

layout(std140) uniform commonUniforms {
  vec2 u_rminmax;
  vec2 u_gminmax;
  vec2 u_bminmax;
  float u_opacity;
  float u_noDataValue;
};

out vec2 v_texCoord;

#pragma include "projection"

void main() {
  v_texCoord = a_Uv;
  vec4 project_pos = project_position(vec4(a_Position, 1.0), a_Position64Low);
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0.0, 1.0));
}
`;class Gte extends nn{constructor(...t){super(...t),L(this,"texture",void 0),L(this,"dataOption",{})}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9})}getUninforms(){const t=this.getCommonUniformsInfo(),r=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),Ge(Ge({},t.uniformsOption),r.uniformsOption)}getCommonUniformsInfo(){const{opacity:t=1,noDataValue:r=0}=this.layer.getLayerConfig(),{rMinMax:n=[0,255],gMinMax:i=[0,255],bMinMax:a=[0,255]}=this.dataOption,s={u_rminmax:n,u_gminmax:i,u_bminmax:a,u_opacity:t||1,u_noDataValue:r,u_texture:this.texture};return this.textures=[this.texture],this.getUniformsBufferInfo(s)}getRasterData(t){var r=this;return Ze(function*(){if(Array.isArray(t.data)){const{data:s}=t,l=ms(t,jte);return r.dataOption=l,Ge({data:s},l)}const n=yield t.data,{rasterData:i}=n,a=ms(n,Hte);return r.dataOption=a,Array.isArray(i)?Ge({data:i},a):Ge({data:Array.from(i)},a)})()}initModels(){var t=this;return Ze(function*(){t.initUniformsBuffer();const r=t.layer.getSource(),{createTexture2D:n}=t.rendererService,i=r.data.dataArray[0],{data:a,width:s,height:l}=yield t.getRasterData(i);return t.texture=n({data:new Float32Array(a),width:s,height:l,format:N.RGB,type:N.FLOAT}),[yield t.layer.buildLayerModel({moduleName:"rasterImageDataRGBA",vertexShader:Xte,fragmentShader:Vte,defines:t.getDefines(),triangulation:Yg,primitive:N.TRIANGLES,depth:{enable:!1},pickingEnabled:!1})]})()}buildModels(){var t=this;return Ze(function*(){return t.initModels()})()}clearModels(){var t;(t=this.texture)===null||t===void 0||t.destroy()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Dt.Attribute,descriptor:{name:"a_Uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:2,update:(t,r,n)=>[n[3],n[4]]}})}}const qte=`uniform sampler2D u_texture;
uniform sampler2D u_colorTexture;

layout(std140) uniform commonUniforms {
 vec4 u_unpack;
 vec2 u_domain;
 float u_opacity;
 float u_noDataValue;
 float u_clampLow;
 float u_clampHigh;
};

in vec2 v_texCoord;
out vec4 outputColor;


float getElevation(vec2 coord, float bias) {
    // Convert encoded elevation value to meters
    vec4 data =  texture(SAMPLER_2D(u_texture), coord,bias) * 255.0;
    data.a = -1.0;
    return dot(data, u_unpack);
}

vec4 getColor(float value) {
   float normalisedValue =(value- u_domain[0]) / (u_domain[1] - u_domain[0]);
    vec2 coord = vec2(normalisedValue, 0);
    return  texture(SAMPLER_2D(u_colorTexture), coord);
}

void main() {
  float value = getElevation(v_texCoord,0.0);
  if (value == u_noDataValue) {
    outputColor = vec4(0.0, 0, 0, 0.0);
  } else if ((u_clampLow < 0.5 && value < u_domain[0]) || (u_clampHigh < 0.5 && value > u_domain[1])) {
     outputColor = vec4(0.0, 0, 0, 0.0);
  } else {
   
    outputColor = getColor(value);
    outputColor.a =  outputColor.a * u_opacity ;
      if(outputColor.a < 0.01)
      discard;
  }
}
`,Wte=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;
layout(location = ATTRIBUTE_LOCATION_UV) in vec2 a_Uv;

layout(std140) uniform commonUniforms {
  vec4 u_unpack;
  vec2 u_domain;
  float u_opacity;
  float u_noDataValue;
  float u_clampLow;
  float u_clampHigh;
};
out vec2 v_texCoord;
#pragma include "projection"

void main() {
  v_texCoord = a_Uv;
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xy, 0.0, 1.0));
}
`;class Yte extends nn{constructor(...t){super(...t),L(this,"texture",void 0)}get attributeLocation(){return Object.assign(super.attributeLocation,{MAX:super.attributeLocation.MAX,UV:9})}getCommonUniformsInfo(){const{opacity:t,clampLow:r=!0,clampHigh:n=!0,noDataValue:i=-9999999,domain:a,rampColors:s,colorTexture:l,rScaler:c=6553.6,gScaler:d=25.6,bScaler:p=.1,offset:h=1e4}=this.layer.getLayerConfig(),m=a||Zx(s);let _=l;l?this.layer.textureService.setColorTexture(l,s,m):_=this.layer.textureService.getColorTexture(s,m);const y={u_unpack:[c,d,p,h],u_domain:m,u_opacity:t||1,u_noDataValue:i,u_clampLow:r,u_clampHigh:typeof n<"u"?n:r,u_texture:this.texture,u_colorTexture:_};return this.textures=[this.texture,_],this.getUniformsBufferInfo(y)}initModels(){var t=this;return Ze(function*(){t.initUniformsBuffer();const r=t.layer.getSource(),{createTexture2D:n}=t.rendererService,i=yield r.data.images;return t.texture=n({data:i[0],width:i[0].width,height:i[0].height,min:N.LINEAR,mag:N.LINEAR}),[yield t.layer.buildLayerModel({moduleName:"RasterTileDataImage",vertexShader:Wte,fragmentShader:qte,defines:t.getDefines(),triangulation:Yg,primitive:N.TRIANGLES,depth:{enable:!1}})]})()}clearModels(){var t;(t=this.texture)===null||t===void 0||t.destroy()}buildModels(){var t=this;return Ze(function*(){return t.initModels()})()}registerBuiltinAttributes(){this.registerPosition64LowAttribute(),this.styleAttributeService.registerStyleAttribute({name:"uv",type:Dt.Attribute,descriptor:{name:"a_Uv",shaderLocation:this.attributeLocation.UV,buffer:{usage:N.DYNAMIC_DRAW,data:[],type:N.FLOAT},size:2,update:(t,r,n)=>[n[3],n[4]]}})}}const $te={raster:$4,rasterRgb:Gte,raster3d:$4,rasterTerrainRgb:Yte};class NR extends ah{constructor(...t){super(...t),L(this,"type","RasterLayer")}buildModels(){var t=this;return Ze(function*(){const r=t.getModelType();t.layerModel=new $te[r](t),yield t.initLayerModels()})()}getDefaultConfig(){const t=this.getModelType();return{raster:{},rasterRgb:{},raster3d:{},rasterTerrainRgb:{}}[t]}getModelType(){switch(this.layerSource.getParserType()){case"raster":case"ndi":return"raster";case"rasterRgb":return"rasterRgb";case"rgb":return"rasterRgb";case"image":return"rasterTerrainRgb";default:return"raster"}}getLegend(t){if(t!=="color")return{type:void 0,field:void 0,items:[]};const r=this.getLayerConfig().rampColors;return eee(r,t)}}class Zte{constructor({rendererService:t,layerService:r,parent:n}){L(this,"tileResource",new Map),L(this,"rendererService",void 0),L(this,"layerService",void 0),L(this,"parent",void 0),L(this,"layerTiles",[]),this.rendererService=t,this.layerService=r,this.parent=n}get tiles(){return this.layerTiles}hasTile(t){return this.layerTiles.some(r=>r.key===t)}addTile(t){this.layerTiles.push(t)}getTile(t){return this.layerTiles.find(r=>r.key===t)}getVisibleTileBylngLat(t){return this.layerTiles.find(r=>r.isLoaded&&r.visible&&r.lnglatInBounds(t))}removeTile(t){const r=this.layerTiles.findIndex(i=>i.key===t),n=this.layerTiles.splice(r,1);n[0]&&n[0].destroy()}updateTileVisible(t){const r=this.getTile(t.key);if(t.isVisible)if(t.parent){const n=this.isChildrenLoaded(t.parent);r?.updateVisible(n)}else r?.updateVisible(!0);else if(t.parent){const n=this.isChildrenLoaded(t.parent);r?.updateVisible(!n)}else r?.updateVisible(!1)}isParentLoaded(t){const r=t.parent;if(!r)return!0;const n=this.getTile(r?.key);return!!(n!=null&&n.isLoaded)}isChildrenLoaded(t){const r=t?.children;return r.length===0?!0:r.every(n=>{const i=this.getTile(n?.key);return i?i?.isLoaded===!0:!0})}render(){var t=this;return Ze(function*(){const n=t.getRenderLayers().map((function(){var i=Ze(function*(a){yield t.layerService.renderTileLayer(a)});return function(a){return i.apply(this,arguments)}})());yield Promise.all(n)})()}getRenderLayers(){const t=this.layerTiles.filter(n=>n.visible&&n.isLoaded),r=[];return t.map(n=>r.push(...n.getLayers())),r}getLayers(){const t=this.layerTiles.filter(n=>n.isLoaded),r=[];return t.map(n=>r.push(...n.getLayers())),r}getTiles(){return this.layerTiles}destroy(){this.layerTiles.forEach(t=>t.destroy()),this.tileResource.clear()}}/**
 * splaytree v3.1.2
 * Fast Splay tree for Node and browser
 *
 * @author Alexander Milevski <info@w8r.name>
 * @license MIT
 * @preserve
 *//*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function Kte(e,t){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,s;return s={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function l(d){return function(p){return c([d,p])}}function c(d){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(a=d[0]&2?i.return:d[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,d[1])).done)return a;switch(i=0,a&&(d=[d[0]&2,a.value]),d[0]){case 0:case 1:a=d;break;case 4:return r.label++,{value:d[1],done:!1};case 5:r.label++,i=d[1],d=[0];continue;case 7:d=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(d[0]===6||d[0]===2)){r=0;continue}if(d[0]===3&&(!a||d[1]>a[0]&&d[1]<a[3])){r.label=d[1];break}if(d[0]===6&&r.label<a[1]){r.label=a[1],a=d;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(d);break}a[2]&&r.ops.pop(),r.trys.pop();continue}d=t.call(e,r)}catch(p){d=[6,p],i=0}finally{n=a=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}var wl=(function(){function e(t,r){this.next=null,this.key=t,this.data=r,this.left=null,this.right=null}return e})();function Qte(e,t){return e>t?1:e<t?-1:0}function gl(e,t,r){for(var n=new wl(null,null),i=n,a=n;;){var s=r(e,t.key);if(s<0){if(t.left===null)break;if(r(e,t.left.key)<0){var l=t.left;if(t.left=l.right,l.right=t,t=l,t.left===null)break}a.left=t,a=t,t=t.left}else if(s>0){if(t.right===null)break;if(r(e,t.right.key)>0){var l=t.right;if(t.right=l.left,l.left=t,t=l,t.right===null)break}i.right=t,i=t,t=t.right}else break}return i.right=t.left,a.left=t.right,t.left=n.right,t.right=n.left,t}function $A(e,t,r,n){var i=new wl(e,t);if(r===null)return i.left=i.right=null,i;r=gl(e,r,n);var a=n(e,r.key);return a<0?(i.left=r.left,i.right=r,r.left=null):a>=0&&(i.right=r.right,i.left=r,r.right=null),i}function Z4(e,t,r){var n=null,i=null;if(t){t=gl(e,t,r);var a=r(t.key,e);a===0?(n=t.left,i=t.right):a<0?(i=t.right,t.right=null,n=t):(n=t.left,t.left=null,i=t)}return{left:n,right:i}}function Jte(e,t,r){return t===null?e:(e===null||(t=gl(e.key,t,r),t.left=e),t)}function ax(e,t,r,n,i){if(e){n(""+t+(r?"└── ":"├── ")+i(e)+`
`);var a=t+(r?"    ":"│   ");e.left&&ax(e.left,a,!1,n,i),e.right&&ax(e.right,a,!0,n,i)}}var IR=(function(){function e(t){t===void 0&&(t=Qte),this._root=null,this._size=0,this._comparator=t}return e.prototype.insert=function(t,r){return this._size++,this._root=$A(t,r,this._root,this._comparator)},e.prototype.add=function(t,r){var n=new wl(t,r);this._root===null&&(n.left=n.right=null,this._size++,this._root=n);var i=this._comparator,a=gl(t,this._root,i),s=i(t,a.key);return s===0?this._root=a:(s<0?(n.left=a.left,n.right=a,a.left=null):s>0&&(n.right=a.right,n.left=a,a.right=null),this._size++,this._root=n),this._root},e.prototype.remove=function(t){this._root=this._remove(t,this._root,this._comparator)},e.prototype._remove=function(t,r,n){var i;if(r===null)return null;r=gl(t,r,n);var a=n(t,r.key);return a===0?(r.left===null?i=r.right:(i=gl(t,r.left,n),i.right=r.right),this._size--,i):r},e.prototype.pop=function(){var t=this._root;if(t){for(;t.left;)t=t.left;return this._root=gl(t.key,this._root,this._comparator),this._root=this._remove(t.key,this._root,this._comparator),{key:t.key,data:t.data}}return null},e.prototype.findStatic=function(t){for(var r=this._root,n=this._comparator;r;){var i=n(t,r.key);if(i===0)return r;i<0?r=r.left:r=r.right}return null},e.prototype.find=function(t){return this._root&&(this._root=gl(t,this._root,this._comparator),this._comparator(t,this._root.key)!==0)?null:this._root},e.prototype.contains=function(t){for(var r=this._root,n=this._comparator;r;){var i=n(t,r.key);if(i===0)return!0;i<0?r=r.left:r=r.right}return!1},e.prototype.forEach=function(t,r){for(var n=this._root,i=[],a=!1;!a;)n!==null?(i.push(n),n=n.left):i.length!==0?(n=i.pop(),t.call(r,n),n=n.right):a=!0;return this},e.prototype.range=function(t,r,n,i){for(var a=[],s=this._comparator,l=this._root,c;a.length!==0||l;)if(l)a.push(l),l=l.left;else{if(l=a.pop(),c=s(l.key,r),c>0)break;if(s(l.key,t)>=0&&n.call(i,l))return this;l=l.right}return this},e.prototype.keys=function(){var t=[];return this.forEach(function(r){var n=r.key;return t.push(n)}),t},e.prototype.values=function(){var t=[];return this.forEach(function(r){var n=r.data;return t.push(n)}),t},e.prototype.min=function(){return this._root?this.minNode(this._root).key:null},e.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},e.prototype.minNode=function(t){if(t===void 0&&(t=this._root),t)for(;t.left;)t=t.left;return t},e.prototype.maxNode=function(t){if(t===void 0&&(t=this._root),t)for(;t.right;)t=t.right;return t},e.prototype.at=function(t){for(var r=this._root,n=!1,i=0,a=[];!n;)if(r)a.push(r),r=r.left;else if(a.length>0){if(r=a.pop(),i===t)return r;i++,r=r.right}else n=!0;return null},e.prototype.next=function(t){var r=this._root,n=null;if(t.right){for(n=t.right;n.left;)n=n.left;return n}for(var i=this._comparator;r;){var a=i(t.key,r.key);if(a===0)break;a<0?(n=r,r=r.left):r=r.right}return n},e.prototype.prev=function(t){var r=this._root,n=null;if(t.left!==null){for(n=t.left;n.right;)n=n.right;return n}for(var i=this._comparator;r;){var a=i(t.key,r.key);if(a===0)break;a<0?r=r.left:(n=r,r=r.right)}return n},e.prototype.clear=function(){return this._root=null,this._size=0,this},e.prototype.toList=function(){return tre(this._root)},e.prototype.load=function(t,r,n){r===void 0&&(r=[]),n===void 0&&(n=!1);var i=t.length,a=this._comparator;if(n&&ux(t,r,0,i-1,a),this._root===null)this._root=ox(t,r,0,i),this._size=i;else{var s=rre(this.toList(),ere(t,r),a);i=this._size+i,this._root=sx({head:s},0,i)}return this},e.prototype.isEmpty=function(){return this._root===null},Object.defineProperty(e.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),e.prototype.toString=function(t){t===void 0&&(t=function(n){return String(n.key)});var r=[];return ax(this._root,"",!0,function(n){return r.push(n)},t),r.join("")},e.prototype.update=function(t,r,n){var i=this._comparator,a=Z4(t,this._root,i),s=a.left,l=a.right;i(t,r)<0?l=$A(r,n,l,i):s=$A(r,n,s,i),this._root=Jte(s,l,i)},e.prototype.split=function(t){return Z4(t,this._root,this._comparator)},e.prototype[Symbol.iterator]=function(){var t,r,n;return Kte(this,function(i){switch(i.label){case 0:t=this._root,r=[],n=!1,i.label=1;case 1:return n?[3,6]:t===null?[3,2]:(r.push(t),t=t.left,[3,5]);case 2:return r.length===0?[3,4]:(t=r.pop(),[4,t]);case 3:return i.sent(),t=t.right,[3,5];case 4:n=!0,i.label=5;case 5:return[3,1];case 6:return[2]}})},e})();function ox(e,t,r,n){var i=n-r;if(i>0){var a=r+Math.floor(i/2),s=e[a],l=t[a],c=new wl(s,l);return c.left=ox(e,t,r,a),c.right=ox(e,t,a+1,n),c}return null}function ere(e,t){for(var r=new wl(null,null),n=r,i=0;i<e.length;i++)n=n.next=new wl(e[i],t[i]);return n.next=null,r.next}function tre(e){for(var t=e,r=[],n=!1,i=new wl(null,null),a=i;!n;)t?(r.push(t),t=t.left):r.length>0?(t=a=a.next=r.pop(),t=t.right):n=!0;return a.next=null,i.next}function sx(e,t,r){var n=r-t;if(n>0){var i=t+Math.floor(n/2),a=sx(e,t,i),s=e.head;return s.left=a,e.head=e.head.next,s.right=sx(e,i+1,r),s}return null}function rre(e,t,r){for(var n=new wl(null,null),i=n,a=e,s=t;a!==null&&s!==null;)r(a.key,s.key)<0?(i.next=a,a=a.next):(i.next=s,s=s.next),i=i.next;return a!==null?i.next=a:s!==null&&(i.next=s),n.next}function ux(e,t,r,n,i){if(!(r>=n)){for(var a=e[r+n>>1],s=r-1,l=n+1;;){do s++;while(i(e[s],a)<0);do l--;while(i(e[l],a)>0);if(s>=l)break;var c=e[s];e[s]=e[l],e[l]=c,c=t[s],t[s]=t[l],t[l]=c}ux(e,t,r,l,i),ux(e,t,l+1,n,i)}}const iu=11102230246251565e-32,wi=134217729,nre=(3+8*iu)*iu;function ZA(e,t,r,n,i){let a,s,l,c,d=t[0],p=n[0],h=0,m=0;p>d==p>-d?(a=d,d=t[++h]):(a=p,p=n[++m]);let _=0;if(h<e&&m<r)for(p>d==p>-d?(s=d+a,l=a-(s-d),d=t[++h]):(s=p+a,l=a-(s-p),p=n[++m]),a=s,l!==0&&(i[_++]=l);h<e&&m<r;)p>d==p>-d?(s=a+d,c=s-a,l=a-(s-c)+(d-c),d=t[++h]):(s=a+p,c=s-a,l=a-(s-c)+(p-c),p=n[++m]),a=s,l!==0&&(i[_++]=l);for(;h<e;)s=a+d,c=s-a,l=a-(s-c)+(d-c),d=t[++h],a=s,l!==0&&(i[_++]=l);for(;m<r;)s=a+p,c=s-a,l=a-(s-c)+(p-c),p=n[++m],a=s,l!==0&&(i[_++]=l);return(a!==0||_===0)&&(i[_++]=a),_}function ire(e,t){let r=t[0];for(let n=1;n<e;n++)r+=t[n];return r}function Kv(e){return new Float64Array(e)}const are=(3+16*iu)*iu,ore=(2+12*iu)*iu,sre=(9+64*iu)*iu*iu,hd=Kv(4),K4=Kv(8),Q4=Kv(12),J4=Kv(16),Vi=Kv(4);function ure(e,t,r,n,i,a,s){let l,c,d,p,h,m,_,y,E,T,A,b,R,M,B,w,D,U;const ae=e-i,Q=r-i,X=t-a,x=n-a;M=ae*x,m=wi*ae,_=m-(m-ae),y=ae-_,m=wi*x,E=m-(m-x),T=x-E,B=y*T-(M-_*E-y*E-_*T),w=X*Q,m=wi*X,_=m-(m-X),y=X-_,m=wi*Q,E=m-(m-Q),T=Q-E,D=y*T-(w-_*E-y*E-_*T),A=B-D,h=B-A,hd[0]=B-(A+h)+(h-D),b=M+A,h=b-M,R=M-(b-h)+(A-h),A=R-w,h=R-A,hd[1]=R-(A+h)+(h-w),U=b+A,h=U-b,hd[2]=b-(U-h)+(A-h),hd[3]=U;let P=ire(4,hd),H=ore*s;if(P>=H||-P>=H||(h=e-ae,l=e-(ae+h)+(h-i),h=r-Q,d=r-(Q+h)+(h-i),h=t-X,c=t-(X+h)+(h-a),h=n-x,p=n-(x+h)+(h-a),l===0&&c===0&&d===0&&p===0)||(H=sre*s+nre*Math.abs(P),P+=ae*p+x*l-(X*d+Q*c),P>=H||-P>=H))return P;M=l*x,m=wi*l,_=m-(m-l),y=l-_,m=wi*x,E=m-(m-x),T=x-E,B=y*T-(M-_*E-y*E-_*T),w=c*Q,m=wi*c,_=m-(m-c),y=c-_,m=wi*Q,E=m-(m-Q),T=Q-E,D=y*T-(w-_*E-y*E-_*T),A=B-D,h=B-A,Vi[0]=B-(A+h)+(h-D),b=M+A,h=b-M,R=M-(b-h)+(A-h),A=R-w,h=R-A,Vi[1]=R-(A+h)+(h-w),U=b+A,h=U-b,Vi[2]=b-(U-h)+(A-h),Vi[3]=U;const pe=ZA(4,hd,4,Vi,K4);M=ae*p,m=wi*ae,_=m-(m-ae),y=ae-_,m=wi*p,E=m-(m-p),T=p-E,B=y*T-(M-_*E-y*E-_*T),w=X*d,m=wi*X,_=m-(m-X),y=X-_,m=wi*d,E=m-(m-d),T=d-E,D=y*T-(w-_*E-y*E-_*T),A=B-D,h=B-A,Vi[0]=B-(A+h)+(h-D),b=M+A,h=b-M,R=M-(b-h)+(A-h),A=R-w,h=R-A,Vi[1]=R-(A+h)+(h-w),U=b+A,h=U-b,Vi[2]=b-(U-h)+(A-h),Vi[3]=U;const O=ZA(pe,K4,4,Vi,Q4);M=l*p,m=wi*l,_=m-(m-l),y=l-_,m=wi*p,E=m-(m-p),T=p-E,B=y*T-(M-_*E-y*E-_*T),w=c*d,m=wi*c,_=m-(m-c),y=c-_,m=wi*d,E=m-(m-d),T=d-E,D=y*T-(w-_*E-y*E-_*T),A=B-D,h=B-A,Vi[0]=B-(A+h)+(h-D),b=M+A,h=b-M,R=M-(b-h)+(A-h),A=R-w,h=R-A,Vi[1]=R-(A+h)+(h-w),U=b+A,h=U-b,Vi[2]=b-(U-h)+(A-h),Vi[3]=U;const F=ZA(O,Q4,4,Vi,J4);return J4[F-1]}function lre(e,t,r,n,i,a){const s=(t-a)*(r-i),l=(e-i)*(n-a),c=s-l,d=Math.abs(s+l);return Math.abs(c)>=are*d?c:-ure(e,t,r,n,i,a,d)}var uF={};const kp=(e,t)=>e.ll.x<=t.x&&t.x<=e.ur.x&&e.ll.y<=t.y&&t.y<=e.ur.y,lx=(e,t)=>{if(t.ur.x<e.ll.x||e.ur.x<t.ll.x||t.ur.y<e.ll.y||e.ur.y<t.ll.y)return null;const r=e.ll.x<t.ll.x?t.ll.x:e.ll.x,n=e.ur.x<t.ur.x?e.ur.x:t.ur.x,i=e.ll.y<t.ll.y?t.ll.y:e.ll.y,a=e.ur.y<t.ur.y?e.ur.y:t.ur.y;return{ll:{x:r,y:i},ur:{x:n,y:a}}};let Tl=Number.EPSILON;Tl===void 0&&(Tl=Math.pow(2,-52));const cre=Tl*Tl,eP=(e,t)=>{if(-Tl<e&&e<Tl&&-Tl<t&&t<Tl)return 0;const r=e-t;return r*r<cre*e*t?0:e<t?-1:1};class fre{constructor(){this.reset()}reset(){this.xRounder=new tP,this.yRounder=new tP}round(t,r){return{x:this.xRounder.round(t),y:this.yRounder.round(r)}}}class tP{constructor(){this.tree=new IR,this.round(0)}round(t){const r=this.tree.add(t),n=this.tree.prev(r);if(n!==null&&eP(r.key,n.key)===0)return this.tree.remove(t),n.key;const i=this.tree.next(r);return i!==null&&eP(r.key,i.key)===0?(this.tree.remove(t),i.key):t}}const Fv=new fre,h0=(e,t)=>e.x*t.y-e.y*t.x,lF=(e,t)=>e.x*t.x+e.y*t.y,rP=(e,t,r)=>{const n=lre(e.x,e.y,t.x,t.y,r.x,r.y);return n>0?-1:n<0?1:0},ag=e=>Math.sqrt(lF(e,e)),dre=(e,t,r)=>{const n={x:t.x-e.x,y:t.y-e.y},i={x:r.x-e.x,y:r.y-e.y};return h0(i,n)/ag(i)/ag(n)},hre=(e,t,r)=>{const n={x:t.x-e.x,y:t.y-e.y},i={x:r.x-e.x,y:r.y-e.y};return lF(i,n)/ag(i)/ag(n)},nP=(e,t,r)=>t.y===0?null:{x:e.x+t.x/t.y*(r-e.y),y:r},iP=(e,t,r)=>t.x===0?null:{x:r,y:e.y+t.y/t.x*(r-e.x)},pre=(e,t,r,n)=>{if(t.x===0)return iP(r,n,e.x);if(n.x===0)return iP(e,t,r.x);if(t.y===0)return nP(r,n,e.y);if(n.y===0)return nP(e,t,r.y);const i=h0(t,n);if(i==0)return null;const a={x:r.x-e.x,y:r.y-e.y},s=h0(a,t)/i,l=h0(a,n)/i,c=e.x+l*t.x,d=r.x+s*n.x,p=e.y+l*t.y,h=r.y+s*n.y,m=(c+d)/2,_=(p+h)/2;return{x:m,y:_}};class Wa{static compare(t,r){const n=Wa.comparePoints(t.point,r.point);return n!==0?n:(t.point!==r.point&&t.link(r),t.isLeft!==r.isLeft?t.isLeft?1:-1:Rl.compare(t.segment,r.segment))}static comparePoints(t,r){return t.x<r.x?-1:t.x>r.x?1:t.y<r.y?-1:t.y>r.y?1:0}constructor(t,r){t.events===void 0?t.events=[this]:t.events.push(this),this.point=t,this.isLeft=r}link(t){if(t.point===this.point)throw new Error("Tried to link already linked events");const r=t.point.events;for(let n=0,i=r.length;n<i;n++){const a=r[n];this.point.events.push(a),a.point=this.point}this.checkForConsuming()}checkForConsuming(){const t=this.point.events.length;for(let r=0;r<t;r++){const n=this.point.events[r];if(n.segment.consumedBy===void 0)for(let i=r+1;i<t;i++){const a=this.point.events[i];a.consumedBy===void 0&&n.otherSE.point.events===a.otherSE.point.events&&n.segment.consume(a.segment)}}}getAvailableLinkedEvents(){const t=[];for(let r=0,n=this.point.events.length;r<n;r++){const i=this.point.events[r];i!==this&&!i.segment.ringOut&&i.segment.isInResult()&&t.push(i)}return t}getLeftmostComparator(t){const r=new Map,n=i=>{const a=i.otherSE;r.set(i,{sine:dre(this.point,t.point,a.point),cosine:hre(this.point,t.point,a.point)})};return(i,a)=>{r.has(i)||n(i),r.has(a)||n(a);const{sine:s,cosine:l}=r.get(i),{sine:c,cosine:d}=r.get(a);return s>=0&&c>=0?l<d?1:l>d?-1:0:s<0&&c<0?l<d?-1:l>d?1:0:c<s?-1:c>s?1:0}}}let vre=0;class Rl{static compare(t,r){const n=t.leftSE.point.x,i=r.leftSE.point.x,a=t.rightSE.point.x,s=r.rightSE.point.x;if(s<n)return 1;if(a<i)return-1;const l=t.leftSE.point.y,c=r.leftSE.point.y,d=t.rightSE.point.y,p=r.rightSE.point.y;if(n<i){if(c<l&&c<d)return 1;if(c>l&&c>d)return-1;const h=t.comparePoint(r.leftSE.point);if(h<0)return 1;if(h>0)return-1;const m=r.comparePoint(t.rightSE.point);return m!==0?m:-1}if(n>i){if(l<c&&l<p)return-1;if(l>c&&l>p)return 1;const h=r.comparePoint(t.leftSE.point);if(h!==0)return h;const m=t.comparePoint(r.rightSE.point);return m<0?1:m>0?-1:1}if(l<c)return-1;if(l>c)return 1;if(a<s){const h=r.comparePoint(t.rightSE.point);if(h!==0)return h}if(a>s){const h=t.comparePoint(r.rightSE.point);if(h<0)return 1;if(h>0)return-1}if(a!==s){const h=d-l,m=a-n,_=p-c,y=s-i;if(h>m&&_<y)return 1;if(h<m&&_>y)return-1}return a>s?1:a<s||d<p?-1:d>p?1:t.id<r.id?-1:t.id>r.id?1:0}constructor(t,r,n,i){this.id=++vre,this.leftSE=t,t.segment=this,t.otherSE=r,this.rightSE=r,r.segment=this,r.otherSE=t,this.rings=n,this.windings=i}static fromRing(t,r,n){let i,a,s;const l=Wa.comparePoints(t,r);if(l<0)i=t,a=r,s=1;else if(l>0)i=r,a=t,s=-1;else throw new Error(`Tried to create degenerate segment at [${t.x}, ${t.y}]`);const c=new Wa(i,!0),d=new Wa(a,!1);return new Rl(c,d,[n],[s])}replaceRightSE(t){this.rightSE=t,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}bbox(){const t=this.leftSE.point.y,r=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:t<r?t:r},ur:{x:this.rightSE.point.x,y:t>r?t:r}}}vector(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}isAnEndpoint(t){return t.x===this.leftSE.point.x&&t.y===this.leftSE.point.y||t.x===this.rightSE.point.x&&t.y===this.rightSE.point.y}comparePoint(t){if(this.isAnEndpoint(t))return 0;const r=this.leftSE.point,n=this.rightSE.point,i=this.vector();if(r.x===n.x)return t.x===r.x?0:t.x<r.x?1:-1;const a=(t.y-r.y)/i.y,s=r.x+a*i.x;if(t.x===s)return 0;const l=(t.x-r.x)/i.x,c=r.y+l*i.y;return t.y===c?0:t.y<c?-1:1}getIntersection(t){const r=this.bbox(),n=t.bbox(),i=lx(r,n);if(i===null)return null;const a=this.leftSE.point,s=this.rightSE.point,l=t.leftSE.point,c=t.rightSE.point,d=kp(r,l)&&this.comparePoint(l)===0,p=kp(n,a)&&t.comparePoint(a)===0,h=kp(r,c)&&this.comparePoint(c)===0,m=kp(n,s)&&t.comparePoint(s)===0;if(p&&d)return m&&!h?s:!m&&h?c:null;if(p)return h&&a.x===c.x&&a.y===c.y?null:a;if(d)return m&&s.x===l.x&&s.y===l.y?null:l;if(m&&h)return null;if(m)return s;if(h)return c;const _=pre(a,this.vector(),l,t.vector());return _===null||!kp(i,_)?null:Fv.round(_.x,_.y)}split(t){const r=[],n=t.events!==void 0,i=new Wa(t,!0),a=new Wa(t,!1),s=this.rightSE;this.replaceRightSE(a),r.push(a),r.push(i);const l=new Rl(i,s,this.rings.slice(),this.windings.slice());return Wa.comparePoints(l.leftSE.point,l.rightSE.point)>0&&l.swapEvents(),Wa.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),n&&(i.checkForConsuming(),a.checkForConsuming()),r}swapEvents(){const t=this.rightSE;this.rightSE=this.leftSE,this.leftSE=t,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(let r=0,n=this.windings.length;r<n;r++)this.windings[r]*=-1}consume(t){let r=this,n=t;for(;r.consumedBy;)r=r.consumedBy;for(;n.consumedBy;)n=n.consumedBy;const i=Rl.compare(r,n);if(i!==0){if(i>0){const a=r;r=n,n=a}if(r.prev===n){const a=r;r=n,n=a}for(let a=0,s=n.rings.length;a<s;a++){const l=n.rings[a],c=n.windings[a],d=r.rings.indexOf(l);d===-1?(r.rings.push(l),r.windings.push(c)):r.windings[d]+=c}n.rings=null,n.windings=null,n.consumedBy=r,n.leftSE.consumedBy=r.leftSE,n.rightSE.consumedBy=r.rightSE}}prevInResult(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}beforeState(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{const t=this.prev.consumedBy||this.prev;this._beforeState=t.afterState()}return this._beforeState}afterState(){if(this._afterState!==void 0)return this._afterState;const t=this.beforeState();this._afterState={rings:t.rings.slice(0),windings:t.windings.slice(0),multiPolys:[]};const r=this._afterState.rings,n=this._afterState.windings,i=this._afterState.multiPolys;for(let l=0,c=this.rings.length;l<c;l++){const d=this.rings[l],p=this.windings[l],h=r.indexOf(d);h===-1?(r.push(d),n.push(p)):n[h]+=p}const a=[],s=[];for(let l=0,c=r.length;l<c;l++){if(n[l]===0)continue;const d=r[l],p=d.poly;if(s.indexOf(p)===-1)if(d.isExterior)a.push(p);else{s.indexOf(p)===-1&&s.push(p);const h=a.indexOf(d.poly);h!==-1&&a.splice(h,1)}}for(let l=0,c=a.length;l<c;l++){const d=a[l].multiPoly;i.indexOf(d)===-1&&i.push(d)}return this._afterState}isInResult(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;const t=this.beforeState().multiPolys,r=this.afterState().multiPolys;switch(Oo.type){case"union":{const n=t.length===0,i=r.length===0;this._isInResult=n!==i;break}case"intersection":{let n,i;t.length<r.length?(n=t.length,i=r.length):(n=r.length,i=t.length),this._isInResult=i===Oo.numMultiPolys&&n<i;break}case"xor":{const n=Math.abs(t.length-r.length);this._isInResult=n%2===1;break}case"difference":{const n=i=>i.length===1&&i[0].isSubject;this._isInResult=n(t)!==n(r);break}default:throw new Error(`Unrecognized operation type found ${Oo.type}`)}return this._isInResult}}class aP{constructor(t,r,n){if(!Array.isArray(t)||t.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=r,this.isExterior=n,this.segments=[],typeof t[0][0]!="number"||typeof t[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");const i=Fv.round(t[0][0],t[0][1]);this.bbox={ll:{x:i.x,y:i.y},ur:{x:i.x,y:i.y}};let a=i;for(let s=1,l=t.length;s<l;s++){if(typeof t[s][0]!="number"||typeof t[s][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");let c=Fv.round(t[s][0],t[s][1]);c.x===a.x&&c.y===a.y||(this.segments.push(Rl.fromRing(a,c,this)),c.x<this.bbox.ll.x&&(this.bbox.ll.x=c.x),c.y<this.bbox.ll.y&&(this.bbox.ll.y=c.y),c.x>this.bbox.ur.x&&(this.bbox.ur.x=c.x),c.y>this.bbox.ur.y&&(this.bbox.ur.y=c.y),a=c)}(i.x!==a.x||i.y!==a.y)&&this.segments.push(Rl.fromRing(a,i,this))}getSweepEvents(){const t=[];for(let r=0,n=this.segments.length;r<n;r++){const i=this.segments[r];t.push(i.leftSE),t.push(i.rightSE)}return t}}class mre{constructor(t,r){if(!Array.isArray(t))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new aP(t[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(let n=1,i=t.length;n<i;n++){const a=new aP(t[n],this,!1);a.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=a.bbox.ll.x),a.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=a.bbox.ll.y),a.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=a.bbox.ur.x),a.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=a.bbox.ur.y),this.interiorRings.push(a)}this.multiPoly=r}getSweepEvents(){const t=this.exteriorRing.getSweepEvents();for(let r=0,n=this.interiorRings.length;r<n;r++){const i=this.interiorRings[r].getSweepEvents();for(let a=0,s=i.length;a<s;a++)t.push(i[a])}return t}}class oP{constructor(t,r){if(!Array.isArray(t))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof t[0][0][0]=="number"&&(t=[t])}catch{}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(let n=0,i=t.length;n<i;n++){const a=new mre(t[n],this);a.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=a.bbox.ll.x),a.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=a.bbox.ll.y),a.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=a.bbox.ur.x),a.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=a.bbox.ur.y),this.polys.push(a)}this.isSubject=r}getSweepEvents(){const t=[];for(let r=0,n=this.polys.length;r<n;r++){const i=this.polys[r].getSweepEvents();for(let a=0,s=i.length;a<s;a++)t.push(i[a])}return t}}class og{static factory(t){const r=[];for(let n=0,i=t.length;n<i;n++){const a=t[n];if(!a.isInResult()||a.ringOut)continue;let s=null,l=a.leftSE,c=a.rightSE;const d=[l],p=l.point,h=[];for(;s=l,l=c,d.push(l),l.point!==p;)for(;;){const m=l.getAvailableLinkedEvents();if(m.length===0){const E=d[0].point,T=d[d.length-1].point;throw new Error(`Unable to complete output ring starting at [${E.x}, ${E.y}]. Last matching segment found ends at [${T.x}, ${T.y}].`)}if(m.length===1){c=m[0].otherSE;break}let _=null;for(let E=0,T=h.length;E<T;E++)if(h[E].point===l.point){_=E;break}if(_!==null){const E=h.splice(_)[0],T=d.splice(E.index);T.unshift(T[0].otherSE),r.push(new og(T.reverse()));continue}h.push({index:d.length,point:l.point});const y=l.getLeftmostComparator(s);c=m.sort(y)[0].otherSE;break}r.push(new og(d))}return r}constructor(t){this.events=t;for(let r=0,n=t.length;r<n;r++)t[r].segment.ringOut=this;this.poly=null}getGeom(){let t=this.events[0].point;const r=[t];for(let d=1,p=this.events.length-1;d<p;d++){const h=this.events[d].point,m=this.events[d+1].point;rP(h,t,m)!==0&&(r.push(h),t=h)}if(r.length===1)return null;const n=r[0],i=r[1];rP(n,t,i)===0&&r.shift(),r.push(r[0]);const a=this.isExteriorRing()?1:-1,s=this.isExteriorRing()?0:r.length-1,l=this.isExteriorRing()?r.length:-1,c=[];for(let d=s;d!=l;d+=a)c.push([r[d].x,r[d].y]);return c}isExteriorRing(){if(this._isExteriorRing===void 0){const t=this.enclosingRing();this._isExteriorRing=t?!t.isExteriorRing():!0}return this._isExteriorRing}enclosingRing(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}_calcEnclosingRing(){let t=this.events[0];for(let i=1,a=this.events.length;i<a;i++){const s=this.events[i];Wa.compare(t,s)>0&&(t=s)}let r=t.segment.prevInResult(),n=r?r.prevInResult():null;for(;;){if(!r)return null;if(!n)return r.ringOut;if(n.ringOut!==r.ringOut)return n.ringOut.enclosingRing()!==r.ringOut?r.ringOut:r.ringOut.enclosingRing();r=n.prevInResult(),n=r?r.prevInResult():null}}}class sP{constructor(t){this.exteriorRing=t,t.poly=this,this.interiorRings=[]}addInterior(t){this.interiorRings.push(t),t.poly=this}getGeom(){const t=[this.exteriorRing.getGeom()];if(t[0]===null)return null;for(let r=0,n=this.interiorRings.length;r<n;r++){const i=this.interiorRings[r].getGeom();i!==null&&t.push(i)}return t}}class _re{constructor(t){this.rings=t,this.polys=this._composePolys(t)}getGeom(){const t=[];for(let r=0,n=this.polys.length;r<n;r++){const i=this.polys[r].getGeom();i!==null&&t.push(i)}return t}_composePolys(t){const r=[];for(let n=0,i=t.length;n<i;n++){const a=t[n];if(!a.poly)if(a.isExteriorRing())r.push(new sP(a));else{const s=a.enclosingRing();s.poly||r.push(new sP(s)),s.poly.addInterior(a)}}return r}}class gre{constructor(t){let r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:Rl.compare;this.queue=t,this.tree=new IR(r),this.segments=[]}process(t){const r=t.segment,n=[];if(t.consumedBy)return t.isLeft?this.queue.remove(t.otherSE):this.tree.remove(r),n;const i=t.isLeft?this.tree.add(r):this.tree.find(r);if(!i)throw new Error(`Unable to find segment #${r.id} [${r.leftSE.point.x}, ${r.leftSE.point.y}] -> [${r.rightSE.point.x}, ${r.rightSE.point.y}] in SweepLine tree.`);let a=i,s=i,l,c;for(;l===void 0;)a=this.tree.prev(a),a===null?l=null:a.key.consumedBy===void 0&&(l=a.key);for(;c===void 0;)s=this.tree.next(s),s===null?c=null:s.key.consumedBy===void 0&&(c=s.key);if(t.isLeft){let d=null;if(l){const h=l.getIntersection(r);if(h!==null&&(r.isAnEndpoint(h)||(d=h),!l.isAnEndpoint(h))){const m=this._splitSafely(l,h);for(let _=0,y=m.length;_<y;_++)n.push(m[_])}}let p=null;if(c){const h=c.getIntersection(r);if(h!==null&&(r.isAnEndpoint(h)||(p=h),!c.isAnEndpoint(h))){const m=this._splitSafely(c,h);for(let _=0,y=m.length;_<y;_++)n.push(m[_])}}if(d!==null||p!==null){let h=null;d===null?h=p:p===null?h=d:h=Wa.comparePoints(d,p)<=0?d:p,this.queue.remove(r.rightSE),n.push(r.rightSE);const m=r.split(h);for(let _=0,y=m.length;_<y;_++)n.push(m[_])}n.length>0?(this.tree.remove(r),n.push(t)):(this.segments.push(r),r.prev=l)}else{if(l&&c){const d=l.getIntersection(c);if(d!==null){if(!l.isAnEndpoint(d)){const p=this._splitSafely(l,d);for(let h=0,m=p.length;h<m;h++)n.push(p[h])}if(!c.isAnEndpoint(d)){const p=this._splitSafely(c,d);for(let h=0,m=p.length;h<m;h++)n.push(p[h])}}}this.tree.remove(r)}return n}_splitSafely(t,r){this.tree.remove(t);const n=t.rightSE;this.queue.remove(n);const i=t.split(r);return i.push(n),t.consumedBy===void 0&&this.tree.add(t),i}}const uP=typeof process<"u"&&uF.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,yre=typeof process<"u"&&uF.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6;class Ere{run(t,r,n){Oo.type=t,Fv.reset();const i=[new oP(r,!0)];for(let h=0,m=n.length;h<m;h++)i.push(new oP(n[h],!1));if(Oo.numMultiPolys=i.length,Oo.type==="difference"){const h=i[0];let m=1;for(;m<i.length;)lx(i[m].bbox,h.bbox)!==null?m++:i.splice(m,1)}if(Oo.type==="intersection")for(let h=0,m=i.length;h<m;h++){const _=i[h];for(let y=h+1,E=i.length;y<E;y++)if(lx(_.bbox,i[y].bbox)===null)return[]}const a=new IR(Wa.compare);for(let h=0,m=i.length;h<m;h++){const _=i[h].getSweepEvents();for(let y=0,E=_.length;y<E;y++)if(a.insert(_[y]),a.size>uP)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big).")}const s=new gre(a);let l=a.size,c=a.pop();for(;c;){const h=c.key;if(a.size===l){const _=h.segment;throw new Error(`Unable to pop() ${h.isLeft?"left":"right"} SweepEvent [${h.point.x}, ${h.point.y}] from segment #${_.id} [${_.leftSE.point.x}, ${_.leftSE.point.y}] -> [${_.rightSE.point.x}, ${_.rightSE.point.y}] from queue.`)}if(a.size>uP)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big).");if(s.segments.length>yre)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments).");const m=s.process(h);for(let _=0,y=m.length;_<y;_++){const E=m[_];E.consumedBy===void 0&&a.insert(E)}l=a.size,c=a.pop()}Fv.reset();const d=og.factory(s.segments);return new _re(d).getGeom()}}const Oo=new Ere,Tre=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return Oo.run("union",e,r)},Sre=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return Oo.run("intersection",e,r)},Are=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return Oo.run("xor",e,r)},bre=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return Oo.run("difference",e,r)};var xre={union:Tre,intersection:Sre,xor:Are,difference:bre};function Rre(e,t,r){r===void 0&&(r={});var n=qC(e),i=qC(t),a=xre.union(n.coordinates,i.coordinates);return a.length===0?null:a.length===1?Hx(a[0],r.properties):j9(a,r.properties)}class Cre{getCombineFeature(t){let r=null;const n=t[0];return t.map(i=>{const a=Hx(i.coordinates);r===null?r=a:r=Rre(r,a)}),n&&(r.properties=Ge({},n)),r}}const zp="select",jp="active";class Ore{constructor({layerService:t,tileLayerService:r,parent:n}){L(this,"layerService",void 0),L(this,"tileLayerService",void 0),L(this,"tileSourceService",void 0),L(this,"parent",void 0),L(this,"tilePickID",new Map),this.layerService=t,this.tileLayerService=r,this.parent=n,this.tileSourceService=new Cre}pickRender(t){const r=this.tileLayerService.getVisibleTileBylngLat(t.lngLat);if(r){const n=r.getMainLayer();n?.layerPickService.pickRender(t)}}pick(t,r){var n=this;return Ze(function*(){const a=n.parent.getContainer().pickingService;if(t.type==="RasterLayer"){const s=n.tileLayerService.getVisibleTileBylngLat(r.lngLat);if(s&&s.getMainLayer()!==void 0){const l=s.getMainLayer();return l.layerPickService.pickRasterLayer(l,r,n.parent)}return!1}return n.pickRender(r),a.pickFromPickingFBO(t,r)})()}selectFeature(t){const[r,n,i]=t,a=this.color2PickId(r,n,i);this.tilePickID.set(zp,a),this.updateHighLight(r,n,i,zp)}highlightPickedFeature(t){const[r,n,i]=t,a=this.color2PickId(r,n,i);this.tilePickID.set(jp,a),this.updateHighLight(r,n,i,jp)}updateHighLight(t,r,n,i){this.tileLayerService.tiles.map(a=>{const s=a.getMainLayer();switch(i){case zp:s?.hooks.beforeSelect.call([t,r,n]);break;case jp:s?.hooks.beforeHighlight.call([t,r,n]);break}})}setPickState(){const t=this.tilePickID.get(zp),r=this.tilePickID.get(jp);if(t){const[n,i,a]=this.pickId2Color(t);this.updateHighLight(n,i,a,zp);return}if(r){const[n,i,a]=this.pickId2Color(r);this.updateHighLight(n,i,a,jp);return}}color2PickId(t,r,n){return Dc(new Uint8Array([t,r,n]))}pickId2Color(t){return Hd(t)}getFeatureById(t){const r=this.tileLayerService.getTiles().filter(i=>i.visible),n=[];return r.forEach(i=>{n.push(...i.getFeatureById(t))}),n}pickRasterLayer(){return!1}}function Mre(e){return e==="PolygonLayer"?sF:e==="LineLayer"?J6:ig}function wre(e){return["PolygonLayer","LineLayer"].indexOf(e)!==-1}class Zc extends Oa.EventEmitter{constructor(t,r){super(),L(this,"x",void 0),L(this,"y",void 0),L(this,"z",void 0),L(this,"key",void 0),L(this,"parent",void 0),L(this,"sourceTile",void 0),L(this,"visible",!0),L(this,"layers",[]),L(this,"isLoaded",!1),L(this,"tileMaskLayers",[]),L(this,"tileMask",void 0),this.parent=r,this.sourceTile=t,this.x=t.x,this.y=t.y,this.z=t.z,this.key=`${this.x}_${this.y}_${this.z}`}getLayers(){return this.layers}styleUpdate(...t){}lnglatInBounds(t){const[r,n,i,a]=this.sourceTile.bounds,{lng:s,lat:l}=t;return s>=r&&s<=i&&l>=n&&l<=a}getLayerOptions(){var t;const r=this.parent.getLayerConfig();return Ge(Ge({},r),{},{textAllowOverlap:!0,autoFit:!1,maskLayers:this.getMaskLayer(),tileMask:wre(this.parent.type),mask:r.mask||((t=r.maskLayers)===null||t===void 0?void 0:t.length)!==0&&r.enableMask})}getMaskLayer(){const{maskLayers:t}=this.parent.getLayerConfig(),r=[];return t?.forEach(n=>{if(!n.tileLayer)return r.push(n),n;const a=n.tileLayer.getTile(this.sourceTile.key),s=a?.getLayers()[0];s&&r.push(s)}),r}addTileMask(){var t=this;return Ze(function*(){const r=new sF({name:"mask",visible:!0,enablePicking:!1}).source({type:"FeatureCollection",features:[t.sourceTile.bboxPolygon]},{parser:{type:"geojson",featureId:"id"}}).shape("fill").color("#0f0").style({opacity:.5}),n=yv(t.parent.container);r.setContainer(n),yield r.init(),t.tileMask=r;const i=t.getMainLayer();return i!==void 0&&(i.tileMask=r),r})()}addMask(t,r){var n=this;return Ze(function*(){const i=yv(n.parent.container);r.setContainer(i),yield r.init(),t.addMask(r),n.tileMaskLayers.push(r)})()}addLayer(t){var r=this;return Ze(function*(){t.isTileLayer=!0;const n=yv(r.parent.container);t.setContainer(n),r.layers.push(t),yield t.init()})()}updateVisible(t){this.visible=t,this.updateOptions("visible",t)}updateOptions(t,r){this.layers.forEach(n=>{n.updateLayerConfig({[t]:r})})}getMainLayer(){return this.layers[0]}getFeatures(t){return[]}getFeatureById(t){return[]}destroy(){var t;(t=this.tileMask)===null||t===void 0||t.destroy(),this.layers.forEach(r=>r.destroy())}}class Nre extends Zc{initTileLayer(){var t=this;return Ze(function*(){const r=t.getSourceOption(),n=r.data.features[0].properties,i=new J6().source(r.data,r.options).size(1).shape("line").color("red"),a=new ig({minZoom:t.z-1,maxZoom:t.z+1,textAllowOverlap:!0}).source([n],{parser:{type:"json",x:"x",y:"y"}}).size(20).color("red").shape(t.key).style({stroke:"#fff",strokeWidth:2});yield t.addLayer(i),yield t.addLayer(a),t.isLoaded=!0})()}getSourceOption(){const t=this.parent.getSource();return{data:{type:"FeatureCollection",features:this.sourceTile.data.layers.testTile.features},options:{parser:{type:"geojson"},transforms:t.transforms}}}}class Ire extends Zc{initTileLayer(){var t=this;return Ze(function*(){const r=t.parent.getLayerAttributeConfig(),n=t.getLayerOptions(),i=t.getSourceOption(),a=new aee(Ge({},n)).source(i.data,i.options);r&&Object.keys(r).forEach(s=>{var l,c;const d=s;a[d]((l=r[d])===null||l===void 0?void 0:l.field,(c=r[d])===null||c===void 0?void 0:c.values)}),yield t.addLayer(a),t.isLoaded=!0})()}getSourceOption(){const t=this.parent.getSource();return{data:this.sourceTile.data,options:{parser:{type:"image",extent:this.sourceTile.bounds},transforms:t.transforms}}}}const Pre=`layout(std140) uniform commonUniorm {
  vec4 u_color;
  float u_opacity;
};

out vec4 outputColor;

void main() {
  outputColor = u_color;
  outputColor.a *= u_opacity;
}
`,Dre=`layout(location = ATTRIBUTE_LOCATION_POSITION) in vec3 a_Position;

layout(std140) uniform commonUniorm {
  vec4 u_color;
  float u_opacity;
};

#pragma include "projection"

void main() {
  vec4 project_pos = project_position(vec4(a_Position, 1.0));
  gl_Position = project_common_position_to_clipspace(vec4(project_pos.xyz, 1.0));
}

`;class Lre extends nn{getUninforms(){const t=this.getCommonUniformsInfo(),r=this.getUniformsBufferInfo(this.getStyleAttribute());return this.updateStyleUnifoms(),Ge(Ge({},t.uniformsOption),r.uniformsOption)}getCommonUniformsInfo(){const{opacity:t=1,color:r="#000"}=this.layer.getLayerConfig(),n={u_color:$r(r),u_opacity:t||1};return this.getUniformsBufferInfo(n)}initModels(){var t=this;return Ze(function*(){return t.buildModels()})()}buildModels(){var t=this;return Ze(function*(){return t.initUniformsBuffer(),[yield t.layer.buildLayerModel({moduleName:"mask",vertexShader:Dre,fragmentShader:Pre,defines:t.getDefines(),triangulation:Zv,depth:{enable:!1},pick:!1})]})()}clearModels(t=!0){t&&this.layerService.clear()}registerBuiltinAttributes(){return""}}const Bre={fill:Lre};class cF extends ah{constructor(...t){super(...t),L(this,"type","MaskLayer")}buildModels(){var t=this;return Ze(function*(){const r=t.getModelType();t.layerModel=new Bre[r](t),yield t.initLayerModels()})()}getModelType(){return"fill"}}class Fre extends Zc{initTileLayer(){var t=this;return Ze(function*(){const r=t.parent.getLayerAttributeConfig(),n=t.getLayerOptions(),i=t.getSourceOption(),a=new cF(Ge({},n)).source(i.data,i.options);r&&Object.keys(r).forEach(s=>{var l,c;const d=s;a[d]((l=r[d])===null||l===void 0?void 0:l.field,(c=r[d])===null||c===void 0?void 0:c.values)}),yield t.addLayer(a),t.isLoaded=!0})()}getFeatures(t){return t?this.sourceTile.data.getTileData(t):[]}getSourceOption(){const t=this.parent.getSource(),{sourceLayer:r,featureId:n}=this.parent.getLayerConfig();return{data:{type:"FeatureCollection",features:this.getFeatures(r)},options:{parser:{type:"geojson",featureId:n},transforms:t.transforms}}}}const Ure=["rasterData"];let kre=class extends Zc{initTileLayer(){var t=this;return Ze(function*(){const r=t.parent.getLayerAttributeConfig(),n=t.getLayerOptions(),i=t.getSourceOption(),a=new NR(Ge({},n)).source(i.data,i.options);r&&Object.keys(r).forEach(s=>{var l,c;const d=s;a[d]((l=r[d])===null||l===void 0?void 0:l.field,(c=r[d])===null||c===void 0?void 0:c.values)}),yield t.addLayer(a),t.isLoaded=!0})()}getSourceOption(){const t=this.parent.getSource(),r=this.sourceTile.data.data,{rasterData:n}=r,i=ms(r,Ure);return{data:n,options:{parser:Ge({type:"rasterRgb",extent:this.sourceTile.bounds},i),transforms:t.transforms}}}};class zre extends Zc{initTileLayer(){var t=this;return Ze(function*(){const r=t.parent.getLayerAttributeConfig(),n=t.getLayerOptions(),i=t.getSourceOption(),a=new NR(Ge({},n)).source(i.data,i.options);r&&Object.keys(r).forEach(s=>{var l,c;const d=s;a[d]((l=r[d])===null||l===void 0?void 0:l.field,(c=r[d])===null||c===void 0?void 0:c.values)}),yield t.addLayer(a),t.isLoaded=!0})()}getSourceOption(){const t=this.parent.getSource();return{data:this.sourceTile.data,options:{parser:{type:"image",extent:this.sourceTile.bounds},transforms:t.transforms}}}}const jre=["rasterData"],Hre={positions:[0,1],colors:["#000","#fff"]};class Vre extends Zc{constructor(...t){super(...t),L(this,"colorTexture",void 0)}initTileLayer(){var t=this;return Ze(function*(){const r=t.parent.getLayerAttributeConfig(),n=t.getLayerOptions(),i=t.getSourceOption(),{rampColors:a,domain:s}=t.getLayerOptions();t.colorTexture=t.parent.textureService.getColorTexture(a,s);const l=new NR(Ge(Ge({},n),{},{colorTexture:t.colorTexture})).source(i.data,i.options);r&&Object.keys(r).forEach(c=>{var d,p;const h=c;l[h]((d=r[h])===null||d===void 0?void 0:d.field,(p=r[h])===null||p===void 0?void 0:p.values)}),yield t.addLayer(l),t.isLoaded=!0})()}getSourceOption(){const t=this.parent.getSource(),r=this.sourceTile.data.data,{rasterData:n}=r,i=ms(r,jre);return{data:n,options:{parser:Ge({type:"raster",extent:this.sourceTile.bounds},i),transforms:t.transforms}}}styleUpdate(...t){const{rampColors:r=Hre,domain:n}=t;this.colorTexture=this.parent.textureService.getColorTexture(r,n||Zx(r)),this.layers.forEach(i=>i.style({colorTexture:this.colorTexture}))}destroy(){this.layers.forEach(t=>t.destroy())}}class X_ extends Zc{initTileLayer(){var t=this;return Ze(function*(){const r=t.parent.getLayerAttributeConfig(),n=t.getLayerOptions(),i=Mre(t.parent.type),a=t.getSourceOption();if(!a){t.isLoaded=!0,t.emit("loaded");return}const s=new i(Ge({},n)).source(a.data,a.options);Object.keys(r).forEach(l=>{var c,d;const p=l;s[p]((c=r[p])===null||c===void 0?void 0:c.field,(d=r[p])===null||d===void 0?void 0:d.values)}),yield t.addLayer(s),n.tileMask&&(yield t.addTileMask()),t.setLayerMinMaxZoom(s),t.isLoaded=!0,t.emit("loaded")})()}getSourceOption(){const t=this.parent.getSource(),{sourceLayer:r="defaultLayer",featureId:n="id"}=this.parent.getLayerConfig();return{data:{type:"FeatureCollection",features:this.getFeatures(r)},options:{parser:{type:"geojson",featureId:n},transforms:t.transforms}}}setLayerMinMaxZoom(t){t.getModelType()==="text"&&t.updateLayerConfig({maxZoom:this.z+1,minZoom:this.z-1})}getFeatures(t){return this.sourceTile.data.getTileData(t)}getFeatureById(t){const r=this.getMainLayer();return r?r.getSource().data.dataArray.filter(i=>i._id===t):[]}}function Xre(e){switch(e.type){case"PolygonLayer":return X_;case"LineLayer":return X_;case"PointLayer":return X_;case"TileDebugLayer":return Nre;case"MaskLayer":return Fre;case"RasterLayer":const{dataType:r}=e.getSource().parser;switch(r){case Ei.RGB:case Ei.CUSTOMRGB:return kre;case Ei.ARRAYBUFFER:case Ei.CUSTOMARRAYBUFFER:return Vre;case Ei.TERRAINRGB:case Ei.CUSTOMTERRAINRGB:return zre;default:return Ire}default:return X_}}const Gre=["shape","color","size","style","animate","filter","rotate","scale","setBlend","setSelect","setActive","disableMask","enableMask","addMask","removeMask"],{debounce:qre}=yn;class Wre{constructor(t){L(this,"parent",void 0),L(this,"tileLayerService",void 0),L(this,"mapService",void 0),L(this,"layerService",void 0),L(this,"rendererService",void 0),L(this,"pickingService",void 0),L(this,"tilePickService",void 0),L(this,"tilesetManager",void 0),L(this,"initedTileset",!1),L(this,"lastViewStates",void 0),L(this,"mapchange",()=>{var n;if(this.parent.isVisible()===!1)return;const{latLonBounds:i,zoom:a}=this.getCurrentView();this.lastViewStates&&this.lastViewStates.zoom===a&&this.lastViewStates.latLonBounds.toString()===i.toString()||(this.lastViewStates={zoom:a,latLonBounds:i},(n=this.tilesetManager)===null||n===void 0||n.throttleUpdate(a,i))}),L(this,"viewchange",qre(this.mapchange,24)),this.parent=t;const r=this.parent.getContainer();this.rendererService=r.rendererService,this.layerService=r.layerService,this.mapService=r.mapService,this.pickingService=r.pickingService,this.tileLayerService=new Zte({rendererService:this.rendererService,layerService:this.layerService,parent:t}),this.tilePickService=new Ore({tileLayerService:this.tileLayerService,layerService:this.layerService,parent:t}),this.parent.setLayerPickService(this.tilePickService),this.proxy(t),this.initTileSetManager()}initTileSetManager(){var t;const r=this.parent.getSource();if(this.tilesetManager=r.tileset,this.initedTileset||(this.bindTilesetEvent(),this.initedTileset=!0),this.parent.isVisible()===!1)return;const{latLonBounds:n,zoom:i}=this.getCurrentView();(t=this.tilesetManager)===null||t===void 0||t.update(i,n)}getCurrentView(){const t=this.mapService.getBounds(),r=[t[0][0],t[0][1],t[1][0],t[1][1]],n=this.mapService.getZoom();return{latLonBounds:r,zoom:n}}bindTilesetEvent(){this.tilesetManager.on("tile-loaded",t=>{}),this.tilesetManager.on("tile-unload",t=>{this.tileUnLoad(t)}),this.tilesetManager.on("tile-error",(t,r)=>{this.tileError(t)}),this.tilesetManager.on("tile-update",()=>{this.tileUpdate()}),this.mapService.on("zoomend",this.mapchange),this.mapService.on("moveend",this.viewchange)}render(){this.tileLayerService.render()}getLayers(){return this.tileLayerService.getLayers()}getTiles(){return this.tileLayerService.getTiles()}getTile(t){return this.tileLayerService.getTile(t)}tileLoaded(t){}tileError(t){console.warn("error:",t)}destroy(){var t;this.mapService.off("zoomend",this.mapchange),this.mapService.off("moveend",this.viewchange),(t=this.tilesetManager)===null||t===void 0||t.destroy(),this.tileLayerService.destroy()}reload(){var t;this.tilesetManager.clear();const{latLonBounds:r,zoom:n}=this.getCurrentView();(t=this.tilesetManager)===null||t===void 0||t.update(n,r)}tileUnLoad(t){this.tileLayerService.removeTile(t.key)}tileUpdate(){var t=this;return Ze(function*(){if(!t.tilesetManager)return;const r=t.parent.getMinZoom(),n=t.parent.getMaxZoom(),i=t.tilesetManager.tiles.filter(a=>a.isLoaded).filter(a=>a.isVisibleChange).filter(a=>a.data).filter(a=>a.z>=r&&a.z<n);yield Promise.all(i.map((function(){var a=Ze(function*(s){if(t.tileLayerService.hasTile(s.key))t.tileLayerService.updateTileVisible(s),t.tilePickService.setPickState(),t.layerService.reRender();else{const l=Xre(t.parent),c=new l(s,t.parent);yield c.initTileLayer(),t.tilePickService.setPickState(),c.getLayers().length!==0&&(t.tileLayerService.addTile(c),t.tileLayerService.updateTileVisible(s),t.layerService.reRender())}});return function(s){return a.apply(this,arguments)}})())),t.tilesetManager.isLoaded&&t.parent.emit("tiles-loaded",t.tilesetManager.currentTiles)})()}setPickState(t){}pickRender(t){this.tilePickService.pickRender(t)}selectFeature(t){this.tilePickService.selectFeature(t)}highlightPickedFeature(t){this.tilePickService.highlightPickedFeature(t)}proxy(t){Gre.forEach(r=>{const n=t[r].bind(t);t[r]=(...i)=>(n(...i),this.getLayers().map(a=>{a[r](...i)}),r==="style"&&this.getTiles().forEach(a=>a.styleUpdate(...i)),t)})}}const{get:Ede}=yn;function Yre(e,t){var r=typeof my<"u"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,n=typeof wx<"u"&&wx!==null&&(typeof wx.request<"u"||typeof wx.miniProgram<"u");if(!(r||n)&&(t||(t=document),!!t)){var i=t.head||t.getElementsByTagName("head")[0];if(!i){i=t.createElement("head");var a=t.body||t.getElementsByTagName("body")[0];a?a.parentNode.insertBefore(i,a):t.documentElement.appendChild(i)}var s=t.createElement("style");return s.type="text/css",s.styleSheet?s.styleSheet.cssText=e:s.appendChild(t.createTextNode(e)),i.appendChild(s),s}}Yre(`.l7-marker-container {
  position: absolute;
  width: 100%;
  height: 100%;
  overflow: hidden;
}
.l7-marker {
  position: absolute !important;
  top: 0;
  left: 0;
  z-index: 5;
  cursor: pointer;
}
.l7-marker-cluster {
  width: 40px;
  height: 40px;
  background-color: rgba(181, 226, 140, 0.6);
  background-clip: padding-box;
  border-radius: 20px;
}
.l7-marker-cluster div {
  width: 30px;
  height: 30px;
  margin-top: 5px;
  margin-left: 5px;
  font:
    12px 'Helvetica Neue',
    Arial,
    Helvetica,
    sans-serif;
  text-align: center;
  background-color: rgba(110, 204, 57, 0.6);
  border-radius: 15px;
}
.l7-marker-cluster span {
  line-height: 30px;
}
.l7-touch .l7-control-attribution,
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
  box-shadow: none;
}
.l7-touch .l7-control-layers,
.l7-touch .l7-bar {
  background-clip: padding-box;
  border: 2px solid rgba(0, 0, 0, 0.2);
}
.mapboxgl-ctrl-logo,
.amap-logo {
  display: none !important;
}
.l7-select-box {
  border: 3px dashed gray;
  border-radius: 2px;
  position: absolute;
  z-index: 999;
  box-sizing: border-box;
}
.l7-control-container {
  font:
    12px/1.5 'Helvetica Neue',
    Arial,
    Helvetica,
    sans-serif;
}
.l7-control-container .l7-control {
  position: relative;
  z-index: 999;
  float: left;
  clear: both;
  color: #595959;
  font-size: 12px;
  pointer-events: visiblePainted;
  /* IE 9-10 doesn't have auto */
  pointer-events: auto;
}
.l7-control-container .l7-control.l7-control--hide {
  display: none;
}
.l7-control-container .l7-top {
  top: 0;
  display: flex;
  position: absolute;
  z-index: 999;
  pointer-events: none;
}
.l7-control-container .l7-top .l7-control:not(.l7-control--hide) {
  margin-top: 8px;
}
.l7-control-container .l7-right {
  right: 0;
  display: flex;
  position: absolute;
  z-index: 999;
  pointer-events: none;
}
.l7-control-container .l7-right .l7-control:not(.l7-control--hide) {
  margin-right: 8px;
}
.l7-control-container .l7-bottom {
  bottom: 0;
  display: flex;
  position: absolute;
  z-index: 999;
  pointer-events: none;
}
.l7-control-container .l7-bottom .l7-control:not(.l7-control--hide) {
  margin-bottom: 8px;
}
.l7-control-container .l7-left {
  left: 0;
  display: flex;
  position: absolute;
  z-index: 999;
  pointer-events: none;
}
.l7-control-container .l7-left .l7-control:not(.l7-control--hide) {
  margin-left: 8px;
}
.l7-control-container .l7-center {
  position: absolute;
  display: flex;
  justify-content: center;
}
.l7-control-container .l7-center.l7-top,
.l7-control-container .l7-center.l7-bottom {
  width: 100%;
}
.l7-control-container .l7-center.l7-left,
.l7-control-container .l7-center.l7-right {
  height: 100%;
}
.l7-control-container .l7-center .l7-control {
  margin-right: 8px;
  margin-bottom: 8px;
}
.l7-control-container .l7-row {
  flex-direction: row;
}
.l7-control-container .l7-row.l7-top {
  align-items: flex-start;
}
.l7-control-container .l7-row.l7-bottom {
  align-items: flex-end;
}
.l7-control-container .l7-column {
  flex-direction: column;
}
.l7-control-container .l7-column.l7-left {
  align-items: flex-start;
}
.l7-control-container .l7-column.l7-right {
  align-items: flex-end;
}
.l7-button-control {
  min-width: 28px;
  height: 28px;
  background-color: #fff;
  border-width: 0;
  border-radius: 2px;
  outline: 0;
  cursor: pointer;
  transition: all 0.2s;
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 0 6px;
  box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
  line-height: 16px;
}
.l7-button-control .l7-iconfont {
  fill: #595959;
  color: #595959;
  width: 16px;
  height: 16px;
}
.l7-button-control.l7-button-control--row {
  padding: 0 16px 0 13px;
}
.l7-button-control.l7-button-control--row * + .l7-button-control__text {
  margin-left: 8px;
}
.l7-button-control.l7-button-control--column {
  height: 44px;
  flex-direction: column;
}
.l7-button-control.l7-button-control--column .l7-iconfont {
  margin-top: 3px;
}
.l7-button-control.l7-button-control--column .l7-button-control__text {
  margin-top: 3px;
  font-size: 10px;
  -webkit-transform: scale(0.83333);
          transform: scale(0.83333);
}
.l7-button-control:not(:disabled):hover {
  background-color: #f3f3f3;
}
.l7-button-control:not(:disabled):active {
  background-color: #f3f3f3;
}
.l7-button-control:disabled {
  background-color: #fafafa;
  color: #bdbdbd;
  cursor: not-allowed;
}
.l7-button-control:disabled .l7-iconfont {
  fill: #bdbdbd;
  color: #bdbdbd;
}
.l7-button-control:disabled:hover {
  background-color: #fafafa;
}
.l7-button-control:disabled:active {
  background-color: #fafafa;
}
.l7-popper {
  position: absolute;
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 5;
  color: #595959;
}
.l7-popper.l7-popper-hide {
  display: none;
}
.l7-popper .l7-popper-content {
  min-height: 28px;
  background: #fff;
  border-radius: 2px;
  box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
}
.l7-popper .l7-popper-arrow {
  width: 0;
  height: 0;
  border-width: 4px;
  border-style: solid;
  border-top-color: transparent;
  border-bottom-color: transparent;
  border-left-color: transparent;
  border-right-color: transparent;
  box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
}
.l7-popper.l7-popper-left {
  flex-direction: row;
}
.l7-popper.l7-popper-left .l7-popper-arrow {
  border-left-color: #fff;
  margin: 10px 0;
}
.l7-popper.l7-popper-right {
  flex-direction: row-reverse;
}
.l7-popper.l7-popper-right .l7-popper-arrow {
  border-right-color: #fff;
  margin: 10px 0;
}
.l7-popper.l7-popper-top {
  flex-direction: column;
}
.l7-popper.l7-popper-top .l7-popper-arrow {
  border-top-color: #fff;
  margin: 0 10px;
}
.l7-popper.l7-popper-bottom {
  flex-direction: column-reverse;
}
.l7-popper.l7-popper-bottom .l7-popper-arrow {
  border-bottom-color: #fff;
  margin: 0 10px;
}
.l7-popper.l7-popper-start {
  align-items: flex-start;
}
.l7-popper.l7-popper-end {
  align-items: flex-end;
}
.l7-select-control--normal {
  padding: 4px 0;
}
.l7-select-control--normal .l7-select-control-item {
  display: flex;
  align-items: center;
  height: 24px;
  padding: 0 16px;
  font-size: 12px;
  line-height: 24px;
}
.l7-select-control--normal .l7-select-control-item > * + * {
  margin-left: 6px;
}
.l7-select-control--normal .l7-select-control-item input[type='checkbox'] {
  width: 14px;
  height: 14px;
}
.l7-select-control--normal .l7-select-control-item:hover {
  background-color: #f3f3f3;
}
.l7-select-control--image {
  display: flex;
  flex-wrap: wrap;
  align-items: flex-start;
  box-sizing: content-box;
  max-width: 460px;
  max-height: 400px;
  margin: 12px 0 0 12px;
  overflow-x: hidden;
  overflow-y: auto;
}
.l7-select-control--image .l7-select-control-item {
  position: relative;
  display: flex;
  flex: 0 0 calc((100% - (12px + 9px) * 2) / 3);
  flex-direction: column;
  justify-content: center;
  box-sizing: content-box;
  margin-right: 12px;
  margin-bottom: 12px;
  overflow: hidden;
  font-size: 12px;
  border: 1px solid #fff;
  border-radius: 2px;
}
.l7-select-control--image .l7-select-control-item img {
  width: 100%;
  height: 80px;
}
.l7-select-control--image .l7-select-control-item input[type='checkbox'] {
  position: absolute;
  top: 0;
  right: 0;
}
.l7-select-control--image .l7-select-control-item .l7-select-control-item-row {
  display: flex;
  align-items: center;
  justify-content: center;
  line-height: 26px;
}
.l7-select-control--image .l7-select-control-item .l7-select-control-item-row > * + * {
  margin-left: 8px;
}
.l7-select-control--image .l7-select-control-item.l7-select-control-item-active {
  border-color: #0370fe;
}
.l7-select-control-item {
  cursor: pointer;
}
.l7-select-control-item input[type='checkbox'] {
  margin: 0;
  cursor: pointer;
}
.l7-select-control--multiple .l7-select-control-item:hover {
  background-color: transparent;
}
.l7-control-logo {
  width: 89px;
  height: 16px;
  -webkit-user-select: none;
     -moz-user-select: none;
      -ms-user-select: none;
          user-select: none;
}
.l7-control-logo img {
  height: 100%;
  width: 100%;
}
.l7-control-logo .l7-control-logo-link {
  display: block;
  cursor: pointer;
}
.l7-control-logo .l7-control-logo-link img {
  cursor: pointer;
}
.l7-control-mouse-location {
  background-color: #fff;
  border-radius: 2px;
  box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
  padding: 2px 4px;
  min-width: 130px;
}
.l7-control-zoom {
  overflow: hidden;
  border-radius: 2px;
  box-shadow: 0 0 20px 0 rgba(0, 0, 0, 0.15);
}
.l7-control-zoom .l7-button-control {
  font-size: 16px;
  border-bottom: 1px solid #f0f0f0;
  border-radius: 0;
  box-shadow: 0 0 0;
}
.l7-control-zoom .l7-button-control .l7-iconfont {
  width: 14px;
  height: 14px;
}
.l7-control-zoom .l7-button-control:last-child {
  border-bottom: 0;
}
.l7-control-zoom .l7-control-zoom__number {
  color: #595959;
  padding: 0;
}
.l7-control-zoom .l7-control-zoom__number:hover {
  background-color: #fff;
}
.l7-control-scale {
  display: flex;
  flex-direction: column;
}
.l7-control-scale .l7-control-scale-line {
  box-sizing: border-box;
  padding: 2px 5px 1px;
  overflow: hidden;
  color: #595959;
  font-size: 10px;
  line-height: 1.1;
  white-space: nowrap;
  background: #fff;
  border: 2px solid #000;
  border-top: 0;
  transition: width 0.1s;
}
.l7-control-scale .l7-control-scale-line + .l7-control-scale .l7-control-scale-line {
  margin-top: -2px;
  border-top: 2px solid #777;
  border-bottom: none;
}
.l7-right .l7-control-scale {
  display: flex;
  align-items: flex-end;
}
.l7-right .l7-control-scale .l7-control-scale-line {
  text-align: right;
}
.l7-popup {
  position: absolute;
  top: 0;
  left: 0;
  z-index: 5;
  display: flex;
  will-change: transform;
  pointer-events: none;
}
.l7-popup.l7-popup-hide {
  display: none;
}
.l7-popup .l7-popup-content {
  position: relative;
  padding: 16px;
  font-size: 14px;
  background: #fff;
  border-radius: 3px;
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.1);
}
.l7-popup .l7-popup-content .l7-popup-content__title {
  margin-bottom: 8px;
  font-weight: bold;
}
.l7-popup .l7-popup-content .l7-popup-close-button,
.l7-popup .l7-popup-content .l7-popup-content__title,
.l7-popup .l7-popup-content .l7-popup-content__panel {
  white-space: normal;
  -webkit-user-select: text;
     -moz-user-select: text;
      -ms-user-select: text;
          user-select: text;
  pointer-events: initial;
}
.l7-popup .l7-popup-content .l7-popup-close-button {
  position: absolute;
  top: 0;
  right: 0;
  width: 18px;
  height: 18px;
  padding: 0;
  font-size: 14px;
  line-height: 18px;
  text-align: center;
  background-color: transparent;
  border: 0;
  border-radius: 0 3px 0 0;
  cursor: pointer;
}
.l7-popup .l7-popup-tip {
  position: relative;
  z-index: 1;
  width: 0;
  height: 0;
  border: 10px solid transparent;
}
.l7-popup.l7-popup-anchor-bottom,
.l7-popup.l7-popup-anchor-bottom-left,
.l7-popup.l7-popup-anchor-bottom-right {
  flex-direction: column-reverse;
}
.l7-popup.l7-popup-anchor-bottom .l7-popup-tip,
.l7-popup.l7-popup-anchor-bottom-left .l7-popup-tip,
.l7-popup.l7-popup-anchor-bottom-right .l7-popup-tip {
  bottom: 1px;
}
.l7-popup.l7-popup-anchor-top,
.l7-popup.l7-popup-anchor-top-left,
.l7-popup.l7-popup-anchor-top-right {
  flex-direction: column;
}
.l7-popup.l7-popup-anchor-top .l7-popup-tip,
.l7-popup.l7-popup-anchor-top-left .l7-popup-tip,
.l7-popup.l7-popup-anchor-top-right .l7-popup-tip {
  top: 1px;
}
.l7-popup.l7-popup-anchor-left {
  flex-direction: row;
}
.l7-popup.l7-popup-anchor-right {
  flex-direction: row-reverse;
}
.l7-popup-anchor-top .l7-popup-tip {
  position: relative;
  align-self: center;
  border-top: none;
  border-bottom-color: #fff;
}
.l7-popup-anchor-top-left .l7-popup-tip {
  align-self: flex-start;
  border-top: none;
  border-bottom-color: #fff;
  border-left: none;
}
.l7-popup-anchor-top-right .l7-popup-tip {
  align-self: flex-end;
  border-top: none;
  border-right: none;
  border-bottom-color: #fff;
}
.l7-popup-anchor-bottom .l7-popup-tip {
  align-self: center;
  border-top-color: #fff;
  border-bottom: none;
}
.l7-popup-anchor-bottom-left .l7-popup-tip {
  align-self: flex-start;
  border-top-color: #fff;
  border-bottom: none;
  border-left: none;
}
.l7-popup-anchor-bottom-right .l7-popup-tip {
  align-self: flex-end;
  border-top-color: #fff;
  border-right: none;
  border-bottom: none;
}
.l7-popup-anchor-left .l7-popup-tip {
  align-self: center;
  border-right-color: #fff;
  border-left: none;
}
.l7-popup-anchor-right .l7-popup-tip {
  right: 1px;
  align-self: center;
  border-right: none;
  border-left-color: #fff;
}
.l7-popup-anchor-top-left .l7-popup-content {
  border-top-left-radius: 0;
}
.l7-popup-anchor-top-right .l7-popup-content {
  border-top-right-radius: 0;
}
.l7-popup-anchor-bottom-left .l7-popup-content {
  border-bottom-left-radius: 0;
}
.l7-popup-anchor-bottom-right .l7-popup-content {
  border-bottom-right-radius: 0;
}
.l7-popup-track-pointer {
  display: none;
}
.l7-popup-track-pointer * {
  -webkit-user-select: none;
     -moz-user-select: none;
      -ms-user-select: none;
          user-select: none;
  pointer-events: none;
}
.l7-map:hover .l7-popup-track-pointer {
  display: flex;
}
.l7-map:active .l7-popup-track-pointer {
  display: none;
}
.l7-layer-popup__row {
  font-size: 12px;
}
.l7-layer-popup__row + .l7-layer-popup__row {
  margin-top: 4px;
}
.l7-control-swipe {
  position: absolute;
  top: 50%;
  left: 50%;
  z-index: 6;
  -webkit-transform: translate(-50%, -50%);
          transform: translate(-50%, -50%);
  touch-action: none;
}
.l7-control-swipe_hide {
  display: none;
}
.l7-control-swipe:before {
  position: absolute;
  top: -5000px;
  bottom: -5000px;
  left: 50%;
  z-index: -1;
  width: 4px;
  background: #fff;
  -webkit-transform: translate(-2px, 0);
          transform: translate(-2px, 0);
  content: '';
}
.l7-control-swipe.horizontal:before {
  top: 50%;
  right: -5000px;
  bottom: auto;
  left: -5000px;
  width: auto;
  height: 4px;
}
.l7-control-swipe__button {
  display: block;
  width: 28px;
  height: 28px;
  margin: 0;
  padding: 0;
  color: #595959;
  font-weight: bold;
  font-size: inherit;
  text-align: center;
  text-decoration: none;
  background-color: #fff;
  border: none;
  border-radius: 2px;
  outline: none;
}
.l7-control-swipe,
.l7-control-swipe__button {
  cursor: ew-resize;
}
.l7-control-swipe.horizontal,
.l7-control-swipe.horizontal button {
  cursor: ns-resize;
}
.l7-control-swipe:after,
.l7-control-swipe__button:before,
.l7-control-swipe__button:after {
  position: absolute;
  top: 25%;
  bottom: 25%;
  left: 50%;
  width: 2px;
  background: currentColor;
  -webkit-transform: translate(-1px, 0);
          transform: translate(-1px, 0);
  content: '';
}
.l7-control-swipe__button:after {
  -webkit-transform: translateX(4px);
          transform: translateX(4px);
}
.l7-control-swipe__button:before {
  -webkit-transform: translateX(-6px);
          transform: translateX(-6px);
}
`);class $re{constructor(t){L(this,"configService",void 0),L(this,"config",void 0),this.config=t}setContainer(t,r){this.configService=t.globalConfigService,t.mapConfig=Ge(Ge({},this.config),{},{id:r}),t.mapService=new(this.getServiceConstructor())(t)}getServiceConstructor(){throw new Error("Method not implemented.")}}var p0={exports:{}},Zre=p0.exports,lP;function Kre(){return lP||(lP=1,(function(e,t){(function(r,n){e.exports=n()})(Zre,function(){function r(h){var m=[];return h.AMapUI&&m.push(n(h.AMapUI)),h.Loca&&m.push(i(h.Loca)),Promise.all(m)}function n(h){return new Promise(function(m,_){var y=[];if(h.plugins)for(var E=0;E<h.plugins.length;E+=1)s.AMapUI.plugins.indexOf(h.plugins[E])==-1&&y.push(h.plugins[E]);if(l.AMapUI===a.failed)_("前次请求 AMapUI 失败");else if(l.AMapUI===a.notload){l.AMapUI=a.loading,s.AMapUI.version=h.version||s.AMapUI.version,E=s.AMapUI.version;var T=document.body||document.head,A=document.createElement("script");A.type="text/javascript",A.src="https://webapi.amap.com/ui/"+E+"/main.js",A.onerror=function(b){l.AMapUI=a.failed,_("请求 AMapUI 失败")},A.onload=function(){if(l.AMapUI=a.loaded,y.length)window.AMapUI.loadUI(y,function(){for(var b=0,R=y.length;b<R;b++){var M=y[b].split("/").slice(-1)[0];window.AMapUI[M]=arguments[b]}for(m();c.AMapUI.length;)c.AMapUI.splice(0,1)[0]()});else for(m();c.AMapUI.length;)c.AMapUI.splice(0,1)[0]()},T.appendChild(A)}else l.AMapUI===a.loaded?h.version&&h.version!==s.AMapUI.version?_("不允许多个版本 AMapUI 混用"):y.length?window.AMapUI.loadUI(y,function(){for(var b=0,R=y.length;b<R;b++){var M=y[b].split("/").slice(-1)[0];window.AMapUI[M]=arguments[b]}m()}):m():h.version&&h.version!==s.AMapUI.version?_("不允许多个版本 AMapUI 混用"):c.AMapUI.push(function(b){b?_(b):y.length?window.AMapUI.loadUI(y,function(){for(var R=0,M=y.length;R<M;R++){var B=y[R].split("/").slice(-1)[0];window.AMapUI[B]=arguments[R]}m()}):m()})})}function i(h){return new Promise(function(m,_){if(l.Loca===a.failed)_("前次请求 Loca 失败");else if(l.Loca===a.notload){l.Loca=a.loading,s.Loca.version=h.version||s.Loca.version;var y=s.Loca.version,E=s.AMap.version.startsWith("2"),T=y.startsWith("2");if(E&&!T||!E&&T)_("JSAPI 与 Loca 版本不对应！！");else{E=s.key,T=document.body||document.head;var A=document.createElement("script");A.type="text/javascript",A.src="https://webapi.amap.com/loca?v="+y+"&key="+E,A.onerror=function(b){l.Loca=a.failed,_("请求 AMapUI 失败")},A.onload=function(){for(l.Loca=a.loaded,m();c.Loca.length;)c.Loca.splice(0,1)[0]()},T.appendChild(A)}}else l.Loca===a.loaded?h.version&&h.version!==s.Loca.version?_("不允许多个版本 Loca 混用"):m():h.version&&h.version!==s.Loca.version?_("不允许多个版本 Loca 混用"):c.Loca.push(function(b){b?_(b):_()})})}if(!window)throw Error("AMap JSAPI can only be used in Browser.");var a;(function(h){h.notload="notload",h.loading="loading",h.loaded="loaded",h.failed="failed"})(a||(a={}));var s={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},l={AMap:a.notload,AMapUI:a.notload,Loca:a.notload},c={AMapUI:[],Loca:[]},d=[],p=function(h){typeof h=="function"&&(l.AMap===a.loaded?h(window.AMap):d.push(h))};return{load:function(h){return new Promise(function(m,_){if(l.AMap==a.failed)_("");else if(l.AMap==a.notload){var y=h.key,E=h.version,T=h.plugins;y?(window.AMap&&location.host!=="lbs.amap.com"&&_("禁止多种API加载方式混用"),s.key=y,s.AMap.version=E||s.AMap.version,s.AMap.plugins=T||s.AMap.plugins,l.AMap=a.loading,E=document.body||document.head,window.___onAPILoaded=function(b){if(delete window.___onAPILoaded,b)l.AMap=a.failed,_(b);else for(l.AMap=a.loaded,r(h).then(function(){m(window.AMap)}).catch(_);d.length;)d.splice(0,1)[0]()},T=document.createElement("script"),T.type="text/javascript",T.src="https://webapi.amap.com/maps?callback=___onAPILoaded&v="+s.AMap.version+"&key="+y+"&plugin="+s.AMap.plugins.join(","),T.onerror=function(b){l.AMap=a.failed,_(b)},E.appendChild(T)):_("请填写key")}else if(l.AMap==a.loaded)if(h.key&&h.key!==s.key)_("多个不一致的 key");else if(h.version&&h.version!==s.AMap.version)_("不允许多个版本 JSAPI 混用");else{if(y=[],h.plugins)for(E=0;E<h.plugins.length;E+=1)s.AMap.plugins.indexOf(h.plugins[E])==-1&&y.push(h.plugins[E]);y.length?window.AMap.plugin(y,function(){r(h).then(function(){m(window.AMap)}).catch(_)}):r(h).then(function(){m(window.AMap)}).catch(_)}else if(h.key&&h.key!==s.key)_("多个不一致的 key");else if(h.version&&h.version!==s.AMap.version)_("不允许多个版本 JSAPI 混用");else{var A=[];if(h.plugins)for(E=0;E<h.plugins.length;E+=1)s.AMap.plugins.indexOf(h.plugins[E])==-1&&A.push(h.plugins[E]);p(function(){A.length?window.AMap.plugin(A,function(){r(h).then(function(){m(window.AMap)}).catch(_)}):r(h).then(function(){m(window.AMap)}).catch(_)})}})},reset:function(){delete window.AMap,delete window.AMapUI,delete window.Loca,s={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},l={AMap:a.notload,AMapUI:a.notload,Loca:a.notload},c={AMap:[],AMapUI:[],Loca:[]}}}})})(p0)),p0.exports}var Qre=Kre();const Jre=Pr(Qre);class ene{constructor(t){L(this,"size",1e4),this.size=t||1e4}setSize(t){this.size=t}getSize(){return[this.size,this.size]}mercatorXfromLng(t){return(180+t)/360*this.size}mercatorYfromLat(t){return(1-(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+t*Math.PI/360)))/360)*this.size}lngFromMercatorX(t){return t/this.size*360-180}latFromMercatorY(t){const r=180-(1-t/this.size)*360;return 360/Math.PI*Math.atan(Math.exp(r*Math.PI/180))-90}project(t){const r=this.mercatorXfromLng(t[0]),n=this.mercatorYfromLat(t[1]);return[r,n]}unproject(t){const r=this.lngFromMercatorX(t[0]),n=this.latFromMercatorY(t[1]);return[r,n]}}const tne=12;class rne{constructor(t){L(this,"map",void 0),L(this,"simpleMapCoord",new ene),L(this,"bgColor","rgba(0.0, 0.0, 0.0, 0.0)"),L(this,"config",void 0),L(this,"configService",void 0),L(this,"coordinateSystemService",void 0),L(this,"eventEmitter",void 0),L(this,"markerContainer",void 0),L(this,"mapContainer",void 0),L(this,"cameraChangedCallback",void 0),this.config=t.mapConfig,this.configService=t.globalConfigService,this.coordinateSystemService=t.coordinateSystemService,this.eventEmitter=new Oa.EventEmitter}onCameraChanged(t){this.cameraChangedCallback=t}updateView(t){var r;this.emit("mapchange"),this.viewport.syncWithMapCamera({bearing:t.bearing,center:t.center,viewportHeight:t.viewportHeight,pitch:t.pitch,viewportWidth:t.viewportWidth,zoom:t.zoom}),this.updateCoordinateSystemService(),(r=this.cameraChangedCallback)===null||r===void 0||r.call(this,this.viewport)}updateCoordinateSystemService(){const{offsetCoordinate:t=!0}=this.config;this.viewport.getZoom()>tne&&t?this.coordinateSystemService.setCoordinateSystem(U0.LNGLAT_OFFSET):this.coordinateSystemService.setCoordinateSystem(U0.LNGLAT)}creatMapContainer(t){let r;return typeof t=="string"?r=document.getElementById(t):r=t,r}getMapStyleValue(t){var r;return(r=this.getMapStyleConfig()[t])!==null&&r!==void 0?r:t}setBgColor(t){this.bgColor=t}getMapContainer(){return this.mapContainer}getMarkerContainer(){return this.markerContainer}getOverlayContainer(){}getCanvasOverlays(){}emit(t,...r){this.eventEmitter.emit(t,...r)}once(t,r){this.eventEmitter.once(t,r)}meterToCoord(t,r){return 1}destroy(){this.eventEmitter.removeAllListeners()}}function fF(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function nne(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,IB(n.key),n)}}function dF(e,t,r){return t&&nne(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function lv(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ine(e,t){if(t&&(Vd(t)=="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return lv(e)}function cx(e){return cx=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},cx(e)}function fx(e,t){return fx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},fx(e,t)}function ane(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&fx(e,t)}function one(e){if(Array.isArray(e))return e}function sne(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,i,a,s,l=[],c=!0,d=!1;try{if(a=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=a.call(r)).done)&&(l.push(n.value),l.length!==t);c=!0);}catch(p){d=!0,i=p}finally{try{if(!c&&r.return!=null&&(s=r.return(),Object(s)!==s))return}finally{if(d)throw i}}return l}}function cP(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function une(e,t){if(e){if(typeof e=="string")return cP(e,t);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?cP(e,t):void 0}}function lne(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $a(e,t){return one(e)||sne(e,t)||une(e,t)||lne()}function Ev(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function v0(e,t){var r=mR([],t,e);return Gq(r,r,1/r[3]),r}function jc(e,t){if(!e)throw new Error(t||"viewport-mercator-project: assertion failed.")}var Mo=Math.PI,hF=Mo/4,Cl=Mo/180,fP=180/Mo,PR=512,dP=4003e4,cne=1.5;function pF(e){return Math.pow(2,e)}function KA(e,t){var r=$a(e,2),n=r[0],i=r[1];jc(Number.isFinite(n)&&Number.isFinite(t)),jc(Number.isFinite(i)&&i>=-90&&i<=90,"invalid latitude"),t*=PR;var a=n*Cl,s=i*Cl,l=t*(a+Mo)/(2*Mo),c=t*(Mo-Math.log(Math.tan(hF+s*.5)))/(2*Mo);return[l,c]}function hP(e,t){var r=$a(e,2),n=r[0],i=r[1];t*=PR;var a=n/t*(2*Mo)-Mo,s=2*(Math.atan(Math.exp(Mo-i/t*(2*Mo)))-hF);return[a*fP,s*fP]}function fne(e){var t=e.latitude,r=e.longitude,n=e.zoom,i=e.scale,a=e.highPrecision,s=a===void 0?!1:a;i=i!==void 0?i:pF(n),jc(Number.isFinite(t)&&Number.isFinite(r)&&Number.isFinite(i));var l={},c=PR*i,d=Math.cos(t*Cl),p=c/360,h=p/d,m=c/dP/d;if(l.pixelsPerMeter=[m,-m,m],l.metersPerPixel=[1/m,-1/m,1/m],l.pixelsPerDegree=[p,-h,m],l.degreesPerPixel=[1/p,-1/h,1/m],s){var _=Cl*Math.tan(t*Cl)/d,y=p*_/2,E=c/dP*_,T=E/h*m;l.pixelsPerDegree2=[0,-y,E],l.pixelsPerMeter2=[T,0,T]}return l}function dne(e){var t=e.height,r=e.pitch,n=e.bearing,i=e.altitude,a=e.center,s=a===void 0?null:a,l=Ev();return k0(l,l,[0,0,-i]),z0(l,l,[1,1,1/t]),vR(l,l,-r*Cl),FB(l,l,n*Cl),z0(l,l,[1,-1,1]),s&&k0(l,l,jq([],s)),l}function hne(e){var t=e.width,r=e.height,n=e.altitude,i=n===void 0?cne:n,a=e.pitch,s=a===void 0?0:a,l=e.nearZMultiplier,c=l===void 0?1:l,d=e.farZMultiplier,p=d===void 0?1:d,h=s*Cl,m=Math.atan(.5/i),_=Math.sin(m)*i/Math.sin(Math.PI/2-h-m),y=Math.cos(Math.PI/2-h)*_+i;return{fov:2*Math.atan(r/2/i),aspect:t/r,focalDistance:i,near:c,far:y*p}}function pne(e){var t=e.width,r=e.height,n=e.pitch,i=e.altitude,a=e.nearZMultiplier,s=e.farZMultiplier,l=hne({width:t,height:r,altitude:i,pitch:n,nearZMultiplier:a,farZMultiplier:s}),c=l.fov,d=l.aspect,p=l.near,h=l.far,m=kq([],c,d,p,h);return m}function vne(e,t){var r=$a(e,3),n=r[0],i=r[1],a=r[2],s=a===void 0?0:a;return jc(Number.isFinite(n)&&Number.isFinite(i)&&Number.isFinite(s)),v0(t,[n,i,s,1])}function vF(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=$a(e,3),i=n[0],a=n[1],s=n[2];if(jc(Number.isFinite(i)&&Number.isFinite(a),"invalid pixel coordinate"),Number.isFinite(s)){var l=v0(t,[i,a,s,1]);return l}var c=v0(t,[i,a,0,1]),d=v0(t,[i,a,1,1]),p=c[2],h=d[2],m=p===h?0:((r||0)-p)/(h-p);return Yq([],c,d,m)}var pP=Ev(),mne=(function(){function e(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=t.width,n=t.height,i=t.viewMatrix,a=i===void 0?pP:i,s=t.projectionMatrix,l=s===void 0?pP:s;fF(this,e),this.width=r||1,this.height=n||1,this.scale=1,this.pixelsPerMeter=1,this.viewMatrix=a,this.projectionMatrix=l;var c=Ev();Nd(c,c,this.projectionMatrix),Nd(c,c,this.viewMatrix),this.viewProjectionMatrix=c;var d=Ev();z0(d,d,[this.width/2,-this.height/2,1]),k0(d,d,[1,-1,0]),Nd(d,d,this.viewProjectionMatrix);var p=LB(Ev(),d);if(!p)throw new Error("Pixel project matrix not invertible");this.pixelProjectionMatrix=d,this.pixelUnprojectionMatrix=p,this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}return dF(e,[{key:"equals",value:function(r){return r instanceof e?r.width===this.width&&r.height===this.height&&HN(r.projectionMatrix,this.projectionMatrix)&&HN(r.viewMatrix,this.viewMatrix):!1}},{key:"project",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=n.topLeft,a=i===void 0?!0:i,s=this.projectPosition(r),l=vne(s,this.pixelProjectionMatrix),c=$a(l,2),d=c[0],p=c[1],h=a?p:this.height-p;return r.length===2?[d,h]:[d,h,l[2]]}},{key:"unproject",value:function(r){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=n.topLeft,a=i===void 0?!0:i,s=n.targetZ,l=$a(r,3),c=l[0],d=l[1],p=l[2],h=a?d:this.height-d,m=s&&s*this.pixelsPerMeter,_=vF([c,h,p],this.pixelUnprojectionMatrix,m),y=this.unprojectPosition(_),E=$a(y,3),T=E[0],A=E[1],b=E[2];return Number.isFinite(p)?[T,A,b]:Number.isFinite(s)?[T,A,s]:[T,A]}},{key:"projectPosition",value:function(r){var n=this.projectFlat(r),i=$a(n,2),a=i[0],s=i[1],l=(r[2]||0)*this.pixelsPerMeter;return[a,s,l]}},{key:"unprojectPosition",value:function(r){var n=this.unprojectFlat(r),i=$a(n,2),a=i[0],s=i[1],l=(r[2]||0)/this.pixelsPerMeter;return[a,s,l]}},{key:"projectFlat",value:function(r){return arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale,r}},{key:"unprojectFlat",value:function(r){return arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale,r}}]),e})();function _ne(e){var t=e.width,r=e.height,n=e.bounds,i=e.minExtent,a=i===void 0?0:i,s=e.maxZoom,l=s===void 0?24:s,c=e.padding,d=c===void 0?0:c,p=e.offset,h=p===void 0?[0,0]:p,m=$a(n,2),_=$a(m[0],2),y=_[0],E=_[1],T=$a(m[1],2),A=T[0],b=T[1];if(Number.isFinite(d)){var R=d;d={top:R,bottom:R,left:R,right:R}}else jc(Number.isFinite(d.top)&&Number.isFinite(d.bottom)&&Number.isFinite(d.left)&&Number.isFinite(d.right));var M=new dx({width:t,height:r,longitude:0,latitude:0,zoom:0}),B=M.project([y,b]),w=M.project([A,E]),D=[Math.max(Math.abs(w[0]-B[0]),a),Math.max(Math.abs(w[1]-B[1]),a)],U=[t-d.left-d.right-Math.abs(h[0])*2,r-d.top-d.bottom-Math.abs(h[1])*2];jc(U[0]>0&&U[1]>0);var ae=U[0]/D[0],Q=U[1]/D[1],X=(d.right-d.left)/2/ae,x=(d.bottom-d.top)/2/Q,P=[(w[0]+B[0])/2+X,(w[1]+B[1])/2+x],H=M.unproject(P),pe=M.zoom+Math.log2(Math.abs(Math.min(ae,Q)));return{longitude:H[0],latitude:H[1],zoom:Math.min(pe,l)}}var dx=(function(e){ane(t,e);function t(){var r,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=n.width,a=n.height,s=n.latitude,l=s===void 0?0:s,c=n.longitude,d=c===void 0?0:c,p=n.zoom,h=p===void 0?0:p,m=n.pitch,_=m===void 0?0:m,y=n.bearing,E=y===void 0?0:y,T=n.altitude,A=T===void 0?1.5:T,b=n.nearZMultiplier,R=n.farZMultiplier;fF(this,t),i=i||1,a=a||1;var M=pF(h);A=Math.max(.75,A);var B=KA([d,l],M);B[2]=0;var w=pne({width:i,height:a,pitch:_,altitude:A,nearZMultiplier:b||1/a,farZMultiplier:R||1.01}),D=dne({height:a,center:B,pitch:_,bearing:E,altitude:A});return r=ine(this,cx(t).call(this,{width:i,height:a,viewMatrix:D,projectionMatrix:w})),r.latitude=l,r.longitude=d,r.zoom=h,r.pitch=_,r.bearing=E,r.altitude=A,r.scale=M,r.center=B,r.pixelsPerMeter=fne(lv(lv(r))).pixelsPerMeter[2],Object.freeze(lv(lv(r))),r}return dF(t,[{key:"projectFlat",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return KA(n,i)}},{key:"unprojectFlat",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.scale;return hP(n,i)}},{key:"getMapCenterByLngLatPosition",value:function(n){var i=n.lngLat,a=n.pos,s=vF(a,this.pixelUnprojectionMatrix),l=KA(i,this.scale),c=_l([],l,Wq([],s)),d=_l([],this.center,c);return hP(d,this.scale)}},{key:"getLocationAtPoint",value:function(n){var i=n.lngLat,a=n.pos;return this.getMapCenterByLngLatPosition({lngLat:i,pos:a})}},{key:"fitBounds",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=this.width,s=this.height,l=_ne(Object.assign({width:a,height:s,bounds:n},i)),c=l.longitude,d=l.latitude,p=l.zoom;return new t({width:a,height:s,longitude:c,latitude:d,zoom:p})}}]),t})(mne);class gne{constructor(){L(this,"viewport",new dx)}syncWithMapCamera(t){const{center:r,zoom:n,pitch:i,bearing:a,viewportHeight:s,viewportWidth:l}=t,c={width:this.viewport.width,height:this.viewport.height,longitude:this.viewport.center[0],latitude:this.viewport.center[1],zoom:this.viewport.zoom,pitch:this.viewport.pitch,bearing:this.viewport.bearing};this.viewport=new dx(Ge(Ge({},c),{},{width:l,height:s,longitude:r&&r[0],latitude:r&&r[1],zoom:n,pitch:i,bearing:a}))}getZoom(){return this.viewport.zoom}getZoomScale(){return Math.pow(2,this.getZoom())}getCenter(){return[this.viewport.longitude,this.viewport.latitude]}getProjectionMatrix(){return this.viewport.projectionMatrix}getModelMatrix(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}getViewMatrix(){return this.viewport.viewMatrix}getViewMatrixUncentered(){return this.viewport.viewMatrixUncentered}getViewProjectionMatrix(){return this.viewport.viewProjectionMatrix}getViewProjectionMatrixUncentered(){return this.viewport.viewProjectionMatrix}getFocalDistance(){return 1}projectFlat(t,r){return this.viewport.projectFlat(t,r)}}let yne=(function(e){return e.GAODE="GAODE",e.MAPBOX="MAPBOX",e.DEFAULT="DEFAUlTMAP",e.SIMPLE="SIMPLE",e.GLOBEL="GLOBEL",e})({});function vP(e={}){const t={top:0,right:0,bottom:0,left:0};if(typeof e=="number")return{top:e,right:e,bottom:e,left:e};if(Array.isArray(e)){if(e.length===4)return{top:e[0],right:e[1],bottom:e[2],left:e[3]};if(e.length===2)return{top:e[0],right:e[1],bottom:e[0],left:e[1]}}return Ge(Ge({},t),e)}const Ene={normal:"amap://styles/normal",light:"amap://styles/c422f5c0cfced5be9fe3a83f05f28a68?isPublic=true",dark:"amap://styles/c9f1d10cae34f8ab05e425462c5a58d7?isPublic=true",blank:"amap://styles/07c17002b38775b32a7a76c66cf90e99?isPublic=true",fresh:"amap://styles/fresh",grey:"amap://styles/grey",graffiti:"amap://styles/graffiti",macaron:"amap://styles/macaron",darkblue:"amap://styles/darkblue",wine:"amap://styles/wine"},Tne=["id","style","minZoom","maxZoom","token","mapInstance","plugin"];function Sne(e,t){var r=typeof my<"u"&&!!my&&typeof my.showToast=="function"&&my.isFRM!==!0,n=typeof wx<"u"&&wx!==null&&(typeof wx.request<"u"||typeof wx.miniProgram<"u");if(!(r||n)&&(t||(t=document),!!t)){var i=t.head||t.getElementsByTagName("head")[0];if(!i){i=t.createElement("head");var a=t.body||t.getElementsByTagName("body")[0];a?a.parentNode.insertBefore(i,a):t.documentElement.appendChild(i)}var s=t.createElement("style");return s.type="text/css",s.styleSheet?s.styleSheet.cssText=e:s.appendChild(t.createTextNode(e)),i.appendChild(s),s}}Sne(`.amap-logo {
  display: none !important;
}

.amap-copyright {
  display: none !important;
}

.amap-overlays {
  z-index: 3 !important;
}
`);const Ane="2.0",mP="f59bcf249433f8b05caaee19f349b3d7",Cc=1;window.forceWebGL=!0;const _P={contextmenu:"rightclick",camerachange:"viewchange"};class bne extends rne{constructor(...t){super(...t),L(this,"viewport",new gne),L(this,"version",yne.GAODE),L(this,"handleCameraChanged",()=>{const r=this.getViewState();this.updateView(r)})}getType(){return"amap"}init(){var t=this;return Ze(function*(){const r=t.config,{id:n,style:i="light",minZoom:a=0,maxZoom:s=24,token:l=mP,mapInstance:c,plugin:d=[]}=r,p=ms(r,Tne);if(window.AMap||c||(d.push("Map3D"),yield Jre.load({key:l,version:Ane,plugins:d})),c)t.map=c,t.mapContainer=t.map.getContainer(),t.map.on("viewchange",t.handleCameraChanged);else{const h=Ge({mapStyle:t.getMapStyleValue(i),zooms:[a,s],viewMode:"3D"},p);if(h.zoom&&(h.zoom+=Cc),l===mP&&(window._AMapSecurityConfig={securityJsCode:"2653011adeb04230b3a26cc9a780a800"},console.warn(`%c${t.configService.getSceneWarninfo("MapToken")}!`,"color: #873bf4;font-weigh:900;font-size: 16px;")),!n)throw Error("No container id specified");window.forceWebGL=!0,t.mapContainer=t.creatMapContainer(n);const m=new AMap.Map(t.mapContainer,h);t.map=m,m.on("viewchange",t.handleCameraChanged)}t.syncInitViewPort()})()}syncInitViewPort(){const t=this.getViewState();this.updateView(t)}getViewState(){const{center:t,zoom:r}=xne(this.map);return{center:t,viewportWidth:this.map.getContainer().clientWidth,viewportHeight:this.map.getContainer().clientHeight,bearing:-this.map.getRotation(),pitch:this.map.getPitch(),zoom:r-Cc}}creatMapContainer(t){const r=super.creatMapContainer(t),n=document.createElement("div");return n.style.cssText+=`
       position: absolute;
       top: 0;
       height: 100%;
       width: 100%;
     `,n.id=yn.uniqueId("l7_amap_div"),r.appendChild(n),n}getContainer(){return this.map.getContainer()}addMarkerContainer(){if(!this.map)return;const t=this.map.getContainer();if(t!==null){const r=t.getElementsByClassName("amap-maps")[0];r.style.zIndex="auto",this.markerContainer=ba("div","l7-marker-container2",r)}}getMarkerContainer(){return this.markerContainer}getCanvasOverlays(){var t;return(t=this.mapContainer)===null||t===void 0?void 0:t.querySelector(".amap-overlays")}on(t,r){PN.indexOf(t)!==-1?this.eventEmitter.on(t,r):this.map.on(_P[t]||t,r)}off(t,r){PN.indexOf(t)!==-1?this.eventEmitter.off(t,r):this.map.off(_P[t]||t,r)}getSize(){const t=this.map.getSize();return[t.getWidth(),t.getHeight()]}getMinZoom(){return this.map.getZooms()[0]-Cc}getMaxZoom(){return this.map.getZooms()[1]-Cc}getZoom(){return this.map.getZoom()-Cc}getCenter(t){if(t!=null&&t.padding){const n=this.getCenter(),i=vP(t.padding),a=this.lngLatToPixel([n.lng,n.lat]),s=[(i.right-i.left)/2,(i.bottom-i.top)/2];return this.pixelToLngLat([a.x-s[0],a.y-s[1]])}const r=this.map.getCenter();return{lng:r.getLng(),lat:r.getLat()}}getPitch(){return this.map.getPitch()}getRotation(){return 360-this.map.getRotation()}getBounds(){const t=this.map.getBounds(),r=t.getNorthEast(),n=t.getSouthWest(),i=this.getCenter(),a=i.lng>r.getLng()||i.lng<n.getLng()?180-r.getLng():r.getLng();return[[i.lng<n.getLng()?n.getLng()-180:n.getLng(),n.getLat()],[a,r.getLat()]]}getMapContainer(){return this.mapContainer}getMapCanvasContainer(){var t;return(t=this.map.getContainer())===null||t===void 0?void 0:t.getElementsByClassName("amap-maps")[0]}getMapStyleConfig(){return Ene}getMapStyleValue(t){return this.getMapStyleConfig()[t]||t}getMapStyle(){return this.map.getMapStyle()}setMapStyle(t){this.map.setMapStyle(this.getMapStyleValue(t))}setRotation(t){return this.map.setRotation(t)}zoomIn(){this.map.zoomIn()}zoomOut(){this.map.zoomOut()}panTo(t){this.map.panTo(t)}panBy(t=0,r=0){this.map.panBy(t,r)}fitBounds(t){this.map.setBounds(new AMap.Bounds([t[0][0],t[0][1],t[1][0],t[1][1]]),!0)}setZoomAndCenter(t,r){this.map.setZoomAndCenter(t+Cc,r)}setCenter(t,r){if(r!=null&&r.padding){const n=vP(r.padding),i=this.lngLatToPixel(t),a=[(n.right-n.left)/2,(n.bottom-n.top)/2],s=this.pixelToLngLat([i.x+a[0],i.y+a[1]]);this.map.setCenter([s.lng,s.lat])}else this.map.setCenter(t)}setPitch(t){return this.map.setPitch(t)}setZoom(t){return this.map.setZoom(t+Cc)}setMaxZoom(t){throw new Error("Method not implemented.")}setMinZoom(t){throw new Error("Method not implemented.")}setMapStatus(t){this.map.setStatus(t)}meterToCoord(t,r){const n=AMap.GeometryUtil.distance(new AMap.LngLat(...t),new AMap.LngLat(...r)),[i,a]=sA(...t),[s,l]=sA(...r);return Math.sqrt(Math.pow(i-s,2)+Math.pow(a-l,2))/n}pixelToLngLat(t){const r=this.map.pixelToLngLat(new AMap.Pixel(t[0],t[1]));return{lng:r.getLng(),lat:r.getLat()}}lngLatToPixel(t){const r=this.map.lnglatToPixel(t);return{x:r.getX(),y:r.getY()}}containerToLngLat(t){const r=new AMap.Pixel(t[0],t[1]),n=this.map.containerToLngLat(r);return{lng:n?.getLng(),lat:n?.getLat()}}lngLatToContainer(t){const r=this.map.lngLatToContainer(t);return{x:r.getX(),y:r.getY()}}lngLatToMercator([t,r],n){const[i,a]=sA(t,r);return{x:i,y:a,z:n}}getModelMatrix(t,r,n,i=[1,1,1]){const a=this.viewport.projectFlat(t),s=pR();return k0(s,s,Co(a[0],a[1],r)),z0(s,s,Co(i[0],i[1],i[2])),vR(s,s,n[0]),BB(s,s,n[1]),FB(s,s,n[2]),s}exportMap(t){var r;const n=(r=this.getContainer())===null||r===void 0?void 0:r.getElementsByClassName("amap-layer")[0];return t==="jpg"?n?.toDataURL("image/jpeg"):n?.toDataURL("image/png")}destroy(){var t;super.destroy(),(t=this.mapContainer)===null||t===void 0||(t=t.parentNode)===null||t===void 0||t.removeChild(this.mapContainer),delete window.initAMap;const r=document.getElementById("amap-script");r&&document.head.removeChild(r),this.map.destroy()}}function xne(e){const t=e._view.getOptions(),r=t.center,n=t.zoom;return{center:r,zoom:n}}class Rne extends $re{getServiceConstructor(){return bne}}const Cne=Rne;function Za(e){return e==null}var One=function(e,t,r){return e<t?t:e>r?r:e};function Ad(e){return typeof e=="number"}var hx=function(e,t){return hx=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])},hx(e,t)};function En(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");hx(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var pn=function(){return pn=Object.assign||function(t){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a])}return t},pn.apply(this,arguments)};function Mne(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function Id(e,t,r,n){function i(a){return a instanceof r?a:new r(function(s){s(a)})}return new(r||(r=Promise))(function(a,s){function l(p){try{d(n.next(p))}catch(h){s(h)}}function c(p){try{d(n.throw(p))}catch(h){s(h)}}function d(p){p.done?a(p.value):i(p.value).then(l,c)}d((n=n.apply(e,t||[])).next())})}function Pd(e,t){var r={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},n,i,a,s=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return s.next=l(0),s.throw=l(1),s.return=l(2),typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function l(d){return function(p){return c([d,p])}}function c(d){if(n)throw new TypeError("Generator is already executing.");for(;s&&(s=0,d[0]&&(r=0)),r;)try{if(n=1,i&&(a=d[0]&2?i.return:d[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,d[1])).done)return a;switch(i=0,a&&(d=[d[0]&2,a.value]),d[0]){case 0:case 1:a=d;break;case 4:return r.label++,{value:d[1],done:!1};case 5:r.label++,i=d[1],d=[0];continue;case 7:d=r.ops.pop(),r.trys.pop();continue;default:if(a=r.trys,!(a=a.length>0&&a[a.length-1])&&(d[0]===6||d[0]===2)){r=0;continue}if(d[0]===3&&(!a||d[1]>a[0]&&d[1]<a[3])){r.label=d[1];break}if(d[0]===6&&r.label<a[1]){r.label=a[1],a=d;break}if(a&&r.label<a[2]){r.label=a[2],r.ops.push(d);break}a[2]&&r.ops.pop(),r.trys.pop();continue}d=t.call(e,r)}catch(p){d=[6,p],i=0}finally{n=a=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}function Hc(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ro(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),i,a=[],s;try{for(;(t===void 0||t-- >0)&&!(i=n.next()).done;)a.push(i.value)}catch(l){s={error:l}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(s)throw s.error}}return a}function Hp(e,t,r){if(r||arguments.length===2)for(var n=0,i=t.length,a;n<i;n++)(a||!(n in t))&&(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))}var QA={exports:{}},gP;function wne(){return gP||(gP=1,(function(e){var t=Object.prototype.hasOwnProperty,r="~";function n(){}Object.create&&(n.prototype=Object.create(null),new n().__proto__||(r=!1));function i(c,d,p){this.fn=c,this.context=d,this.once=p||!1}function a(c,d,p,h,m){if(typeof p!="function")throw new TypeError("The listener must be a function");var _=new i(p,h||c,m),y=r?r+d:d;return c._events[y]?c._events[y].fn?c._events[y]=[c._events[y],_]:c._events[y].push(_):(c._events[y]=_,c._eventsCount++),c}function s(c,d){--c._eventsCount===0?c._events=new n:delete c._events[d]}function l(){this._events=new n,this._eventsCount=0}l.prototype.eventNames=function(){var d=[],p,h;if(this._eventsCount===0)return d;for(h in p=this._events)t.call(p,h)&&d.push(r?h.slice(1):h);return Object.getOwnPropertySymbols?d.concat(Object.getOwnPropertySymbols(p)):d},l.prototype.listeners=function(d){var p=r?r+d:d,h=this._events[p];if(!h)return[];if(h.fn)return[h.fn];for(var m=0,_=h.length,y=new Array(_);m<_;m++)y[m]=h[m].fn;return y},l.prototype.listenerCount=function(d){var p=r?r+d:d,h=this._events[p];return h?h.fn?1:h.length:0},l.prototype.emit=function(d,p,h,m,_,y){var E=r?r+d:d;if(!this._events[E])return!1;var T=this._events[E],A=arguments.length,b,R;if(T.fn){switch(T.once&&this.removeListener(d,T.fn,void 0,!0),A){case 1:return T.fn.call(T.context),!0;case 2:return T.fn.call(T.context,p),!0;case 3:return T.fn.call(T.context,p,h),!0;case 4:return T.fn.call(T.context,p,h,m),!0;case 5:return T.fn.call(T.context,p,h,m,_),!0;case 6:return T.fn.call(T.context,p,h,m,_,y),!0}for(R=1,b=new Array(A-1);R<A;R++)b[R-1]=arguments[R];T.fn.apply(T.context,b)}else{var M=T.length,B;for(R=0;R<M;R++)switch(T[R].once&&this.removeListener(d,T[R].fn,void 0,!0),A){case 1:T[R].fn.call(T[R].context);break;case 2:T[R].fn.call(T[R].context,p);break;case 3:T[R].fn.call(T[R].context,p,h);break;case 4:T[R].fn.call(T[R].context,p,h,m);break;default:if(!b)for(B=1,b=new Array(A-1);B<A;B++)b[B-1]=arguments[B];T[R].fn.apply(T[R].context,b)}}return!0},l.prototype.on=function(d,p,h){return a(this,d,p,h,!1)},l.prototype.once=function(d,p,h){return a(this,d,p,h,!0)},l.prototype.removeListener=function(d,p,h,m){var _=r?r+d:d;if(!this._events[_])return this;if(!p)return s(this,_),this;var y=this._events[_];if(y.fn)y.fn===p&&(!m||y.once)&&(!h||y.context===h)&&s(this,_);else{for(var E=0,T=[],A=y.length;E<A;E++)(y[E].fn!==p||m&&!y[E].once||h&&y[E].context!==h)&&T.push(y[E]);T.length?this._events[_]=T.length===1?T[0]:T:s(this,_)}return this},l.prototype.removeAllListeners=function(d){var p;return d?(p=r?r+d:d,this._events[p]&&s(this,p)):(this._events=new n,this._eventsCount=0),this},l.prototype.off=l.prototype.removeListener,l.prototype.addListener=l.prototype.on,l.prefixed=r,l.EventEmitter=l,e.exports=l})(QA)),QA.exports}var Nne=wne();const mF=Pr(Nne);var ee;(function(e){e[e.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",e[e.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",e[e.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",e[e.POINTS=0]="POINTS",e[e.LINES=1]="LINES",e[e.LINE_LOOP=2]="LINE_LOOP",e[e.LINE_STRIP=3]="LINE_STRIP",e[e.TRIANGLES=4]="TRIANGLES",e[e.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",e[e.TRIANGLE_FAN=6]="TRIANGLE_FAN",e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.SRC_COLOR=768]="SRC_COLOR",e[e.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",e[e.SRC_ALPHA=770]="SRC_ALPHA",e[e.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",e[e.DST_ALPHA=772]="DST_ALPHA",e[e.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",e[e.DST_COLOR=774]="DST_COLOR",e[e.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",e[e.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",e[e.CONSTANT_COLOR=32769]="CONSTANT_COLOR",e[e.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",e[e.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",e[e.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",e[e.FUNC_ADD=32774]="FUNC_ADD",e[e.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",e[e.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",e[e.BLEND_EQUATION=32777]="BLEND_EQUATION",e[e.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",e[e.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",e[e.BLEND_DST_RGB=32968]="BLEND_DST_RGB",e[e.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",e[e.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",e[e.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",e[e.BLEND_COLOR=32773]="BLEND_COLOR",e[e.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",e[e.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",e[e.LINE_WIDTH=2849]="LINE_WIDTH",e[e.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",e[e.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",e[e.CULL_FACE_MODE=2885]="CULL_FACE_MODE",e[e.FRONT_FACE=2886]="FRONT_FACE",e[e.DEPTH_RANGE=2928]="DEPTH_RANGE",e[e.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",e[e.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",e[e.DEPTH_FUNC=2932]="DEPTH_FUNC",e[e.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",e[e.STENCIL_FUNC=2962]="STENCIL_FUNC",e[e.STENCIL_FAIL=2964]="STENCIL_FAIL",e[e.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",e[e.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",e[e.STENCIL_REF=2967]="STENCIL_REF",e[e.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",e[e.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",e[e.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",e[e.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",e[e.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",e[e.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",e[e.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",e[e.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",e[e.VIEWPORT=2978]="VIEWPORT",e[e.SCISSOR_BOX=3088]="SCISSOR_BOX",e[e.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",e[e.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",e[e.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",e[e.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",e[e.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",e[e.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",e[e.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",e[e.RED_BITS=3410]="RED_BITS",e[e.GREEN_BITS=3411]="GREEN_BITS",e[e.BLUE_BITS=3412]="BLUE_BITS",e[e.ALPHA_BITS=3413]="ALPHA_BITS",e[e.DEPTH_BITS=3414]="DEPTH_BITS",e[e.STENCIL_BITS=3415]="STENCIL_BITS",e[e.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",e[e.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",e[e.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",e[e.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",e[e.SAMPLES=32937]="SAMPLES",e[e.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",e[e.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",e[e.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",e[e.VENDOR=7936]="VENDOR",e[e.RENDERER=7937]="RENDERER",e[e.VERSION=7938]="VERSION",e[e.IMPLEMENTATION_COLOR_READ_TYPE=35738]="IMPLEMENTATION_COLOR_READ_TYPE",e[e.IMPLEMENTATION_COLOR_READ_FORMAT=35739]="IMPLEMENTATION_COLOR_READ_FORMAT",e[e.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",e[e.STATIC_DRAW=35044]="STATIC_DRAW",e[e.STREAM_DRAW=35040]="STREAM_DRAW",e[e.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",e[e.ARRAY_BUFFER=34962]="ARRAY_BUFFER",e[e.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",e[e.BUFFER_SIZE=34660]="BUFFER_SIZE",e[e.BUFFER_USAGE=34661]="BUFFER_USAGE",e[e.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",e[e.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",e[e.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",e[e.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",e[e.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",e[e.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",e[e.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",e[e.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",e[e.CULL_FACE=2884]="CULL_FACE",e[e.FRONT=1028]="FRONT",e[e.BACK=1029]="BACK",e[e.FRONT_AND_BACK=1032]="FRONT_AND_BACK",e[e.BLEND=3042]="BLEND",e[e.DEPTH_TEST=2929]="DEPTH_TEST",e[e.DITHER=3024]="DITHER",e[e.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",e[e.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",e[e.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",e[e.SCISSOR_TEST=3089]="SCISSOR_TEST",e[e.STENCIL_TEST=2960]="STENCIL_TEST",e[e.NO_ERROR=0]="NO_ERROR",e[e.INVALID_ENUM=1280]="INVALID_ENUM",e[e.INVALID_VALUE=1281]="INVALID_VALUE",e[e.INVALID_OPERATION=1282]="INVALID_OPERATION",e[e.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",e[e.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",e[e.CW=2304]="CW",e[e.CCW=2305]="CCW",e[e.DONT_CARE=4352]="DONT_CARE",e[e.FASTEST=4353]="FASTEST",e[e.NICEST=4354]="NICEST",e[e.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",e[e.BYTE=5120]="BYTE",e[e.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",e[e.SHORT=5122]="SHORT",e[e.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",e[e.INT=5124]="INT",e[e.UNSIGNED_INT=5125]="UNSIGNED_INT",e[e.FLOAT=5126]="FLOAT",e[e.DOUBLE=5130]="DOUBLE",e[e.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",e[e.ALPHA=6406]="ALPHA",e[e.RGB=6407]="RGB",e[e.RGBA=6408]="RGBA",e[e.LUMINANCE=6409]="LUMINANCE",e[e.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",e[e.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",e[e.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",e[e.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",e[e.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",e[e.VERTEX_SHADER=35633]="VERTEX_SHADER",e[e.COMPILE_STATUS=35713]="COMPILE_STATUS",e[e.DELETE_STATUS=35712]="DELETE_STATUS",e[e.LINK_STATUS=35714]="LINK_STATUS",e[e.VALIDATE_STATUS=35715]="VALIDATE_STATUS",e[e.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",e[e.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",e[e.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",e[e.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",e[e.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",e[e.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",e[e.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",e[e.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",e[e.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",e[e.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",e[e.SHADER_TYPE=35663]="SHADER_TYPE",e[e.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",e[e.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",e[e.NEVER=512]="NEVER",e[e.ALWAYS=519]="ALWAYS",e[e.LESS=513]="LESS",e[e.EQUAL=514]="EQUAL",e[e.LEQUAL=515]="LEQUAL",e[e.GREATER=516]="GREATER",e[e.GEQUAL=518]="GEQUAL",e[e.NOTEQUAL=517]="NOTEQUAL",e[e.KEEP=7680]="KEEP",e[e.REPLACE=7681]="REPLACE",e[e.INCR=7682]="INCR",e[e.DECR=7683]="DECR",e[e.INVERT=5386]="INVERT",e[e.INCR_WRAP=34055]="INCR_WRAP",e[e.DECR_WRAP=34056]="DECR_WRAP",e[e.NEAREST=9728]="NEAREST",e[e.LINEAR=9729]="LINEAR",e[e.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",e[e.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",e[e.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",e[e.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",e[e.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",e[e.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",e[e.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",e[e.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",e[e.TEXTURE_2D=3553]="TEXTURE_2D",e[e.TEXTURE=5890]="TEXTURE",e[e.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",e[e.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",e[e.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e[e.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",e[e.TEXTURE0=33984]="TEXTURE0",e[e.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",e[e.REPEAT=10497]="REPEAT",e[e.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",e[e.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",e[e.TEXTURE_WIDTH=4096]="TEXTURE_WIDTH",e[e.TEXTURE_HEIGHT=4097]="TEXTURE_HEIGHT",e[e.FLOAT_VEC2=35664]="FLOAT_VEC2",e[e.FLOAT_VEC3=35665]="FLOAT_VEC3",e[e.FLOAT_VEC4=35666]="FLOAT_VEC4",e[e.INT_VEC2=35667]="INT_VEC2",e[e.INT_VEC3=35668]="INT_VEC3",e[e.INT_VEC4=35669]="INT_VEC4",e[e.BOOL=35670]="BOOL",e[e.BOOL_VEC2=35671]="BOOL_VEC2",e[e.BOOL_VEC3=35672]="BOOL_VEC3",e[e.BOOL_VEC4=35673]="BOOL_VEC4",e[e.FLOAT_MAT2=35674]="FLOAT_MAT2",e[e.FLOAT_MAT3=35675]="FLOAT_MAT3",e[e.FLOAT_MAT4=35676]="FLOAT_MAT4",e[e.SAMPLER_2D=35678]="SAMPLER_2D",e[e.SAMPLER_CUBE=35680]="SAMPLER_CUBE",e[e.LOW_FLOAT=36336]="LOW_FLOAT",e[e.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",e[e.HIGH_FLOAT=36338]="HIGH_FLOAT",e[e.LOW_INT=36339]="LOW_INT",e[e.MEDIUM_INT=36340]="MEDIUM_INT",e[e.HIGH_INT=36341]="HIGH_INT",e[e.FRAMEBUFFER=36160]="FRAMEBUFFER",e[e.RENDERBUFFER=36161]="RENDERBUFFER",e[e.RGBA4=32854]="RGBA4",e[e.RGB5_A1=32855]="RGB5_A1",e[e.RGB565=36194]="RGB565",e[e.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",e[e.STENCIL_INDEX=6401]="STENCIL_INDEX",e[e.STENCIL_INDEX8=36168]="STENCIL_INDEX8",e[e.DEPTH_STENCIL=34041]="DEPTH_STENCIL",e[e.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",e[e.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",e[e.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",e[e.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",e[e.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",e[e.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",e[e.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",e[e.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",e[e.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",e[e.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",e[e.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",e[e.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",e[e.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",e[e.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",e[e.NONE=0]="NONE",e[e.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",e[e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",e[e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",e[e.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",e[e.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",e[e.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",e[e.READ_FRAMEBUFFER=36008]="READ_FRAMEBUFFER",e[e.DRAW_FRAMEBUFFER=36009]="DRAW_FRAMEBUFFER",e[e.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",e[e.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",e[e.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",e[e.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",e[e.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",e[e.READ_BUFFER=3074]="READ_BUFFER",e[e.UNPACK_ROW_LENGTH=3314]="UNPACK_ROW_LENGTH",e[e.UNPACK_SKIP_ROWS=3315]="UNPACK_SKIP_ROWS",e[e.UNPACK_SKIP_PIXELS=3316]="UNPACK_SKIP_PIXELS",e[e.PACK_ROW_LENGTH=3330]="PACK_ROW_LENGTH",e[e.PACK_SKIP_ROWS=3331]="PACK_SKIP_ROWS",e[e.PACK_SKIP_PIXELS=3332]="PACK_SKIP_PIXELS",e[e.TEXTURE_BINDING_3D=32874]="TEXTURE_BINDING_3D",e[e.UNPACK_SKIP_IMAGES=32877]="UNPACK_SKIP_IMAGES",e[e.UNPACK_IMAGE_HEIGHT=32878]="UNPACK_IMAGE_HEIGHT",e[e.MAX_3D_TEXTURE_SIZE=32883]="MAX_3D_TEXTURE_SIZE",e[e.MAX_ELEMENTS_VERTICES=33e3]="MAX_ELEMENTS_VERTICES",e[e.MAX_ELEMENTS_INDICES=33001]="MAX_ELEMENTS_INDICES",e[e.MAX_TEXTURE_LOD_BIAS=34045]="MAX_TEXTURE_LOD_BIAS",e[e.MAX_FRAGMENT_UNIFORM_COMPONENTS=35657]="MAX_FRAGMENT_UNIFORM_COMPONENTS",e[e.MAX_VERTEX_UNIFORM_COMPONENTS=35658]="MAX_VERTEX_UNIFORM_COMPONENTS",e[e.MAX_ARRAY_TEXTURE_LAYERS=35071]="MAX_ARRAY_TEXTURE_LAYERS",e[e.MIN_PROGRAM_TEXEL_OFFSET=35076]="MIN_PROGRAM_TEXEL_OFFSET",e[e.MAX_PROGRAM_TEXEL_OFFSET=35077]="MAX_PROGRAM_TEXEL_OFFSET",e[e.MAX_VARYING_COMPONENTS=35659]="MAX_VARYING_COMPONENTS",e[e.FRAGMENT_SHADER_DERIVATIVE_HINT=35723]="FRAGMENT_SHADER_DERIVATIVE_HINT",e[e.RASTERIZER_DISCARD=35977]="RASTERIZER_DISCARD",e[e.VERTEX_ARRAY_BINDING=34229]="VERTEX_ARRAY_BINDING",e[e.MAX_VERTEX_OUTPUT_COMPONENTS=37154]="MAX_VERTEX_OUTPUT_COMPONENTS",e[e.MAX_FRAGMENT_INPUT_COMPONENTS=37157]="MAX_FRAGMENT_INPUT_COMPONENTS",e[e.MAX_SERVER_WAIT_TIMEOUT=37137]="MAX_SERVER_WAIT_TIMEOUT",e[e.MAX_ELEMENT_INDEX=36203]="MAX_ELEMENT_INDEX",e[e.RED=6403]="RED",e[e.RGB8=32849]="RGB8",e[e.RGBA8=32856]="RGBA8",e[e.RGB10_A2=32857]="RGB10_A2",e[e.TEXTURE_3D=32879]="TEXTURE_3D",e[e.TEXTURE_WRAP_R=32882]="TEXTURE_WRAP_R",e[e.TEXTURE_MIN_LOD=33082]="TEXTURE_MIN_LOD",e[e.TEXTURE_MAX_LOD=33083]="TEXTURE_MAX_LOD",e[e.TEXTURE_BASE_LEVEL=33084]="TEXTURE_BASE_LEVEL",e[e.TEXTURE_MAX_LEVEL=33085]="TEXTURE_MAX_LEVEL",e[e.TEXTURE_COMPARE_MODE=34892]="TEXTURE_COMPARE_MODE",e[e.TEXTURE_COMPARE_FUNC=34893]="TEXTURE_COMPARE_FUNC",e[e.SRGB=35904]="SRGB",e[e.SRGB8=35905]="SRGB8",e[e.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",e[e.COMPARE_REF_TO_TEXTURE=34894]="COMPARE_REF_TO_TEXTURE",e[e.RGBA32F=34836]="RGBA32F",e[e.RGB32F=34837]="RGB32F",e[e.RGBA16F=34842]="RGBA16F",e[e.RGB16F=34843]="RGB16F",e[e.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",e[e.TEXTURE_BINDING_2D_ARRAY=35869]="TEXTURE_BINDING_2D_ARRAY",e[e.R11F_G11F_B10F=35898]="R11F_G11F_B10F",e[e.RGB9_E5=35901]="RGB9_E5",e[e.RGBA32UI=36208]="RGBA32UI",e[e.RGB32UI=36209]="RGB32UI",e[e.RGBA16UI=36214]="RGBA16UI",e[e.RGB16UI=36215]="RGB16UI",e[e.RGBA8UI=36220]="RGBA8UI",e[e.RGB8UI=36221]="RGB8UI",e[e.RGBA32I=36226]="RGBA32I",e[e.RGB32I=36227]="RGB32I",e[e.RGBA16I=36232]="RGBA16I",e[e.RGB16I=36233]="RGB16I",e[e.RGBA8I=36238]="RGBA8I",e[e.RGB8I=36239]="RGB8I",e[e.RED_INTEGER=36244]="RED_INTEGER",e[e.RGB_INTEGER=36248]="RGB_INTEGER",e[e.RGBA_INTEGER=36249]="RGBA_INTEGER",e[e.R8=33321]="R8",e[e.RG8=33323]="RG8",e[e.R16F=33325]="R16F",e[e.R32F=33326]="R32F",e[e.RG16F=33327]="RG16F",e[e.RG32F=33328]="RG32F",e[e.R8I=33329]="R8I",e[e.R8UI=33330]="R8UI",e[e.R16I=33331]="R16I",e[e.R16UI=33332]="R16UI",e[e.R32I=33333]="R32I",e[e.R32UI=33334]="R32UI",e[e.RG8I=33335]="RG8I",e[e.RG8UI=33336]="RG8UI",e[e.RG16I=33337]="RG16I",e[e.RG16UI=33338]="RG16UI",e[e.RG32I=33339]="RG32I",e[e.RG32UI=33340]="RG32UI",e[e.R8_SNORM=36756]="R8_SNORM",e[e.RG8_SNORM=36757]="RG8_SNORM",e[e.RGB8_SNORM=36758]="RGB8_SNORM",e[e.RGBA8_SNORM=36759]="RGBA8_SNORM",e[e.RGB10_A2UI=36975]="RGB10_A2UI",e[e.TEXTURE_IMMUTABLE_FORMAT=37167]="TEXTURE_IMMUTABLE_FORMAT",e[e.TEXTURE_IMMUTABLE_LEVELS=33503]="TEXTURE_IMMUTABLE_LEVELS",e[e.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",e[e.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",e[e.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",e[e.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",e[e.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",e[e.HALF_FLOAT=5131]="HALF_FLOAT",e[e.RG=33319]="RG",e[e.RG_INTEGER=33320]="RG_INTEGER",e[e.INT_2_10_10_10_REV=36255]="INT_2_10_10_10_REV",e[e.CURRENT_QUERY=34917]="CURRENT_QUERY",e[e.QUERY_RESULT=34918]="QUERY_RESULT",e[e.QUERY_RESULT_AVAILABLE=34919]="QUERY_RESULT_AVAILABLE",e[e.ANY_SAMPLES_PASSED=35887]="ANY_SAMPLES_PASSED",e[e.ANY_SAMPLES_PASSED_CONSERVATIVE=36202]="ANY_SAMPLES_PASSED_CONSERVATIVE",e[e.MAX_DRAW_BUFFERS=34852]="MAX_DRAW_BUFFERS",e[e.DRAW_BUFFER0=34853]="DRAW_BUFFER0",e[e.DRAW_BUFFER1=34854]="DRAW_BUFFER1",e[e.DRAW_BUFFER2=34855]="DRAW_BUFFER2",e[e.DRAW_BUFFER3=34856]="DRAW_BUFFER3",e[e.DRAW_BUFFER4=34857]="DRAW_BUFFER4",e[e.DRAW_BUFFER5=34858]="DRAW_BUFFER5",e[e.DRAW_BUFFER6=34859]="DRAW_BUFFER6",e[e.DRAW_BUFFER7=34860]="DRAW_BUFFER7",e[e.DRAW_BUFFER8=34861]="DRAW_BUFFER8",e[e.DRAW_BUFFER9=34862]="DRAW_BUFFER9",e[e.DRAW_BUFFER10=34863]="DRAW_BUFFER10",e[e.DRAW_BUFFER11=34864]="DRAW_BUFFER11",e[e.DRAW_BUFFER12=34865]="DRAW_BUFFER12",e[e.DRAW_BUFFER13=34866]="DRAW_BUFFER13",e[e.DRAW_BUFFER14=34867]="DRAW_BUFFER14",e[e.DRAW_BUFFER15=34868]="DRAW_BUFFER15",e[e.MAX_COLOR_ATTACHMENTS=36063]="MAX_COLOR_ATTACHMENTS",e[e.COLOR_ATTACHMENT1=36065]="COLOR_ATTACHMENT1",e[e.COLOR_ATTACHMENT2=36066]="COLOR_ATTACHMENT2",e[e.COLOR_ATTACHMENT3=36067]="COLOR_ATTACHMENT3",e[e.COLOR_ATTACHMENT4=36068]="COLOR_ATTACHMENT4",e[e.COLOR_ATTACHMENT5=36069]="COLOR_ATTACHMENT5",e[e.COLOR_ATTACHMENT6=36070]="COLOR_ATTACHMENT6",e[e.COLOR_ATTACHMENT7=36071]="COLOR_ATTACHMENT7",e[e.COLOR_ATTACHMENT8=36072]="COLOR_ATTACHMENT8",e[e.COLOR_ATTACHMENT9=36073]="COLOR_ATTACHMENT9",e[e.COLOR_ATTACHMENT10=36074]="COLOR_ATTACHMENT10",e[e.COLOR_ATTACHMENT11=36075]="COLOR_ATTACHMENT11",e[e.COLOR_ATTACHMENT12=36076]="COLOR_ATTACHMENT12",e[e.COLOR_ATTACHMENT13=36077]="COLOR_ATTACHMENT13",e[e.COLOR_ATTACHMENT14=36078]="COLOR_ATTACHMENT14",e[e.COLOR_ATTACHMENT15=36079]="COLOR_ATTACHMENT15",e[e.SAMPLER_3D=35679]="SAMPLER_3D",e[e.SAMPLER_2D_SHADOW=35682]="SAMPLER_2D_SHADOW",e[e.SAMPLER_2D_ARRAY=36289]="SAMPLER_2D_ARRAY",e[e.SAMPLER_2D_ARRAY_SHADOW=36292]="SAMPLER_2D_ARRAY_SHADOW",e[e.SAMPLER_CUBE_SHADOW=36293]="SAMPLER_CUBE_SHADOW",e[e.INT_SAMPLER_2D=36298]="INT_SAMPLER_2D",e[e.INT_SAMPLER_3D=36299]="INT_SAMPLER_3D",e[e.INT_SAMPLER_CUBE=36300]="INT_SAMPLER_CUBE",e[e.INT_SAMPLER_2D_ARRAY=36303]="INT_SAMPLER_2D_ARRAY",e[e.UNSIGNED_INT_SAMPLER_2D=36306]="UNSIGNED_INT_SAMPLER_2D",e[e.UNSIGNED_INT_SAMPLER_3D=36307]="UNSIGNED_INT_SAMPLER_3D",e[e.UNSIGNED_INT_SAMPLER_CUBE=36308]="UNSIGNED_INT_SAMPLER_CUBE",e[e.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]="UNSIGNED_INT_SAMPLER_2D_ARRAY",e[e.MAX_SAMPLES=36183]="MAX_SAMPLES",e[e.SAMPLER_BINDING=35097]="SAMPLER_BINDING",e[e.PIXEL_PACK_BUFFER=35051]="PIXEL_PACK_BUFFER",e[e.PIXEL_UNPACK_BUFFER=35052]="PIXEL_UNPACK_BUFFER",e[e.PIXEL_PACK_BUFFER_BINDING=35053]="PIXEL_PACK_BUFFER_BINDING",e[e.PIXEL_UNPACK_BUFFER_BINDING=35055]="PIXEL_UNPACK_BUFFER_BINDING",e[e.COPY_READ_BUFFER=36662]="COPY_READ_BUFFER",e[e.COPY_WRITE_BUFFER=36663]="COPY_WRITE_BUFFER",e[e.COPY_READ_BUFFER_BINDING=36662]="COPY_READ_BUFFER_BINDING",e[e.COPY_WRITE_BUFFER_BINDING=36663]="COPY_WRITE_BUFFER_BINDING",e[e.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",e[e.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",e[e.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",e[e.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",e[e.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",e[e.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",e[e.UNSIGNED_INT_VEC2=36294]="UNSIGNED_INT_VEC2",e[e.UNSIGNED_INT_VEC3=36295]="UNSIGNED_INT_VEC3",e[e.UNSIGNED_INT_VEC4=36296]="UNSIGNED_INT_VEC4",e[e.UNSIGNED_NORMALIZED=35863]="UNSIGNED_NORMALIZED",e[e.SIGNED_NORMALIZED=36764]="SIGNED_NORMALIZED",e[e.VERTEX_ATTRIB_ARRAY_INTEGER=35069]="VERTEX_ATTRIB_ARRAY_INTEGER",e[e.VERTEX_ATTRIB_ARRAY_DIVISOR=35070]="VERTEX_ATTRIB_ARRAY_DIVISOR",e[e.TRANSFORM_FEEDBACK_BUFFER_MODE=35967]="TRANSFORM_FEEDBACK_BUFFER_MODE",e[e.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS=35968]="MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS",e[e.TRANSFORM_FEEDBACK_VARYINGS=35971]="TRANSFORM_FEEDBACK_VARYINGS",e[e.TRANSFORM_FEEDBACK_BUFFER_START=35972]="TRANSFORM_FEEDBACK_BUFFER_START",e[e.TRANSFORM_FEEDBACK_BUFFER_SIZE=35973]="TRANSFORM_FEEDBACK_BUFFER_SIZE",e[e.TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN=35976]="TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN",e[e.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS=35978]="MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS",e[e.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS=35979]="MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS",e[e.INTERLEAVED_ATTRIBS=35980]="INTERLEAVED_ATTRIBS",e[e.SEPARATE_ATTRIBS=35981]="SEPARATE_ATTRIBS",e[e.TRANSFORM_FEEDBACK_BUFFER=35982]="TRANSFORM_FEEDBACK_BUFFER",e[e.TRANSFORM_FEEDBACK_BUFFER_BINDING=35983]="TRANSFORM_FEEDBACK_BUFFER_BINDING",e[e.TRANSFORM_FEEDBACK=36386]="TRANSFORM_FEEDBACK",e[e.TRANSFORM_FEEDBACK_PAUSED=36387]="TRANSFORM_FEEDBACK_PAUSED",e[e.TRANSFORM_FEEDBACK_ACTIVE=36388]="TRANSFORM_FEEDBACK_ACTIVE",e[e.TRANSFORM_FEEDBACK_BINDING=36389]="TRANSFORM_FEEDBACK_BINDING",e[e.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING=33296]="FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING",e[e.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE=33297]="FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE",e[e.FRAMEBUFFER_ATTACHMENT_RED_SIZE=33298]="FRAMEBUFFER_ATTACHMENT_RED_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_GREEN_SIZE=33299]="FRAMEBUFFER_ATTACHMENT_GREEN_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_BLUE_SIZE=33300]="FRAMEBUFFER_ATTACHMENT_BLUE_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE=33301]="FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE=33302]="FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE",e[e.FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE=33303]="FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE",e[e.FRAMEBUFFER_DEFAULT=33304]="FRAMEBUFFER_DEFAULT",e[e.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",e[e.DRAW_FRAMEBUFFER_BINDING=36006]="DRAW_FRAMEBUFFER_BINDING",e[e.READ_FRAMEBUFFER_BINDING=36010]="READ_FRAMEBUFFER_BINDING",e[e.RENDERBUFFER_SAMPLES=36011]="RENDERBUFFER_SAMPLES",e[e.FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER=36052]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER",e[e.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE=36182]="FRAMEBUFFER_INCOMPLETE_MULTISAMPLE",e[e.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",e[e.UNIFORM_BUFFER_BINDING=35368]="UNIFORM_BUFFER_BINDING",e[e.UNIFORM_BUFFER_START=35369]="UNIFORM_BUFFER_START",e[e.UNIFORM_BUFFER_SIZE=35370]="UNIFORM_BUFFER_SIZE",e[e.MAX_VERTEX_UNIFORM_BLOCKS=35371]="MAX_VERTEX_UNIFORM_BLOCKS",e[e.MAX_FRAGMENT_UNIFORM_BLOCKS=35373]="MAX_FRAGMENT_UNIFORM_BLOCKS",e[e.MAX_COMBINED_UNIFORM_BLOCKS=35374]="MAX_COMBINED_UNIFORM_BLOCKS",e[e.MAX_UNIFORM_BUFFER_BINDINGS=35375]="MAX_UNIFORM_BUFFER_BINDINGS",e[e.MAX_UNIFORM_BLOCK_SIZE=35376]="MAX_UNIFORM_BLOCK_SIZE",e[e.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS=35377]="MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS",e[e.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS=35379]="MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS",e[e.UNIFORM_BUFFER_OFFSET_ALIGNMENT=35380]="UNIFORM_BUFFER_OFFSET_ALIGNMENT",e[e.ACTIVE_UNIFORM_BLOCKS=35382]="ACTIVE_UNIFORM_BLOCKS",e[e.UNIFORM_TYPE=35383]="UNIFORM_TYPE",e[e.UNIFORM_SIZE=35384]="UNIFORM_SIZE",e[e.UNIFORM_BLOCK_INDEX=35386]="UNIFORM_BLOCK_INDEX",e[e.UNIFORM_OFFSET=35387]="UNIFORM_OFFSET",e[e.UNIFORM_ARRAY_STRIDE=35388]="UNIFORM_ARRAY_STRIDE",e[e.UNIFORM_MATRIX_STRIDE=35389]="UNIFORM_MATRIX_STRIDE",e[e.UNIFORM_IS_ROW_MAJOR=35390]="UNIFORM_IS_ROW_MAJOR",e[e.UNIFORM_BLOCK_BINDING=35391]="UNIFORM_BLOCK_BINDING",e[e.UNIFORM_BLOCK_DATA_SIZE=35392]="UNIFORM_BLOCK_DATA_SIZE",e[e.UNIFORM_BLOCK_ACTIVE_UNIFORMS=35394]="UNIFORM_BLOCK_ACTIVE_UNIFORMS",e[e.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES=35395]="UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES",e[e.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER=35396]="UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER",e[e.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER=35398]="UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER",e[e.OBJECT_TYPE=37138]="OBJECT_TYPE",e[e.SYNC_CONDITION=37139]="SYNC_CONDITION",e[e.SYNC_STATUS=37140]="SYNC_STATUS",e[e.SYNC_FLAGS=37141]="SYNC_FLAGS",e[e.SYNC_FENCE=37142]="SYNC_FENCE",e[e.SYNC_GPU_COMMANDS_COMPLETE=37143]="SYNC_GPU_COMMANDS_COMPLETE",e[e.UNSIGNALED=37144]="UNSIGNALED",e[e.SIGNALED=37145]="SIGNALED",e[e.ALREADY_SIGNALED=37146]="ALREADY_SIGNALED",e[e.TIMEOUT_EXPIRED=37147]="TIMEOUT_EXPIRED",e[e.CONDITION_SATISFIED=37148]="CONDITION_SATISFIED",e[e.WAIT_FAILED=37149]="WAIT_FAILED",e[e.SYNC_FLUSH_COMMANDS_BIT=1]="SYNC_FLUSH_COMMANDS_BIT",e[e.COLOR=6144]="COLOR",e[e.DEPTH=6145]="DEPTH",e[e.STENCIL=6146]="STENCIL",e[e.MIN=32775]="MIN",e[e.MAX=32776]="MAX",e[e.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",e[e.STREAM_READ=35041]="STREAM_READ",e[e.STREAM_COPY=35042]="STREAM_COPY",e[e.STATIC_READ=35045]="STATIC_READ",e[e.STATIC_COPY=35046]="STATIC_COPY",e[e.DYNAMIC_READ=35049]="DYNAMIC_READ",e[e.DYNAMIC_COPY=35050]="DYNAMIC_COPY",e[e.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F",e[e.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8",e[e.INVALID_INDEX=4294967295]="INVALID_INDEX",e[e.TIMEOUT_IGNORED=-1]="TIMEOUT_IGNORED",e[e.MAX_CLIENT_WAIT_TIMEOUT_WEBGL=37447]="MAX_CLIENT_WAIT_TIMEOUT_WEBGL",e[e.VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE=35070]="VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE",e[e.UNMASKED_VENDOR_WEBGL=37445]="UNMASKED_VENDOR_WEBGL",e[e.UNMASKED_RENDERER_WEBGL=37446]="UNMASKED_RENDERER_WEBGL",e[e.MAX_TEXTURE_MAX_ANISOTROPY_EXT=34047]="MAX_TEXTURE_MAX_ANISOTROPY_EXT",e[e.TEXTURE_MAX_ANISOTROPY_EXT=34046]="TEXTURE_MAX_ANISOTROPY_EXT",e[e.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",e[e.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",e[e.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",e[e.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",e[e.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",e[e.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",e[e.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",e[e.COMPRESSED_RGBA8_ETC2_EAC=37493]="COMPRESSED_RGBA8_ETC2_EAC",e[e.COMPRESSED_SRGB8_ETC2=37494]="COMPRESSED_SRGB8_ETC2",e[e.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37495]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",e[e.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37496]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37497]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",e[e.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",e[e.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",e[e.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",e[e.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",e[e.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",e[e.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",e[e.UNSIGNED_INT_24_8_WEBGL=34042]="UNSIGNED_INT_24_8_WEBGL",e[e.HALF_FLOAT_OES=36193]="HALF_FLOAT_OES",e[e.RGBA32F_EXT=34836]="RGBA32F_EXT",e[e.RGB32F_EXT=34837]="RGB32F_EXT",e[e.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT=33297]="FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT",e[e.UNSIGNED_NORMALIZED_EXT=35863]="UNSIGNED_NORMALIZED_EXT",e[e.MIN_EXT=32775]="MIN_EXT",e[e.MAX_EXT=32776]="MAX_EXT",e[e.SRGB_EXT=35904]="SRGB_EXT",e[e.SRGB_ALPHA_EXT=35906]="SRGB_ALPHA_EXT",e[e.SRGB8_ALPHA8_EXT=35907]="SRGB8_ALPHA8_EXT",e[e.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING_EXT=33296]="FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING_EXT",e[e.FRAGMENT_SHADER_DERIVATIVE_HINT_OES=35723]="FRAGMENT_SHADER_DERIVATIVE_HINT_OES",e[e.COLOR_ATTACHMENT0_WEBGL=36064]="COLOR_ATTACHMENT0_WEBGL",e[e.COLOR_ATTACHMENT1_WEBGL=36065]="COLOR_ATTACHMENT1_WEBGL",e[e.COLOR_ATTACHMENT2_WEBGL=36066]="COLOR_ATTACHMENT2_WEBGL",e[e.COLOR_ATTACHMENT3_WEBGL=36067]="COLOR_ATTACHMENT3_WEBGL",e[e.COLOR_ATTACHMENT4_WEBGL=36068]="COLOR_ATTACHMENT4_WEBGL",e[e.COLOR_ATTACHMENT5_WEBGL=36069]="COLOR_ATTACHMENT5_WEBGL",e[e.COLOR_ATTACHMENT6_WEBGL=36070]="COLOR_ATTACHMENT6_WEBGL",e[e.COLOR_ATTACHMENT7_WEBGL=36071]="COLOR_ATTACHMENT7_WEBGL",e[e.COLOR_ATTACHMENT8_WEBGL=36072]="COLOR_ATTACHMENT8_WEBGL",e[e.COLOR_ATTACHMENT9_WEBGL=36073]="COLOR_ATTACHMENT9_WEBGL",e[e.COLOR_ATTACHMENT10_WEBGL=36074]="COLOR_ATTACHMENT10_WEBGL",e[e.COLOR_ATTACHMENT11_WEBGL=36075]="COLOR_ATTACHMENT11_WEBGL",e[e.COLOR_ATTACHMENT12_WEBGL=36076]="COLOR_ATTACHMENT12_WEBGL",e[e.COLOR_ATTACHMENT13_WEBGL=36077]="COLOR_ATTACHMENT13_WEBGL",e[e.COLOR_ATTACHMENT14_WEBGL=36078]="COLOR_ATTACHMENT14_WEBGL",e[e.COLOR_ATTACHMENT15_WEBGL=36079]="COLOR_ATTACHMENT15_WEBGL",e[e.DRAW_BUFFER0_WEBGL=34853]="DRAW_BUFFER0_WEBGL",e[e.DRAW_BUFFER1_WEBGL=34854]="DRAW_BUFFER1_WEBGL",e[e.DRAW_BUFFER2_WEBGL=34855]="DRAW_BUFFER2_WEBGL",e[e.DRAW_BUFFER3_WEBGL=34856]="DRAW_BUFFER3_WEBGL",e[e.DRAW_BUFFER4_WEBGL=34857]="DRAW_BUFFER4_WEBGL",e[e.DRAW_BUFFER5_WEBGL=34858]="DRAW_BUFFER5_WEBGL",e[e.DRAW_BUFFER6_WEBGL=34859]="DRAW_BUFFER6_WEBGL",e[e.DRAW_BUFFER7_WEBGL=34860]="DRAW_BUFFER7_WEBGL",e[e.DRAW_BUFFER8_WEBGL=34861]="DRAW_BUFFER8_WEBGL",e[e.DRAW_BUFFER9_WEBGL=34862]="DRAW_BUFFER9_WEBGL",e[e.DRAW_BUFFER10_WEBGL=34863]="DRAW_BUFFER10_WEBGL",e[e.DRAW_BUFFER11_WEBGL=34864]="DRAW_BUFFER11_WEBGL",e[e.DRAW_BUFFER12_WEBGL=34865]="DRAW_BUFFER12_WEBGL",e[e.DRAW_BUFFER13_WEBGL=34866]="DRAW_BUFFER13_WEBGL",e[e.DRAW_BUFFER14_WEBGL=34867]="DRAW_BUFFER14_WEBGL",e[e.DRAW_BUFFER15_WEBGL=34868]="DRAW_BUFFER15_WEBGL",e[e.MAX_COLOR_ATTACHMENTS_WEBGL=36063]="MAX_COLOR_ATTACHMENTS_WEBGL",e[e.MAX_DRAW_BUFFERS_WEBGL=34852]="MAX_DRAW_BUFFERS_WEBGL",e[e.VERTEX_ARRAY_BINDING_OES=34229]="VERTEX_ARRAY_BINDING_OES",e[e.QUERY_COUNTER_BITS_EXT=34916]="QUERY_COUNTER_BITS_EXT",e[e.CURRENT_QUERY_EXT=34917]="CURRENT_QUERY_EXT",e[e.QUERY_RESULT_EXT=34918]="QUERY_RESULT_EXT",e[e.QUERY_RESULT_AVAILABLE_EXT=34919]="QUERY_RESULT_AVAILABLE_EXT",e[e.TIME_ELAPSED_EXT=35007]="TIME_ELAPSED_EXT",e[e.TIMESTAMP_EXT=36392]="TIMESTAMP_EXT",e[e.GPU_DISJOINT_EXT=36795]="GPU_DISJOINT_EXT"})(ee||(ee={}));var Cr;(function(e){e[e.Buffer=0]="Buffer",e[e.Texture=1]="Texture",e[e.RenderTarget=2]="RenderTarget",e[e.Sampler=3]="Sampler",e[e.Program=4]="Program",e[e.Bindings=5]="Bindings",e[e.InputLayout=6]="InputLayout",e[e.RenderPipeline=7]="RenderPipeline",e[e.ComputePipeline=8]="ComputePipeline",e[e.Readback=9]="Readback",e[e.QueryPool=10]="QueryPool",e[e.RenderBundle=11]="RenderBundle"})(Cr||(Cr={}));var Ir;(function(e){e[e.NEVER=512]="NEVER",e[e.LESS=513]="LESS",e[e.EQUAL=514]="EQUAL",e[e.LEQUAL=515]="LEQUAL",e[e.GREATER=516]="GREATER",e[e.NOTEQUAL=517]="NOTEQUAL",e[e.GEQUAL=518]="GEQUAL",e[e.ALWAYS=519]="ALWAYS"})(Ir||(Ir={}));var Uv;(function(e){e[e.CCW=2305]="CCW",e[e.CW=2304]="CW"})(Uv||(Uv={}));var la;(function(e){e[e.NONE=0]="NONE",e[e.FRONT=1]="FRONT",e[e.BACK=2]="BACK",e[e.FRONT_AND_BACK=3]="FRONT_AND_BACK"})(la||(la={}));var fr;(function(e){e[e.ZERO=0]="ZERO",e[e.ONE=1]="ONE",e[e.SRC=768]="SRC",e[e.ONE_MINUS_SRC=769]="ONE_MINUS_SRC",e[e.DST=774]="DST",e[e.ONE_MINUS_DST=775]="ONE_MINUS_DST",e[e.SRC_ALPHA=770]="SRC_ALPHA",e[e.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",e[e.DST_ALPHA=772]="DST_ALPHA",e[e.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",e[e.CONST=32769]="CONST",e[e.ONE_MINUS_CONSTANT=32770]="ONE_MINUS_CONSTANT",e[e.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE"})(fr||(fr={}));var ti;(function(e){e[e.ADD=32774]="ADD",e[e.SUBSTRACT=32778]="SUBSTRACT",e[e.REVERSE_SUBSTRACT=32779]="REVERSE_SUBSTRACT",e[e.MIN=32775]="MIN",e[e.MAX=32776]="MAX"})(ti||(ti={}));var qi;(function(e){e[e.CLAMP_TO_EDGE=0]="CLAMP_TO_EDGE",e[e.REPEAT=1]="REPEAT",e[e.MIRRORED_REPEAT=2]="MIRRORED_REPEAT"})(qi||(qi={}));var Rn;(function(e){e[e.POINT=0]="POINT",e[e.BILINEAR=1]="BILINEAR"})(Rn||(Rn={}));var qn;(function(e){e[e.NO_MIP=0]="NO_MIP",e[e.NEAREST=1]="NEAREST",e[e.LINEAR=2]="LINEAR"})(qn||(qn={}));var Fn;(function(e){e[e.POINTS=0]="POINTS",e[e.TRIANGLES=1]="TRIANGLES",e[e.TRIANGLE_STRIP=2]="TRIANGLE_STRIP",e[e.LINES=3]="LINES",e[e.LINE_STRIP=4]="LINE_STRIP"})(Fn||(Fn={}));var Xr;(function(e){e[e.MAP_READ=1]="MAP_READ",e[e.MAP_WRITE=2]="MAP_WRITE",e[e.COPY_SRC=4]="COPY_SRC",e[e.COPY_DST=8]="COPY_DST",e[e.INDEX=16]="INDEX",e[e.VERTEX=32]="VERTEX",e[e.UNIFORM=64]="UNIFORM",e[e.STORAGE=128]="STORAGE",e[e.INDIRECT=256]="INDIRECT",e[e.QUERY_RESOLVE=512]="QUERY_RESOLVE"})(Xr||(Xr={}));var No;(function(e){e[e.STATIC=1]="STATIC",e[e.DYNAMIC=2]="DYNAMIC"})(No||(No={}));var Vc;(function(e){e[e.VERTEX=1]="VERTEX",e[e.INSTANCE=2]="INSTANCE"})(Vc||(Vc={}));var yP;(function(e){e.LOADED="loaded"})(yP||(yP={}));var dr;(function(e){e[e.TEXTURE_2D=0]="TEXTURE_2D",e[e.TEXTURE_2D_ARRAY=1]="TEXTURE_2D_ARRAY",e[e.TEXTURE_3D=2]="TEXTURE_3D",e[e.TEXTURE_CUBE_MAP=3]="TEXTURE_CUBE_MAP"})(dr||(dr={}));var Pi;(function(e){e[e.SAMPLED=1]="SAMPLED",e[e.RENDER_TARGET=2]="RENDER_TARGET",e[e.STORAGE=4]="STORAGE"})(Pi||(Pi={}));var ei;(function(e){e[e.NONE=0]="NONE",e[e.RED=1]="RED",e[e.GREEN=2]="GREEN",e[e.BLUE=4]="BLUE",e[e.ALPHA=8]="ALPHA",e[e.RGB=7]="RGB",e[e.ALL=15]="ALL"})(ei||(ei={}));var _n;(function(e){e[e.KEEP=7680]="KEEP",e[e.ZERO=0]="ZERO",e[e.REPLACE=7681]="REPLACE",e[e.INVERT=5386]="INVERT",e[e.INCREMENT_CLAMP=7682]="INCREMENT_CLAMP",e[e.DECREMENT_CLAMP=7683]="DECREMENT_CLAMP",e[e.INCREMENT_WRAP=34055]="INCREMENT_WRAP",e[e.DECREMENT_WRAP=34056]="DECREMENT_WRAP"})(_n||(_n={}));var mn;(function(e){e[e.Float=0]="Float",e[e.UnfilterableFloat=1]="UnfilterableFloat",e[e.Uint=2]="Uint",e[e.Sint=3]="Sint",e[e.Depth=4]="Depth"})(mn||(mn={}));var wo;(function(e){e[e.LOWER_LEFT=0]="LOWER_LEFT",e[e.UPPER_LEFT=1]="UPPER_LEFT"})(wo||(wo={}));var Wd;(function(e){e[e.NEGATIVE_ONE=0]="NEGATIVE_ONE",e[e.ZERO=1]="ZERO"})(Wd||(Wd={}));var sg;(function(e){e[e.OcclusionConservative=0]="OcclusionConservative"})(sg||(sg={}));var Ye;(function(e){e[e.U8=1]="U8",e[e.U16=2]="U16",e[e.U32=3]="U32",e[e.S8=4]="S8",e[e.S16=5]="S16",e[e.S32=6]="S32",e[e.F16=7]="F16",e[e.F32=8]="F32",e[e.BC1=65]="BC1",e[e.BC2=66]="BC2",e[e.BC3=67]="BC3",e[e.BC4_UNORM=68]="BC4_UNORM",e[e.BC4_SNORM=69]="BC4_SNORM",e[e.BC5_UNORM=70]="BC5_UNORM",e[e.BC5_SNORM=71]="BC5_SNORM",e[e.U16_PACKED_5551=97]="U16_PACKED_5551",e[e.U16_PACKED_565=98]="U16_PACKED_565",e[e.D24=129]="D24",e[e.D32F=130]="D32F",e[e.D24S8=131]="D24S8",e[e.D32FS8=132]="D32FS8"})(Ye||(Ye={}));var wt;(function(e){e[e.R=1]="R",e[e.RG=2]="RG",e[e.RGB=3]="RGB",e[e.RGBA=4]="RGBA",e[e.A=5]="A"})(wt||(wt={}));var At;(function(e){e[e.None=0]="None",e[e.Normalized=1]="Normalized",e[e.sRGB=2]="sRGB",e[e.Depth=4]="Depth",e[e.Stencil=8]="Stencil",e[e.RenderTarget=16]="RenderTarget",e[e.Luminance=32]="Luminance"})(At||(At={}));function Ft(e,t,r){return e<<16|t<<8|r}var he;(function(e){e[e.ALPHA=Ft(Ye.U8,wt.A,At.None)]="ALPHA",e[e.U8_LUMINANCE=Ft(Ye.U8,wt.A,At.Luminance)]="U8_LUMINANCE",e[e.F16_LUMINANCE=Ft(Ye.F16,wt.A,At.Luminance)]="F16_LUMINANCE",e[e.F32_LUMINANCE=Ft(Ye.F32,wt.A,At.Luminance)]="F32_LUMINANCE",e[e.F16_R=Ft(Ye.F16,wt.R,At.None)]="F16_R",e[e.F16_RG=Ft(Ye.F16,wt.RG,At.None)]="F16_RG",e[e.F16_RGB=Ft(Ye.F16,wt.RGB,At.None)]="F16_RGB",e[e.F16_RGBA=Ft(Ye.F16,wt.RGBA,At.None)]="F16_RGBA",e[e.F32_R=Ft(Ye.F32,wt.R,At.None)]="F32_R",e[e.F32_RG=Ft(Ye.F32,wt.RG,At.None)]="F32_RG",e[e.F32_RGB=Ft(Ye.F32,wt.RGB,At.None)]="F32_RGB",e[e.F32_RGBA=Ft(Ye.F32,wt.RGBA,At.None)]="F32_RGBA",e[e.U8_R=Ft(Ye.U8,wt.R,At.None)]="U8_R",e[e.U8_R_NORM=Ft(Ye.U8,wt.R,At.Normalized)]="U8_R_NORM",e[e.U8_RG=Ft(Ye.U8,wt.RG,At.None)]="U8_RG",e[e.U8_RG_NORM=Ft(Ye.U8,wt.RG,At.Normalized)]="U8_RG_NORM",e[e.U8_RGB=Ft(Ye.U8,wt.RGB,At.None)]="U8_RGB",e[e.U8_RGB_NORM=Ft(Ye.U8,wt.RGB,At.Normalized)]="U8_RGB_NORM",e[e.U8_RGB_SRGB=Ft(Ye.U8,wt.RGB,At.sRGB|At.Normalized)]="U8_RGB_SRGB",e[e.U8_RGBA=Ft(Ye.U8,wt.RGBA,At.None)]="U8_RGBA",e[e.U8_RGBA_NORM=Ft(Ye.U8,wt.RGBA,At.Normalized)]="U8_RGBA_NORM",e[e.U8_RGBA_SRGB=Ft(Ye.U8,wt.RGBA,At.sRGB|At.Normalized)]="U8_RGBA_SRGB",e[e.U16_R=Ft(Ye.U16,wt.R,At.None)]="U16_R",e[e.U16_R_NORM=Ft(Ye.U16,wt.R,At.Normalized)]="U16_R_NORM",e[e.U16_RG_NORM=Ft(Ye.U16,wt.RG,At.Normalized)]="U16_RG_NORM",e[e.U16_RGBA_NORM=Ft(Ye.U16,wt.RGBA,At.Normalized)]="U16_RGBA_NORM",e[e.U16_RGBA=Ft(Ye.U16,wt.RGBA,At.None)]="U16_RGBA",e[e.U16_RGB=Ft(Ye.U16,wt.RGB,At.None)]="U16_RGB",e[e.U16_RG=Ft(Ye.U16,wt.RG,At.None)]="U16_RG",e[e.U32_R=Ft(Ye.U32,wt.R,At.None)]="U32_R",e[e.U32_RG=Ft(Ye.U32,wt.RG,At.None)]="U32_RG",e[e.U32_RGB=Ft(Ye.U32,wt.RGB,At.None)]="U32_RGB",e[e.U32_RGBA=Ft(Ye.U32,wt.RGBA,At.None)]="U32_RGBA",e[e.S8_R=Ft(Ye.S8,wt.R,At.None)]="S8_R",e[e.S8_R_NORM=Ft(Ye.S8,wt.R,At.Normalized)]="S8_R_NORM",e[e.S8_RG_NORM=Ft(Ye.S8,wt.RG,At.Normalized)]="S8_RG_NORM",e[e.S8_RGB_NORM=Ft(Ye.S8,wt.RGB,At.Normalized)]="S8_RGB_NORM",e[e.S8_RGBA_NORM=Ft(Ye.S8,wt.RGBA,At.Normalized)]="S8_RGBA_NORM",e[e.S16_R=Ft(Ye.S16,wt.R,At.None)]="S16_R",e[e.S16_RG=Ft(Ye.S16,wt.RG,At.None)]="S16_RG",e[e.S16_RG_NORM=Ft(Ye.S16,wt.RG,At.Normalized)]="S16_RG_NORM",e[e.S16_RGB_NORM=Ft(Ye.S16,wt.RGB,At.Normalized)]="S16_RGB_NORM",e[e.S16_RGBA=Ft(Ye.S16,wt.RGBA,At.None)]="S16_RGBA",e[e.S16_RGBA_NORM=Ft(Ye.S16,wt.RGBA,At.Normalized)]="S16_RGBA_NORM",e[e.S32_R=Ft(Ye.S32,wt.R,At.None)]="S32_R",e[e.S32_RG=Ft(Ye.S32,wt.RG,At.None)]="S32_RG",e[e.S32_RGB=Ft(Ye.S32,wt.RGB,At.None)]="S32_RGB",e[e.S32_RGBA=Ft(Ye.S32,wt.RGBA,At.None)]="S32_RGBA",e[e.U16_RGBA_5551=Ft(Ye.U16_PACKED_5551,wt.RGBA,At.Normalized)]="U16_RGBA_5551",e[e.U16_RGB_565=Ft(Ye.U16_PACKED_565,wt.RGB,At.Normalized)]="U16_RGB_565",e[e.BC1=Ft(Ye.BC1,wt.RGBA,At.Normalized)]="BC1",e[e.BC1_SRGB=Ft(Ye.BC1,wt.RGBA,At.Normalized|At.sRGB)]="BC1_SRGB",e[e.BC2=Ft(Ye.BC2,wt.RGBA,At.Normalized)]="BC2",e[e.BC2_SRGB=Ft(Ye.BC2,wt.RGBA,At.Normalized|At.sRGB)]="BC2_SRGB",e[e.BC3=Ft(Ye.BC3,wt.RGBA,At.Normalized)]="BC3",e[e.BC3_SRGB=Ft(Ye.BC3,wt.RGBA,At.Normalized|At.sRGB)]="BC3_SRGB",e[e.BC4_UNORM=Ft(Ye.BC4_UNORM,wt.R,At.Normalized)]="BC4_UNORM",e[e.BC4_SNORM=Ft(Ye.BC4_SNORM,wt.R,At.Normalized)]="BC4_SNORM",e[e.BC5_UNORM=Ft(Ye.BC5_UNORM,wt.RG,At.Normalized)]="BC5_UNORM",e[e.BC5_SNORM=Ft(Ye.BC5_SNORM,wt.RG,At.Normalized)]="BC5_SNORM",e[e.D24=Ft(Ye.D24,wt.R,At.Depth)]="D24",e[e.D24_S8=Ft(Ye.D24S8,wt.RG,At.Depth|At.Stencil)]="D24_S8",e[e.D32F=Ft(Ye.D32F,wt.R,At.Depth)]="D32F",e[e.D32F_S8=Ft(Ye.D32FS8,wt.RG,At.Depth|At.Stencil)]="D32F_S8",e[e.U8_RGB_RT=Ft(Ye.U8,wt.RGB,At.RenderTarget|At.Normalized)]="U8_RGB_RT",e[e.U8_RGBA_RT=Ft(Ye.U8,wt.RGBA,At.RenderTarget|At.Normalized)]="U8_RGBA_RT",e[e.U8_RGBA_RT_SRGB=Ft(Ye.U8,wt.RGBA,At.RenderTarget|At.Normalized|At.sRGB)]="U8_RGBA_RT_SRGB"})(he||(he={}));function DR(e){return e>>>8&255}function gs(e){return e>>>16&255}function Yd(e){return e&255}function _F(e){switch(e){case Ye.F32:case Ye.U32:case Ye.S32:return 4;case Ye.U16:case Ye.S16:case Ye.F16:return 2;case Ye.U8:case Ye.S8:return 1;default:throw new Error("whoops")}}function gF(e){return _F(gs(e))}function Ine(e){var t=_F(gs(e)),r=DR(e);return t*r}function yF(e){var t=Yd(e);if(t&At.Depth)return mn.Depth;if(t&At.Normalized)return mn.Float;var r=gs(e);if(r===Ye.F16||r===Ye.F32)return mn.Float;if(r===Ye.U8||r===Ye.U16||r===Ye.U32)return mn.Uint;if(r===Ye.S8||r===Ye.S16||r===Ye.S32)return mn.Sint;throw new Error("whoops")}function rr(e,t){if(t===void 0&&(t=""),!e)throw new Error("Assert fail: ".concat(t))}function wc(e){if(e!=null)return e;throw new Error("Missing object")}function EF(e,t){return e.r===t.r&&e.g===t.g&&e.b===t.b&&e.a===t.a}function TF(e,t){e.r=t.r,e.g=t.g,e.b=t.b,e.a=t.a}function SF(e){var t=e.r,r=e.g,n=e.b,i=e.a;return{r:t,g:r,b:n,a:i}}function Qv(e,t,r,n){return n===void 0&&(n=1),{r:e,g:t,b:r,a:n}}var $g=Qv(0,0,0,0);Qv(0,0,0,1);var Pne=Qv(1,1,1,0);Qv(1,1,1,1);function ug(e){return!!(e&&(e&e-1)===0)}function cl(e,t){return e??t}function Dne(e){return e===void 0?null:e}function lg(e,t){var r=t-1;return e+r&~r}function Lne(e,t){for(var r=new Array(e),n=0;n<e;n++)r[n]=t();return r}function Bne(e,t){t===void 0&&(t=1);var r=e.split(`
`);return r.map(function(n,i){return"".concat(Fne(""+(t+i),4," "),"  ").concat(n)}).join(`
`)}function Fne(e,t,r){for(;e.length<t;)e="".concat(r).concat(e);return e}function EP(e,t){e.blendDstFactor=t.blendDstFactor,e.blendSrcFactor=t.blendSrcFactor,e.blendMode=t.blendMode}function cg(e,t){return e===void 0&&(e={}),e.compare=t.compare,e.depthFailOp=t.depthFailOp,e.passOp=t.passOp,e.failOp=t.failOp,e.mask=t.mask,e}function AF(e,t){return e===void 0&&(e={rgbBlendState:{},alphaBlendState:{},channelWriteMask:0}),EP(e.rgbBlendState,t.rgbBlendState),EP(e.alphaBlendState,t.alphaBlendState),e.channelWriteMask=t.channelWriteMask,e}function bF(e,t){e.length!==t.length&&(e.length=t.length);for(var r=0;r<t.length;r++)e[r]=AF(e[r],t[r])}function Une(e,t){t.attachmentsState!==void 0&&bF(e.attachmentsState,t.attachmentsState),e.blendConstant&&t.blendConstant&&TF(e.blendConstant,t.blendConstant),e.depthCompare=cl(t.depthCompare,e.depthCompare),e.depthWrite=cl(t.depthWrite,e.depthWrite),e.stencilWrite=cl(t.stencilWrite,e.stencilWrite),e.stencilFront&&t.stencilFront&&cg(e.stencilFront,t.stencilFront),e.stencilBack&&t.stencilBack&&cg(e.stencilBack,t.stencilBack),e.cullMode=cl(t.cullMode,e.cullMode),e.frontFace=cl(t.frontFace,e.frontFace),e.polygonOffset=cl(t.polygonOffset,e.polygonOffset),e.polygonOffsetFactor=cl(t.polygonOffsetFactor,e.polygonOffsetFactor),e.polygonOffsetUnits=cl(t.polygonOffsetUnits,e.polygonOffsetUnits)}function $d(e){var t=Object.assign({},e);return t.attachmentsState=[],bF(t.attachmentsState,e.attachmentsState),t.blendConstant=t.blendConstant&&SF(t.blendConstant),t.stencilFront=cg(void 0,e.stencilFront),t.stencilBack=cg(void 0,e.stencilBack),t}var TP={blendMode:ti.ADD,blendSrcFactor:fr.ONE,blendDstFactor:fr.ZERO},Zd={attachmentsState:[{channelWriteMask:ei.ALL,rgbBlendState:TP,alphaBlendState:TP}],blendConstant:SF($g),depthWrite:!0,depthCompare:Ir.LEQUAL,stencilWrite:!1,stencilFront:{compare:Ir.ALWAYS,passOp:_n.KEEP,depthFailOp:_n.KEEP,failOp:_n.KEEP},stencilBack:{compare:Ir.ALWAYS,passOp:_n.KEEP,depthFailOp:_n.KEEP,failOp:_n.KEEP},cullMode:la.NONE,frontFace:Uv.CCW,polygonOffset:!1,polygonOffsetFactor:0,polygonOffsetUnits:0};function kne(e,t){e===void 0&&(e=null),t===void 0&&(t=Zd);var r=$d(t);return e!==null&&Une(r,e),r}kne({depthCompare:Ir.ALWAYS,depthWrite:!1},Zd);var xF={texture:null,sampler:null,formatKind:mn.Float,dimension:dr.TEXTURE_2D};function Sl(e,t,r){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(!r(e[n],t[n]))return!1;return!0}function bd(e,t){for(var r=Array(e.length),n=0;n<e.length;n++)r[n]=t(e[n]);return r}function zne(e,t){return e.texture===t.texture&&e.binding===t.binding}function SP(e,t){return e.buffer===t.buffer&&e.size===t.size&&e.binding===t.binding&&e.offset===t.offset}function jne(e,t){return e===null?t===null:t===null?!1:e.sampler===t.sampler&&e.texture===t.texture&&e.dimension===t.dimension&&e.formatKind===t.formatKind&&e.comparison===t.comparison}function Hne(e,t){return e.samplerBindings=e.samplerBindings||[],e.uniformBufferBindings=e.uniformBufferBindings||[],e.storageBufferBindings=e.storageBufferBindings||[],e.storageTextureBindings=e.storageTextureBindings||[],t.samplerBindings=t.samplerBindings||[],t.uniformBufferBindings=t.uniformBufferBindings||[],t.storageBufferBindings=t.storageBufferBindings||[],t.storageTextureBindings=t.storageTextureBindings||[],!(e.samplerBindings.length!==t.samplerBindings.length||!Sl(e.samplerBindings,t.samplerBindings,jne)||!Sl(e.uniformBufferBindings,t.uniformBufferBindings,SP)||!Sl(e.storageBufferBindings,t.storageBufferBindings,SP)||!Sl(e.storageTextureBindings,t.storageTextureBindings,zne))}function AP(e,t){return e.blendMode==t.blendMode&&e.blendSrcFactor===t.blendSrcFactor&&e.blendDstFactor===t.blendDstFactor}function Vne(e,t){return!(!AP(e.rgbBlendState,t.rgbBlendState)||!AP(e.alphaBlendState,t.alphaBlendState)||e.channelWriteMask!==t.channelWriteMask)}function fg(e,t){return e.compare==t.compare&&e.depthFailOp===t.depthFailOp&&e.failOp===t.failOp&&e.passOp===t.passOp&&e.mask===t.mask}function Xne(e,t){return!Sl(e.attachmentsState,t.attachmentsState,Vne)||e.blendConstant&&t.blendConstant&&!EF(e.blendConstant,t.blendConstant)||e.stencilFront&&t.stencilFront&&!fg(e.stencilFront,t.stencilFront)||e.stencilBack&&t.stencilBack&&!fg(e.stencilBack,t.stencilBack)?!1:e.depthCompare===t.depthCompare&&e.depthWrite===t.depthWrite&&e.stencilWrite===t.stencilWrite&&e.cullMode===t.cullMode&&e.frontFace===t.frontFace&&e.polygonOffset===t.polygonOffset&&e.polygonOffsetFactor===t.polygonOffsetFactor&&e.polygonOffsetUnits===t.polygonOffsetUnits}function RF(e,t){return e.id===t.id}function Gne(e,t){return e===t}function qne(e,t){return!(e.topology!==t.topology||e.inputLayout!==t.inputLayout||e.sampleCount!==t.sampleCount||e.megaStateDescriptor&&t.megaStateDescriptor&&!Xne(e.megaStateDescriptor,t.megaStateDescriptor)||!RF(e.program,t.program)||!Sl(e.colorAttachmentFormats,t.colorAttachmentFormats,Gne)||e.depthStencilAttachmentFormat!==t.depthStencilAttachmentFormat)}function Wne(e,t){return e.offset===t.offset&&e.shaderLocation===t.shaderLocation&&e.format===t.format&&e.divisor===t.divisor}function Yne(e,t){return Za(e)?Za(t):Za(t)?!1:e.arrayStride===t.arrayStride&&e.stepMode===t.stepMode&&Sl(e.attributes,t.attributes,Wne)}function $ne(e,t){return!(e.indexBufferFormat!==t.indexBufferFormat||!Sl(e.vertexBufferDescriptors,t.vertexBufferDescriptors,Yne)||!RF(e.program,t.program))}function Zne(e){var t=e.sampler,r=e.texture,n=e.dimension,i=e.formatKind,a=e.comparison;return{sampler:t,texture:r,dimension:n,formatKind:i,comparison:a}}function bP(e){var t=e.buffer,r=e.size,n=e.binding,i=e.offset;return{binding:n,buffer:t,offset:i,size:r}}function Kne(e){var t=e.binding,r=e.texture;return{binding:t,texture:r}}function Qne(e){var t=e.samplerBindings&&bd(e.samplerBindings,Zne),r=e.uniformBufferBindings&&bd(e.uniformBufferBindings,bP),n=e.storageBufferBindings&&bd(e.storageBufferBindings,bP),i=e.storageTextureBindings&&bd(e.storageTextureBindings,Kne);return{samplerBindings:t,uniformBufferBindings:r,storageBufferBindings:n,storageTextureBindings:i,pipeline:e.pipeline}}function Jne(e){var t=e.inputLayout,r=e.program,n=e.topology,i=e.megaStateDescriptor&&$d(e.megaStateDescriptor),a=e.colorAttachmentFormats.slice(),s=e.depthStencilAttachmentFormat,l=e.sampleCount;return{inputLayout:t,megaStateDescriptor:i,program:r,topology:n,colorAttachmentFormats:a,depthStencilAttachmentFormat:s,sampleCount:l}}function eie(e){var t=e.shaderLocation,r=e.format,n=e.offset,i=e.divisor;return{shaderLocation:t,format:r,offset:n,divisor:i}}function tie(e){if(Za(e))return e;var t=e.arrayStride,r=e.stepMode,n=bd(e.attributes,eie);return{arrayStride:t,stepMode:r,attributes:n}}function rie(e){var t=bd(e.vertexBufferDescriptors,tie),r=e.indexBufferFormat,n=e.program;return{vertexBufferDescriptors:t,indexBufferFormat:r,program:n}}var gr,nie=/([^[]*)(\[[0-9]+\])?/;function iie(e){if(e[e.length-1]!=="]")return{name:e,length:1,isArray:!1};var t=e.match(nie);if(!t||t.length<2)throw new Error("Failed to parse GLSL uniform name ".concat(e));return{name:t[1],length:Number(t[2])||1,isArray:!!t[2]}}function Xi(){var e=null;return function(t,r,n){var i=e!==n;return i&&(t.uniform1i(r,n),e=n),i}}function dn(e,t,r,n){var i=null,a=null;return function(s,l,c){var d=t(c,r),p=d.length,h=!1;if(i===null)i=new Float32Array(p),a=p,h=!0;else{rr(a===p,"Uniform length cannot change.");for(var m=0;m<p;++m)if(d[m]!==i[m]){h=!0;break}}return h&&(n(s,e,l,d),i.set(d)),h}}function Ni(e,t,r,n){e[t](r,n)}function Qs(e,t,r,n){e[t](r,!1,n)}var aie={},oie={},sie={},xP=[0];function LR(e,t,r,n){t===1&&typeof e=="boolean"&&(e=e?1:0),Number.isFinite(e)&&(xP[0]=e,e=xP);var i=e.length;if(e instanceof r)return e;var a=n[i];a||(a=new r(i),n[i]=a);for(var s=0;s<i;s++)a[s]=e[s];return a}function Ta(e,t){return LR(e,t,Float32Array,aie)}function fl(e,t){return LR(e,t,Int32Array,oie)}function G_(e,t){return LR(e,t,Uint32Array,sie)}var uie=(gr={},gr[ee.FLOAT]=dn.bind(null,"uniform1fv",Ta,1,Ni),gr[ee.FLOAT_VEC2]=dn.bind(null,"uniform2fv",Ta,2,Ni),gr[ee.FLOAT_VEC3]=dn.bind(null,"uniform3fv",Ta,3,Ni),gr[ee.FLOAT_VEC4]=dn.bind(null,"uniform4fv",Ta,4,Ni),gr[ee.INT]=dn.bind(null,"uniform1iv",fl,1,Ni),gr[ee.INT_VEC2]=dn.bind(null,"uniform2iv",fl,2,Ni),gr[ee.INT_VEC3]=dn.bind(null,"uniform3iv",fl,3,Ni),gr[ee.INT_VEC4]=dn.bind(null,"uniform4iv",fl,4,Ni),gr[ee.BOOL]=dn.bind(null,"uniform1iv",fl,1,Ni),gr[ee.BOOL_VEC2]=dn.bind(null,"uniform2iv",fl,2,Ni),gr[ee.BOOL_VEC3]=dn.bind(null,"uniform3iv",fl,3,Ni),gr[ee.BOOL_VEC4]=dn.bind(null,"uniform4iv",fl,4,Ni),gr[ee.FLOAT_MAT2]=dn.bind(null,"uniformMatrix2fv",Ta,4,Qs),gr[ee.FLOAT_MAT3]=dn.bind(null,"uniformMatrix3fv",Ta,9,Qs),gr[ee.FLOAT_MAT4]=dn.bind(null,"uniformMatrix4fv",Ta,16,Qs),gr[ee.UNSIGNED_INT]=dn.bind(null,"uniform1uiv",G_,1,Ni),gr[ee.UNSIGNED_INT_VEC2]=dn.bind(null,"uniform2uiv",G_,2,Ni),gr[ee.UNSIGNED_INT_VEC3]=dn.bind(null,"uniform3uiv",G_,3,Ni),gr[ee.UNSIGNED_INT_VEC4]=dn.bind(null,"uniform4uiv",G_,4,Ni),gr[ee.FLOAT_MAT2x3]=dn.bind(null,"uniformMatrix2x3fv",Ta,6,Qs),gr[ee.FLOAT_MAT2x4]=dn.bind(null,"uniformMatrix2x4fv",Ta,8,Qs),gr[ee.FLOAT_MAT3x2]=dn.bind(null,"uniformMatrix3x2fv",Ta,6,Qs),gr[ee.FLOAT_MAT3x4]=dn.bind(null,"uniformMatrix3x4fv",Ta,12,Qs),gr[ee.FLOAT_MAT4x2]=dn.bind(null,"uniformMatrix4x2fv",Ta,8,Qs),gr[ee.FLOAT_MAT4x3]=dn.bind(null,"uniformMatrix4x3fv",Ta,12,Qs),gr[ee.SAMPLER_2D]=Xi,gr[ee.SAMPLER_CUBE]=Xi,gr[ee.SAMPLER_3D]=Xi,gr[ee.SAMPLER_2D_SHADOW]=Xi,gr[ee.SAMPLER_2D_ARRAY]=Xi,gr[ee.SAMPLER_2D_ARRAY_SHADOW]=Xi,gr[ee.SAMPLER_CUBE_SHADOW]=Xi,gr[ee.INT_SAMPLER_2D]=Xi,gr[ee.INT_SAMPLER_3D]=Xi,gr[ee.INT_SAMPLER_CUBE]=Xi,gr[ee.INT_SAMPLER_2D_ARRAY]=Xi,gr[ee.UNSIGNED_INT_SAMPLER_2D]=Xi,gr[ee.UNSIGNED_INT_SAMPLER_3D]=Xi,gr[ee.UNSIGNED_INT_SAMPLER_CUBE]=Xi,gr[ee.UNSIGNED_INT_SAMPLER_2D_ARRAY]=Xi,gr);function RP(e,t,r){var n=uie[r.type];if(!n)throw new Error("Unknown GLSL uniform type ".concat(r.type));return n().bind(null,e,t)}var lie={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121};function cie(e){return Object.prototype.toString.call(e)in lie}function Vp(e,t){return"#define ".concat(e," ").concat(t)}function fie(e){var t={};return e.replace(/^\s*#define\s*(\S*)\s*(\S*)\s*$/gm,function(r,n,i){var a=Number(i);return t[n]=isNaN(a)?i:a,""}),t}function die(e,t){var r=[];return e.replace(/^\s*layout\(location\s*=\s*(\S*)\)\s*in\s+\S+\s*(.*);$/gm,function(n,i,a){var s=Number(i);return r.push({location:isNaN(s)?t[i]:s,name:a}),""}),r}function CP(e){if(e===void 0)return null;var t=/binding\s*=\s*(\d+)/.exec(e);if(t!==null){var r=parseInt(t[1],10);if(!Number.isNaN(r))return r}return null}function OP(e){var t="",r=e;return[r,t]}function Kd(e,t,r,n,i){var a;n===void 0&&(n=null),i===void 0&&(i=!0);var s=e.glslVersion==="#version 100",l=t==="frag"&&((a=r.match(/^\s*layout\(location\s*=\s*\d*\)\s*out\s+vec4\s*(.*);$/gm))===null||a===void 0?void 0:a.length)>1,c=r.replace(`\r
`,`
`).split(`
`).map(function(w){return w.replace(/[/][/].*$/,"")}).filter(function(w){var D=!w||/^\s+$/.test(w);return!D}),d="";n!==null&&(d=Object.keys(n).map(function(w){return Vp(w,n[w])}).join(`
`));var p=c.find(function(w){return w.startsWith("precision")})||"precision mediump float;",h=i?c.filter(function(w){return!w.startsWith("precision")}).join(`
`):c.join(`
`),m="";if(e.viewportOrigin===wo.UPPER_LEFT&&(m+="".concat(Vp("VIEWPORT_ORIGIN_TL","1"),`
`)),e.clipSpaceNearZ===Wd.ZERO&&(m+="".concat(Vp("CLIPSPACE_NEAR_ZERO","1"),`
`)),e.explicitBindingLocations){var _=0,y=0,E=0;h=h.replace(/^\s*(layout\((.*)\))?\s*uniform(.+{)$/gm,function(w,D,U,ae){var Q=U?"".concat(U,", "):"";return"layout(".concat(Q,"set = ").concat(_,", binding = ").concat(y++,") uniform ").concat(ae)}),_++,y=0,rr(e.separateSamplerTextures),h=h.replace(/^\s*(layout\((.*)\))?\s*uniform sampler(\w+) (.*);/gm,function(w,D,U,ae,Q){var X=CP(U);X===null&&(X=y++);var x=Ro(OP(ae),2),P=x[0],H=x[1];return t==="frag"?`
layout(set = `.concat(_,", binding = ").concat(X*2+0,") uniform texture").concat(P," T_").concat(Q,`;
layout(set = `).concat(_,", binding = ").concat(X*2+1,") uniform sampler").concat(H," S_").concat(Q,";").trim():""}),h=h.replace(t==="frag"?/^\s*\b(varying|in)\b/gm:/^\s*\b(varying|out)\b/gm,function(w,D){return"layout(location = ".concat(E++,") ").concat(D)}),m+="".concat(Vp("gl_VertexID","gl_VertexIndex"),`
`),m+="".concat(Vp("gl_InstanceID","gl_InstanceIndex"),`
`),p=p.replace(/^precision (.*) sampler(.*);$/gm,"")}else{var T=0;h=h.replace(/^\s*(layout\((.*)\))?\s*uniform sampler(\w+) (.*);/gm,function(w,D,U,ae,Q){var X=CP(U);return X===null&&(X=T++),"uniform sampler".concat(ae," ").concat(Q,"; // BINDING=").concat(X)})}if(h=h.replace(/\bPU_SAMPLER_(\w+)\((.*?)\)/g,function(w,D,U){return"SAMPLER_".concat(D,"(P_").concat(U,")")}),h=h.replace(/\bPF_SAMPLER_(\w+)\((.*?)\)/g,function(w,D,U){return"PP_SAMPLER_".concat(D,"(P_").concat(U,")")}),h=h.replace(/\bPU_TEXTURE\((.*?)\)/g,function(w,D){return"TEXTURE(P_".concat(D,")")}),e.separateSamplerTextures)h=h.replace(/\bPD_SAMPLER_(\w+)\((.*?)\)/g,function(w,D,U){var ae=Ro(OP(D),2),Q=ae[0],X=ae[1];return"texture".concat(Q," T_P_").concat(U,", sampler").concat(X," S_P_").concat(U)}),h=h.replace(/\bPP_SAMPLER_(\w+)\((.*?)\)/g,function(w,D,U){return"T_".concat(U,", S_").concat(U)}),h=h.replace(/\bSAMPLER_(\w+)\((.*?)\)/g,function(w,D,U){return"sampler".concat(D,"(T_").concat(U,", S_").concat(U,")")}),h=h.replace(/\bTEXTURE\((.*?)\)/g,function(w,D){return"T_".concat(D)});else{var A=[];h=h.replace(/\bPD_SAMPLER_(\w+)\((.*?)\)/g,function(w,D,U){return"sampler".concat(D," P_").concat(U)}),h=h.replace(/\bPP_SAMPLER_(\w+)\((.*?)\)/g,function(w,D,U){return U}),h=h.replace(/\bSAMPLER_(\w+)\((.*?)\)/g,function(w,D,U){return A.push([U,D]),U}),s&&A.forEach(function(w){var D=Ro(w,2),U=D[0],ae=D[1];h=h.replace(new RegExp("texture\\(".concat(U),"g"),function(){return"texture".concat(ae,"(").concat(U)})}),h=h.replace(/\bTEXTURE\((.*?)\)/g,function(w,D){return D})}var b="".concat(s?"":e.glslVersion,`
`).concat(s&&l?`#extension GL_EXT_draw_buffers : require
`:"",`
`).concat(s&&t==="frag"?`#extension GL_OES_standard_derivatives : enable
`:"").concat(i?p:"",`
`).concat(m||"").concat(d?d+`
`:"",`
`).concat(h,`
`).trim();if(e.explicitBindingLocations&&t==="frag"&&(b=b.replace(/^\b(out)\b/g,function(w,D){return"layout(location = 0) ".concat(D)})),s){if(t==="frag"&&(b=b.replace(/^\s*in\s+(\S+)\s*(.*);$/gm,function(w,D,U){return"varying ".concat(D," ").concat(U,`;
`)})),t==="vert"&&(b=b.replace(/^\s*out\s+(\S+)\s*(.*);$/gm,function(w,D,U){return"varying ".concat(D," ").concat(U,`;
`)}),b=b.replace(/^\s*layout\(location\s*=\s*\S*\)\s*in\s+(\S+)\s*(.*);$/gm,function(w,D,U){return"attribute ".concat(D," ").concat(U,`;
`)})),b=b.replace(/\s*uniform\s*.*\s*{((?:\s*.*\s*)*?)};/g,function(w,D){return D.trim().replace(/^.*$/gm,function(U){var ae=U.trim();return ae.startsWith("#")?ae:U?"uniform ".concat(ae):""})}),t==="frag")if(l){var R=[];b=b.replace(/^\s*layout\(location\s*=\s*\d*\)\s*out\s+vec4\s*(.*);$/gm,function(w,D){return R.push(D),"vec4 ".concat(D,`;
`)});var M=b.lastIndexOf("}");b=b.substring(0,M)+`
    `.concat(R.map(function(w,D){return"gl_FragData[".concat(D,"] = ").concat(w,`;
    `)}).join(`
`))+b.substring(M)}else{var B;if(b=b.replace(/^\s*out\s+(\S+)\s*(.*);$/gm,function(w,D,U){return B=U,"".concat(D," ").concat(U,`;
`)}),B){var M=b.lastIndexOf("}");b=b.substring(0,M)+`
  gl_FragColor = vec4(`.concat(B,`);
`)+b.substring(M)}}b=b.replace(/^\s*layout\((.*)\)/gm,"")}return b}var eo=(function(e){En(t,e);function t(r){var n=r.id,i=r.device,a=e.call(this)||this;return a.id=n,a.device=i,a.device.resourceCreationTracker!==null&&a.device.resourceCreationTracker.trackResourceCreated(a),a}return t.prototype.destroy=function(){this.device.resourceCreationTracker!==null&&this.device.resourceCreationTracker.trackResourceDestroyed(this)},t})(mF),hie=(function(e){En(t,e);function t(r){var n=r.id,i=r.device,a=r.descriptor,s=e.call(this,{id:n,device:i})||this;s.type=Cr.Bindings;var l=a.uniformBufferBindings,c=a.samplerBindings;return s.uniformBufferBindings=l||[],s.samplerBindings=c||[],s.bindingLayouts=s.createBindingLayouts(),s}return t.prototype.createBindingLayouts=function(){var r=0,n=0,i=[],a=this.uniformBufferBindings.length,s=this.samplerBindings.length;return i.push({firstUniformBuffer:r,numUniformBuffers:a,firstSampler:n,numSamplers:s}),r+=a,n+=s,{numUniformBuffers:r,numSamplers:n,bindingLayoutTables:i}},t})(eo),Xp;function Pt(e){return Xp!==void 0?Xp:typeof WebGL2RenderingContext<"u"&&e instanceof WebGL2RenderingContext?(Xp=!0,!0):(Xp=!!(e&&e._version===2),Xp)}function CF(e){var t=gs(e);switch(t){case Ye.BC1:case Ye.BC2:case Ye.BC3:case Ye.BC4_UNORM:case Ye.BC4_SNORM:case Ye.BC5_UNORM:case Ye.BC5_SNORM:return!0;default:return!1}}function OF(e){var t=Yd(e);if(t&At.Normalized)return!1;var r=gs(e);return r===Ye.S8||r===Ye.S16||r===Ye.S32||r===Ye.U8||r===Ye.U16||r===Ye.U32}function pie(e){switch(e){case No.STATIC:return ee.STATIC_DRAW;case No.DYNAMIC:return ee.DYNAMIC_DRAW}}function MP(e){if(e&Xr.INDEX)return ee.ELEMENT_ARRAY_BUFFER;if(e&Xr.VERTEX)return ee.ARRAY_BUFFER;if(e&Xr.UNIFORM)return ee.UNIFORM_BUFFER}function vie(e){switch(e){case Fn.TRIANGLES:return ee.TRIANGLES;case Fn.POINTS:return ee.POINTS;case Fn.TRIANGLE_STRIP:return ee.TRIANGLE_STRIP;case Fn.LINES:return ee.LINES;case Fn.LINE_STRIP:return ee.LINE_STRIP;default:throw new Error("Unknown primitive topology mode")}}function mie(e){switch(e){case Ye.U8:return ee.UNSIGNED_BYTE;case Ye.U16:return ee.UNSIGNED_SHORT;case Ye.U32:return ee.UNSIGNED_INT;case Ye.S8:return ee.BYTE;case Ye.S16:return ee.SHORT;case Ye.S32:return ee.INT;case Ye.F16:return ee.HALF_FLOAT;case Ye.F32:return ee.FLOAT;default:throw new Error("whoops")}}function _ie(e){switch(e){case wt.R:return 1;case wt.RG:return 2;case wt.RGB:return 3;case wt.RGBA:return 4;default:return 1}}function gie(e){var t=gs(e),r=DR(e),n=Yd(e),i=mie(t),a=_ie(r),s=!!(n&At.Normalized);return{size:a,type:i,normalized:s}}function yie(e){switch(e){case he.U8_R:return ee.UNSIGNED_BYTE;case he.U16_R:return ee.UNSIGNED_SHORT;case he.U32_R:return ee.UNSIGNED_INT;default:throw new Error("whoops")}}function Gp(e){switch(e){case qi.CLAMP_TO_EDGE:return ee.CLAMP_TO_EDGE;case qi.REPEAT:return ee.REPEAT;case qi.MIRRORED_REPEAT:return ee.MIRRORED_REPEAT;default:throw new Error("whoops")}}function q_(e,t){if(t===qn.LINEAR&&e===Rn.BILINEAR)return ee.LINEAR_MIPMAP_LINEAR;if(t===qn.LINEAR&&e===Rn.POINT)return ee.NEAREST_MIPMAP_LINEAR;if(t===qn.NEAREST&&e===Rn.BILINEAR)return ee.LINEAR_MIPMAP_NEAREST;if(t===qn.NEAREST&&e===Rn.POINT)return ee.NEAREST_MIPMAP_NEAREST;if(t===qn.NO_MIP&&e===Rn.BILINEAR)return ee.LINEAR;if(t===qn.NO_MIP&&e===Rn.POINT)return ee.NEAREST;throw new Error("Unknown texture filter mode")}function Dd(e,t){t===void 0&&(t=0);var r=e;return r.gl_buffer_pages[t/r.pageByteSize|0]}function Sd(e){var t=e;return t.gl_texture}function px(e){var t=e;return t.gl_sampler}function qp(e,t){e.name=t,e.__SPECTOR_Metadata={name:t}}function wP(e,t){for(var r=[];;){var n=t.exec(e);if(!n)break;r.push(n)}return r}function dl(e){return e.blendMode==ti.ADD&&e.blendSrcFactor==fr.ONE&&e.blendDstFactor===fr.ZERO}function Eie(e){switch(e){case sg.OcclusionConservative:return ee.ANY_SAMPLES_PASSED_CONSERVATIVE;default:throw new Error("whoops")}}function Tie(e){if(e===dr.TEXTURE_2D)return ee.TEXTURE_2D;if(e===dr.TEXTURE_2D_ARRAY)return ee.TEXTURE_2D_ARRAY;if(e===dr.TEXTURE_CUBE_MAP)return ee.TEXTURE_CUBE_MAP;if(e===dr.TEXTURE_3D)return ee.TEXTURE_3D;throw new Error("whoops")}function JA(e,t,r,n){return!(e%r!==0||t%n!==0)}var Sie=(function(e){En(t,e);function t(r){var n=r.id,i=r.device,a=r.descriptor,s=e.call(this,{id:n,device:i})||this;s.type=Cr.Buffer;var l=a.viewOrSize,c=a.usage,d=a.hint,p=d===void 0?No.STATIC:d,h=i.uniformBufferMaxPageByteSize,m=i.gl,_=c&Xr.UNIFORM;_||(Pt(m)?m.bindVertexArray(null):i.OES_vertex_array_object.bindVertexArrayOES(null));var y=Ad(l)?lg(l,4):lg(l.byteLength,4);s.gl_buffer_pages=[];var E;if(_){for(var T=y;T>0;)s.gl_buffer_pages.push(s.createBufferPage(Math.min(T,h),c,p)),T-=h;E=h}else s.gl_buffer_pages.push(s.createBufferPage(y,c,p)),E=y;return s.pageByteSize=E,s.byteSize=y,s.usage=c,s.gl_target=MP(c),Ad(l)||s.setSubData(0,new Uint8Array(l.buffer)),_||(Pt(m)?m.bindVertexArray(s.device.currentBoundVAO):i.OES_vertex_array_object.bindVertexArrayOES(s.device.currentBoundVAO)),s}return t.prototype.setSubData=function(r,n,i,a){i===void 0&&(i=0),a===void 0&&(a=n.byteLength-i);for(var s=this.device.gl,l=this.pageByteSize,c=r+a,d=r,p=r%l;d<c;){var h=Pt(s)?s.COPY_WRITE_BUFFER:this.gl_target,m=Dd(this,d);if(m.ubo)return;s.bindBuffer(h,m),Pt(s)?s.bufferSubData(h,p,n,i,Math.min(c-d,l)):s.bufferSubData(h,p,n),d+=l,p=0,i+=l,this.device.debugGroupStatisticsBufferUpload()}},t.prototype.destroy=function(){e.prototype.destroy.call(this);for(var r=0;r<this.gl_buffer_pages.length;r++)this.gl_buffer_pages[r].ubo||this.device.gl.deleteBuffer(this.gl_buffer_pages[r]);this.gl_buffer_pages=[]},t.prototype.createBufferPage=function(r,n,i){var a=this.device.gl,s=n&Xr.UNIFORM;if(!Pt(a)&&s)return{ubo:!0};var l=this.device.ensureResourceExists(a.createBuffer()),c=MP(n),d=pie(i);return a.bindBuffer(c,l),a.bufferData(c,r,d),l},t})(eo),Aie=(function(e){En(t,e);function t(r){var n,i,a,s,l=r.id,c=r.device,d=r.descriptor,p,h=e.call(this,{id:l,device:c})||this;h.type=Cr.InputLayout;var m=d.vertexBufferDescriptors,_=d.indexBufferFormat,y=d.program;rr(_===he.U16_R||_===he.U32_R||_===null);var E=_!==null?yie(_):null,T=_!==null?gF(_):null,A=h.device.gl,b=h.device.ensureResourceExists(Pt(A)?A.createVertexArray():c.OES_vertex_array_object.createVertexArrayOES());Pt(A)?A.bindVertexArray(b):c.OES_vertex_array_object.bindVertexArrayOES(b),A.bindBuffer(A.ARRAY_BUFFER,Dd(h.device.fallbackVertexBuffer));try{for(var R=Hc(d.vertexBufferDescriptors),M=R.next();!M.done;M=R.next()){var B=M.value,w=B.stepMode,D=B.attributes;try{for(var U=(a=void 0,Hc(D)),ae=U.next();!ae.done;ae=U.next()){var Q=ae.value,X=Q.shaderLocation,x=Q.format,P=Q.divisor,H=P===void 0?1:P,pe=Pt(A)?X:(p=y.attributes[X])===null||p===void 0?void 0:p.location,O=gie(x);if(Q.vertexFormat=O,!Za(pe)){OF(x);var F=O.size,z=O.type,re=O.normalized;A.vertexAttribPointer(pe,F,z,re,0,0),w===Vc.INSTANCE&&(Pt(A)?A.vertexAttribDivisor(pe,H):c.ANGLE_instanced_arrays.vertexAttribDivisorANGLE(pe,H)),A.enableVertexAttribArray(pe)}}}catch(oe){a={error:oe}}finally{try{ae&&!ae.done&&(s=U.return)&&s.call(U)}finally{if(a)throw a.error}}}}catch(oe){n={error:oe}}finally{try{M&&!M.done&&(i=R.return)&&i.call(R)}finally{if(n)throw n.error}}return Pt(A)?A.bindVertexArray(null):c.OES_vertex_array_object.bindVertexArrayOES(null),h.vertexBufferDescriptors=m,h.vao=b,h.indexBufferFormat=_,h.indexBufferType=E,h.indexBufferCompByteSize=T,h.program=y,h}return t.prototype.destroy=function(){e.prototype.destroy.call(this),this.device.currentBoundVAO===this.vao&&(Pt(this.device.gl)?(this.device.gl.bindVertexArray(null),this.device.gl.deleteVertexArray(this.vao)):(this.device.OES_vertex_array_object.bindVertexArrayOES(null),this.device.OES_vertex_array_object.deleteVertexArrayOES(this.vao)),this.device.currentBoundVAO=null)},t})(eo),vx=(function(e){En(t,e);function t(r){var n=r.id,i=r.device,a=r.descriptor,s=r.fake,l=e.call(this,{id:n,device:i})||this;l.type=Cr.Texture,a=pn({dimension:dr.TEXTURE_2D,depthOrArrayLayers:1,mipLevelCount:1},a);var c=l.device.gl,d,p,h=l.clampmipLevelCount(a);if(l.immutable=a.usage===Pi.RENDER_TARGET,l.pixelStore=a.pixelStore,l.format=a.format,l.dimension=a.dimension,l.formatKind=yF(a.format),l.width=a.width,l.height=a.height,l.depthOrArrayLayers=a.depthOrArrayLayers,l.mipmaps=h>=1,!s){p=l.device.ensureResourceExists(c.createTexture());var m=l.device.translateTextureType(a.format),_=l.device.translateTextureInternalFormat(a.format);if(l.device.setActiveTexture(c.TEXTURE0),l.device.currentTextures[0]=null,l.preprocessImage(),a.dimension===dr.TEXTURE_2D){if(d=ee.TEXTURE_2D,c.bindTexture(d,p),l.immutable)if(Pt(c))c.texStorage2D(d,h,_,a.width,a.height);else{var y=(_===ee.DEPTH_COMPONENT||l.isNPOT(),0);(l.format===he.D32F||l.format===he.D24_S8)&&!Pt(c)&&!i.WEBGL_depth_texture||(c.texImage2D(d,y,_,a.width,a.height,0,_,m,null),l.mipmaps&&(l.mipmaps=!1,c.texParameteri(ee.TEXTURE_2D,ee.TEXTURE_MIN_FILTER,ee.LINEAR),c.texParameteri(ee.TEXTURE_2D,ee.TEXTURE_WRAP_S,ee.CLAMP_TO_EDGE),c.texParameteri(ee.TEXTURE_2D,ee.TEXTURE_WRAP_T,ee.CLAMP_TO_EDGE)))}rr(a.depthOrArrayLayers===1)}else if(a.dimension===dr.TEXTURE_2D_ARRAY)d=ee.TEXTURE_2D_ARRAY,c.bindTexture(d,p),l.immutable&&Pt(c)&&c.texStorage3D(d,h,_,a.width,a.height,a.depthOrArrayLayers);else if(a.dimension===dr.TEXTURE_3D)d=ee.TEXTURE_3D,c.bindTexture(d,p),l.immutable&&Pt(c)&&c.texStorage3D(d,h,_,a.width,a.height,a.depthOrArrayLayers);else if(a.dimension===dr.TEXTURE_CUBE_MAP)d=ee.TEXTURE_CUBE_MAP,c.bindTexture(d,p),l.immutable&&Pt(c)&&c.texStorage2D(d,h,_,a.width,a.height),rr(a.depthOrArrayLayers===6);else throw new Error("whoops")}return l.gl_texture=p,l.gl_target=d,l.mipLevelCount=h,l}return t.prototype.setImageData=function(r,n){n===void 0&&(n=0);var i=this.device.gl;CF(this.format);var a=this.gl_target===ee.TEXTURE_3D||this.gl_target===ee.TEXTURE_2D_ARRAY,s=this.gl_target===ee.TEXTURE_CUBE_MAP,l=cie(r[0]);this.device.setActiveTexture(i.TEXTURE0),this.device.currentTextures[0]=null;var c=r[0],d,p;l?(d=this.width,p=this.height):(d=c.width,p=c.height,this.width=d,this.height=p),i.bindTexture(this.gl_target,this.gl_texture);var h=this.device.translateTextureFormat(this.format),m=Pt(i)?this.device.translateInternalTextureFormat(this.format):h,_=this.device.translateTextureType(this.format);this.preprocessImage();for(var y=0;y<this.depthOrArrayLayers;y++){var E=r[y],T=this.gl_target;s&&(T=ee.TEXTURE_CUBE_MAP_POSITIVE_X+y%6),this.immutable?i.texSubImage2D(T,n,0,0,d,p,h,_,E):Pt(i)?a?i.texImage3D(T,n,m,d,p,this.depthOrArrayLayers,0,h,_,E):i.texImage2D(T,n,m,d,p,0,h,_,E):l?i.texImage2D(T,n,h,d,p,0,h,_,E):i.texImage2D(T,n,h,h,_,E)}this.mipmaps&&this.generateMipmap(a)},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.device.gl.deleteTexture(Sd(this))},t.prototype.clampmipLevelCount=function(r){if(r.dimension===dr.TEXTURE_2D_ARRAY&&r.depthOrArrayLayers>1){var n=gs(r.format);if(n===Ye.BC1)for(var i=r.width,a=r.height,s=0;s<r.mipLevelCount;s++){if(i<=2||a<=2)return s-1;i=Math.max(i/2|0,1),a=Math.max(a/2|0,1)}}return r.mipLevelCount},t.prototype.preprocessImage=function(){var r=this.device.gl;this.pixelStore&&(this.pixelStore.unpackFlipY&&r.pixelStorei(ee.UNPACK_FLIP_Y_WEBGL,!0),this.pixelStore.packAlignment&&r.pixelStorei(ee.PACK_ALIGNMENT,this.pixelStore.packAlignment),this.pixelStore.unpackAlignment&&r.pixelStorei(ee.UNPACK_ALIGNMENT,this.pixelStore.unpackAlignment))},t.prototype.generateMipmap=function(r){r===void 0&&(r=!1);var n=this.device.gl;return!Pt(n)&&this.isNPOT()?this:(this.gl_texture&&this.gl_target&&(n.bindTexture(this.gl_target,this.gl_texture),r?(n.texParameteri(this.gl_target,ee.TEXTURE_BASE_LEVEL,0),n.texParameteri(this.gl_target,ee.TEXTURE_MAX_LEVEL,Math.log2(this.width)),n.texParameteri(this.gl_target,ee.TEXTURE_MIN_FILTER,ee.LINEAR_MIPMAP_LINEAR),n.texParameteri(this.gl_target,ee.TEXTURE_MAG_FILTER,ee.LINEAR)):n.texParameteri(ee.TEXTURE_2D,ee.TEXTURE_MIN_FILTER,ee.NEAREST_MIPMAP_LINEAR),n.generateMipmap(this.gl_target),n.bindTexture(this.gl_target,null)),this)},t.prototype.isNPOT=function(){var r=this.device.gl;return Pt(r)?!1:!ug(this.width)||!ug(this.height)},t})(eo),bie=(function(e){En(t,e);function t(r){var n=r.id,i=r.device,a=r.descriptor,s=e.call(this,{id:n,device:i})||this;s.type=Cr.RenderTarget,s.gl_renderbuffer=null,s.texture=null;var l=s.device.gl,c=a.format,d=a.width,p=a.height,h=a.sampleCount,m=h===void 0?1:h,_=a.texture,y=!1;if((c===he.D32F||c===he.D24_S8)&&_&&!Pt(l)&&!i.WEBGL_depth_texture&&(_.destroy(),s.texture=null,y=!0),!y&&_)s.texture=_;else{s.gl_renderbuffer=s.device.ensureResourceExists(l.createRenderbuffer()),l.bindRenderbuffer(l.RENDERBUFFER,s.gl_renderbuffer);var E=s.device.translateTextureInternalFormat(c,!0);Pt(l)&&m>1?l.renderbufferStorageMultisample(ee.RENDERBUFFER,m,E,d,p):l.renderbufferStorage(ee.RENDERBUFFER,E,d,p)}return s.format=c,s.width=d,s.height=p,s.sampleCount=m,s}return t.prototype.destroy=function(){e.prototype.destroy.call(this),this.gl_renderbuffer!==null&&this.device.gl.deleteRenderbuffer(this.gl_renderbuffer),this.texture&&this.texture.destroy()},t})(eo),aa;(function(e){e[e.NeedsCompile=0]="NeedsCompile",e[e.Compiling=1]="Compiling",e[e.NeedsBind=2]="NeedsBind",e[e.ReadyToUse=3]="ReadyToUse"})(aa||(aa={}));var xie=(function(e){En(t,e);function t(r,n){var i=r.id,a=r.device,s=r.descriptor,l=e.call(this,{id:i,device:a})||this;l.rawVertexGLSL=n,l.type=Cr.Program,l.uniformSetters={},l.attributes=[];var c=l.device.gl;return l.descriptor=s,l.gl_program=l.device.ensureResourceExists(c.createProgram()),l.gl_shader_vert=null,l.gl_shader_frag=null,l.compileState=aa.NeedsCompile,l.tryCompileProgram(),l}return t.prototype.destroy=function(){e.prototype.destroy.call(this),this.device.gl.deleteProgram(this.gl_program),this.device.gl.deleteShader(this.gl_shader_vert),this.device.gl.deleteShader(this.gl_shader_frag)},t.prototype.tryCompileProgram=function(){rr(this.compileState===aa.NeedsCompile);var r=this.descriptor,n=r.vertex,i=r.fragment,a=this.device.gl;n?.glsl&&i?.glsl&&(this.gl_shader_vert=this.compileShader(n.postprocess?n.postprocess(n.glsl):n.glsl,a.VERTEX_SHADER),this.gl_shader_frag=this.compileShader(i.postprocess?i.postprocess(i.glsl):i.glsl,a.FRAGMENT_SHADER),a.attachShader(this.gl_program,this.gl_shader_vert),a.attachShader(this.gl_program,this.gl_shader_frag),a.linkProgram(this.gl_program),this.compileState=aa.Compiling,Pt(a)||(this.readUniformLocationsFromLinkedProgram(),this.readAttributesFromLinkedProgram()))},t.prototype.readAttributesFromLinkedProgram=function(){for(var r,n=this.device.gl,i=n.getProgramParameter(this.gl_program,n.ACTIVE_ATTRIBUTES),a=fie(this.descriptor.vertex.glsl),s=die(this.rawVertexGLSL,a),l=function(p){var h=n.getActiveAttrib(c.gl_program,p),m=h.name,_=h.type,y=h.size,E=n.getAttribLocation(c.gl_program,m),T=(r=s.find(function(A){return A.name===m}))===null||r===void 0?void 0:r.location;E>=0&&!Za(T)&&(c.attributes[T]={name:m,location:E,type:_,size:y})},c=this,d=0;d<i;d++)l(d)},t.prototype.readUniformLocationsFromLinkedProgram=function(){for(var r=this.device.gl,n=r.getProgramParameter(this.gl_program,r.ACTIVE_UNIFORMS),i=0;i<n;i++){var a=r.getActiveUniform(this.gl_program,i),s=iie(a.name).name,l=r.getUniformLocation(this.gl_program,s);if(this.uniformSetters[s]=RP(r,l,a),a&&a.size>1)for(var c=0;c<a.size;c++)l=r.getUniformLocation(this.gl_program,"".concat(s,"[").concat(c,"]")),this.uniformSetters["".concat(s,"[").concat(c,"]")]=RP(r,l,a)}},t.prototype.compileShader=function(r,n){var i=this.device.gl,a=this.device.ensureResourceExists(i.createShader(n));return i.shaderSource(a,r),i.compileShader(a),a},t.prototype.setUniformsLegacy=function(r){r===void 0&&(r={});var n=this.device.gl;if(!Pt(n)){var i=!1;for(var a in r){i||(n.useProgram(this.gl_program),i=!0);var s=r[a],l=this.uniformSetters[a];if(l){var c=s;c instanceof vx&&(c=c.textureIndex),l(c)}}}return this},t})(eo),Rie=(function(e){En(t,e);function t(r){var n=r.id,i=r.device,a=r.descriptor,s=e.call(this,{id:n,device:i})||this;s.type=Cr.QueryPool;var l=s.device.gl;if(Pt(l)){var c=a.elemCount,d=a.type;s.gl_query=Lne(c,function(){return s.device.ensureResourceExists(l.createQuery())}),s.gl_query_type=Eie(d)}return s}return t.prototype.queryResultOcclusion=function(r){var n=this.device.gl;if(Pt(n)){var i=this.gl_query[r];return n.getQueryParameter(i,n.QUERY_RESULT_AVAILABLE)?!!n.getQueryParameter(i,n.QUERY_RESULT):null}return null},t.prototype.destroy=function(){e.prototype.destroy.call(this);var r=this.device.gl;if(Pt(r))for(var n=0;n<this.gl_query.length;n++)r.deleteQuery(this.gl_query[n])},t})(eo),Cie=(function(e){En(t,e);function t(r){var n=r.id,i=r.device,a=e.call(this,{id:n,device:i})||this;return a.type=Cr.Readback,a.gl_pbo=null,a.gl_sync=null,a}return t.prototype.clientWaitAsync=function(r,n,i){n===void 0&&(n=0),i===void 0&&(i=10);var a=this.device.gl;return new Promise(function(s,l){function c(){var d=a.clientWaitSync(r,n,0);if(d==a.WAIT_FAILED){l();return}if(d==a.TIMEOUT_EXPIRED){setTimeout(c,One(i,0,a.MAX_CLIENT_WAIT_TIMEOUT_WEBGL));return}s()}c()})},t.prototype.getBufferSubDataAsync=function(r,n,i,a,s,l){return Id(this,void 0,void 0,function(){var c;return Pd(this,function(d){switch(d.label){case 0:return c=this.device.gl,Pt(c)?(this.gl_sync=c.fenceSync(c.SYNC_GPU_COMMANDS_COMPLETE,0),c.flush(),[4,this.clientWaitAsync(this.gl_sync,0,10)]):[3,2];case 1:return d.sent(),c.bindBuffer(r,n),c.getBufferSubData(r,i,a,s,l),c.bindBuffer(r,null),[2,a];case 2:return[2]}})})},t.prototype.readTexture=function(r,n,i,a,s,l,c,d){return c===void 0&&(c=0),d===void 0&&(d=l.byteLength||0),Id(this,void 0,void 0,function(){var p,h,m,_,y;return Pd(this,function(E){return p=this.device.gl,h=r,m=this.device.translateTextureFormat(h.format),_=this.device.translateTextureType(h.format),y=Ine(h.format),Pt(p)?(this.gl_pbo=this.device.ensureResourceExists(p.createBuffer()),p.bindBuffer(p.PIXEL_PACK_BUFFER,this.gl_pbo),p.bufferData(p.PIXEL_PACK_BUFFER,d,p.STREAM_READ),p.bindBuffer(p.PIXEL_PACK_BUFFER,null),p.bindFramebuffer(ee.READ_FRAMEBUFFER,this.device.readbackFramebuffer),p.framebufferTexture2D(ee.READ_FRAMEBUFFER,ee.COLOR_ATTACHMENT0,ee.TEXTURE_2D,h.gl_texture,0),p.bindBuffer(p.PIXEL_PACK_BUFFER,this.gl_pbo),p.readPixels(n,i,a,s,m,_,c*y),p.bindBuffer(p.PIXEL_PACK_BUFFER,null),[2,this.getBufferSubDataAsync(p.PIXEL_PACK_BUFFER,this.gl_pbo,0,l,c,0)]):[2,this.readTextureSync(r,n,i,a,s,l,c,d)]})})},t.prototype.readTextureSync=function(r,n,i,a,s,l,c,d){d===void 0&&(d=l.byteLength||0);var p=this.device.gl,h=r,m=this.device.translateTextureType(h.format);return p.bindFramebuffer(ee.FRAMEBUFFER,this.device.readbackFramebuffer),p.framebufferTexture2D(ee.FRAMEBUFFER,ee.COLOR_ATTACHMENT0,ee.TEXTURE_2D,h.gl_texture,0),p.pixelStorei(p.PACK_ALIGNMENT,4),p.readPixels(n,i,a,s,p.RGBA,m,l),l},t.prototype.readBuffer=function(r,n,i,a,s){return Id(this,void 0,void 0,function(){var l;return Pd(this,function(c){return l=this.device.gl,Pt(l)?[2,this.getBufferSubDataAsync(l.ARRAY_BUFFER,Dd(r,n),n,i,a,s)]:[2,Promise.reject()]})})},t.prototype.destroy=function(){e.prototype.destroy.call(this),Pt(this.device.gl)&&(this.gl_sync!==null&&this.device.gl.deleteSync(this.gl_sync),this.gl_pbo!==null&&this.device.gl.deleteBuffer(this.gl_pbo))},t})(eo),Oie=(function(e){En(t,e);function t(r){var n=r.id,i=r.device,a=r.descriptor,s,l,c=e.call(this,{id:n,device:i})||this;return c.type=Cr.RenderPipeline,c.drawMode=vie((s=a.topology)!==null&&s!==void 0?s:Fn.TRIANGLES),c.program=a.program,c.inputLayout=a.inputLayout,c.megaState=pn(pn({},$d(Zd)),a.megaStateDescriptor),c.colorAttachmentFormats=a.colorAttachmentFormats.slice(),c.depthStencilAttachmentFormat=a.depthStencilAttachmentFormat,c.sampleCount=(l=a.sampleCount)!==null&&l!==void 0?l:1,c}return t})(eo),Mie=(function(e){En(t,e);function t(r){var n=r.id,i=r.device,a=r.descriptor,s=e.call(this,{id:n,device:i})||this;return s.type=Cr.ComputePipeline,s.descriptor=a,s}return t})(eo),wie=(function(){function e(){this.liveObjects=new Set,this.creationStacks=new Map,this.deletionStacks=new Map}return e.prototype.trackResourceCreated=function(t){this.creationStacks.set(t,new Error().stack),this.liveObjects.add(t)},e.prototype.trackResourceDestroyed=function(t){this.deletionStacks.has(t)&&console.warn("Object double freed:",t,`

Creation stack: `,this.creationStacks.get(t),`

Deletion stack: `,this.deletionStacks.get(t),`

This stack: `,new Error().stack),this.deletionStacks.set(t,new Error().stack),this.liveObjects.delete(t)},e.prototype.checkForLeaks=function(){var t,r;try{for(var n=Hc(this.liveObjects.values()),i=n.next();!i.done;i=n.next()){var a=i.value;console.warn("Object leaked:",a,"Creation stack:",this.creationStacks.get(a))}}catch(s){t={error:s}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(t)throw t.error}}},e.prototype.setResourceLeakCheck=function(t,r){r?this.liveObjects.add(t):this.liveObjects.delete(t)},e})(),Nie=(function(e){En(t,e);function t(r){var n=r.id,i=r.device,a=r.descriptor,s,l,c=e.call(this,{id:n,device:i})||this;c.type=Cr.Sampler;var d=c.device.gl;if(Pt(d)){var p=c.device.ensureResourceExists(d.createSampler());d.samplerParameteri(p,ee.TEXTURE_WRAP_S,Gp(a.addressModeU)),d.samplerParameteri(p,ee.TEXTURE_WRAP_T,Gp(a.addressModeV)),d.samplerParameteri(p,ee.TEXTURE_WRAP_R,Gp((s=a.addressModeW)!==null&&s!==void 0?s:a.addressModeU)),d.samplerParameteri(p,ee.TEXTURE_MIN_FILTER,q_(a.minFilter,a.mipmapFilter)),d.samplerParameteri(p,ee.TEXTURE_MAG_FILTER,q_(a.magFilter,qn.NO_MIP)),a.lodMinClamp!==void 0&&d.samplerParameterf(p,ee.TEXTURE_MIN_LOD,a.lodMinClamp),a.lodMaxClamp!==void 0&&d.samplerParameterf(p,ee.TEXTURE_MAX_LOD,a.lodMaxClamp),a.compareFunction!==void 0&&(d.samplerParameteri(p,d.TEXTURE_COMPARE_MODE,d.COMPARE_REF_TO_TEXTURE),d.samplerParameteri(p,d.TEXTURE_COMPARE_FUNC,a.compareFunction));var h=(l=a.maxAnisotropy)!==null&&l!==void 0?l:1;h>1&&c.device.EXT_texture_filter_anisotropic!==null&&(rr(a.minFilter===Rn.BILINEAR&&a.magFilter===Rn.BILINEAR&&a.mipmapFilter===qn.LINEAR),d.samplerParameterf(p,c.device.EXT_texture_filter_anisotropic.TEXTURE_MAX_ANISOTROPY_EXT,h)),c.gl_sampler=p}else c.descriptor=a;return c}return t.prototype.setTextureParameters=function(r,n,i){var a,s=this.device.gl,l=this.descriptor;this.isNPOT(n,i)?s.texParameteri(ee.TEXTURE_2D,ee.TEXTURE_MIN_FILTER,ee.LINEAR):s.texParameteri(r,ee.TEXTURE_MIN_FILTER,q_(l.minFilter,l.mipmapFilter)),s.texParameteri(ee.TEXTURE_2D,ee.TEXTURE_WRAP_S,Gp(l.addressModeU)),s.texParameteri(ee.TEXTURE_2D,ee.TEXTURE_WRAP_T,Gp(l.addressModeV)),s.texParameteri(r,ee.TEXTURE_MAG_FILTER,q_(l.magFilter,qn.NO_MIP));var c=(a=l.maxAnisotropy)!==null&&a!==void 0?a:1;c>1&&this.device.EXT_texture_filter_anisotropic!==null&&(rr(l.minFilter===Rn.BILINEAR&&l.magFilter===Rn.BILINEAR&&l.mipmapFilter===qn.LINEAR),s.texParameteri(r,this.device.EXT_texture_filter_anisotropic.TEXTURE_MAX_ANISOTROPY_EXT,c))},t.prototype.destroy=function(){e.prototype.destroy.call(this),Pt(this.device.gl)&&this.device.gl.deleteSampler(px(this))},t.prototype.isNPOT=function(r,n){return!ug(r)||!ug(n)},t})(eo),Iie=(function(){function e(){}return e.prototype.dispatchWorkgroups=function(t,r,n){},e.prototype.dispatchWorkgroupsIndirect=function(t,r){},e.prototype.setPipeline=function(t){},e.prototype.setBindings=function(t){},e.prototype.pushDebugGroup=function(t){},e.prototype.popDebugGroup=function(){},e.prototype.insertDebugMarker=function(t){},e})(),Pie=(function(e){En(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=Cr.RenderBundle,r.commands=[],r}return t.prototype.push=function(r){this.commands.push(r)},t.prototype.replay=function(){this.commands.forEach(function(r){return r()})},t})(eo),NP=65536,Die=/uniform(?:\s+)(\w+)(?:\s?){([^]*?)}/g,Lie=(function(){function e(t,r){r===void 0&&(r={}),this.shaderDebug=!1,this.OES_vertex_array_object=null,this.ANGLE_instanced_arrays=null,this.OES_texture_float=null,this.OES_draw_buffers_indexed=null,this.WEBGL_draw_buffers=null,this.WEBGL_depth_texture=null,this.WEBGL_color_buffer_float=null,this.EXT_color_buffer_half_float=null,this.WEBGL_compressed_texture_s3tc=null,this.WEBGL_compressed_texture_s3tc_srgb=null,this.EXT_texture_compression_rgtc=null,this.EXT_texture_filter_anisotropic=null,this.KHR_parallel_shader_compile=null,this.EXT_texture_norm16=null,this.EXT_color_buffer_float=null,this.OES_texture_float_linear=null,this.OES_texture_half_float_linear=null,this.scTexture=null,this.scPlatformFramebuffer=null,this.currentActiveTexture=null,this.currentBoundVAO=null,this.currentProgram=null,this.resourceCreationTracker=null,this.resourceUniqueId=0,this.currentColorAttachments=[],this.currentColorAttachmentLevels=[],this.currentColorResolveTos=[],this.currentColorResolveToLevels=[],this.currentSampleCount=-1,this.currentIndexBufferByteOffset=null,this.currentMegaState=$d(Zd),this.currentSamplers=[],this.currentTextures=[],this.currentUniformBuffers=[],this.currentUniformBufferByteOffsets=[],this.currentUniformBufferByteSizes=[],this.currentScissorEnabled=!1,this.currentStencilRef=null,this.currentRenderPassDescriptor=null,this.currentRenderPassDescriptorStack=[],this.debugGroupStack=[],this.resolveColorAttachmentsChanged=!1,this.resolveDepthStencilAttachmentsChanged=!1,this.explicitBindingLocations=!1,this.separateSamplerTextures=!1,this.viewportOrigin=wo.LOWER_LEFT,this.clipSpaceNearZ=Wd.NEGATIVE_ONE,this.supportMRT=!1,this.inBlitRenderPass=!1,this.supportedSampleCounts=[],this.occlusionQueriesRecommended=!1,this.computeShadersSupported=!1,this.gl=t,this.contextAttributes=wc(t.getContextAttributes()),Pt(t)?(this.EXT_texture_norm16=t.getExtension("EXT_texture_norm16"),this.EXT_color_buffer_float=t.getExtension("EXT_color_buffer_float")):(this.OES_vertex_array_object=t.getExtension("OES_vertex_array_object"),this.ANGLE_instanced_arrays=t.getExtension("ANGLE_instanced_arrays"),this.OES_texture_float=t.getExtension("OES_texture_float"),this.WEBGL_draw_buffers=t.getExtension("WEBGL_draw_buffers"),this.WEBGL_depth_texture=t.getExtension("WEBGL_depth_texture"),this.WEBGL_color_buffer_float=t.getExtension("WEBGL_color_buffer_float"),this.EXT_color_buffer_half_float=t.getExtension("EXT_color_buffer_half_float"),t.getExtension("EXT_frag_depth"),t.getExtension("OES_element_index_uint"),t.getExtension("OES_standard_derivatives")),this.WEBGL_compressed_texture_s3tc=t.getExtension("WEBGL_compressed_texture_s3tc"),this.WEBGL_compressed_texture_s3tc_srgb=t.getExtension("WEBGL_compressed_texture_s3tc_srgb"),this.EXT_texture_compression_rgtc=t.getExtension("EXT_texture_compression_rgtc"),this.EXT_texture_filter_anisotropic=t.getExtension("EXT_texture_filter_anisotropic"),this.EXT_texture_norm16=t.getExtension("EXT_texture_norm16"),this.OES_texture_float_linear=t.getExtension("OES_texture_float_linear"),this.OES_texture_half_float_linear=t.getExtension("OES_texture_half_float_linear"),this.KHR_parallel_shader_compile=t.getExtension("KHR_parallel_shader_compile"),Pt(t)?(this.platformString="WebGL2",this.glslVersion="#version 300 es"):(this.platformString="WebGL1",this.glslVersion="#version 100"),this.scTexture=new vx({id:this.getNextUniqueId(),device:this,descriptor:{width:0,height:0,depthOrArrayLayers:1,dimension:dr.TEXTURE_2D,mipLevelCount:1,usage:Pi.RENDER_TARGET,format:this.contextAttributes.alpha===!1?he.U8_RGB_RT:he.U8_RGBA_RT},fake:!0}),this.scTexture.formatKind=mn.Float,this.scTexture.gl_target=null,this.scTexture.gl_texture=null,this.resolveColorReadFramebuffer=this.ensureResourceExists(t.createFramebuffer()),this.resolveColorDrawFramebuffer=this.ensureResourceExists(t.createFramebuffer()),this.resolveDepthStencilReadFramebuffer=this.ensureResourceExists(t.createFramebuffer()),this.resolveDepthStencilDrawFramebuffer=this.ensureResourceExists(t.createFramebuffer()),this.renderPassDrawFramebuffer=this.ensureResourceExists(t.createFramebuffer()),this.readbackFramebuffer=this.ensureResourceExists(t.createFramebuffer()),this.fallbackTexture2D=this.createFallbackTexture(dr.TEXTURE_2D,mn.Float),this.fallbackTexture2DDepth=this.createFallbackTexture(dr.TEXTURE_2D,mn.Depth),this.fallbackVertexBuffer=this.createBuffer({viewOrSize:1,usage:Xr.VERTEX,hint:No.STATIC}),Pt(t)&&(this.fallbackTexture2DArray=this.createFallbackTexture(dr.TEXTURE_2D_ARRAY,mn.Float),this.fallbackTexture3D=this.createFallbackTexture(dr.TEXTURE_3D,mn.Float),this.fallbackTextureCube=this.createFallbackTexture(dr.TEXTURE_CUBE_MAP,mn.Float)),this.currentMegaState.depthCompare=Ir.LESS,this.currentMegaState.depthWrite=!1,this.currentMegaState.attachmentsState[0].channelWriteMask=ei.ALL,t.enable(t.DEPTH_TEST),t.enable(t.STENCIL_TEST),this.checkLimits(),r.shaderDebug&&(this.shaderDebug=!0),r.trackResources&&(this.resourceCreationTracker=new wie)}return e.prototype.destroy=function(){this.blitBindings&&this.blitBindings.destroy(),this.blitInputLayout&&this.blitInputLayout.destroy(),this.blitRenderPipeline&&this.blitRenderPipeline.destroy(),this.blitVertexBuffer&&this.blitVertexBuffer.destroy(),this.blitProgram&&this.blitProgram.destroy()},e.prototype.createFallbackTexture=function(t,r){var n=t===dr.TEXTURE_CUBE_MAP?6:1,i=r===mn.Depth?he.D32F:he.U8_RGBA_NORM,a=this.createTexture({dimension:t,format:i,usage:Pi.SAMPLED,width:1,height:1,depthOrArrayLayers:n,mipLevelCount:1});return r===mn.Float&&a.setImageData([new Uint8Array(4*n)]),Sd(a)},e.prototype.getNextUniqueId=function(){return++this.resourceUniqueId},e.prototype.checkLimits=function(){var t=this.gl;if(this.maxVertexAttribs=t.getParameter(ee.MAX_VERTEX_ATTRIBS),Pt(t)){this.uniformBufferMaxPageByteSize=Math.min(t.getParameter(ee.MAX_UNIFORM_BLOCK_SIZE),NP),this.uniformBufferWordAlignment=t.getParameter(t.UNIFORM_BUFFER_OFFSET_ALIGNMENT)/4;var r=t.getInternalformatParameter(t.RENDERBUFFER,t.DEPTH32F_STENCIL8,t.SAMPLES);this.supportedSampleCounts=r?Hp([],Ro(r),!1):[],this.occlusionQueriesRecommended=!0}else this.uniformBufferWordAlignment=64,this.uniformBufferMaxPageByteSize=NP;this.uniformBufferMaxPageWordSize=this.uniformBufferMaxPageByteSize/4,this.supportedSampleCounts.includes(1)||this.supportedSampleCounts.push(1),this.supportedSampleCounts.sort(function(n,i){return n-i})},e.prototype.configureSwapChain=function(t,r,n){var i=this.scTexture;i.width=t,i.height=r,this.scPlatformFramebuffer=Dne(n)},e.prototype.getDevice=function(){return this},e.prototype.getCanvas=function(){return this.gl.canvas},e.prototype.getOnscreenTexture=function(){return this.scTexture},e.prototype.beginFrame=function(){},e.prototype.endFrame=function(){},e.prototype.translateTextureInternalFormat=function(t,r){switch(r===void 0&&(r=!1),t){case he.ALPHA:return ee.ALPHA;case he.U8_LUMINANCE:case he.F16_LUMINANCE:case he.F32_LUMINANCE:return ee.LUMINANCE;case he.F16_R:return ee.R16F;case he.F16_RG:return ee.RG16F;case he.F16_RGB:return ee.RGB16F;case he.F16_RGBA:return ee.RGBA16F;case he.F32_R:return ee.R32F;case he.F32_RG:return ee.RG32F;case he.F32_RGB:return ee.RGB32F;case he.F32_RGBA:return Pt(this.gl)?ee.RGBA32F:r?this.WEBGL_color_buffer_float.RGBA32F_EXT:ee.RGBA;case he.U8_R_NORM:return ee.R8;case he.U8_RG_NORM:return ee.RG8;case he.U8_RGB_NORM:case he.U8_RGB_RT:return ee.RGB8;case he.U8_RGB_SRGB:return ee.SRGB8;case he.U8_RGBA_NORM:case he.U8_RGBA_RT:return Pt(this.gl)?ee.RGBA8:r?ee.RGBA4:ee.RGBA;case he.U8_RGBA:return ee.RGBA;case he.U8_RGBA_SRGB:case he.U8_RGBA_RT_SRGB:return ee.SRGB8_ALPHA8;case he.U16_R:return ee.R16UI;case he.U16_R_NORM:return this.EXT_texture_norm16.R16_EXT;case he.U16_RG_NORM:return this.EXT_texture_norm16.RG16_EXT;case he.U16_RGBA_NORM:return this.EXT_texture_norm16.RGBA16_EXT;case he.U16_RGBA_5551:return ee.RGB5_A1;case he.U16_RGB_565:return ee.RGB565;case he.U32_R:return ee.R32UI;case he.S8_RGBA_NORM:return ee.RGBA8_SNORM;case he.S8_RG_NORM:return ee.RG8_SNORM;case he.BC1:return this.WEBGL_compressed_texture_s3tc.COMPRESSED_RGBA_S3TC_DXT1_EXT;case he.BC1_SRGB:return this.WEBGL_compressed_texture_s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;case he.BC2:return this.WEBGL_compressed_texture_s3tc.COMPRESSED_RGBA_S3TC_DXT3_EXT;case he.BC2_SRGB:return this.WEBGL_compressed_texture_s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;case he.BC3:return this.WEBGL_compressed_texture_s3tc.COMPRESSED_RGBA_S3TC_DXT5_EXT;case he.BC3_SRGB:return this.WEBGL_compressed_texture_s3tc_srgb.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT;case he.BC4_UNORM:return this.EXT_texture_compression_rgtc.COMPRESSED_RED_RGTC1_EXT;case he.BC4_SNORM:return this.EXT_texture_compression_rgtc.COMPRESSED_SIGNED_RED_RGTC1_EXT;case he.BC5_UNORM:return this.EXT_texture_compression_rgtc.COMPRESSED_RED_GREEN_RGTC2_EXT;case he.BC5_SNORM:return this.EXT_texture_compression_rgtc.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT;case he.D32F_S8:return Pt(this.gl)?ee.DEPTH32F_STENCIL8:this.WEBGL_depth_texture?ee.DEPTH_STENCIL:ee.DEPTH_COMPONENT16;case he.D24_S8:return Pt(this.gl)?ee.DEPTH24_STENCIL8:this.WEBGL_depth_texture?ee.DEPTH_STENCIL:ee.DEPTH_COMPONENT16;case he.D32F:return Pt(this.gl)?ee.DEPTH_COMPONENT32F:this.WEBGL_depth_texture?ee.DEPTH_COMPONENT:ee.DEPTH_COMPONENT16;case he.D24:return Pt(this.gl)?ee.DEPTH_COMPONENT24:this.WEBGL_depth_texture?ee.DEPTH_COMPONENT:ee.DEPTH_COMPONENT16;default:throw new Error("whoops")}},e.prototype.translateTextureType=function(t){var r=gs(t);switch(r){case Ye.U8:return ee.UNSIGNED_BYTE;case Ye.U16:return ee.UNSIGNED_SHORT;case Ye.U32:return ee.UNSIGNED_INT;case Ye.S8:return ee.BYTE;case Ye.F16:return ee.HALF_FLOAT;case Ye.F32:return ee.FLOAT;case Ye.U16_PACKED_5551:return ee.UNSIGNED_SHORT_5_5_5_1;case Ye.D32F:return Pt(this.gl)?ee.FLOAT:this.WEBGL_depth_texture?ee.UNSIGNED_INT:ee.UNSIGNED_BYTE;case Ye.D24:return Pt(this.gl)?ee.UNSIGNED_INT_24_8:this.WEBGL_depth_texture?ee.UNSIGNED_SHORT:ee.UNSIGNED_BYTE;case Ye.D24S8:return Pt(this.gl)?ee.UNSIGNED_INT_24_8:this.WEBGL_depth_texture?ee.UNSIGNED_INT_24_8_WEBGL:ee.UNSIGNED_BYTE;case Ye.D32FS8:return ee.FLOAT_32_UNSIGNED_INT_24_8_REV;default:throw new Error("whoops")}},e.prototype.translateInternalTextureFormat=function(t){switch(t){case he.F32_R:return ee.R32F;case he.F32_RG:return ee.RG32F;case he.F32_RGB:return ee.RGB32F;case he.F32_RGBA:return ee.RGBA32F;case he.F16_R:return ee.R16F;case he.F16_RG:return ee.RG16F;case he.F16_RGB:return ee.RGB16F;case he.F16_RGBA:return ee.RGBA16F}return this.translateTextureFormat(t)},e.prototype.translateTextureFormat=function(t){if(CF(t)||t===he.F32_LUMINANCE||t===he.U8_LUMINANCE)return this.translateTextureInternalFormat(t);var r=Pt(this.gl)||!Pt(this.gl)&&!!this.WEBGL_depth_texture;switch(t){case he.D24_S8:case he.D32F_S8:return r?ee.DEPTH_STENCIL:ee.RGBA;case he.D24:case he.D32F:return r?ee.DEPTH_COMPONENT:ee.RGBA}var n=OF(t),i=DR(t);switch(i){case wt.A:return ee.ALPHA;case wt.R:return n?ee.RED_INTEGER:ee.RED;case wt.RG:return n?ee.RG_INTEGER:ee.RG;case wt.RGB:return n?ee.RGB_INTEGER:ee.RGB;case wt.RGBA:return ee.RGBA}},e.prototype.setActiveTexture=function(t){this.currentActiveTexture!==t&&(this.gl.activeTexture(t),this.currentActiveTexture=t)},e.prototype.bindVAO=function(t){this.currentBoundVAO!==t&&(Pt(this.gl)?this.gl.bindVertexArray(t):this.OES_vertex_array_object.bindVertexArrayOES(t),this.currentBoundVAO=t)},e.prototype.programCompiled=function(t){rr(t.compileState!==aa.NeedsCompile),t.compileState===aa.Compiling&&(t.compileState=aa.NeedsBind,this.shaderDebug&&this.checkProgramCompilationForErrors(t))},e.prototype.useProgram=function(t){this.currentProgram!==t&&(this.programCompiled(t),this.gl.useProgram(t.gl_program),this.currentProgram=t)},e.prototype.ensureResourceExists=function(t){if(t===null){var r=this.gl.getError();throw new Error("Created resource is null; GL error encountered: ".concat(r))}else return t},e.prototype.createBuffer=function(t){return new Sie({id:this.getNextUniqueId(),device:this,descriptor:t})},e.prototype.createTexture=function(t){return new vx({id:this.getNextUniqueId(),device:this,descriptor:t})},e.prototype.createSampler=function(t){return new Nie({id:this.getNextUniqueId(),device:this,descriptor:t})},e.prototype.createRenderTarget=function(t){return new bie({id:this.getNextUniqueId(),device:this,descriptor:t})},e.prototype.createRenderTargetFromTexture=function(t){var r=t,n=r.format,i=r.width,a=r.height,s=r.mipLevelCount;return rr(s===1),this.createRenderTarget({format:n,width:i,height:a,sampleCount:1,texture:t})},e.prototype.createProgram=function(t){var r,n,i,a=(r=t.vertex)===null||r===void 0?void 0:r.glsl;return!((n=t.vertex)===null||n===void 0)&&n.glsl&&(t.vertex.glsl=Kd(this.queryVendorInfo(),"vert",t.vertex.glsl)),!((i=t.fragment)===null||i===void 0)&&i.glsl&&(t.fragment.glsl=Kd(this.queryVendorInfo(),"frag",t.fragment.glsl)),this.createProgramSimple(t,a)},e.prototype.createProgramSimple=function(t,r){var n=new xie({id:this.getNextUniqueId(),device:this,descriptor:t},r);return n},e.prototype.createBindings=function(t){return new hie({id:this.getNextUniqueId(),device:this,descriptor:t})},e.prototype.createInputLayout=function(t){return new Aie({id:this.getNextUniqueId(),device:this,descriptor:t})},e.prototype.createRenderPipeline=function(t){return new Oie({id:this.getNextUniqueId(),device:this,descriptor:t})},e.prototype.createComputePass=function(){return new Iie},e.prototype.createComputePipeline=function(t){return new Mie({id:this.getNextUniqueId(),device:this,descriptor:t})},e.prototype.createReadback=function(){return new Cie({id:this.getNextUniqueId(),device:this})},e.prototype.createQueryPool=function(t,r){return new Rie({id:this.getNextUniqueId(),device:this,descriptor:{type:t,elemCount:r}})},e.prototype.formatRenderPassDescriptor=function(t){var r,n,i,a,s,l,c=t.colorAttachment;t.depthClearValue=(r=t.depthClearValue)!==null&&r!==void 0?r:"load",t.stencilClearValue=(n=t.stencilClearValue)!==null&&n!==void 0?n:"load";for(var d=0;d<c.length;d++)t.colorAttachmentLevel||(t.colorAttachmentLevel=[]),t.colorAttachmentLevel[d]=(i=t.colorAttachmentLevel[d])!==null&&i!==void 0?i:0,t.colorResolveToLevel||(t.colorResolveToLevel=[]),t.colorResolveToLevel[d]=(a=t.colorResolveToLevel[d])!==null&&a!==void 0?a:0,t.colorClearColor||(t.colorClearColor=[]),t.colorClearColor[d]=(s=t.colorClearColor[d])!==null&&s!==void 0?s:"load",t.colorStore||(t.colorStore=[]),t.colorStore[d]=(l=t.colorStore[d])!==null&&l!==void 0?l:!1},e.prototype.createRenderBundle=function(){return new Pie({id:this.getNextUniqueId(),device:this})},e.prototype.beginBundle=function(t){this.renderBundle=t},e.prototype.endBundle=function(){this.renderBundle=void 0},e.prototype.executeBundles=function(t){t.forEach(function(r){r.replay()})},e.prototype.createRenderPass=function(t){this.currentRenderPassDescriptor!==null&&this.currentRenderPassDescriptorStack.push(this.currentRenderPassDescriptor),this.currentRenderPassDescriptor=t,this.formatRenderPassDescriptor(t);var r=t.colorAttachment,n=t.colorAttachmentLevel,i=t.colorClearColor,a=t.colorResolveTo,s=t.colorResolveToLevel,l=t.depthStencilAttachment,c=t.depthClearValue,d=t.stencilClearValue,p=t.depthStencilResolveTo,h=a&&a.length===1&&a[0]===this.scTexture;this.setRenderPassParametersBegin(r.length,h);for(var m=0;m<r.length;m++)this.setRenderPassParametersColor(m,r[m],n[m],a[m],s[m],h);this.setRenderPassParametersDepthStencil(l,p,h),this.validateCurrentAttachments();for(var m=0;m<r.length;m++){var _=i[m];_!=="load"&&this.setRenderPassParametersClearColor(m,_.r,_.g,_.b,_.a)}return this.setRenderPassParametersClearDepthStencil(c,d),this},e.prototype.submitPass=function(t){rr(this.currentRenderPassDescriptor!==null),this.endPass(),this.currentRenderPassDescriptorStack.length?this.currentRenderPassDescriptor=this.currentRenderPassDescriptorStack.pop():this.currentRenderPassDescriptor=null},e.prototype.copySubTexture2D=function(t,r,n,i,a,s){var l=this.gl,c=t,d=i;if(rr(d.mipLevelCount===1),rr(c.mipLevelCount===1),Pt(l))c===this.scTexture?l.bindFramebuffer(l.DRAW_FRAMEBUFFER,this.scPlatformFramebuffer):(l.bindFramebuffer(l.DRAW_FRAMEBUFFER,this.resolveColorDrawFramebuffer),this.bindFramebufferAttachment(l.DRAW_FRAMEBUFFER,l.COLOR_ATTACHMENT0,c,0)),l.bindFramebuffer(l.READ_FRAMEBUFFER,this.resolveColorReadFramebuffer),this.bindFramebufferAttachment(l.READ_FRAMEBUFFER,l.COLOR_ATTACHMENT0,d,0),l.blitFramebuffer(a,s,a+d.width,s+d.height,r,n,r+d.width,n+d.height,l.COLOR_BUFFER_BIT,l.LINEAR),l.bindFramebuffer(l.READ_FRAMEBUFFER,null),l.bindFramebuffer(l.DRAW_FRAMEBUFFER,null);else if(c===this.scTexture){var p=this.createRenderTargetFromTexture(i);this.submitBlitRenderPass(p,c)}},e.prototype.queryLimits=function(){return this},e.prototype.queryTextureFormatSupported=function(t,r,n){switch(t){case he.BC1_SRGB:case he.BC2_SRGB:case he.BC3_SRGB:return this.WEBGL_compressed_texture_s3tc_srgb!==null?JA(r,n,4,4):!1;case he.BC1:case he.BC2:case he.BC3:return this.WEBGL_compressed_texture_s3tc!==null?JA(r,n,4,4):!1;case he.BC4_UNORM:case he.BC4_SNORM:case he.BC5_UNORM:case he.BC5_SNORM:return this.EXT_texture_compression_rgtc!==null?JA(r,n,4,4):!1;case he.U16_R_NORM:case he.U16_RG_NORM:case he.U16_RGBA_NORM:return this.EXT_texture_norm16!==null;case he.F32_R:case he.F32_RG:case he.F32_RGB:case he.F32_RGBA:return this.OES_texture_float_linear!==null;case he.F16_R:case he.F16_RG:case he.F16_RGB:case he.F16_RGBA:return this.OES_texture_half_float_linear!==null;default:return!0}},e.prototype.queryProgramReady=function(t){var r=this.gl;if(t.compileState===aa.NeedsCompile)throw new Error("whoops");if(t.compileState===aa.Compiling){var n=void 0;return this.KHR_parallel_shader_compile!==null?n=r.getProgramParameter(t.gl_program,this.KHR_parallel_shader_compile.COMPLETION_STATUS_KHR):n=!0,n&&this.programCompiled(t),n}return t.compileState===aa.NeedsBind||t.compileState===aa.ReadyToUse},e.prototype.queryPlatformAvailable=function(){return this.gl.isContextLost()},e.prototype.queryVendorInfo=function(){return this},e.prototype.queryRenderPass=function(t){return this.currentRenderPassDescriptor},e.prototype.queryRenderTarget=function(t){var r=t;return r},e.prototype.setResourceName=function(t,r){if(t.name=r,t.type===Cr.Buffer)for(var n=t.gl_buffer_pages,i=0;i<n.length;i++)qp(n[i],"".concat(r," Page ").concat(i));else if(t.type===Cr.Texture)qp(Sd(t),r);else if(t.type===Cr.Sampler)qp(px(t),r);else if(t.type===Cr.RenderTarget){var a=t.gl_renderbuffer;a!==null&&qp(a,r)}else t.type===Cr.InputLayout&&qp(t.vao,r)},e.prototype.setResourceLeakCheck=function(t,r){this.resourceCreationTracker!==null&&this.resourceCreationTracker.setResourceLeakCheck(t,r)},e.prototype.checkForLeaks=function(){this.resourceCreationTracker!==null&&this.resourceCreationTracker.checkForLeaks()},e.prototype.pushDebugGroup=function(t){},e.prototype.popDebugGroup=function(){},e.prototype.insertDebugMarker=function(t){},e.prototype.programPatched=function(t,r){rr(this.shaderDebug)},e.prototype.getBufferData=function(t,r,n){n===void 0&&(n=0);var i=this.gl;Pt(i)&&(i.bindBuffer(i.COPY_READ_BUFFER,Dd(t,n*4)),i.getBufferSubData(i.COPY_READ_BUFFER,n*4,r))},e.prototype.debugGroupStatisticsDrawCall=function(t){t===void 0&&(t=1);for(var r=this.debugGroupStack.length-1;r>=0;r--)this.debugGroupStack[r].drawCallCount+=t},e.prototype.debugGroupStatisticsBufferUpload=function(t){t===void 0&&(t=1);for(var r=this.debugGroupStack.length-1;r>=0;r--)this.debugGroupStack[r].bufferUploadCount+=t},e.prototype.debugGroupStatisticsTextureBind=function(t){t===void 0&&(t=1);for(var r=this.debugGroupStack.length-1;r>=0;r--)this.debugGroupStack[r].textureBindCount+=t},e.prototype.debugGroupStatisticsTriangles=function(t){for(var r=this.debugGroupStack.length-1;r>=0;r--)this.debugGroupStack[r].triangleCount+=t},e.prototype.reportShaderError=function(t,r){var n=this.gl,i=n.getShaderParameter(t,n.COMPILE_STATUS);if(!i){console.error(Bne(r));var a=n.getExtension("WEBGL_debug_shaders");a&&console.error(a.getTranslatedShaderSource(t)),console.error(n.getShaderInfoLog(t))}return i},e.prototype.checkProgramCompilationForErrors=function(t){var r=this.gl,n=t.gl_program;if(!r.getProgramParameter(n,r.LINK_STATUS)){var i=t.descriptor;if(!this.reportShaderError(t.gl_shader_vert,i.vertex.glsl)||!this.reportShaderError(t.gl_shader_frag,i.fragment.glsl))return;console.error(r.getProgramInfoLog(t.gl_program))}},e.prototype.bindFramebufferAttachment=function(t,r,n,i){var a=this.gl;if(Za(n))a.framebufferRenderbuffer(t,r,a.RENDERBUFFER,null);else if(n.type===Cr.RenderTarget)n.gl_renderbuffer!==null?a.framebufferRenderbuffer(t,r,a.RENDERBUFFER,n.gl_renderbuffer):n.texture!==null&&a.framebufferTexture2D(t,r,ee.TEXTURE_2D,Sd(n.texture),i);else if(n.type===Cr.Texture){var s=Sd(n);n.dimension===dr.TEXTURE_2D?a.framebufferTexture2D(t,r,ee.TEXTURE_2D,s,i):Pt(a)&&(n.dimension,dr.TEXTURE_2D_ARRAY)}},e.prototype.bindFramebufferDepthStencilAttachment=function(t,r){var n=this.gl,i=Za(r)?At.Depth|At.Stencil:Yd(r.format),a=!!(i&At.Depth),s=!!(i&At.Stencil);if(a&&s){var l=Pt(this.gl)||!Pt(this.gl)&&!!this.WEBGL_depth_texture;l?this.bindFramebufferAttachment(t,n.DEPTH_STENCIL_ATTACHMENT,r,0):this.bindFramebufferAttachment(t,n.DEPTH_ATTACHMENT,r,0)}else a?(this.bindFramebufferAttachment(t,n.DEPTH_ATTACHMENT,r,0),this.bindFramebufferAttachment(t,n.STENCIL_ATTACHMENT,null,0)):s&&(this.bindFramebufferAttachment(t,n.STENCIL_ATTACHMENT,r,0),this.bindFramebufferAttachment(t,n.DEPTH_ATTACHMENT,null,0))},e.prototype.validateCurrentAttachments=function(){for(var t=-1,r=-1,n=-1,i=0;i<this.currentColorAttachments.length;i++){var a=this.currentColorAttachments[i];a!==null&&(t===-1?(t=a.sampleCount,r=a.width,n=a.height):(rr(t===a.sampleCount),rr(r===a.width),rr(n===a.height)))}this.currentDepthStencilAttachment&&(t===-1?t=this.currentDepthStencilAttachment.sampleCount:(rr(t===this.currentDepthStencilAttachment.sampleCount),rr(r===this.currentDepthStencilAttachment.width),rr(n===this.currentDepthStencilAttachment.height))),this.currentSampleCount=t},e.prototype.setRenderPassParametersBegin=function(t,r){r===void 0&&(r=!1);var n=this.gl;if(r)n.bindFramebuffer(ee.FRAMEBUFFER,null);else if(Pt(n)?n.bindFramebuffer(ee.DRAW_FRAMEBUFFER,this.renderPassDrawFramebuffer):this.inBlitRenderPass||n.bindFramebuffer(ee.FRAMEBUFFER,this.renderPassDrawFramebuffer),Pt(n)?n.drawBuffers([ee.COLOR_ATTACHMENT0,ee.COLOR_ATTACHMENT1,ee.COLOR_ATTACHMENT2,ee.COLOR_ATTACHMENT3]):!this.inBlitRenderPass&&this.WEBGL_draw_buffers&&this.WEBGL_draw_buffers.drawBuffersWEBGL([ee.COLOR_ATTACHMENT0_WEBGL,ee.COLOR_ATTACHMENT1_WEBGL,ee.COLOR_ATTACHMENT2_WEBGL,ee.COLOR_ATTACHMENT3_WEBGL]),!this.inBlitRenderPass)for(var i=t;i<this.currentColorAttachments.length;i++){var a=Pt(n)?ee.DRAW_FRAMEBUFFER:ee.FRAMEBUFFER,s=Pt(n)?ee.COLOR_ATTACHMENT0:ee.COLOR_ATTACHMENT0_WEBGL;n.framebufferRenderbuffer(a,s+i,ee.RENDERBUFFER,null),n.framebufferTexture2D(a,s+i,ee.TEXTURE_2D,null,0)}this.currentColorAttachments.length=t},e.prototype.setRenderPassParametersColor=function(t,r,n,i,a,s){s===void 0&&(s=!1);var l=this.gl,c=Pt(l);(this.currentColorAttachments[t]!==r||this.currentColorAttachmentLevels[t]!==n)&&(this.currentColorAttachments[t]=r,this.currentColorAttachmentLevels[t]=n,!s&&(c||!c&&this.WEBGL_draw_buffers)&&this.bindFramebufferAttachment(c?ee.DRAW_FRAMEBUFFER:ee.FRAMEBUFFER,(c?ee.COLOR_ATTACHMENT0:ee.COLOR_ATTACHMENT0_WEBGL)+t,r,n),this.resolveColorAttachmentsChanged=!0),(this.currentColorResolveTos[t]!==i||this.currentColorResolveToLevels[t]!==a)&&(this.currentColorResolveTos[t]=i,this.currentColorResolveToLevels[t]=a,i!==null&&(this.resolveColorAttachmentsChanged=!0))},e.prototype.setRenderPassParametersDepthStencil=function(t,r,n){n===void 0&&(n=!1);var i=this.gl;this.currentDepthStencilAttachment!==t&&(this.currentDepthStencilAttachment=t,!n&&!this.inBlitRenderPass&&this.bindFramebufferDepthStencilAttachment(Pt(i)?ee.DRAW_FRAMEBUFFER:ee.FRAMEBUFFER,this.currentDepthStencilAttachment),this.resolveDepthStencilAttachmentsChanged=!0),this.currentDepthStencilResolveTo!==r&&(this.currentDepthStencilResolveTo=r,r&&(this.resolveDepthStencilAttachmentsChanged=!0))},e.prototype.setRenderPassParametersClearColor=function(t,r,n,i,a){var s=this.gl;if(this.OES_draw_buffers_indexed!==null){var l=this.currentMegaState.attachmentsState[t];l&&l.channelWriteMask!==ei.ALL&&(this.OES_draw_buffers_indexed.colorMaskiOES(t,!0,!0,!0,!0),l.channelWriteMask=ei.ALL)}else{var l=this.currentMegaState.attachmentsState[0];l&&l.channelWriteMask!==ei.ALL&&(s.colorMask(!0,!0,!0,!0),l.channelWriteMask=ei.ALL)}this.setScissorRectEnabled(!1),Pt(s)?s.clearBufferfv(s.COLOR,t,[r,n,i,a]):(s.clearColor(r,n,i,a),s.clear(s.COLOR_BUFFER_BIT))},e.prototype.setRenderPassParametersClearDepthStencil=function(t,r){t===void 0&&(t="load"),r===void 0&&(r="load");var n=this.gl;t!=="load"&&(rr(!!this.currentDepthStencilAttachment),this.currentMegaState.depthWrite||(n.depthMask(!0),this.currentMegaState.depthWrite=!0),Pt(n)?n.clearBufferfv(n.DEPTH,0,[t]):(n.clearDepth(t),n.clear(n.DEPTH_BUFFER_BIT))),r!=="load"&&(rr(!!this.currentDepthStencilAttachment),this.currentMegaState.stencilWrite||(n.enable(n.STENCIL_TEST),n.stencilMask(255),this.currentMegaState.stencilWrite=!0),Pt(n)?n.clearBufferiv(n.STENCIL,0,[r]):(n.clearStencil(r),n.clear(n.STENCIL_BUFFER_BIT)))},e.prototype.setBindings=function(t){var r=this,n;if(this.renderBundle){this.renderBundle.push(function(){return r.setBindings(t)});return}var i=this.gl,a=t,s=a.uniformBufferBindings,l=a.samplerBindings,c=a.bindingLayouts;rr(0<c.bindingLayoutTables.length);var d=c.bindingLayoutTables[0];rr(s.length>=d.numUniformBuffers),rr(l.length>=d.numSamplers);for(var p=0;p<s.length;p++){var h=s[p];if(h.size!==0){var m=d.firstUniformBuffer+p,_=h.buffer,y=h.offset||0,E=h.size||_.byteSize;if(_!==this.currentUniformBuffers[m]||y!==this.currentUniformBufferByteOffsets[m]||E!==this.currentUniformBufferByteSizes[m]){var T=y%_.pageByteSize,A=_.gl_buffer_pages[y/_.pageByteSize|0];rr(T+E<=_.pageByteSize),Pt(i)&&i.bindBufferRange(i.UNIFORM_BUFFER,m,A,T,E),this.currentUniformBuffers[m]=_,this.currentUniformBufferByteOffsets[m]=y,this.currentUniformBufferByteSizes[m]=E}}}for(var p=0;p<d.numSamplers;p++){var h=l[p],b=d.firstSampler+p,R=h!==null&&h.sampler!==null?px(h.sampler):null,M=h!==null&&h.texture!==null?Sd(h.texture):null;if(this.currentSamplers[b]!==R&&(Pt(i)&&i.bindSampler(b,R),this.currentSamplers[b]=R),this.currentTextures[b]!==M){if(this.setActiveTexture(i.TEXTURE0+b),M!==null){var B=wc(h).texture,w=B.gl_target,D=B.width,U=B.height;h.texture.textureIndex=b,i.bindTexture(w,M),Pt(i)||(n=h.sampler)===null||n===void 0||n.setTextureParameters(w,D,U),this.debugGroupStatisticsTextureBind()}else{var ae=pn(pn({},h),xF),Q=ae.dimension,X=ae.formatKind,w=Tie(Q);i.bindTexture(w,this.getFallbackTexture(pn({gl_target:w,formatKind:X},ae)))}this.currentTextures[b]=M}}},e.prototype.setViewport=function(t,r,n,i){var a=this.gl;a.viewport(t,r,n,i)},e.prototype.setScissorRect=function(t,r,n,i){var a=this.gl;this.setScissorRectEnabled(!0),a.scissor(t,r,n,i)},e.prototype.applyAttachmentStateIndexed=function(t,r,n){var i=this.gl,a=this.OES_draw_buffers_indexed;r.channelWriteMask!==n.channelWriteMask&&(a.colorMaskiOES(t,!!(n.channelWriteMask&ei.RED),!!(n.channelWriteMask&ei.GREEN),!!(n.channelWriteMask&ei.BLUE),!!(n.channelWriteMask&ei.ALPHA)),r.channelWriteMask=n.channelWriteMask);var s=r.rgbBlendState.blendMode!==n.rgbBlendState.blendMode||r.alphaBlendState.blendMode!==n.alphaBlendState.blendMode,l=r.rgbBlendState.blendSrcFactor!==n.rgbBlendState.blendSrcFactor||r.alphaBlendState.blendSrcFactor!==n.alphaBlendState.blendSrcFactor||r.rgbBlendState.blendDstFactor!==n.rgbBlendState.blendDstFactor||r.alphaBlendState.blendDstFactor!==n.alphaBlendState.blendDstFactor;(l||s)&&(dl(r.rgbBlendState)&&dl(r.alphaBlendState)?a.enableiOES(t,i.BLEND):dl(n.rgbBlendState)&&dl(n.alphaBlendState)&&a.disableiOES(t,i.BLEND)),s&&(a.blendEquationSeparateiOES(t,n.rgbBlendState.blendMode,n.alphaBlendState.blendMode),r.rgbBlendState.blendMode=n.rgbBlendState.blendMode,r.alphaBlendState.blendMode=n.alphaBlendState.blendMode),l&&(a.blendFuncSeparateiOES(t,n.rgbBlendState.blendSrcFactor,n.rgbBlendState.blendDstFactor,n.alphaBlendState.blendSrcFactor,n.alphaBlendState.blendDstFactor),r.rgbBlendState.blendSrcFactor=n.rgbBlendState.blendSrcFactor,r.alphaBlendState.blendSrcFactor=n.alphaBlendState.blendSrcFactor,r.rgbBlendState.blendDstFactor=n.rgbBlendState.blendDstFactor,r.alphaBlendState.blendDstFactor=n.alphaBlendState.blendDstFactor)},e.prototype.applyAttachmentState=function(t,r){var n=this.gl;t.channelWriteMask!==r.channelWriteMask&&(n.colorMask(!!(r.channelWriteMask&ei.RED),!!(r.channelWriteMask&ei.GREEN),!!(r.channelWriteMask&ei.BLUE),!!(r.channelWriteMask&ei.ALPHA)),t.channelWriteMask=r.channelWriteMask);var i=t.rgbBlendState.blendMode!==r.rgbBlendState.blendMode||t.alphaBlendState.blendMode!==r.alphaBlendState.blendMode,a=t.rgbBlendState.blendSrcFactor!==r.rgbBlendState.blendSrcFactor||t.alphaBlendState.blendSrcFactor!==r.alphaBlendState.blendSrcFactor||t.rgbBlendState.blendDstFactor!==r.rgbBlendState.blendDstFactor||t.alphaBlendState.blendDstFactor!==r.alphaBlendState.blendDstFactor;(a||i)&&(dl(t.rgbBlendState)&&dl(t.alphaBlendState)?n.enable(n.BLEND):dl(r.rgbBlendState)&&dl(r.alphaBlendState)&&n.disable(n.BLEND)),i&&(n.blendEquationSeparate(r.rgbBlendState.blendMode,r.alphaBlendState.blendMode),t.rgbBlendState.blendMode=r.rgbBlendState.blendMode,t.alphaBlendState.blendMode=r.alphaBlendState.blendMode),a&&(n.blendFuncSeparate(r.rgbBlendState.blendSrcFactor,r.rgbBlendState.blendDstFactor,r.alphaBlendState.blendSrcFactor,r.alphaBlendState.blendDstFactor),t.rgbBlendState.blendSrcFactor=r.rgbBlendState.blendSrcFactor,t.alphaBlendState.blendSrcFactor=r.alphaBlendState.blendSrcFactor,t.rgbBlendState.blendDstFactor=r.rgbBlendState.blendDstFactor,t.alphaBlendState.blendDstFactor=r.alphaBlendState.blendDstFactor)},e.prototype.setMegaState=function(t){var r=this.gl,n=this.currentMegaState;if(this.OES_draw_buffers_indexed!==null)for(var i=0;i<t.attachmentsState.length;i++)this.applyAttachmentStateIndexed(i,n.attachmentsState[0],t.attachmentsState[0]);else rr(t.attachmentsState.length===1),this.applyAttachmentState(n.attachmentsState[0],t.attachmentsState[0]);EF(n.blendConstant,t.blendConstant)||(r.blendColor(t.blendConstant.r,t.blendConstant.g,t.blendConstant.b,t.blendConstant.a),TF(n.blendConstant,t.blendConstant)),n.depthCompare!==t.depthCompare&&(r.depthFunc(t.depthCompare),n.depthCompare=t.depthCompare),!!n.depthWrite!=!!t.depthWrite&&(r.depthMask(t.depthWrite),n.depthWrite=t.depthWrite),!!n.stencilWrite!=!!t.stencilWrite&&(r.stencilMask(t.stencilWrite?255:0),n.stencilWrite=t.stencilWrite);var a=!1;if(!fg(n.stencilFront,t.stencilFront)){a=!0;var s=t.stencilFront,l=s.passOp,c=s.failOp,d=s.depthFailOp,p=s.compare;(n.stencilFront.passOp!==l||n.stencilFront.failOp!==c||n.stencilFront.depthFailOp!==d)&&(r.stencilOpSeparate(r.FRONT,c,d,l),n.stencilFront.passOp=l,n.stencilFront.failOp=c,n.stencilFront.depthFailOp=d),n.stencilFront.compare!==p&&(this.setStencilReference(0),n.stencilFront.compare=p)}if(!fg(n.stencilBack,t.stencilBack)){a=!0;var h=t.stencilBack,l=h.passOp,c=h.failOp,d=h.depthFailOp,p=h.compare;(n.stencilBack.passOp!==l||n.stencilBack.failOp!==c||n.stencilBack.depthFailOp!==d)&&(r.stencilOpSeparate(r.BACK,c,d,l),n.stencilBack.passOp=l,n.stencilBack.failOp=c,n.stencilBack.depthFailOp=d),n.stencilBack.compare!==p&&(this.setStencilReference(0),n.stencilBack.compare=p)}(n.stencilFront.mask!==t.stencilFront.mask||n.stencilBack.mask!==t.stencilBack.mask)&&(a=!0,n.stencilFront.mask=t.stencilFront.mask,n.stencilBack.mask=t.stencilBack.mask),a&&this.applyStencil(),n.cullMode!==t.cullMode&&(n.cullMode===la.NONE?r.enable(r.CULL_FACE):t.cullMode===la.NONE&&r.disable(r.CULL_FACE),t.cullMode===la.BACK?r.cullFace(r.BACK):t.cullMode===la.FRONT?r.cullFace(r.FRONT):t.cullMode===la.FRONT_AND_BACK&&r.cullFace(r.FRONT_AND_BACK),n.cullMode=t.cullMode),n.frontFace!==t.frontFace&&(r.frontFace(t.frontFace),n.frontFace=t.frontFace),n.polygonOffset!==t.polygonOffset&&(t.polygonOffset?r.enable(r.POLYGON_OFFSET_FILL):r.disable(r.POLYGON_OFFSET_FILL),n.polygonOffset=t.polygonOffset),(n.polygonOffsetFactor!==t.polygonOffsetFactor||n.polygonOffsetUnits!==t.polygonOffsetUnits)&&(r.polygonOffset(t.polygonOffsetFactor,t.polygonOffsetUnits),n.polygonOffsetFactor=t.polygonOffsetFactor,n.polygonOffsetUnits=t.polygonOffsetUnits)},e.prototype.validatePipelineFormats=function(t){for(var r=0;r<this.currentColorAttachments.length;r++)var n=this.currentColorAttachments[r];this.currentDepthStencilAttachment&&rr(this.currentDepthStencilAttachment.format===t.depthStencilAttachmentFormat),this.currentSampleCount!==-1&&rr(this.currentSampleCount===t.sampleCount)},e.prototype.setPipeline=function(t){var r=this;if(this.renderBundle){this.renderBundle.push(function(){return r.setPipeline(t)});return}this.currentPipeline=t,this.validatePipelineFormats(this.currentPipeline),this.setMegaState(this.currentPipeline.megaState);var n=this.currentPipeline.program;if(this.useProgram(n),n.compileState===aa.NeedsBind){var i=this.gl,a=n.gl_program,s=n.descriptor,l=wP(s.vertex.glsl,Die);if(Pt(i))for(var c=0;c<l.length;c++){var d=Ro(l[c],2),p=d[1],h=i.getUniformBlockIndex(a,p);h!==-1&&h!==4294967295&&i.uniformBlockBinding(a,h,c)}for(var m=wP(s.fragment.glsl,/^uniform .*sampler\S+ (\w+);\s* \/\/ BINDING=(\d+)$/gm),c=0;c<m.length;c++){var _=Ro(m[c],3),y=_[1],E=_[2],T=i.getUniformLocation(a,y);i.uniform1i(T,parseInt(E))}n.compileState=aa.ReadyToUse}},e.prototype.setVertexInput=function(t,r,n){var i,a,s=this,l;if(this.renderBundle){this.renderBundle.push(function(){return s.setVertexInput(t,r,n)});return}if(t!==null){rr(this.currentPipeline.inputLayout===t);var c=t;this.bindVAO(c.vao);for(var d=this.gl,p=0;p<c.vertexBufferDescriptors.length;p++){var h=c.vertexBufferDescriptors[p],m=h.arrayStride,_=h.attributes;try{for(var y=(i=void 0,Hc(_)),E=y.next();!E.done;E=y.next()){var T=E.value,A=T.shaderLocation,b=T.offset,R=Pt(d)?A:(l=c.program.attributes[A])===null||l===void 0?void 0:l.location;if(!Za(R)){var M=r[p];if(M===null)continue;var B=T.vertexFormat;d.bindBuffer(d.ARRAY_BUFFER,Dd(M.buffer));var w=(M.offset||0)+b;d.vertexAttribPointer(R,B.size,B.type,B.normalized,m,w)}}}catch(U){i={error:U}}finally{try{E&&!E.done&&(a=y.return)&&a.call(y)}finally{if(i)throw i.error}}}if(rr(n!==null==(c.indexBufferFormat!==null)),n!==null){var D=n.buffer;rr(D.usage===Xr.INDEX),d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,Dd(D)),this.currentIndexBufferByteOffset=n.offset||0}else this.currentIndexBufferByteOffset=null}else rr(this.currentPipeline.inputLayout===null),rr(n===null),this.bindVAO(null),this.currentIndexBufferByteOffset=0},e.prototype.setStencilReference=function(t){this.currentStencilRef!==t&&(this.currentStencilRef=t,this.applyStencil())},e.prototype.draw=function(t,r,n,i){var a,s=this;if(this.renderBundle){this.renderBundle.push(function(){return s.draw(t,r,n,i)});return}var l=this.gl,c=this.currentPipeline;if(r){var d=[c.drawMode,n||0,t,r];Pt(l)?l.drawArraysInstanced.apply(l,Hp([],Ro(d),!1)):(a=this.ANGLE_instanced_arrays).drawArraysInstancedANGLE.apply(a,Hp([],Ro(d),!1))}else l.drawArrays(c.drawMode,n,t);this.debugGroupStatisticsDrawCall(),this.debugGroupStatisticsTriangles(t/3*Math.max(r,1))},e.prototype.drawIndexed=function(t,r,n,i,a){var s,l=this;if(this.renderBundle){this.renderBundle.push(function(){return l.drawIndexed(t,r,n,i,a)});return}var c=this.gl,d=this.currentPipeline,p=wc(d.inputLayout),h=wc(this.currentIndexBufferByteOffset)+n*p.indexBufferCompByteSize;if(r){var m=[d.drawMode,t,p.indexBufferType,h,r];Pt(c)?c.drawElementsInstanced.apply(c,Hp([],Ro(m),!1)):(s=this.ANGLE_instanced_arrays).drawElementsInstancedANGLE.apply(s,Hp([],Ro(m),!1))}else c.drawElements(d.drawMode,t,p.indexBufferType,h);this.debugGroupStatisticsDrawCall(),this.debugGroupStatisticsTriangles(t/3*Math.max(r,1))},e.prototype.drawIndirect=function(t,r){},e.prototype.drawIndexedIndirect=function(t,r){},e.prototype.beginOcclusionQuery=function(t){var r=this.gl;if(Pt(r)){var n=this.currentRenderPassDescriptor.occlusionQueryPool;r.beginQuery(n.gl_query_type,n.gl_query[t])}},e.prototype.endOcclusionQuery=function(){var t=this.gl;if(Pt(t)){var r=this.currentRenderPassDescriptor.occlusionQueryPool;t.endQuery(r.gl_query_type)}},e.prototype.pipelineQueryReady=function(t){var r=t;return this.queryProgramReady(r.program)},e.prototype.pipelineForceReady=function(t){},e.prototype.endPass=function(){for(var t=this.gl,r=Pt(t),n=this.currentColorResolveTos.length===1&&this.currentColorResolveTos[0]===this.scTexture,i=!1,a=0;a<this.currentColorAttachments.length;a++){var s=this.currentColorAttachments[a];if(s!==null){var l=this.currentColorResolveTos[a],c=!1;l!==null&&(rr(s.width===l.width&&s.height===l.height),this.setScissorRectEnabled(!1),n||(r&&t.bindFramebuffer(t.READ_FRAMEBUFFER,this.resolveColorReadFramebuffer),this.resolveColorAttachmentsChanged&&r&&this.bindFramebufferAttachment(t.READ_FRAMEBUFFER,t.COLOR_ATTACHMENT0,s,this.currentColorAttachmentLevels[a])),c=!0,n||(l===this.scTexture?t.bindFramebuffer(r?ee.DRAW_FRAMEBUFFER:ee.FRAMEBUFFER,this.scPlatformFramebuffer):(t.bindFramebuffer(r?ee.DRAW_FRAMEBUFFER:ee.FRAMEBUFFER,this.resolveColorDrawFramebuffer),this.resolveColorAttachmentsChanged&&t.framebufferTexture2D(r?ee.DRAW_FRAMEBUFFER:ee.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,l.gl_texture,this.currentColorResolveToLevels[a]))),n||(r?(t.blitFramebuffer(0,0,s.width,s.height,0,0,l.width,l.height,t.COLOR_BUFFER_BIT,t.LINEAR),t.bindFramebuffer(t.DRAW_FRAMEBUFFER,null)):this.submitBlitRenderPass(s,l)),i=!0),this.currentRenderPassDescriptor.colorStore[a]||!n&&!c&&(t.bindFramebuffer(r?ee.READ_FRAMEBUFFER:ee.FRAMEBUFFER,this.resolveColorReadFramebuffer),this.resolveColorAttachmentsChanged&&this.bindFramebufferAttachment(r?ee.READ_FRAMEBUFFER:ee.FRAMEBUFFER,t.COLOR_ATTACHMENT0,s,this.currentColorAttachmentLevels[a])),n||t.bindFramebuffer(r?ee.READ_FRAMEBUFFER:ee.FRAMEBUFFER,null)}}this.resolveColorAttachmentsChanged=!1;var d=this.currentDepthStencilAttachment;if(d){var p=this.currentDepthStencilResolveTo,c=!1;p&&(rr(d.width===p.width&&d.height===p.height),this.setScissorRectEnabled(!1),n||(t.bindFramebuffer(r?ee.READ_FRAMEBUFFER:ee.FRAMEBUFFER,this.resolveDepthStencilReadFramebuffer),t.bindFramebuffer(r?ee.DRAW_FRAMEBUFFER:ee.FRAMEBUFFER,this.resolveDepthStencilDrawFramebuffer),this.resolveDepthStencilAttachmentsChanged&&(this.bindFramebufferDepthStencilAttachment(r?ee.READ_FRAMEBUFFER:ee.FRAMEBUFFER,d),this.bindFramebufferDepthStencilAttachment(r?ee.DRAW_FRAMEBUFFER:ee.FRAMEBUFFER,p))),c=!0,n||(r&&t.blitFramebuffer(0,0,d.width,d.height,0,0,p.width,p.height,t.DEPTH_BUFFER_BIT,t.NEAREST),t.bindFramebuffer(r?ee.DRAW_FRAMEBUFFER:ee.FRAMEBUFFER,null)),i=!0),!n&&!this.currentRenderPassDescriptor.depthStencilStore&&(c||(t.bindFramebuffer(r?ee.READ_FRAMEBUFFER:ee.FRAMEBUFFER,this.resolveDepthStencilReadFramebuffer),this.resolveDepthStencilAttachmentsChanged&&this.bindFramebufferDepthStencilAttachment(r?ee.READ_FRAMEBUFFER:ee.FRAMEBUFFER,d),c=!0),r&&t.invalidateFramebuffer(t.READ_FRAMEBUFFER,[t.DEPTH_STENCIL_ATTACHMENT])),!n&&c&&t.bindFramebuffer(r?ee.READ_FRAMEBUFFER:ee.FRAMEBUFFER,null),this.resolveDepthStencilAttachmentsChanged=!1}!n&&!i&&t.bindFramebuffer(r?ee.DRAW_FRAMEBUFFER:ee.FRAMEBUFFER,null)},e.prototype.setScissorRectEnabled=function(t){if(this.currentScissorEnabled!==t){var r=this.gl;t?r.enable(r.SCISSOR_TEST):r.disable(r.SCISSOR_TEST),this.currentScissorEnabled=t}},e.prototype.applyStencil=function(){Za(this.currentStencilRef)||(this.gl.stencilFuncSeparate(ee.FRONT,this.currentMegaState.stencilFront.compare,this.currentStencilRef,this.currentMegaState.stencilFront.mask||255),this.gl.stencilFuncSeparate(ee.BACK,this.currentMegaState.stencilBack.compare,this.currentStencilRef,this.currentMegaState.stencilBack.mask||255))},e.prototype.getFallbackTexture=function(t){var r=t.gl_target,n=t.formatKind;if(r===ee.TEXTURE_2D)return n===mn.Depth?this.fallbackTexture2DDepth:this.fallbackTexture2D;if(r===ee.TEXTURE_2D_ARRAY)return this.fallbackTexture2DArray;if(r===ee.TEXTURE_3D)return this.fallbackTexture3D;if(r===ee.TEXTURE_CUBE_MAP)return this.fallbackTextureCube;throw new Error("whoops")},e.prototype.submitBlitRenderPass=function(t,r){this.blitRenderPipeline||(this.blitProgram=this.createProgram({vertex:{glsl:`layout(location = 0) in vec2 a_Position;
out vec2 v_TexCoord;
void main() {
  v_TexCoord = 0.5 * (a_Position + 1.0);
  gl_Position = vec4(a_Position, 0., 1.);

  #ifdef VIEWPORT_ORIGIN_TL
    v_TexCoord.y = 1.0 - v_TexCoord.y;
  #endif
}`},fragment:{glsl:`uniform sampler2D u_Texture;
in vec2 v_TexCoord;
out vec4 outputColor;
void main() {
  outputColor = texture(SAMPLER_2D(u_Texture), v_TexCoord);
}`}}),this.blitVertexBuffer=this.createBuffer({usage:Xr.VERTEX|Xr.COPY_DST,viewOrSize:new Float32Array([-4,-4,4,-4,0,4])}),this.blitInputLayout=this.createInputLayout({vertexBufferDescriptors:[{arrayStride:8,stepMode:Vc.VERTEX,attributes:[{format:he.F32_RG,offset:0,shaderLocation:0}]}],indexBufferFormat:null,program:this.blitProgram}),this.blitRenderPipeline=this.createRenderPipeline({topology:Fn.TRIANGLES,sampleCount:1,program:this.blitProgram,colorAttachmentFormats:[he.U8_RGBA_RT],depthStencilAttachmentFormat:null,inputLayout:this.blitInputLayout,megaStateDescriptor:$d(Zd)}),this.blitBindings=this.createBindings({samplerBindings:[{sampler:null,texture:t.texture}],uniformBufferBindings:[]}),this.blitProgram.setUniformsLegacy({u_Texture:t}));var n=this.currentRenderPassDescriptor;this.currentRenderPassDescriptor=null,this.inBlitRenderPass=!0;var i=this.createRenderPass({colorAttachment:[t],colorResolveTo:[r],colorClearColor:[Pne]}),a=this.getCanvas(),s=a.width,l=a.height;i.setPipeline(this.blitRenderPipeline),i.setBindings(this.blitBindings),i.setVertexInput(this.blitInputLayout,[{buffer:this.blitVertexBuffer}],null),i.setViewport(0,0,s,l),this.gl.disable(this.gl.BLEND),i.draw(3,0),this.gl.enable(this.gl.BLEND),this.currentRenderPassDescriptor=n,this.inBlitRenderPass=!1},e})(),Bie=(function(){function e(t){this.pluginOptions=t}return e.prototype.createSwapChain=function(t){return Id(this,void 0,void 0,function(){var r,n,i,a,s,l,c,d,p,h,m,_,y;return Pd(this,function(E){return r=this.pluginOptions,n=r.targets,i=r.xrCompatible,a=r.antialias,s=a===void 0?!1:a,l=r.preserveDrawingBuffer,c=l===void 0?!1:l,d=r.premultipliedAlpha,p=d===void 0?!0:d,h=r.shaderDebug,m=r.trackResources,_={antialias:s,preserveDrawingBuffer:c,stencil:!0,premultipliedAlpha:p,xrCompatible:i},this.handleContextEvents(t),n.includes("webgl2")&&(y=t.getContext("webgl2",_)||t.getContext("experimental-webgl2",_)),!y&&n.includes("webgl1")&&(y=t.getContext("webgl",_)||t.getContext("experimental-webgl",_)),[2,new Lie(y,{shaderDebug:h,trackResources:m})]})})},e.prototype.handleContextEvents=function(t){var r=this.pluginOptions,n=r.onContextLost,i=r.onContextRestored,a=r.onContextCreationError;a&&t.addEventListener("webglcontextcreationerror",a,!1),n&&t.addEventListener("webglcontextlost",n,!1),i&&t.addEventListener("webglcontextrestored",i,!1)},e})();let vn;const MF=typeof TextDecoder<"u"?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};typeof TextDecoder<"u"&&MF.decode();let cv=null;function m0(){return(cv===null||cv.byteLength===0)&&(cv=new Uint8Array(vn.memory.buffer)),cv}function dg(e,t){return e=e>>>0,MF.decode(m0().subarray(e,e+t))}const tu=new Array(128).fill(void 0);tu.push(void 0,null,!0,!1);let Tv=tu.length;function Fie(e){Tv===tu.length&&tu.push(tu.length+1);const t=Tv;return Tv=tu[t],tu[t]=e,t}function _0(e){return tu[e]}function Uie(e){e<132||(tu[e]=Tv,Tv=e)}function kie(e){const t=_0(e);return Uie(e),t}let Qd=0;const g0=typeof TextEncoder<"u"?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},zie=typeof g0.encodeInto=="function"?function(e,t){return g0.encodeInto(e,t)}:function(e,t){const r=g0.encode(e);return t.set(r),{read:e.length,written:r.length}};function hg(e,t,r){if(r===void 0){const l=g0.encode(e),c=t(l.length,1)>>>0;return m0().subarray(c,c+l.length).set(l),Qd=l.length,c}let n=e.length,i=t(n,1)>>>0;const a=m0();let s=0;for(;s<n;s++){const l=e.charCodeAt(s);if(l>127)break;a[i+s]=l}if(s!==n){s!==0&&(e=e.slice(s)),i=r(i,n,n=s+e.length*3,1)>>>0;const l=m0().subarray(i+s,i+n),c=zie(e,l);s+=c.written}return Qd=s,i}let fv=null;function pg(){return(fv===null||fv.byteLength===0)&&(fv=new Int32Array(vn.memory.buffer)),fv}function jie(e,t,r){let n,i;try{const l=vn.__wbindgen_add_to_stack_pointer(-16),c=hg(e,vn.__wbindgen_malloc,vn.__wbindgen_realloc),d=Qd,p=hg(t,vn.__wbindgen_malloc,vn.__wbindgen_realloc),h=Qd;vn.glsl_compile(l,c,d,p,h,r);var a=pg()[l/4+0],s=pg()[l/4+1];return n=a,i=s,dg(a,s)}finally{vn.__wbindgen_add_to_stack_pointer(16),vn.__wbindgen_free(n,i,1)}}class kv{static __wrap(t){t=t>>>0;const r=Object.create(kv.prototype);return r.__wbg_ptr=t,r}__destroy_into_raw(){const t=this.__wbg_ptr;return this.__wbg_ptr=0,t}free(){const t=this.__destroy_into_raw();vn.__wbg_wgslcomposer_free(t)}constructor(){const t=vn.wgslcomposer_new();return kv.__wrap(t)}load_composable(t){const r=hg(t,vn.__wbindgen_malloc,vn.__wbindgen_realloc),n=Qd;vn.wgslcomposer_load_composable(this.__wbg_ptr,r,n)}wgsl_compile(t){let r,n;try{const s=vn.__wbindgen_add_to_stack_pointer(-16),l=hg(t,vn.__wbindgen_malloc,vn.__wbindgen_realloc),c=Qd;vn.wgslcomposer_wgsl_compile(s,this.__wbg_ptr,l,c);var i=pg()[s/4+0],a=pg()[s/4+1];return r=i,n=a,dg(i,a)}finally{vn.__wbindgen_add_to_stack_pointer(16),vn.__wbindgen_free(r,n,1)}}}async function Hie(e,t){if(typeof Response=="function"&&e instanceof Response){if(typeof WebAssembly.instantiateStreaming=="function")try{return await WebAssembly.instantiateStreaming(e,t)}catch(n){if(e.headers.get("Content-Type")!="application/wasm")console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",n);else throw n}const r=await e.arrayBuffer();return await WebAssembly.instantiate(r,t)}else{const r=await WebAssembly.instantiate(e,t);return r instanceof WebAssembly.Instance?{instance:r,module:e}:r}}function Vie(){const e={};return e.wbg={},e.wbg.__wbindgen_string_new=function(t,r){const n=dg(t,r);return Fie(n)},e.wbg.__wbindgen_object_drop_ref=function(t){kie(t)},e.wbg.__wbg_log_1d3ae0273d8f4f8a=function(t){console.log(_0(t))},e.wbg.__wbg_log_576ca876af0d4a77=function(t,r){console.log(_0(t),_0(r))},e.wbg.__wbindgen_throw=function(t,r){throw new Error(dg(t,r))},e}function Xie(e,t){return vn=e.exports,wF.__wbindgen_wasm_module=t,fv=null,cv=null,vn}async function wF(e){if(vn!==void 0)return vn;const t=Vie();(typeof e=="string"||typeof Request=="function"&&e instanceof Request||typeof URL=="function"&&e instanceof URL)&&(e=fetch(e));const{instance:r,module:n}=await Hie(await e,t);return Xie(r,n)}var Gn;(function(e){e[e.COPY_SRC=1]="COPY_SRC",e[e.COPY_DST=2]="COPY_DST",e[e.TEXTURE_BINDING=4]="TEXTURE_BINDING",e[e.STORAGE_BINDING=8]="STORAGE_BINDING",e[e.STORAGE=8]="STORAGE",e[e.RENDER_ATTACHMENT=16]="RENDER_ATTACHMENT"})(Gn||(Gn={}));var mx;(function(e){e[e.READ=1]="READ",e[e.WRITE=2]="WRITE"})(mx||(mx={}));function Gie(e){var t=0;return e&Pi.SAMPLED&&(t|=Gn.TEXTURE_BINDING|Gn.COPY_DST|Gn.COPY_SRC),e&Pi.STORAGE&&(t|=Gn.TEXTURE_BINDING|Gn.STORAGE_BINDING|Gn.COPY_SRC|Gn.COPY_DST),e&Pi.RENDER_TARGET&&(t|=Gn.RENDER_ATTACHMENT|Gn.TEXTURE_BINDING|Gn.COPY_SRC|Gn.COPY_DST),t}function BR(e){if(e===he.U8_R_NORM)return"r8unorm";if(e===he.S8_R_NORM)return"r8snorm";if(e===he.U8_RG_NORM)return"rg8unorm";if(e===he.S8_RG_NORM)return"rg8snorm";if(e===he.U32_R)return"r32uint";if(e===he.S32_R)return"r32sint";if(e===he.F32_R)return"r32float";if(e===he.U16_RG)return"rg16uint";if(e===he.S16_RG)return"rg16sint";if(e===he.F16_RG)return"rg16float";if(e===he.U8_RGBA_RT)return"bgra8unorm";if(e===he.U8_RGBA_RT_SRGB)return"bgra8unorm-srgb";if(e===he.U8_RGBA_NORM)return"rgba8unorm";if(e===he.U8_RGBA_SRGB)return"rgba8unorm-srgb";if(e===he.S8_RGBA_NORM)return"rgba8snorm";if(e===he.U32_RG)return"rg32uint";if(e===he.S32_RG)return"rg32sint";if(e===he.F32_RG)return"rg32float";if(e===he.U16_RGBA)return"rgba16uint";if(e===he.S16_RGBA)return"rgba16sint";if(e===he.F16_RGBA)return"rgba16float";if(e===he.F32_RGBA)return"rgba32float";if(e===he.U32_RGBA)return"rgba32uint";if(e===he.S32_RGBA)return"rgba32sint";if(e===he.D24)return"depth24plus";if(e===he.D24_S8)return"depth24plus-stencil8";if(e===he.D32F)return"depth32float";if(e===he.D32F_S8)return"depth32float-stencil8";if(e===he.BC1)return"bc1-rgba-unorm";if(e===he.BC1_SRGB)return"bc1-rgba-unorm-srgb";if(e===he.BC2)return"bc2-rgba-unorm";if(e===he.BC2_SRGB)return"bc2-rgba-unorm-srgb";if(e===he.BC3)return"bc3-rgba-unorm";if(e===he.BC3_SRGB)return"bc3-rgba-unorm-srgb";if(e===he.BC4_SNORM)return"bc4-r-snorm";if(e===he.BC4_UNORM)return"bc4-r-unorm";if(e===he.BC5_SNORM)return"bc5-rg-snorm";if(e===he.BC5_UNORM)return"bc5-rg-unorm";throw"whoops"}function qie(e){if(e===dr.TEXTURE_2D)return"2d";if(e===dr.TEXTURE_CUBE_MAP)return"2d";if(e===dr.TEXTURE_2D_ARRAY)return"2d";if(e===dr.TEXTURE_3D)return"3d";throw new Error("whoops")}function Wie(e){if(e===dr.TEXTURE_2D)return"2d";if(e===dr.TEXTURE_CUBE_MAP)return"cube";if(e===dr.TEXTURE_2D_ARRAY)return"2d-array";if(e===dr.TEXTURE_3D)return"3d";throw new Error("whoops")}function Yie(e){var t=0;return e&Xr.INDEX&&(t|=GPUBufferUsage.INDEX),e&Xr.VERTEX&&(t|=GPUBufferUsage.VERTEX),e&Xr.UNIFORM&&(t|=GPUBufferUsage.UNIFORM),e&Xr.STORAGE&&(t|=GPUBufferUsage.STORAGE),e&Xr.COPY_SRC&&(t|=GPUBufferUsage.COPY_SRC),e&Xr.INDIRECT&&(t|=GPUBufferUsage.INDIRECT),t|=GPUBufferUsage.COPY_DST,t}function eb(e){if(e===qi.CLAMP_TO_EDGE)return"clamp-to-edge";if(e===qi.REPEAT)return"repeat";if(e===qi.MIRRORED_REPEAT)return"mirror-repeat";throw new Error("whoops")}function IP(e){if(e===Rn.BILINEAR)return"linear";if(e===Rn.POINT)return"nearest";throw new Error("whoops")}function $ie(e){if(e===qn.LINEAR)return"linear";if(e===qn.NEAREST)return"nearest";if(e===qn.NO_MIP)return"nearest";throw new Error("whoops")}function xd(e){var t=e;return t.gpuBuffer}function Zie(e){var t=e;return t.gpuSampler}function Kie(e){var t=e;return t.querySet}function Qie(e){if(e===sg.OcclusionConservative)return"occlusion";throw new Error("whoops")}function Jie(e){switch(e){case Fn.TRIANGLES:return"triangle-list";case Fn.POINTS:return"point-list";case Fn.TRIANGLE_STRIP:return"triangle-strip";case Fn.LINES:return"line-list";case Fn.LINE_STRIP:return"line-strip";default:throw new Error("Unknown primitive topology mode")}}function eae(e){if(e===la.NONE)return"none";if(e===la.FRONT)return"front";if(e===la.BACK)return"back";throw new Error("whoops")}function tae(e){if(e===Uv.CCW)return"ccw";if(e===Uv.CW)return"cw";throw new Error("whoops")}function rae(e,t){return{topology:Jie(e),cullMode:eae(t.cullMode),frontFace:tae(t.frontFace)}}function PP(e){if(e===fr.ZERO)return"zero";if(e===fr.ONE)return"one";if(e===fr.SRC)return"src";if(e===fr.ONE_MINUS_SRC)return"one-minus-src";if(e===fr.DST)return"dst";if(e===fr.ONE_MINUS_DST)return"one-minus-dst";if(e===fr.SRC_ALPHA)return"src-alpha";if(e===fr.ONE_MINUS_SRC_ALPHA)return"one-minus-src-alpha";if(e===fr.DST_ALPHA)return"dst-alpha";if(e===fr.ONE_MINUS_DST_ALPHA)return"one-minus-dst-alpha";if(e===fr.CONST)return"constant";if(e===fr.ONE_MINUS_CONSTANT)return"one-minus-constant";if(e===fr.SRC_ALPHA_SATURATE)return"src-alpha-saturated";throw new Error("whoops")}function nae(e){if(e===ti.ADD)return"add";if(e===ti.SUBSTRACT)return"subtract";if(e===ti.REVERSE_SUBSTRACT)return"reverse-subtract";if(e===ti.MIN)return"min";if(e===ti.MAX)return"max";throw new Error("whoops")}function DP(e){return{operation:nae(e.blendMode),srcFactor:PP(e.blendSrcFactor),dstFactor:PP(e.blendDstFactor)}}function LP(e){return e.blendMode===ti.ADD&&e.blendSrcFactor===fr.ONE&&e.blendDstFactor===fr.ZERO}function iae(e){if(!(LP(e.rgbBlendState)&&LP(e.alphaBlendState)))return{color:DP(e.rgbBlendState),alpha:DP(e.alphaBlendState)}}function aae(e,t){return{format:BR(t),blend:iae(e),writeMask:e.channelWriteMask}}function oae(e,t){return t.attachmentsState.map(function(r,n){return aae(r,e[n])})}function y0(e){if(e===Ir.NEVER)return"never";if(e===Ir.LESS)return"less";if(e===Ir.EQUAL)return"equal";if(e===Ir.LEQUAL)return"less-equal";if(e===Ir.GREATER)return"greater";if(e===Ir.NOTEQUAL)return"not-equal";if(e===Ir.GEQUAL)return"greater-equal";if(e===Ir.ALWAYS)return"always";throw new Error("whoops")}function pd(e){if(e===_n.KEEP)return"keep";if(e===_n.REPLACE)return"replace";if(e===_n.ZERO)return"zero";if(e===_n.DECREMENT_CLAMP)return"decrement-clamp";if(e===_n.DECREMENT_WRAP)return"decrement-wrap";if(e===_n.INCREMENT_CLAMP)return"increment-clamp";if(e===_n.INCREMENT_WRAP)return"increment-wrap";if(e===_n.INVERT)return"invert";throw new Error("whoops")}function sae(e,t){if(!Za(e))return{format:BR(e),depthWriteEnabled:!!t.depthWrite,depthCompare:y0(t.depthCompare),depthBias:t.polygonOffset?t.polygonOffsetUnits:0,depthBiasSlopeScale:t.polygonOffset?t.polygonOffsetFactor:0,stencilFront:{compare:y0(t.stencilFront.compare),passOp:pd(t.stencilFront.passOp),failOp:pd(t.stencilFront.failOp),depthFailOp:pd(t.stencilFront.depthFailOp)},stencilBack:{compare:y0(t.stencilBack.compare),passOp:pd(t.stencilBack.passOp),failOp:pd(t.stencilBack.failOp),depthFailOp:pd(t.stencilBack.depthFailOp)},stencilReadMask:4294967295,stencilWriteMask:4294967295}}function uae(e){if(e!==null){if(e===he.U16_R)return"uint16";if(e===he.U32_R)return"uint32";throw new Error("whoops")}}function lae(e){if(e===Vc.VERTEX)return"vertex";if(e===Vc.INSTANCE)return"instance";throw new Error("whoops")}function cae(e){if(e===he.U8_R)return"uint8x2";if(e===he.U8_RG)return"uint8x2";if(e===he.U8_RGB)return"uint8x4";if(e===he.U8_RGBA)return"uint8x4";if(e===he.U8_RG_NORM)return"unorm8x2";if(e===he.U8_RGBA_NORM)return"unorm8x4";if(e===he.S8_RGB_NORM)return"snorm8x4";if(e===he.S8_RGBA_NORM)return"snorm8x4";if(e===he.U16_RG_NORM)return"unorm16x2";if(e===he.U16_RGBA_NORM)return"unorm16x4";if(e===he.S16_RG_NORM)return"snorm16x2";if(e===he.S16_RGBA_NORM)return"snorm16x4";if(e===he.S16_RG)return"uint16x2";if(e===he.F16_RG)return"float16x2";if(e===he.F16_RGBA)return"float16x4";if(e===he.F32_R)return"float32";if(e===he.F32_RG)return"float32x2";if(e===he.F32_RGB)return"float32x3";if(e===he.F32_RGBA)return"float32x4";throw"whoops"}function fae(e){var t=gs(e);switch(t){case Ye.BC1:case Ye.BC2:case Ye.BC3:case Ye.BC4_SNORM:case Ye.BC4_UNORM:case Ye.BC5_SNORM:case Ye.BC5_UNORM:return!0;default:return!1}}function dae(e){var t=gs(e);switch(t){case Ye.BC1:case Ye.BC2:case Ye.BC3:case Ye.BC4_SNORM:case Ye.BC4_UNORM:case Ye.BC5_SNORM:case Ye.BC5_UNORM:return 4;default:return 1}}function BP(e,t,r,n){switch(r===void 0&&(r=!1),e){case he.S8_R:case he.S8_R_NORM:case he.S8_RG_NORM:case he.S8_RGB_NORM:case he.S8_RGBA_NORM:{var i=t instanceof ArrayBuffer?new Int8Array(t):new Int8Array(t);return n&&i.set(new Int8Array(n)),i}case he.U8_R:case he.U8_R_NORM:case he.U8_RG:case he.U8_RG_NORM:case he.U8_RGB:case he.U8_RGB_NORM:case he.U8_RGB_SRGB:case he.U8_RGBA:case he.U8_RGBA_NORM:case he.U8_RGBA_SRGB:{var a=t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t);return n&&a.set(new Uint8Array(n)),a}case he.S16_R:case he.S16_RG:case he.S16_RG_NORM:case he.S16_RGB_NORM:case he.S16_RGBA:case he.S16_RGBA_NORM:{var s=t instanceof ArrayBuffer?new Int16Array(t):new Int16Array(r?t/2:t);return n&&s.set(new Int16Array(n)),s}case he.U16_R:case he.U16_RGB:case he.U16_RGBA_5551:case he.U16_RGBA_NORM:case he.U16_RG_NORM:case he.U16_R_NORM:{var l=t instanceof ArrayBuffer?new Uint16Array(t):new Uint16Array(r?t/2:t);return n&&l.set(new Uint16Array(n)),l}case he.S32_R:{var c=t instanceof ArrayBuffer?new Int32Array(t):new Int32Array(r?t/4:t);return n&&c.set(new Int32Array(n)),c}case he.U32_R:case he.U32_RG:{var d=t instanceof ArrayBuffer?new Uint32Array(t):new Uint32Array(r?t/4:t);return n&&d.set(new Uint32Array(n)),d}case he.F32_R:case he.F32_RG:case he.F32_RGB:case he.F32_RGBA:{var p=t instanceof ArrayBuffer?new Float32Array(t):new Float32Array(r?t/4:t);return n&&p.set(new Float32Array(n)),p}}var h=t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t);return n&&h.set(new Uint8Array(n)),h}function hae(e){var t=(e&32768)>>15,r=(e&31744)>>10,n=e&1023;return r===0?(t?-1:1)*Math.pow(2,-14)*(n/Math.pow(2,10)):r==31?n?NaN:(t?-1:1)*(1/0):(t?-1:1)*Math.pow(2,r-15)*(1+n/Math.pow(2,10))}function NF(e){switch(e){case"r8unorm":case"r8snorm":case"r8uint":case"r8sint":return{width:1,height:1,length:1};case"r16uint":case"r16sint":case"r16float":case"rg8unorm":case"rg8snorm":case"rg8uint":case"rg8sint":return{width:1,height:1,length:2};case"r32uint":case"r32sint":case"r32float":case"rg16uint":case"rg16sint":case"rg16float":case"rgba8unorm":case"rgba8unorm-srgb":case"rgba8snorm":case"rgba8uint":case"rgba8sint":case"bgra8unorm":case"bgra8unorm-srgb":case"rgb9e5ufloat":case"rgb10a2unorm":case"rg11b10ufloat":return{width:1,height:1,length:4};case"rg32uint":case"rg32sint":case"rg32float":case"rgba16uint":case"rgba16sint":case"rgba16float":return{width:1,height:1,length:8};case"rgba32uint":case"rgba32sint":case"rgba32float":return{width:1,height:1,length:16};case"stencil8":throw new Error("No fixed size for Stencil8 format!");case"depth16unorm":return{width:1,height:1,length:2};case"depth24plus":throw new Error("No fixed size for Depth24Plus format!");case"depth24plus-stencil8":throw new Error("No fixed size for Depth24PlusStencil8 format!");case"depth32float":return{width:1,height:1,length:4};case"depth32float-stencil8":return{width:1,height:1,length:5};case"bc7-rgba-unorm":case"bc7-rgba-unorm-srgb":case"bc6h-rgb-ufloat":case"bc6h-rgb-float":case"bc2-rgba-unorm":case"bc2-rgba-unorm-srgb":case"bc3-rgba-unorm":case"bc3-rgba-unorm-srgb":case"bc5-rg-unorm":case"bc5-rg-snorm":return{width:4,height:4,length:16};case"bc4-r-unorm":case"bc4-r-snorm":case"bc1-rgba-unorm":case"bc1-rgba-unorm-srgb":return{width:4,height:4,length:8};default:return{width:1,height:1,length:4}}}var Lo=(function(e){En(t,e);function t(r){var n=r.id,i=r.device,a=e.call(this)||this;return a.id=n,a.device=i,a}return t.prototype.destroy=function(){},t})(mF),pae=(function(e){En(t,e);function t(r){var n=r.id,i=r.device,a=r.descriptor,s,l,c=e.call(this,{id:n,device:i})||this;c.type=Cr.Bindings;var d=a.pipeline;rr(!!d);var p=a.uniformBufferBindings,h=a.storageBufferBindings,m=a.samplerBindings,_=a.storageTextureBindings;c.numUniformBuffers=p?.length||0;var y=[[],[],[],[]],E=0;if(p&&p.length)for(var T=0;T<p.length;T++){var A=a.uniformBufferBindings[T],b=A.binding,R=A.size,M=A.offset,B=A.buffer,w={buffer:xd(B),offset:M??0,size:R};y[0].push({binding:b??E++,resource:w})}if(m&&m.length){E=0;for(var T=0;T<m.length;T++){var D=pn(pn({},m[T]),xF),b=a.samplerBindings[T],U=b.texture!==null?b.texture:c.device.getFallbackTexture(D);D.dimension=U.dimension,D.formatKind=yF(U.format);var ae=U.gpuTextureView;if(y[1].push({binding:(s=b.textureBinding)!==null&&s!==void 0?s:E++,resource:ae}),b.samplerBinding!==-1){var Q=b.sampler!==null?b.sampler:c.device.getFallbackSampler(D),X=Zie(Q);y[1].push({binding:(l=b.samplerBinding)!==null&&l!==void 0?l:E++,resource:X})}}}if(h&&h.length){E=0;for(var T=0;T<h.length;T++){var x=a.storageBufferBindings[T],b=x.binding,R=x.size,M=x.offset,B=x.buffer,w={buffer:xd(B),offset:M??0,size:R};y[2].push({binding:b??E++,resource:w})}}if(_&&_.length){E=0;for(var T=0;T<_.length;T++){var P=a.storageTextureBindings[T],b=P.binding,U=P.texture,ae=U.gpuTextureView;y[3].push({binding:b??E++,resource:ae})}}var H=y.findLastIndex(function(pe){return!!pe.length});return c.gpuBindGroup=y.map(function(pe,O){return O<=H&&c.device.device.createBindGroup({layout:d.getBindGroupLayout(O),entries:pe})}),c}return t})(Lo),vae=(function(e){En(t,e);function t(r){var n=r.id,i=r.device,a=r.descriptor,s=e.call(this,{id:n,device:i})||this;s.type=Cr.Buffer;var l=a.usage,c=a.viewOrSize,d=!!(l&Xr.MAP_READ);s.usage=Yie(l),d&&(s.usage=Xr.MAP_READ|Xr.COPY_DST);var p=!Ad(c);if(s.view=Ad(c)?null:c,s.size=Ad(c)?lg(c,4):lg(c.byteLength,4),Ad(c))s.gpuBuffer=s.device.device.createBuffer({usage:s.usage,size:s.size,mappedAtCreation:d?p:!1});else{s.gpuBuffer=s.device.device.createBuffer({usage:s.usage,size:s.size,mappedAtCreation:!0});var h=c&&c.constructor||Float32Array;new h(s.gpuBuffer.getMappedRange()).set(c),s.gpuBuffer.unmap()}return s}return t.prototype.setSubData=function(r,n,i,a){i===void 0&&(i=0),a===void 0&&(a=0);var s=this.gpuBuffer;a=a||n.byteLength,a=Math.min(a,this.size-r);var l=n.byteOffset+i,c=l+a,d=a+3&-4;if(d!==a){var p=new Uint8Array(n.buffer.slice(l,c));n=new Uint8Array(d),n.set(p),i=0,l=0,c=d,a=d}for(var h=1024*1024*15,m=0;c-(l+m)>h;)this.device.device.queue.writeBuffer(s,r+m,n.buffer,l+m,h),m+=h;this.device.device.queue.writeBuffer(s,r+m,n.buffer,l+m,a-m)},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.gpuBuffer.destroy()},t})(Lo),FP=(function(){function e(){this.gpuComputePassEncoder=null}return e.prototype.dispatchWorkgroups=function(t,r,n){this.gpuComputePassEncoder.dispatchWorkgroups(t,r,n)},e.prototype.dispatchWorkgroupsIndirect=function(t,r){this.gpuComputePassEncoder.dispatchWorkgroupsIndirect(t.gpuBuffer,r)},e.prototype.finish=function(){this.gpuComputePassEncoder.end(),this.gpuComputePassEncoder=null,this.frameCommandEncoder=null},e.prototype.beginComputePass=function(t){rr(this.gpuComputePassEncoder===null),this.frameCommandEncoder=t,this.gpuComputePassEncoder=this.frameCommandEncoder.beginComputePass(this.gpuComputePassDescriptor)},e.prototype.setPipeline=function(t){var r=t,n=wc(r.gpuComputePipeline);this.gpuComputePassEncoder.setPipeline(n)},e.prototype.setBindings=function(t){var r=this,n=t;n.gpuBindGroup.forEach(function(i,a){i&&r.gpuComputePassEncoder.setBindGroup(a,n.gpuBindGroup[a])})},e.prototype.pushDebugGroup=function(t){this.gpuComputePassEncoder.pushDebugGroup(t)},e.prototype.popDebugGroup=function(){this.gpuComputePassEncoder.popDebugGroup()},e.prototype.insertDebugMarker=function(t){this.gpuComputePassEncoder.insertDebugMarker(t)},e})(),mae=(function(e){En(t,e);function t(r){var n=r.id,i=r.device,a=r.descriptor,s=e.call(this,{id:n,device:i})||this;s.type=Cr.ComputePipeline,s.gpuComputePipeline=null,s.descriptor=a;var l=a.program,c=l.computeStage;if(c===null)return s;var d={layout:"auto",compute:pn({},c)};return s.gpuComputePipeline=s.device.device.createComputePipeline(d),s.name!==void 0&&(s.gpuComputePipeline.label=s.name),s}return t.prototype.getBindGroupLayout=function(r){return this.gpuComputePipeline.getBindGroupLayout(r)},t})(Lo),_ae=(function(e){En(t,e);function t(r){var n,i,a,s,l=r.id,c=r.device,d=r.descriptor,p=e.call(this,{id:l,device:c})||this;p.type=Cr.InputLayout;var h=[];try{for(var m=Hc(d.vertexBufferDescriptors),_=m.next();!_.done;_=m.next()){var y=_.value,E=y.arrayStride,T=y.stepMode,A=y.attributes;h.push({arrayStride:E,stepMode:lae(T),attributes:[]});try{for(var b=(a=void 0,Hc(A)),R=b.next();!R.done;R=b.next()){var M=R.value,B=M.shaderLocation,w=M.format,D=M.offset;h[h.length-1].attributes.push({shaderLocation:B,format:cae(w),offset:D})}}catch(U){a={error:U}}finally{try{R&&!R.done&&(s=b.return)&&s.call(b)}finally{if(a)throw a.error}}}}catch(U){n={error:U}}finally{try{_&&!_.done&&(i=m.return)&&i.call(m)}finally{if(n)throw n.error}}return p.indexFormat=uae(d.indexBufferFormat),p.buffers=h,p}return t})(Lo),UP=(function(e){En(t,e);function t(r){var n=r.id,i=r.device,a=r.descriptor,s=e.call(this,{id:n,device:i})||this;return s.type=Cr.Program,s.vertexStage=null,s.fragmentStage=null,s.computeStage=null,s.descriptor=a,a.vertex&&(s.vertexStage=s.createShaderStage(a.vertex,"vertex")),a.fragment&&(s.fragmentStage=s.createShaderStage(a.fragment,"fragment")),a.compute&&(s.computeStage=s.createShaderStage(a.compute,"compute")),s}return t.prototype.setUniformsLegacy=function(r){},t.prototype.createShaderStage=function(r,n){var i,a,s=r.glsl,l=r.wgsl,c=r.entryPoint,d=r.postprocess,p=!1,h=l;if(!h)try{h=this.device.glsl_compile(s,n,p)}catch(A){throw console.error(A,s),new Error("whoops")}var m=function(A){if(!h.includes(A))return"continue";h=h.replace("var T_".concat(A,": texture_2d<f32>;"),"var T_".concat(A,": texture_depth_2d;")),h=h.replace(new RegExp("textureSample\\(T_".concat(A,"(.*)\\);$"),"gm"),function(b,R){return"vec4<f32>(textureSample(T_".concat(A).concat(R,"), 0.0, 0.0, 0.0);")})};try{for(var _=Hc(["u_TextureFramebufferDepth"]),y=_.next();!y.done;y=_.next()){var E=y.value;m(E)}}catch(A){i={error:A}}finally{try{y&&!y.done&&(a=_.return)&&a.call(_)}finally{if(i)throw i.error}}d&&(h=d(h));var T=this.device.device.createShaderModule({code:h});return{module:T,entryPoint:c||"main"}},t})(Lo),gae=(function(e){En(t,e);function t(r){var n=r.id,i=r.device,a=r.descriptor,s=e.call(this,{id:n,device:i})||this;s.type=Cr.QueryPool;var l=a.elemCount,c=a.type;return s.querySet=s.device.device.createQuerySet({type:Qie(c),count:l}),s.resolveBuffer=s.device.device.createBuffer({size:l*8,usage:GPUBufferUsage.QUERY_RESOLVE|GPUBufferUsage.COPY_SRC}),s.cpuBuffer=s.device.device.createBuffer({size:l*8,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ}),s.results=null,s}return t.prototype.queryResultOcclusion=function(r){return this.results===null?null:this.results[r]!==BigInt(0)},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.querySet.destroy(),this.resolveBuffer.destroy(),this.cpuBuffer.destroy()},t})(Lo),yae=(function(e){En(t,e);function t(r){var n=r.id,i=r.device,a=e.call(this,{id:n,device:i})||this;return a.type=Cr.Readback,a}return t.prototype.readTexture=function(r,n,i,a,s,l,c,d){return c===void 0&&(c=0),Id(this,void 0,void 0,function(){var p,h,m,_,y,E,T,A;return Pd(this,function(b){return p=r,h=0,m=NF(p.gpuTextureformat),_=Math.ceil(a/m.width)*m.length,y=Math.ceil(_/256)*256,E=y*s,T=this.device.createBuffer({usage:Xr.STORAGE|Xr.MAP_READ|Xr.COPY_DST,hint:No.STATIC,viewOrSize:E}),A=this.device.device.createCommandEncoder(),A.copyTextureToBuffer({texture:p.gpuTexture,mipLevel:0,origin:{x:n,y:i,z:Math.max(h,0)}},{buffer:T.gpuBuffer,offset:0,bytesPerRow:y},{width:a,height:s,depthOrArrayLayers:1}),this.device.device.queue.submit([A.finish()]),[2,this.readBuffer(T,0,l.byteLength===E?l:null,c,E,p.format,!0,!1,_,y,s)]})})},t.prototype.readTextureSync=function(r,n,i,a,s,l,c,d){throw new Error("ERROR_MSG_METHOD_NOT_IMPLEMENTED")},t.prototype.readBuffer=function(r,n,i,a,s,l,c,d,p,h,m){var _=this;n===void 0&&(n=0),i===void 0&&(i=null),s===void 0&&(s=0),l===void 0&&(l=he.U8_RGB),c===void 0&&(c=!1),p===void 0&&(p=0),h===void 0&&(h=0),m===void 0&&(m=0);var y=r,E=s||y.size,T=i||y.view,A=T&&T.constructor&&T.constructor.BYTES_PER_ELEMENT||gF(l),b=y;if(!(y.usage&Xr.MAP_READ&&y.usage&Xr.COPY_DST)){var R=this.device.device.createCommandEncoder();b=this.device.createBuffer({usage:Xr.STORAGE|Xr.MAP_READ|Xr.COPY_DST,hint:No.STATIC,viewOrSize:E}),R.copyBufferToBuffer(y.gpuBuffer,n,b.gpuBuffer,0,E),this.device.device.queue.submit([R.finish()])}return new Promise(function(M,B){b.gpuBuffer.mapAsync(mx.READ,n,E).then(function(){var w=b.gpuBuffer.getMappedRange(n,E),D=T;if(c)D===null?D=BP(l,E,!0,w):D=BP(l,D.buffer,void 0,w);else if(D===null)switch(A){case 1:D=new Uint8Array(E),D.set(new Uint8Array(w));break;case 2:D=_.getHalfFloatAsFloatRGBAArrayBuffer(E/2,w);break;case 4:D=new Float32Array(E/4),D.set(new Float32Array(w));break}else switch(A){case 1:D=new Uint8Array(D.buffer),D.set(new Uint8Array(w));break;case 2:D=_.getHalfFloatAsFloatRGBAArrayBuffer(E/2,w,T);break;case 4:var U=T&&T.constructor||Float32Array;D=new U(D.buffer),D.set(new U(w));break}if(p!==h){A===1&&!c&&(p*=2,h*=2);for(var ae=new Uint8Array(D.buffer),Q=p,X=0,x=1;x<m;++x){X=x*h;for(var P=0;P<p;++P)ae[Q++]=ae[X++]}A!==0&&!c?D=new Float32Array(ae.buffer,0,Q/4):D=new Uint8Array(ae.buffer,0,Q)}b.gpuBuffer.unmap(),M(D)},function(w){return B(w)})})},t.prototype.getHalfFloatAsFloatRGBAArrayBuffer=function(r,n,i){i||(i=new Float32Array(r));for(var a=new Uint16Array(n);r--;)i[r]=hae(a[r]);return i},t})(Lo),kP=(function(){function e(t){this.device=t,this.gpuRenderPassEncoder=null,this.gfxColorAttachment=[],this.gfxColorAttachmentLevel=[],this.gfxColorResolveTo=[],this.gfxColorResolveToLevel=[],this.gfxDepthStencilAttachment=null,this.gfxDepthStencilResolveTo=null,this.gpuColorAttachments=[],this.gpuDepthStencilAttachment={view:null,depthLoadOp:"load",depthStoreOp:"store",stencilLoadOp:"load",stencilStoreOp:"store"},this.gpuRenderPassDescriptor={colorAttachments:this.gpuColorAttachments,depthStencilAttachment:this.gpuDepthStencilAttachment}}return e.prototype.getEncoder=function(){var t;return((t=this.renderBundle)===null||t===void 0?void 0:t.renderBundleEncoder)||this.gpuRenderPassEncoder},e.prototype.getTextureView=function(t,r){return rr(r<t.mipLevelCount),t.mipLevelCount===1?t.gpuTextureView:t.gpuTexture.createView({baseMipLevel:r,mipLevelCount:1})},e.prototype.setRenderPassDescriptor=function(t){var r,n,i,a,s,l;this.descriptor=t,this.gpuRenderPassDescriptor.colorAttachments=this.gpuColorAttachments;var c=t.colorAttachment.length;this.gfxColorAttachment.length=c,this.gfxColorResolveTo.length=c;for(var d=0;d<t.colorAttachment.length;d++){var p=t.colorAttachment[d],h=t.colorResolveTo[d];if(p===null&&h!==null&&(p=h,h=null),this.gfxColorAttachment[d]=p,this.gfxColorResolveTo[d]=h,this.gfxColorAttachmentLevel[d]=((r=t.colorAttachmentLevel)===null||r===void 0?void 0:r[d])||0,this.gfxColorResolveToLevel[d]=((n=t.colorResolveToLevel)===null||n===void 0?void 0:n[d])||0,p!==null){this.gpuColorAttachments[d]===void 0&&(this.gpuColorAttachments[d]={});var m=this.gpuColorAttachments[d];m.view=this.getTextureView(p,((i=this.gfxColorAttachmentLevel)===null||i===void 0?void 0:i[d])||0);var _=(s=(a=t.colorClearColor)===null||a===void 0?void 0:a[d])!==null&&s!==void 0?s:"load";_==="load"?m.loadOp="load":(m.loadOp="clear",m.clearValue=_),m.storeOp=!((l=t.colorStore)===null||l===void 0)&&l[d]?"store":"discard",m.resolveTarget=void 0,h!==null&&(p.sampleCount>1?m.resolveTarget=this.getTextureView(h,this.gfxColorResolveToLevel[d]):m.storeOp="store")}else{this.gpuColorAttachments.length=d,this.gfxColorAttachment.length=d,this.gfxColorResolveTo.length=d;break}}if(this.gfxDepthStencilAttachment=t.depthStencilAttachment,this.gfxDepthStencilResolveTo=t.depthStencilResolveTo,t.depthStencilAttachment){var y=t.depthStencilAttachment,m=this.gpuDepthStencilAttachment;m.view=y.gpuTextureView;var E=!!(Yd(y.format)&At.Depth);E?(t.depthClearValue==="load"?m.depthLoadOp="load":(m.depthLoadOp="clear",m.depthClearValue=t.depthClearValue),t.depthStencilStore||this.gfxDepthStencilResolveTo!==null?m.depthStoreOp="store":m.depthStoreOp="discard"):(m.depthLoadOp=void 0,m.depthStoreOp=void 0);var T=!!(Yd(y.format)&At.Stencil);T?(t.stencilClearValue==="load"?m.stencilLoadOp="load":(m.stencilLoadOp="clear",m.stencilClearValue=t.stencilClearValue),t.depthStencilStore||this.gfxDepthStencilResolveTo!==null?m.stencilStoreOp="store":m.stencilStoreOp="discard"):(m.stencilLoadOp=void 0,m.stencilStoreOp=void 0),this.gpuRenderPassDescriptor.depthStencilAttachment=this.gpuDepthStencilAttachment}else this.gpuRenderPassDescriptor.depthStencilAttachment=void 0;this.gpuRenderPassDescriptor.occlusionQuerySet=Za(t.occlusionQueryPool)?void 0:Kie(t.occlusionQueryPool)},e.prototype.beginRenderPass=function(t,r){rr(this.gpuRenderPassEncoder===null),this.setRenderPassDescriptor(r),this.frameCommandEncoder=t,this.gpuRenderPassEncoder=this.frameCommandEncoder.beginRenderPass(this.gpuRenderPassDescriptor)},e.prototype.flipY=function(t,r){var n=this.device.swapChainHeight;return n-t-r},e.prototype.setViewport=function(t,r,n,i,a,s){a===void 0&&(a=0),s===void 0&&(s=1),this.gpuRenderPassEncoder.setViewport(t,this.flipY(r,i),n,i,a,s)},e.prototype.setScissorRect=function(t,r,n,i){this.gpuRenderPassEncoder.setScissorRect(t,this.flipY(r,i),n,i)},e.prototype.setPipeline=function(t){var r=t,n=wc(r.gpuRenderPipeline);this.getEncoder().setPipeline(n)},e.prototype.setVertexInput=function(t,r,n){if(t!==null){var i=this.getEncoder(),a=t;n!==null&&i.setIndexBuffer(xd(n.buffer),wc(a.indexFormat),n.offset);for(var s=0;s<r.length;s++){var l=r[s];l!==null&&i.setVertexBuffer(s,xd(l.buffer),l.offset)}}},e.prototype.setBindings=function(t){var r=t,n=this.getEncoder();r.gpuBindGroup.forEach(function(i,a){i&&n.setBindGroup(a,r.gpuBindGroup[a])})},e.prototype.setStencilReference=function(t){this.gpuRenderPassEncoder.setStencilReference(t)},e.prototype.draw=function(t,r,n,i){this.getEncoder().draw(t,r,n,i)},e.prototype.drawIndexed=function(t,r,n,i,a){this.getEncoder().drawIndexed(t,r,n,i,a)},e.prototype.drawIndirect=function(t,r){this.getEncoder().drawIndirect(xd(t),r)},e.prototype.drawIndexedIndirect=function(t,r){this.getEncoder().drawIndexedIndirect(xd(t),r)},e.prototype.beginOcclusionQuery=function(t){this.gpuRenderPassEncoder.beginOcclusionQuery(t)},e.prototype.endOcclusionQuery=function(){this.gpuRenderPassEncoder.endOcclusionQuery()},e.prototype.pushDebugGroup=function(t){this.gpuRenderPassEncoder.pushDebugGroup(t)},e.prototype.popDebugGroup=function(){this.gpuRenderPassEncoder.popDebugGroup()},e.prototype.insertDebugMarker=function(t){this.gpuRenderPassEncoder.insertDebugMarker(t)},e.prototype.beginBundle=function(t){this.renderBundle=t},e.prototype.endBundle=function(){this.renderBundle.finish()},e.prototype.executeBundles=function(t){this.gpuRenderPassEncoder.executeBundles(t.map(function(r){return r.renderBundle}))},e.prototype.finish=function(){var t;(t=this.gpuRenderPassEncoder)===null||t===void 0||t.end(),this.gpuRenderPassEncoder=null;for(var r=0;r<this.gfxColorAttachment.length;r++){var n=this.gfxColorAttachment[r],i=this.gfxColorResolveTo[r];n!==null&&i!==null&&n.sampleCount===1&&this.copyAttachment(i,this.gfxColorAttachmentLevel[r],n,this.gfxColorResolveToLevel[r])}this.gfxDepthStencilAttachment&&this.gfxDepthStencilResolveTo&&(this.gfxDepthStencilAttachment.sampleCount>1||this.copyAttachment(this.gfxDepthStencilResolveTo,0,this.gfxDepthStencilAttachment,0)),this.frameCommandEncoder=null},e.prototype.copyAttachment=function(t,r,n,i){rr(n.sampleCount===1);var a={texture:n.gpuTexture,mipLevel:i},s={texture:t.gpuTexture,mipLevel:r};rr(n.width>>>i===t.width>>>r),rr(n.height>>>i===t.height>>>r),rr(!!(n.usage&Gn.COPY_SRC)),rr(!!(t.usage&Gn.COPY_DST)),this.frameCommandEncoder.copyTextureToTexture(a,s,[t.width,t.height,1])},e})(),Eae=(function(e){En(t,e);function t(r){var n=r.id,i=r.device,a=r.descriptor,s=e.call(this,{id:n,device:i})||this;return s.type=Cr.RenderPipeline,s.isCreatingAsync=!1,s.gpuRenderPipeline=null,s.descriptor=a,s.device.createRenderPipelineInternal(s,!1),s}return t.prototype.getBindGroupLayout=function(r){return this.gpuRenderPipeline.getBindGroupLayout(r)},t})(Lo),Tae=(function(e){En(t,e);function t(r){var n=r.id,i=r.device,a=r.descriptor,s,l,c=e.call(this,{id:n,device:i})||this;c.type=Cr.Sampler;var d=a.lodMinClamp,p=a.mipmapFilter===qn.NO_MIP?a.lodMinClamp:a.lodMaxClamp,h=(s=a.maxAnisotropy)!==null&&s!==void 0?s:1;return h>1&&rr(a.minFilter===Rn.BILINEAR&&a.magFilter===Rn.BILINEAR&&a.mipmapFilter===qn.LINEAR),c.gpuSampler=c.device.device.createSampler({addressModeU:eb(a.addressModeU),addressModeV:eb(a.addressModeV),addressModeW:eb((l=a.addressModeW)!==null&&l!==void 0?l:a.addressModeU),lodMinClamp:d,lodMaxClamp:p,minFilter:IP(a.minFilter),magFilter:IP(a.magFilter),mipmapFilter:$ie(a.mipmapFilter),compare:a.compareFunction!==void 0?y0(a.compareFunction):void 0,maxAnisotropy:h}),c}return t})(Lo),W_=(function(e){En(t,e);function t(r){var n=r.id,i=r.device,a=r.descriptor,s=r.skipCreate,l=r.sampleCount,c=e.call(this,{id:n,device:i})||this;c.type=Cr.Texture,c.flipY=!1;var d=a.format,p=a.dimension,h=a.width,m=a.height,_=a.depthOrArrayLayers,y=a.mipLevelCount,E=a.usage,T=a.pixelStore;return c.flipY=!!T?.unpackFlipY,c.device.createTextureShared({format:d,dimension:p??dr.TEXTURE_2D,width:h,height:m,depthOrArrayLayers:_??1,mipLevelCount:y??1,usage:E,sampleCount:l??1},c,s),c}return t.prototype.textureFromImageBitmapOrCanvas=function(r,n,i){for(var a=n[0].width,s=n[0].height,l={size:{width:a,height:s,depthOrArrayLayers:i},format:"rgba8unorm",usage:GPUTextureUsage.TEXTURE_BINDING|GPUTextureUsage.COPY_DST|GPUTextureUsage.RENDER_ATTACHMENT},c=r.createTexture(l),d=0;d<n.length;d++)r.queue.copyExternalImageToTexture({source:n[d],flipY:this.flipY},{texture:c,origin:[0,0,d]},[a,s]);return[c,a,s]},t.prototype.isImageBitmapOrCanvases=function(r){var n=r[0];return n instanceof ImageBitmap||n instanceof HTMLCanvasElement||n instanceof OffscreenCanvas},t.prototype.isVideo=function(r){var n=r[0];return n instanceof HTMLVideoElement},t.prototype.setImageData=function(r,n){var i,a=this,s=this.device.device,l,c,d;if(this.isImageBitmapOrCanvases(r))i=Ro(this.textureFromImageBitmapOrCanvas(s,r,this.depthOrArrayLayers),3),l=i[0],c=i[1],d=i[2];else if(this.isVideo(r))l=s.importExternalTexture({source:r[0]});else{var p=NF(this.gpuTextureformat),h=Math.ceil(this.width/p.width)*p.length;r.forEach(function(m){s.queue.writeTexture({texture:a.gpuTexture},m,{bytesPerRow:h},{width:a.width,height:a.height})})}this.width=c,this.height=d,l&&(this.gpuTexture=l),this.gpuTextureView=this.gpuTexture.createView({dimension:Wie(this.dimension)})},t.prototype.destroy=function(){e.prototype.destroy.call(this),this.gpuTexture.destroy()},t})(Lo),Sae=(function(e){En(t,e);function t(r){var n=r.id,i=r.device,a=e.call(this,{id:n,device:i})||this;return a.type=Cr.RenderBundle,a.renderBundleEncoder=a.device.device.createRenderBundleEncoder({colorFormats:[a.device.swapChainFormat]}),a}return t.prototype.finish=function(){this.renderBundle=this.renderBundleEncoder.finish()},t})(Lo),Aae=(function(){function e(t,r,n,i,a,s){this.swapChainWidth=0,this.swapChainHeight=0,this.swapChainTextureUsage=Gn.RENDER_ATTACHMENT|Gn.COPY_DST,this._resourceUniqueId=0,this.renderPassPool=[],this.computePassPool=[],this.frameCommandEncoderPool=[],this.featureTextureCompressionBC=!1,this.platformString="WebGPU",this.glslVersion="#version 440",this.explicitBindingLocations=!0,this.separateSamplerTextures=!0,this.viewportOrigin=wo.UPPER_LEFT,this.clipSpaceNearZ=Wd.ZERO,this.supportsSyncPipelineCompilation=!1,this.supportMRT=!0,this.device=r,this.canvas=n,this.canvasContext=i,this.glsl_compile=a,this.WGSLComposer=s,this.fallbackTexture2D=this.createFallbackTexture(dr.TEXTURE_2D,mn.Float),this.setResourceName(this.fallbackTexture2D,"Fallback Texture2D"),this.fallbackTexture2DDepth=this.createFallbackTexture(dr.TEXTURE_2D,mn.Depth),this.setResourceName(this.fallbackTexture2DDepth,"Fallback Depth Texture2D"),this.fallbackTexture2DArray=this.createFallbackTexture(dr.TEXTURE_2D_ARRAY,mn.Float),this.setResourceName(this.fallbackTexture2DArray,"Fallback Texture2DArray"),this.fallbackTexture3D=this.createFallbackTexture(dr.TEXTURE_3D,mn.Float),this.setResourceName(this.fallbackTexture3D,"Fallback Texture3D"),this.fallbackTextureCube=this.createFallbackTexture(dr.TEXTURE_CUBE_MAP,mn.Float),this.setResourceName(this.fallbackTextureCube,"Fallback TextureCube"),this.fallbackSamplerFiltering=this.createSampler({addressModeU:qi.REPEAT,addressModeV:qi.REPEAT,minFilter:Rn.POINT,magFilter:Rn.POINT,mipmapFilter:qn.NEAREST}),this.setResourceName(this.fallbackSamplerFiltering,"Fallback Sampler Filtering"),this.fallbackSamplerComparison=this.createSampler({addressModeU:qi.REPEAT,addressModeV:qi.REPEAT,minFilter:Rn.POINT,magFilter:Rn.POINT,mipmapFilter:qn.NEAREST,compareFunction:Ir.ALWAYS}),this.setResourceName(this.fallbackSamplerComparison,"Fallback Sampler Comparison Filtering"),this.device.features&&(this.featureTextureCompressionBC=this.device.features.has("texture-compression-bc")),this.device.onuncapturederror=function(l){console.error(l.error)},this.swapChainFormat=navigator.gpu.getPreferredCanvasFormat(),this.canvasContext.configure({device:this.device,format:this.swapChainFormat,usage:this.swapChainTextureUsage,alphaMode:"premultiplied"})}return e.prototype.destroy=function(){},e.prototype.configureSwapChain=function(t,r){this.swapChainWidth===t&&this.swapChainHeight===r||(this.swapChainWidth=t,this.swapChainHeight=r)},e.prototype.getOnscreenTexture=function(){var t=this.canvasContext.getCurrentTexture(),r=t.createView(),n=new W_({id:0,device:this,descriptor:{format:he.U8_RGBA_RT,width:this.swapChainWidth,height:this.swapChainHeight,depthOrArrayLayers:0,dimension:dr.TEXTURE_2D,mipLevelCount:1,usage:this.swapChainTextureUsage},skipCreate:!0});return n.depthOrArrayLayers=1,n.sampleCount=1,n.gpuTexture=t,n.gpuTextureView=r,n.name="Onscreen",this.setResourceName(n,"Onscreen Texture"),n},e.prototype.getDevice=function(){return this},e.prototype.getCanvas=function(){return this.canvas},e.prototype.beginFrame=function(){rr(this.frameCommandEncoderPool.length===0)},e.prototype.endFrame=function(){rr(this.frameCommandEncoderPool.every(function(t){return t!==null})),this.device.queue.submit(this.frameCommandEncoderPool.map(function(t){return t.finish()})),this.frameCommandEncoderPool=[]},e.prototype.getNextUniqueId=function(){return++this._resourceUniqueId},e.prototype.createBuffer=function(t){return new vae({id:this.getNextUniqueId(),device:this,descriptor:t})},e.prototype.createTexture=function(t){return new W_({id:this.getNextUniqueId(),device:this,descriptor:t})},e.prototype.createSampler=function(t){return new Tae({id:this.getNextUniqueId(),device:this,descriptor:t})},e.prototype.createRenderTarget=function(t){var r=new W_({id:this.getNextUniqueId(),device:this,descriptor:pn(pn({},t),{dimension:dr.TEXTURE_2D,mipLevelCount:1,depthOrArrayLayers:1,usage:Pi.RENDER_TARGET}),sampleCount:t.sampleCount});return r.depthOrArrayLayers=1,r.type=Cr.RenderTarget,r},e.prototype.createRenderTargetFromTexture=function(t){var r=t,n=r.format,i=r.width,a=r.height,s=r.depthOrArrayLayers,l=r.sampleCount,c=r.mipLevelCount,d=r.gpuTexture,p=r.gpuTextureView,h=r.usage;rr(!!(h&Gn.RENDER_ATTACHMENT));var m=new W_({id:this.getNextUniqueId(),device:this,descriptor:{format:n,width:i,height:a,depthOrArrayLayers:s,dimension:dr.TEXTURE_2D,mipLevelCount:c,usage:h},skipCreate:!0});return m.depthOrArrayLayers=s,m.sampleCount=l,m.gpuTexture=d,m.gpuTextureView=p,m},e.prototype.createProgram=function(t){var r,n;return!((r=t.vertex)===null||r===void 0)&&r.glsl&&(t.vertex.glsl=Kd(this.queryVendorInfo(),"vert",t.vertex.glsl)),!((n=t.fragment)===null||n===void 0)&&n.glsl&&(t.fragment.glsl=Kd(this.queryVendorInfo(),"frag",t.fragment.glsl)),new UP({id:this.getNextUniqueId(),device:this,descriptor:t})},e.prototype.createProgramSimple=function(t){return new UP({id:this.getNextUniqueId(),device:this,descriptor:t})},e.prototype.createTextureShared=function(t,r,n){var i={width:t.width,height:t.height,depthOrArrayLayers:t.depthOrArrayLayers},a=t.mipLevelCount,s=BR(t.format),l=qie(t.dimension),c=Gie(t.usage);if(r.gpuTextureformat=s,r.dimension=t.dimension,r.format=t.format,r.width=t.width,r.height=t.height,r.depthOrArrayLayers=t.depthOrArrayLayers,r.mipLevelCount=a,r.usage=c,r.sampleCount=t.sampleCount,!n){var d=this.device.createTexture({size:i,mipLevelCount:a,format:s,dimension:l,sampleCount:t.sampleCount,usage:c}),p=d.createView();r.gpuTexture=d,r.gpuTextureView=p}},e.prototype.getFallbackSampler=function(t){var r=t.formatKind;return r===mn.Depth&&t.comparison?this.fallbackSamplerComparison:this.fallbackSamplerFiltering},e.prototype.getFallbackTexture=function(t){var r=t.dimension,n=t.formatKind;if(r===dr.TEXTURE_2D)return n===mn.Depth?this.fallbackTexture2DDepth:this.fallbackTexture2D;if(r===dr.TEXTURE_2D_ARRAY)return this.fallbackTexture2DArray;if(r===dr.TEXTURE_3D)return this.fallbackTexture3D;if(r===dr.TEXTURE_CUBE_MAP)return this.fallbackTextureCube;throw new Error("whoops")},e.prototype.createFallbackTexture=function(t,r){var n=t===dr.TEXTURE_CUBE_MAP?6:1,i=r===mn.Float?he.U8_RGBA_NORM:he.D24;return this.createTexture({dimension:t,format:i,usage:Pi.SAMPLED,width:1,height:1,depthOrArrayLayers:n,mipLevelCount:1})},e.prototype.createBindings=function(t){return new pae({id:this.getNextUniqueId(),device:this,descriptor:t})},e.prototype.createInputLayout=function(t){return new _ae({id:this.getNextUniqueId(),device:this,descriptor:t})},e.prototype.createComputePipeline=function(t){return new mae({id:this.getNextUniqueId(),device:this,descriptor:t})},e.prototype.createRenderPipeline=function(t){return new Eae({id:this.getNextUniqueId(),device:this,descriptor:pn({},t)})},e.prototype.createQueryPool=function(t,r){return new gae({id:this.getNextUniqueId(),device:this,descriptor:{type:t,elemCount:r}})},e.prototype.createRenderPipelineInternal=function(t,r){var n;if(t.gpuRenderPipeline===null){var i=t.descriptor,a=i.program,s=a.vertexStage,l=a.fragmentStage;if(!(s===null||l===null)){var c=i.megaStateDescriptor||{},d=c.stencilBack,p=c.stencilFront,h=Mne(c,["stencilBack","stencilFront"]),m=$d(Zd);i.megaStateDescriptor=pn(pn(pn({},m),{stencilBack:pn(pn({},m.stencilBack),d),stencilFront:pn(pn({},m.stencilFront),p)}),h);var _=i.megaStateDescriptor.attachmentsState[0];i.colorAttachmentFormats.forEach(function(M,B){i.megaStateDescriptor.attachmentsState[B]||(i.megaStateDescriptor.attachmentsState[B]=AF(void 0,_))});var y=rae((n=i.topology)!==null&&n!==void 0?n:Fn.TRIANGLES,i.megaStateDescriptor),E=oae(i.colorAttachmentFormats,i.megaStateDescriptor),T=sae(i.depthStencilAttachmentFormat,i.megaStateDescriptor),A=void 0;i.inputLayout!==null&&(A=i.inputLayout.buffers);var b=i.sampleCount,R={layout:"auto",vertex:pn(pn({},s),{buffers:A}),primitive:y,depthStencil:T,multisample:{count:b},fragment:pn(pn({},l),{targets:E})};t.gpuRenderPipeline=this.device.createRenderPipeline(R)}}},e.prototype.createReadback=function(){return new yae({id:this.getNextUniqueId(),device:this})},e.prototype.createRenderBundle=function(){return new Sae({id:this.getNextUniqueId(),device:this})},e.prototype.createRenderPass=function(t){var r=this.renderPassPool.pop();r===void 0&&(r=new kP(this));var n=this.frameCommandEncoderPool.pop();return n===void 0&&(n=this.device.createCommandEncoder()),r.beginRenderPass(n,t),r},e.prototype.createComputePass=function(){var t=this.computePassPool.pop();t===void 0&&(t=new FP);var r=this.frameCommandEncoderPool.pop();return r===void 0&&(r=this.device.createCommandEncoder()),t.beginComputePass(r),t},e.prototype.submitPass=function(t){var r=t;r instanceof kP?(this.frameCommandEncoderPool.push(r.frameCommandEncoder),r.finish(),this.renderPassPool.push(r)):r instanceof FP&&(this.frameCommandEncoderPool.push(r.frameCommandEncoder),r.finish(),this.computePassPool.push(r))},e.prototype.copySubTexture2D=function(t,r,n,i,a,s,l){var c=this.device.createCommandEncoder(),d=t,p=i,h={texture:p.gpuTexture,origin:[a,s,0],mipLevel:0,aspect:"all"},m={texture:d.gpuTexture,origin:[r,n,0],mipLevel:0,aspect:"all"};rr(!!(p.usage&Gn.COPY_SRC)),rr(!!(d.usage&Gn.COPY_DST)),c.copyTextureToTexture(h,m,[p.width,p.height,l||1]),this.device.queue.submit([c.finish()])},e.prototype.queryLimits=function(){return{uniformBufferMaxPageWordSize:this.device.limits.maxUniformBufferBindingSize>>>2,uniformBufferWordAlignment:this.device.limits.minUniformBufferOffsetAlignment>>>2,supportedSampleCounts:[1],occlusionQueriesRecommended:!0,computeShadersSupported:!0}},e.prototype.queryTextureFormatSupported=function(t,r,n){if(fae(t)){if(!this.featureTextureCompressionBC)return!1;var i=dae(t);return r%i!==0||n%i!==0?!1:this.featureTextureCompressionBC}switch(t){case he.U16_RGBA_NORM:return!1;case he.F32_RGBA:return!1}return!0},e.prototype.queryPlatformAvailable=function(){return!0},e.prototype.queryVendorInfo=function(){return this},e.prototype.queryRenderPass=function(t){var r=t;return r.descriptor},e.prototype.queryRenderTarget=function(t){var r=t;return r},e.prototype.setResourceName=function(t,r){if(t.name=r,t.type===Cr.Buffer){var n=t;n.gpuBuffer.label=r}else if(t.type===Cr.Texture){var n=t;n.gpuTexture.label=r,n.gpuTextureView.label=r}else if(t.type===Cr.RenderTarget){var n=t;n.gpuTexture.label=r,n.gpuTextureView.label=r}else if(t.type===Cr.Sampler){var n=t;n.gpuSampler.label=r}else if(t.type===Cr.RenderPipeline){var n=t;n.gpuRenderPipeline!==null&&(n.gpuRenderPipeline.label=r)}},e.prototype.setResourceLeakCheck=function(t,r){},e.prototype.checkForLeaks=function(){},e.prototype.programPatched=function(t){},e.prototype.pipelineQueryReady=function(t){var r=t;return r.gpuRenderPipeline!==null},e.prototype.pipelineForceReady=function(t){var r=t;this.createRenderPipelineInternal(r,!1)},e})(),bae=(function(){function e(t){this.pluginOptions=t}return e.prototype.createSwapChain=function(t){return Id(this,void 0,void 0,function(){var r,n,i,a,s,l,c,d;return Pd(this,function(p){switch(p.label){case 0:if(globalThis.navigator.gpu===void 0)return[2,null];r=null,p.label=1;case 1:return p.trys.push([1,3,,4]),n=this.pluginOptions.xrCompatible,[4,globalThis.navigator.gpu.requestAdapter({xrCompatible:n})];case 2:return r=p.sent(),[3,4];case 3:return i=p.sent(),console.log(i),[3,4];case 4:return r===null?[2,null]:(a=["depth32float-stencil8","texture-compression-bc","float32-filterable"],s=a.filter(function(h){return r.features.has(h)}),[4,r.requestDevice({requiredFeatures:s})]);case 5:if(l=p.sent(),l&&(c=this.pluginOptions.onContextLost,l.lost.then(function(){c&&c()})),l===null)return[2,null];if(d=t.getContext("webgpu"),!d)return[2,null];p.label=6;case 6:return p.trys.push([6,8,,9]),[4,wF(this.pluginOptions.shaderCompilerPath)];case 7:return p.sent(),[3,9];case 8:return p.sent(),[3,9];case 9:return[2,new Aae(r,l,t,d,jie,kv&&new kv)]}})})},e})(),xae=class{constructor(e,t){const{buffer:r,offset:n,stride:i,normalized:a,size:s,divisor:l,shaderLocation:c}=t;this.buffer=r,this.attribute={shaderLocation:c,buffer:r.get(),offset:n||0,stride:i||0,normalized:a||!1,divisor:l||0},s&&(this.attribute.size=s)}get(){return this.buffer}updateBuffer(e){this.buffer.subData(e)}destroy(){this.buffer.destroy()}},vg={[N.FLOAT]:Float32Array,[N.UNSIGNED_BYTE]:Uint8Array,[N.SHORT]:Int16Array,[N.UNSIGNED_SHORT]:Uint16Array,[N.INT]:Int32Array,[N.UNSIGNED_INT]:Uint32Array},Rae={[N.POINTS]:Fn.POINTS,[N.LINES]:Fn.LINES,[N.LINE_LOOP]:Fn.LINES,[N.LINE_STRIP]:Fn.LINE_STRIP,[N.TRIANGLES]:Fn.TRIANGLES,[N.TRIANGLE_FAN]:Fn.TRIANGLES,[N.TRIANGLE_STRIP]:Fn.TRIANGLE_STRIP},Cae={1:he.F32_R,2:he.F32_RG,3:he.F32_RGB,4:he.F32_RGBA},Oae={[N.STATIC_DRAW]:No.STATIC,[N.DYNAMIC_DRAW]:No.DYNAMIC,[N.STREAM_DRAW]:No.DYNAMIC},zP={[N.REPEAT]:qi.REPEAT,[N.CLAMP_TO_EDGE]:qi.CLAMP_TO_EDGE,[N.MIRRORED_REPEAT]:qi.MIRRORED_REPEAT},Mae={[N.NEVER]:Ir.NEVER,[N.ALWAYS]:Ir.ALWAYS,[N.LESS]:Ir.LESS,[N.LEQUAL]:Ir.LEQUAL,[N.GREATER]:Ir.GREATER,[N.GEQUAL]:Ir.GEQUAL,[N.EQUAL]:Ir.EQUAL,[N.NOTEQUAL]:Ir.NOTEQUAL},wae={[N.FRONT]:la.FRONT,[N.BACK]:la.BACK},jP={[N.FUNC_ADD]:ti.ADD,[N.MIN_EXT]:ti.MIN,[N.MAX_EXT]:ti.MAX,[N.FUNC_SUBTRACT]:ti.SUBSTRACT,[N.FUNC_REVERSE_SUBTRACT]:ti.REVERSE_SUBSTRACT},Y_={[N.ZERO]:fr.ZERO,[N.ONE]:fr.ONE,[N.SRC_COLOR]:fr.SRC,[N.ONE_MINUS_SRC_COLOR]:fr.ONE_MINUS_SRC,[N.SRC_ALPHA]:fr.SRC_ALPHA,[N.ONE_MINUS_SRC_ALPHA]:fr.ONE_MINUS_SRC_ALPHA,[N.DST_COLOR]:fr.DST,[N.ONE_MINUS_DST_COLOR]:fr.ONE_MINUS_DST,[N.DST_ALPHA]:fr.DST_ALPHA,[N.ONE_MINUS_DST_ALPHA]:fr.ONE_MINUS_DST_ALPHA,[N.CONSTANT_COLOR]:fr.CONST,[N.ONE_MINUS_CONSTANT_COLOR]:fr.ONE_MINUS_CONSTANT,[N.CONSTANT_ALPHA]:fr.CONST,[N.ONE_MINUS_CONSTANT_ALPHA]:fr.ONE_MINUS_CONSTANT,[N.SRC_ALPHA_SATURATE]:fr.SRC_ALPHA_SATURATE},vd={[N.REPLACE]:_n.REPLACE,[N.KEEP]:_n.KEEP,[N.ZERO]:_n.ZERO,[N.INVERT]:_n.INVERT,[N.INCR]:_n.INCREMENT_CLAMP,[N.DECR]:_n.DECREMENT_CLAMP,[N.INCR_WRAP]:_n.INCREMENT_WRAP,[N.DECR_WRAP]:_n.DECREMENT_WRAP},Nae={[N.ALWAYS]:Ir.ALWAYS,[N.EQUAL]:Ir.EQUAL,[N.GEQUAL]:Ir.GEQUAL,[N.GREATER]:Ir.GREATER,[N.LEQUAL]:Ir.LEQUAL,[N.LESS]:Ir.LESS,[N.NEVER]:Ir.NEVER,[N.NOTEQUAL]:Ir.NOTEQUAL},Iae={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121};function mg(e){return Object.prototype.toString.call(e)in Iae}function Pae(e,t){const r=e.length,n=Math.ceil(r/3),i=r+n,a=new Float32Array(i);for(let s=0;s<i;s+=4)a[s]=e[s/4*3],a[s+1]=e[s/4*3+1],a[s+2]=e[s/4*3+2],a[s+3]=t;return a}var Dae=class{constructor(e,t){this.isDestroyed=!1;const{data:r,usage:n,type:i,isUBO:a,label:s}=t;let l;mg(r)?l=r:l=new vg[this.type||N.FLOAT](r),this.type=i,this.size=l.byteLength,this.buffer=e.createBuffer({viewOrSize:l,usage:a?Xr.UNIFORM:Xr.VERTEX,hint:Oae[n||N.STATIC_DRAW]}),s&&e.setResourceName(this.buffer,s)}get(){return this.buffer}destroy(){this.isDestroyed||this.buffer.destroy(),this.isDestroyed=!0}subData({data:e,offset:t}){let r;mg(e)?r=e:r=new vg[this.type||N.FLOAT](e),this.buffer.setSubData(t,new Uint8Array(r.buffer))}};function Lr(e,t=0){return e+=t,e+=e<<10,e+=e>>>6,e>>>0}function IF(e){return e+=e<<3,e^=e>>>11,e+=e<<15,e>>>0}function HP(){return 0}var Lae=class{constructor(){this.keys=[],this.values=[]}},$_=class{constructor(e,t){this.keyEqualFunc=e,this.keyHashFunc=t,this.buckets=new Map}findBucketIndex(e,t){for(let r=0;r<e.keys.length;r++)if(this.keyEqualFunc(t,e.keys[r]))return r;return-1}findBucket(e){const t=this.keyHashFunc(e);return this.buckets.get(t)}get(e){const t=this.findBucket(e);if(t===void 0)return null;const r=this.findBucketIndex(t,e);return r<0?null:t.values[r]}add(e,t){const r=this.keyHashFunc(e);this.buckets.get(r)===void 0&&this.buckets.set(r,new Lae);const n=this.buckets.get(r);n.keys.push(e),n.values.push(t)}delete(e){const t=this.findBucket(e);if(t===void 0)return;const r=this.findBucketIndex(t,e);r!==-1&&(t.keys.splice(r,1),t.values.splice(r,1))}clear(){this.buckets.clear()}size(){let e=0;for(const t of this.buckets.values())e+=t.values.length;return e}*values(){for(const e of this.buckets.values())for(let t=e.values.length-1;t>=0;t--)yield e.values[t]}};function VP(e,t){return e=Lr(e,t.blendMode),e=Lr(e,t.blendSrcFactor),e=Lr(e,t.blendDstFactor),e}function Bae(e,t){return e=VP(e,t.rgbBlendState),e=VP(e,t.alphaBlendState),e=Lr(e,t.channelWriteMask),e}function Fae(e,t){return e=Lr(e,t.r<<24|t.g<<16|t.b<<8|t.a),e}function Uae(e,t){var r,n,i,a,s,l,c,d;for(let p=0;p<t.attachmentsState.length;p++)e=Bae(e,t.attachmentsState[p]);return e=Fae(e,t.blendConstant||$g),e=Lr(e,t.depthCompare),e=Lr(e,t.depthWrite?1:0),e=Lr(e,(r=t.stencilFront)==null?void 0:r.compare),e=Lr(e,(n=t.stencilFront)==null?void 0:n.passOp),e=Lr(e,(i=t.stencilFront)==null?void 0:i.failOp),e=Lr(e,(a=t.stencilFront)==null?void 0:a.depthFailOp),e=Lr(e,(s=t.stencilBack)==null?void 0:s.compare),e=Lr(e,(l=t.stencilBack)==null?void 0:l.passOp),e=Lr(e,(c=t.stencilBack)==null?void 0:c.failOp),e=Lr(e,(d=t.stencilBack)==null?void 0:d.depthFailOp),e=Lr(e,t.stencilWrite?1:0),e=Lr(e,t.cullMode),e=Lr(e,t.frontFace?1:0),e=Lr(e,t.polygonOffset?1:0),e}function kae(e){let t=0;t=Lr(t,e.program.id),e.inputLayout!==null&&(t=Lr(t,e.inputLayout.id)),t=Uae(t,e.megaStateDescriptor);for(let r=0;r<e.colorAttachmentFormats.length;r++)t=Lr(t,e.colorAttachmentFormats[r]||0);return t=Lr(t,e.depthStencilAttachmentFormat||0),IF(t)}function zae(e){let t=0;if(e.samplerBindings)for(let r=0;r<e.samplerBindings.length;r++){const n=e.samplerBindings[r];n!==null&&n.texture!==null&&(t=Lr(t,n.texture.id))}if(e.uniformBufferBindings)for(let r=0;r<e.uniformBufferBindings.length;r++){const n=e.uniformBufferBindings[r];n!==null&&n.buffer!==null&&(t=Lr(t,n.buffer.id),t=Lr(t,n.binding),t=Lr(t,n.offset),t=Lr(t,n.size))}if(e.storageBufferBindings)for(let r=0;r<e.storageBufferBindings.length;r++){const n=e.storageBufferBindings[r];n!==null&&n.buffer!==null&&(t=Lr(t,n.buffer.id),t=Lr(t,n.binding),t=Lr(t,n.offset),t=Lr(t,n.size))}if(e.storageTextureBindings)for(let r=0;r<e.storageTextureBindings.length;r++){const n=e.storageTextureBindings[r];n!==null&&n.texture!==null&&(t=Lr(t,n.texture.id),t=Lr(t,n.binding))}return IF(t)}function jae(e,t){var r,n,i,a;return((r=e.vertex)==null?void 0:r.glsl)===((n=t.vertex)==null?void 0:n.glsl)&&((i=e.fragment)==null?void 0:i.glsl)===((a=t.fragment)==null?void 0:a.glsl)}function Hae(e){var t,r;return{vertex:{glsl:(t=e.vertex)==null?void 0:t.glsl},fragment:{glsl:(r=e.fragment)==null?void 0:r.glsl}}}var Vae=class{constructor(e){this.device=e,this.bindingsCache=new $_(Hne,zae),this.renderPipelinesCache=new $_(qne,kae),this.inputLayoutsCache=new $_($ne,HP),this.programCache=new $_(jae,HP)}createBindings(e){var t;let r=this.bindingsCache.get(e);if(r===null){const n=Qne(e);n.uniformBufferBindings=(t=n.uniformBufferBindings)==null?void 0:t.filter(({size:i})=>i&&i>0),r=this.device.createBindings(n),this.bindingsCache.add(n,r)}return r}createRenderPipeline(e){let t=this.renderPipelinesCache.get(e);if(t===null){const r=Jne(e);r.colorAttachmentFormats=r.colorAttachmentFormats.filter(n=>n),t=this.device.createRenderPipeline(r),this.renderPipelinesCache.add(r,t)}return t}createInputLayout(e){e.vertexBufferDescriptors=e.vertexBufferDescriptors.filter(r=>!!r);let t=this.inputLayoutsCache.get(e);if(t===null){const r=rie(e);t=this.device.createInputLayout(r),this.inputLayoutsCache.add(r,t)}return t}createProgram(e){let t=this.programCache.get(e);if(t===null){const r=Hae(e);t=this.device.createProgram(e),this.programCache.add(r,t)}return t}destroy(){for(const e of this.bindingsCache.values())e.destroy();for(const e of this.renderPipelinesCache.values())e.destroy();for(const e of this.inputLayoutsCache.values())e.destroy();for(const e of this.programCache.values())e.destroy();this.bindingsCache.clear(),this.renderPipelinesCache.clear(),this.inputLayoutsCache.clear(),this.programCache.clear()}},Xae=class{constructor(e,t){const{data:r,type:n,count:i=0}=t;let a;mg(r)?a=r:a=new vg[this.type||N.UNSIGNED_INT](r),this.type=n,this.count=i,this.indexBuffer=e.createBuffer({viewOrSize:a,usage:Xr.INDEX})}get(){return this.indexBuffer}subData({data:e}){let t;mg(e)?t=e:t=new vg[this.type||N.UNSIGNED_INT](e),this.indexBuffer.setSubData(0,new Uint8Array(t.buffer))}destroy(){this.indexBuffer.destroy()}};function XP(e){return!!(e&&e.texture)}var PF=class{constructor(e,t){this.device=e,this.options=t,this.isDestroy=!1;const{wrapS:r=N.CLAMP_TO_EDGE,wrapT:n=N.CLAMP_TO_EDGE,aniso:i,mag:a=N.NEAREST,min:s=N.NEAREST}=t;this.createTexture(t),this.sampler=e.createSampler({addressModeU:zP[r],addressModeV:zP[n],minFilter:s===N.NEAREST?Rn.POINT:Rn.BILINEAR,magFilter:a===N.NEAREST?Rn.POINT:Rn.BILINEAR,mipmapFilter:qn.NO_MIP,maxAnisotropy:i})}createTexture(e){const{type:t=N.UNSIGNED_BYTE,width:r,height:n,flipY:i=!1,format:a=N.RGBA,alignment:s=1,usage:l=Ov.SAMPLED,unorm:c=!1,label:d}=e;let{data:p}=e;this.width=r,this.height=n;let h=he.U8_RGBA_RT;if(t===N.UNSIGNED_BYTE&&a===N.RGBA)h=c?he.U8_RGBA_NORM:he.U8_RGBA_RT;else if(t===N.UNSIGNED_BYTE&&a===N.LUMINANCE)h=he.U8_LUMINANCE;else if(t===N.FLOAT&&a===N.LUMINANCE)h=he.F32_LUMINANCE;else if(t===N.FLOAT&&a===N.RGB)this.device.queryVendorInfo().platformString==="WebGPU"?(p&&(p=Pae(p,0)),h=he.F32_RGBA):h=he.F32_RGB;else if(t===N.FLOAT&&a===N.RGBA)h=he.F32_RGBA;else if(t===N.FLOAT&&a===N.RED)h=he.F32_R;else throw new Error(`create texture error, type: ${t}, format: ${a}`);this.texture=this.device.createTexture({format:h,width:r,height:n,usage:l===Ov.SAMPLED?Pi.SAMPLED:Pi.RENDER_TARGET,pixelStore:{unpackFlipY:i,packAlignment:s},mipLevelCount:1}),d&&this.device.setResourceName(this.texture,d),p&&this.texture.setImageData([p])}get(){return this.texture}update(e){const{data:t}=e;this.texture.setImageData([t])}bind(){}resize({width:e,height:t}){(this.width!==e||this.height!==t)&&this.destroy(),this.options.width=e,this.options.height=t,this.createTexture(this.options),this.isDestroy=!1}getSize(){return[this.width,this.height]}destroy(){var e;!this.isDestroy&&!this.texture.destroyed&&((e=this.texture)==null||e.destroy()),this.isDestroy=!0}},DF=class{constructor(e,t){this.device=e,this.options=t,this.createColorRenderTarget(),this.createDepthRenderTarget()}createColorRenderTarget(e=!1){const{width:t,height:r,color:n}=this.options;n&&(XP(n)?(e&&n.resize({width:t,height:r}),this.colorTexture=n.get(),this.colorRenderTarget=this.device.createRenderTargetFromTexture(this.colorTexture),this.width=n.width,this.height=n.height):t&&r&&(this.colorTexture=this.device.createTexture({format:he.U8_RGBA_RT,usage:Pi.RENDER_TARGET,width:t,height:r}),this.colorRenderTarget=this.device.createRenderTargetFromTexture(this.colorTexture),this.width=t,this.height=r))}createDepthRenderTarget(e=!1){const{width:t,height:r,depth:n}=this.options;n&&(XP(n)?(e&&n.resize({width:t,height:r}),this.depthTexture=n.get(),this.depthRenderTarget=this.device.createRenderTargetFromTexture(this.depthTexture),this.width=n.width,this.height=n.height):t&&r&&(this.depthTexture=this.device.createTexture({format:he.D24_S8,usage:Pi.RENDER_TARGET,width:t,height:r}),this.depthRenderTarget=this.device.createRenderTargetFromTexture(this.depthTexture),this.width=t,this.height=r))}get(){return this.colorRenderTarget}destroy(){var e,t;(e=this.colorRenderTarget)==null||e.destroy(),(t=this.depthRenderTarget)==null||t.destroy()}resize({width:e,height:t}){(this.width!==e||this.height!==t)&&(this.destroy(),this.colorTexture.destroyed=!0,this.depthTexture.destroyed=!0,this.options.width=e,this.options.height=t,this.createColorRenderTarget(!0),this.createDepthRenderTarget(!0))}},Gae=Object.defineProperty,qae=Object.defineProperties,Wae=Object.getOwnPropertyDescriptors,GP=Object.getOwnPropertySymbols,Yae=Object.prototype.hasOwnProperty,$ae=Object.prototype.propertyIsEnumerable,qP=(e,t,r)=>t in e?Gae(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Oc=(e,t)=>{for(var r in t||(t={}))Yae.call(t,r)&&qP(e,r,t[r]);if(GP)for(var r of GP(t))$ae.call(t,r)&&qP(e,r,t[r]);return e},Zae=(e,t)=>qae(e,Wae(t)),{isPlainObject:Kae,isTypedArray:Qae,isNil:WP}=yn,Jae=class{constructor(e,t,r){this.device=e,this.options=t,this.service=r,this.destroyed=!1,this.uniforms={},this.vertexBuffers=[];const{vs:n,fs:i,attributes:a,uniforms:s,count:l,elements:c,diagnosticDerivativeUniformityEnabled:d}=t;this.options=t;const p=d?"":this.service.viewportOrigin===wo.UPPER_LEFT?"diagnostic(off,derivative_uniformity);":"";this.program=r.renderCache.createProgram({vertex:{glsl:n},fragment:{glsl:i,postprocess:y=>p+y}}),s&&(this.uniforms=this.extractUniforms(s));const h=[];let m=0;Object.keys(a).forEach(y=>{const E=a[y],T=E.get();this.vertexBuffers.push(T.get());const{offset:A=0,stride:b=0,size:R=1,divisor:M=0,shaderLocation:B=0}=E.attribute;h.push({arrayStride:b||R*4,stepMode:Vc.VERTEX,attributes:[{format:Cae[R],shaderLocation:B,offset:A,divisor:M}]}),m=T.size/R}),l||(this.options.count=m),c&&(this.indexBuffer=c.get());const _=r.renderCache.createInputLayout({vertexBufferDescriptors:h,indexBufferFormat:c?he.U32_R:null,program:this.program});this.inputLayout=_,this.pipeline=this.createPipeline(t)}createPipeline(e,t){var r;const{primitive:n=N.TRIANGLES,depth:i,cull:a,blend:s,stencil:l}=e,c=this.initDepthDrawParams({depth:i}),d=!!(c&&c.enable),p=this.initCullDrawParams({cull:a}),h=!!(p&&p.enable),m=this.getBlendDrawParams({blend:s}),_=!!(m&&m.enable),y=this.getStencilDrawParams({stencil:l}),E=!!(y&&y.enable),T=this.device.createRenderPipeline({inputLayout:this.inputLayout,program:this.program,topology:Rae[n],colorAttachmentFormats:[he.U8_RGBA_RT],depthStencilAttachmentFormat:he.D24_S8,megaStateDescriptor:{attachmentsState:[t?{channelWriteMask:ei.ALL,rgbBlendState:{blendMode:ti.ADD,blendSrcFactor:fr.ONE,blendDstFactor:fr.ZERO},alphaBlendState:{blendMode:ti.ADD,blendSrcFactor:fr.ONE,blendDstFactor:fr.ZERO}}:{channelWriteMask:E&&y.opFront.zpass===_n.REPLACE?ei.NONE:ei.ALL,rgbBlendState:{blendMode:_&&m.equation.rgb||ti.ADD,blendSrcFactor:_&&m.func.srcRGB||fr.SRC_ALPHA,blendDstFactor:_&&m.func.dstRGB||fr.ONE_MINUS_SRC_ALPHA},alphaBlendState:{blendMode:_&&m.equation.alpha||ti.ADD,blendSrcFactor:_&&m.func.srcAlpha||fr.ONE,blendDstFactor:_&&m.func.dstAlpha||fr.ONE}}],blendConstant:_?$g:void 0,depthWrite:d,depthCompare:d&&c.func||Ir.LESS,cullMode:h&&p.face||la.NONE,stencilWrite:E,stencilFront:{compare:E?y.func.cmp:Ir.ALWAYS,passOp:y.opFront.zpass,failOp:y.opFront.fail,depthFailOp:y.opFront.zfail,mask:y.opFront.mask},stencilBack:{compare:E?y.func.cmp:Ir.ALWAYS,passOp:y.opBack.zpass,failOp:y.opBack.fail,depthFailOp:y.opBack.zfail,mask:y.opBack.mask}}});return E&&!WP((r=l?.func)==null?void 0:r.ref)&&(T.stencilFuncReference=l.func.ref),T}updateAttributesAndElements(){}updateAttributes(){}addUniforms(e){this.uniforms=Oc(Oc({},this.uniforms),this.extractUniforms(e))}draw(e,t){const r=Oc(Oc({},this.options),e),{count:n=0,instances:i,elements:a,uniforms:s={},uniformBuffers:l,textures:c}=r;this.uniforms=Oc(Oc({},this.uniforms),this.extractUniforms(s));const{renderPass:d,currentFramebuffer:p,width:h,height:m}=this.service;this.pipeline=this.createPipeline(r,t);const _=this.service.device,y=_.swapChainHeight;if(_.swapChainHeight=p?.height||m,d.setViewport(0,0,p?.width||h,p?.height||m),_.swapChainHeight=y,d.setPipeline(this.pipeline),WP(this.pipeline.stencilFuncReference)||d.setStencilReference(this.pipeline.stencilFuncReference),d.setVertexInput(this.inputLayout,this.vertexBuffers.map(E=>({buffer:E})),a?{buffer:this.indexBuffer,offset:0}:null),l&&(this.bindings=_.createBindings({pipeline:this.pipeline,uniformBufferBindings:l.map((E,T)=>{const A=E;return{binding:T,buffer:A.get(),size:A.size}}),samplerBindings:c?.map(E=>({texture:E.texture,sampler:E.sampler}))})),this.bindings&&(d.setBindings(this.bindings),Object.keys(this.uniforms).forEach(E=>{const T=this.uniforms[E];T instanceof PF?this.uniforms[E]=T.get():T instanceof DF&&(this.uniforms[E]=T.get().texture)}),this.program.setUniformsLegacy(this.uniforms)),a){const E=a.count;E===0?d.draw(n,i):d.drawIndexed(E,i)}else d.draw(n,i)}destroy(){var e,t,r;(e=this.vertexBuffers)==null||e.forEach(n=>n.destroy()),(t=this.indexBuffer)==null||t.destroy(),(r=this.bindings)==null||r.destroy(),this.pipeline.destroy(),this.destroyed=!0}initDepthDrawParams({depth:e}){if(e)return{enable:e.enable===void 0?!0:!!e.enable,mask:e.mask===void 0?!0:!!e.mask,func:Mae[e.func||N.LESS],range:e.range||[0,1]}}getBlendDrawParams({blend:e}){const{enable:t,func:r,equation:n,color:i=[0,0,0,0]}=e||{};return{enable:!!t,func:{srcRGB:Y_[r&&r.srcRGB||N.SRC_ALPHA],srcAlpha:Y_[r&&r.srcAlpha||N.SRC_ALPHA],dstRGB:Y_[r&&r.dstRGB||N.ONE_MINUS_SRC_ALPHA],dstAlpha:Y_[r&&r.dstAlpha||N.ONE_MINUS_SRC_ALPHA]},equation:{rgb:jP[n&&n.rgb||N.FUNC_ADD],alpha:jP[n&&n.alpha||N.FUNC_ADD]},color:i}}getStencilDrawParams({stencil:e}){const{enable:t,mask:r=4294967295,func:n={cmp:N.ALWAYS,ref:0,mask:4294967295},opFront:i={fail:N.KEEP,zfail:N.KEEP,zpass:N.KEEP},opBack:a={fail:N.KEEP,zfail:N.KEEP,zpass:N.KEEP}}=e||{};return{enable:!!t,mask:r,func:Zae(Oc({},n),{cmp:Nae[n.cmp]}),opFront:{fail:vd[i.fail],zfail:vd[i.zfail],zpass:vd[i.zpass],mask:n.mask},opBack:{fail:vd[a.fail],zfail:vd[a.zfail],zpass:vd[a.zpass],mask:n.mask}}}initCullDrawParams({cull:e}){if(e){const{enable:t,face:r=N.BACK}=e;return{enable:!!t,face:wae[r]}}}extractUniforms(e){const t={};return Object.keys(e).forEach(r=>{this.extractUniformsRecursively(r,e[r],t,"")}),t}extractUniformsRecursively(e,t,r,n){if(t===null||typeof t=="number"||typeof t=="boolean"||Array.isArray(t)&&typeof t[0]=="number"||Qae(t)||t===""||"resize"in t){r[`${n&&n+"."}${e}`]=t;return}Kae(t)&&Object.keys(t).forEach(i=>{this.extractUniformsRecursively(i,t[i],r,`${n&&n+"."}${e}`)}),Array.isArray(t)&&t.forEach((i,a)=>{Object.keys(i).forEach(s=>{this.extractUniformsRecursively(s,i[s],r,`${n&&n+"."}${e}[${a}]`)})})}};function eoe(e){return typeof WebGL2RenderingContext<"u"&&e instanceof WebGL2RenderingContext?!0:!!(e&&e._version===2)}var tb=(e,t,r)=>new Promise((n,i)=>{var a=c=>{try{l(r.next(c))}catch(d){i(d)}},s=c=>{try{l(r.throw(c))}catch(d){i(d)}},l=c=>c.done?n(c.value):Promise.resolve(c.value).then(a,s);l((r=r.apply(e,t)).next())}),{isUndefined:Z_}=yn,toe=class{constructor(){this.uniformBuffers=[],this.queryVerdorInfo=()=>this.device.queryVendorInfo().platformString,this.createModel=e=>new Jae(this.device,e,this),this.createAttribute=e=>new xae(this.device,e),this.createBuffer=e=>new Dae(this.device,e),this.createElements=e=>new Xae(this.device,e),this.createTexture2D=e=>new PF(this.device,e),this.createFramebuffer=e=>new DF(this.device,e),this.useFramebuffer=(e,t)=>{this.currentFramebuffer=e,this.beginFrame(),t(),this.endFrame(),this.currentFramebuffer=null},this.useFramebufferAsync=(e,t)=>tb(this,null,function*(){this.currentFramebuffer=e,this.preRenderPass=this.renderPass,this.beginFrame(),yield t(),this.endFrame(),this.currentFramebuffer=null,this.renderPass=this.preRenderPass}),this.clear=e=>{const{color:t,depth:r,stencil:n,framebuffer:i=null}=e;if(i)i.clearOptions={color:t,depth:r,stencil:n};else{const a=this.queryVerdorInfo();if(a==="WebGL1"){const s=this.getGLContext();Z_(n)?Z_(r)||(s.clearDepth(r),s.clear(s.DEPTH_BUFFER_BIT)):(s.clearStencil(n),s.clear(s.STENCIL_BUFFER_BIT))}else if(a==="WebGL2"){const s=this.getGLContext();Z_(n)?Z_(r)||s.clearBufferfv(s.DEPTH,0,[r]):s.clearBufferiv(s.STENCIL,0,[n])}}},this.viewport=({width:e,height:t})=>{this.swapChain.configureSwapChain(e,t),this.createMainColorDepthRT(e,t),this.width=e,this.height=t},this.readPixels=e=>{const{framebuffer:t,x:r,y:n,width:i,height:a}=e,s=this.device.createReadback(),l=t.colorTexture,c=s.readTextureSync(l,r,this.viewportOrigin===wo.LOWER_LEFT?n:this.height-n,i,a,new Uint8Array(i*a*4));if(this.viewportOrigin!==wo.LOWER_LEFT)for(let d=0;d<c.length;d+=4){const p=c[d];c[d]=c[d+2],c[d+2]=p}return s.destroy(),c},this.readPixelsAsync=e=>tb(this,null,function*(){const{framebuffer:t,x:r,y:n,width:i,height:a}=e,s=this.device.createReadback(),l=t.colorTexture,c=yield s.readTexture(l,r,this.viewportOrigin===wo.LOWER_LEFT?n:this.height-n,i,a,new Uint8Array(i*a*4));if(this.viewportOrigin!==wo.LOWER_LEFT)for(let d=0;d<c.length;d+=4){const p=c[d];c[d]=c[d+2],c[d+2]=p}return s.destroy(),c}),this.getViewportSize=()=>({width:this.width,height:this.height}),this.getContainer=()=>{var e;return(e=this.canvas)==null?void 0:e.parentElement},this.getCanvas=()=>this.canvas,this.getGLContext=()=>this.device.gl,this.destroy=()=>{var e;this.canvas=null,(e=this.uniformBuffers)==null||e.forEach(t=>{t.destroy()}),this.device.destroy(),this.renderCache.destroy()}}init(e,t){return tb(this,null,function*(){const{enableWebGPU:r,shaderCompilerPath:n,antialias:i}=t;this.canvas=e;const s=yield(r?new bae({shaderCompilerPath:n}):new Bie({targets:["webgl2","webgl1"],antialias:i,onContextLost(c){console.warn("context lost",c)},onContextCreationError(c){console.warn("context creation error",c)},onContextRestored(c){console.warn("context restored",c)}})).createSwapChain(e);s.configureSwapChain(e.width,e.height),this.device=s.getDevice(),this.swapChain=s,this.renderCache=new Vae(this.device),this.currentFramebuffer=null,this.viewportOrigin=this.device.queryVendorInfo().viewportOrigin;const l=this.device.gl;this.extensionObject={OES_texture_float:!eoe(l)&&this.device.OES_texture_float},this.createMainColorDepthRT(e.width,e.height)})}createMainColorDepthRT(e,t){this.mainColorRT&&this.mainColorRT.destroy(),this.mainDepthRT&&this.mainDepthRT.destroy(),this.mainColorRT=this.device.createRenderTargetFromTexture(this.device.createTexture({format:he.U8_RGBA_RT,width:e,height:t,usage:Pi.RENDER_TARGET})),this.mainDepthRT=this.device.createRenderTargetFromTexture(this.device.createTexture({format:he.D24_S8,width:e,height:t,usage:Pi.RENDER_TARGET}))}beginFrame(){this.device.beginFrame();const{currentFramebuffer:e,swapChain:t,mainColorRT:r,mainDepthRT:n}=this,i=e?e.colorRenderTarget:r,a=e?null:t.getOnscreenTexture(),s=e?e.depthRenderTarget:n,{color:l=[0,0,0,0],depth:c=1,stencil:d=0}=e?.clearOptions||{},p=i?Qv(l[0]*255,l[1]*255,l[2]*255,l[3]):$g,h=s?c:void 0,m=s?d:void 0,_=this.device.createRenderPass({colorAttachment:[i],colorResolveTo:[a],colorClearColor:[p],colorStore:[!0],depthStencilAttachment:s,depthClearValue:h,stencilClearValue:m});this.renderPass=_}endFrame(){this.device.submitPass(this.renderPass),this.device.endFrame()}getPointSizeRange(){const e=this.device.gl;return e.getParameter(e.ALIASED_POINT_SIZE_RANGE)}testExtension(e){return!!this.getGLContext().getExtension(e)}setState(){}setBaseState(){}setCustomLayerDefaults(){}setDirty(e){this.isDirty=e}getDirty(){return this.isDirty}},E0={exports:{}},roe=E0.exports,YP;function noe(){return YP||(YP=1,(function(e,t){(function(r,n){e.exports=n()})(roe,(function(){var r=function(C){return C instanceof Uint8Array||C instanceof Uint16Array||C instanceof Uint32Array||C instanceof Int8Array||C instanceof Int16Array||C instanceof Int32Array||C instanceof Float32Array||C instanceof Float64Array||C instanceof Uint8ClampedArray},n=function(C,W){for(var ne=Object.keys(W),be=0;be<ne.length;++be)C[ne[be]]=W[ne[be]];return C},i=`
`;function a(C){return typeof atob<"u"?atob(C):"base64:"+C}function s(C){var W=new Error("(regl) "+C);throw console.error(W),W}function l(C,W){C||s(W)}function c(C){return C?": "+C:""}function d(C,W,ne){C in W||s("unknown parameter ("+C+")"+c(ne)+". possible values: "+Object.keys(W).join())}function p(C,W){r(C)||s("invalid parameter type"+c(W)+". must be a typed array")}function h(C,W){switch(W){case"number":return typeof C=="number";case"object":return typeof C=="object";case"string":return typeof C=="string";case"boolean":return typeof C=="boolean";case"function":return typeof C=="function";case"undefined":return typeof C>"u";case"symbol":return typeof C=="symbol"}}function m(C,W,ne){h(C,W)||s("invalid parameter type"+c(ne)+". expected "+W+", got "+typeof C)}function _(C,W){C>=0&&(C|0)===C||s("invalid parameter type, ("+C+")"+c(W)+". must be a nonnegative integer")}function y(C,W,ne){W.indexOf(C)<0&&s("invalid value"+c(ne)+". must be one of: "+W)}var E=["gl","canvas","container","attributes","pixelRatio","extensions","optionalExtensions","profile","onDone"];function T(C){Object.keys(C).forEach(function(W){E.indexOf(W)<0&&s('invalid regl constructor argument "'+W+'". must be one of '+E)})}function A(C,W){for(C=C+"";C.length<W;)C=" "+C;return C}function b(){this.name="unknown",this.lines=[],this.index={},this.hasErrors=!1}function R(C,W){this.number=C,this.line=W,this.errors=[]}function M(C,W,ne){this.file=C,this.line=W,this.message=ne}function B(){var C=new Error,W=(C.stack||C).toString(),ne=/compileProcedure.*\n\s*at.*\((.*)\)/.exec(W);if(ne)return ne[1];var be=/compileProcedure.*\n\s*at\s+(.*)(\n|$)/.exec(W);return be?be[1]:"unknown"}function w(){var C=new Error,W=(C.stack||C).toString(),ne=/at REGLCommand.*\n\s+at.*\((.*)\)/.exec(W);if(ne)return ne[1];var be=/at REGLCommand.*\n\s+at\s+(.*)\n/.exec(W);return be?be[1]:"unknown"}function D(C,W){var ne=C.split(`
`),be=1,je=0,Re={unknown:new b,0:new b};Re.unknown.name=Re[0].name=W||B(),Re.unknown.lines.push(new R(0,""));for(var De=0;De<ne.length;++De){var at=ne[De],ut=/^\s*#\s*(\w+)\s+(.+)\s*$/.exec(at);if(ut)switch(ut[1]){case"line":var mt=/(\d+)(\s+\d+)?/.exec(ut[2]);mt&&(be=mt[1]|0,mt[2]&&(je=mt[2]|0,je in Re||(Re[je]=new b)));break;case"define":var lt=/SHADER_NAME(_B64)?\s+(.*)$/.exec(ut[2]);lt&&(Re[je].name=lt[1]?a(lt[2]):lt[2]);break}Re[je].lines.push(new R(be++,at))}return Object.keys(Re).forEach(function(ft){var vt=Re[ft];vt.lines.forEach(function(et){vt.index[et.number]=et})}),Re}function U(C){var W=[];return C.split(`
`).forEach(function(ne){if(!(ne.length<5)){var be=/^ERROR:\s+(\d+):(\d+):\s*(.*)$/.exec(ne);be?W.push(new M(be[1]|0,be[2]|0,be[3].trim())):ne.length>0&&W.push(new M("unknown",0,ne))}}),W}function ae(C,W){W.forEach(function(ne){var be=C[ne.file];if(be){var je=be.index[ne.line];if(je){je.errors.push(ne),be.hasErrors=!0;return}}C.unknown.hasErrors=!0,C.unknown.lines[0].errors.push(ne)})}function Q(C,W,ne,be,je){if(!C.getShaderParameter(W,C.COMPILE_STATUS)){var Re=C.getShaderInfoLog(W),De=be===C.FRAGMENT_SHADER?"fragment":"vertex";F(ne,"string",De+" shader source must be a string",je);var at=D(ne,je),ut=U(Re);ae(at,ut),Object.keys(at).forEach(function(mt){var lt=at[mt];if(!lt.hasErrors)return;var ft=[""],vt=[""];function et(dt,me){ft.push(dt),vt.push(me||"")}et("file number "+mt+": "+lt.name+`
`,"color:red;text-decoration:underline;font-weight:bold"),lt.lines.forEach(function(dt){if(dt.errors.length>0){et(A(dt.number,4)+"|  ","background-color:yellow; font-weight:bold"),et(dt.line+i,"color:red; background-color:yellow; font-weight:bold");var me=0;dt.errors.forEach(function(we){var ot=we.message,Et=/^\s*'(.*)'\s*:\s*(.*)$/.exec(ot);if(Et){var $e=Et[1];switch(ot=Et[2],$e){case"assign":$e="=";break}me=Math.max(dt.line.indexOf($e,me),0)}else me=0;et(A("| ",6)),et(A("^^^",me+3)+i,"font-weight:bold"),et(A("| ",6)),et(ot+i,"font-weight:bold")}),et(A("| ",6)+i)}else et(A(dt.number,4)+"|  "),et(dt.line+i,"color:red")}),typeof document<"u"&&!window.chrome?(vt[0]=ft.join("%c"),console.log.apply(console,vt)):console.log(ft.join(""))}),l.raise("Error compiling "+De+" shader, "+at[0].name)}}function X(C,W,ne,be,je){if(!C.getProgramParameter(W,C.LINK_STATUS)){var Re=C.getProgramInfoLog(W),De=D(ne,je),at=D(be,je),ut='Error linking program with vertex shader, "'+at[0].name+'", and fragment shader "'+De[0].name+'"';typeof document<"u"?console.log("%c"+ut+i+"%c"+Re,"color:red;text-decoration:underline;font-weight:bold","color:red"):console.log(ut+i+Re),l.raise(ut)}}function x(C){C._commandRef=B()}function P(C,W,ne,be){x(C);function je(ut){return ut?be.id(ut):0}C._fragId=je(C.static.frag),C._vertId=je(C.static.vert);function Re(ut,mt){Object.keys(mt).forEach(function(lt){ut[be.id(lt)]=!0})}var De=C._uniformSet={};Re(De,W.static),Re(De,W.dynamic);var at=C._attributeSet={};Re(at,ne.static),Re(at,ne.dynamic),C._hasCount="count"in C.static||"count"in C.dynamic||"elements"in C.static||"elements"in C.dynamic}function H(C,W){var ne=w();s(C+" in command "+(W||B())+(ne==="unknown"?"":" called from "+ne))}function pe(C,W,ne){C||H(W,ne||B())}function O(C,W,ne,be){C in W||H("unknown parameter ("+C+")"+c(ne)+". possible values: "+Object.keys(W).join(),be||B())}function F(C,W,ne,be){h(C,W)||H("invalid parameter type"+c(ne)+". expected "+W+", got "+typeof C,be||B())}function z(C){C()}function re(C,W,ne){C.texture?y(C.texture._texture.internalformat,W,"unsupported texture format for attachment"):y(C.renderbuffer._renderbuffer.format,ne,"unsupported renderbuffer format for attachment")}var oe=33071,_e=9728,ye=9984,Ie=9985,Je=9986,We=9987,Ct=5120,Ve=5121,yt=5122,Ue=5123,ge=5124,nt=5125,Ce=5126,zt=32819,jt=32820,_t=33635,Ot=34042,xt=36193,Xt={};Xt[Ct]=Xt[Ve]=1,Xt[yt]=Xt[Ue]=Xt[xt]=Xt[_t]=Xt[zt]=Xt[jt]=2,Xt[ge]=Xt[nt]=Xt[Ce]=Xt[Ot]=4;function Or(C,W){return C===jt||C===zt||C===_t?2:C===Ot?4:Xt[C]*W}function qr(C){return!(C&C-1)&&!!C}function Tr(C,W,ne){var be,je=W.width,Re=W.height,De=W.channels;l(je>0&&je<=ne.maxTextureSize&&Re>0&&Re<=ne.maxTextureSize,"invalid texture shape"),(C.wrapS!==oe||C.wrapT!==oe)&&l(qr(je)&&qr(Re),"incompatible wrap mode for texture, both width and height must be power of 2"),W.mipmask===1?je!==1&&Re!==1&&l(C.minFilter!==ye&&C.minFilter!==Je&&C.minFilter!==Ie&&C.minFilter!==We,"min filter requires mipmap"):(l(qr(je)&&qr(Re),"texture must be a square power of 2 to support mipmapping"),l(W.mipmask===(je<<1)-1,"missing or incomplete mipmap data")),W.type===Ce&&(ne.extensions.indexOf("oes_texture_float_linear")<0&&l(C.minFilter===_e&&C.magFilter===_e,"filter not supported, must enable oes_texture_float_linear"),l(!C.genMipmaps,"mipmap generation not supported with float textures"));var at=W.images;for(be=0;be<16;++be)if(at[be]){var ut=je>>be,mt=Re>>be;l(W.mipmask&1<<be,"missing mipmap data");var lt=at[be];if(l(lt.width===ut&&lt.height===mt,"invalid shape for mip images"),l(lt.format===W.format&&lt.internalformat===W.internalformat&&lt.type===W.type,"incompatible type for mip image"),!lt.compressed)if(lt.data){var ft=Math.ceil(Or(lt.type,De)*ut/lt.unpackAlignment)*lt.unpackAlignment;l(lt.data.byteLength===ft*mt,"invalid data for image, buffer size is inconsistent with image format")}else lt.element||lt.copy}else C.genMipmaps||l((W.mipmask&1<<be)===0,"extra mipmap data");W.compressed&&l(!C.genMipmaps,"mipmap generation for compressed images not supported")}function zr(C,W,ne,be){var je=C.width,Re=C.height,De=C.channels;l(je>0&&je<=be.maxTextureSize&&Re>0&&Re<=be.maxTextureSize,"invalid texture shape"),l(je===Re,"cube map must be square"),l(W.wrapS===oe&&W.wrapT===oe,"wrap mode not supported by cube map");for(var at=0;at<ne.length;++at){var ut=ne[at];l(ut.width===je&&ut.height===Re,"inconsistent cube map face shape"),W.genMipmaps&&(l(!ut.compressed,"can not generate mipmap for compressed textures"),l(ut.mipmask===1,"can not specify mipmaps and generate mipmaps"));for(var mt=ut.images,lt=0;lt<16;++lt){var ft=mt[lt];if(ft){var vt=je>>lt,et=Re>>lt;l(ut.mipmask&1<<lt,"missing mipmap data"),l(ft.width===vt&&ft.height===et,"invalid shape for mip images"),l(ft.format===C.format&&ft.internalformat===C.internalformat&&ft.type===C.type,"incompatible type for mip image"),ft.compressed||(ft.data?l(ft.data.byteLength===vt*et*Math.max(Or(ft.type,De),ft.unpackAlignment),"invalid data for image, buffer size is inconsistent with image format"):ft.element||ft.copy)}}}}var V=n(l,{optional:z,raise:s,commandRaise:H,command:pe,parameter:d,commandParameter:O,constructor:T,type:m,commandType:F,isTypedArray:p,nni:_,oneOf:y,shaderError:Q,linkError:X,callSite:w,saveCommandRef:x,saveDrawInfo:P,framebufferFormat:re,guessCommand:B,texture2D:Tr,textureCube:zr}),jr=0,en=0;function Hn(C,W){this.id=jr++,this.type=C,this.data=W}function un(C){return C.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}function tn(C){if(C.length===0)return[];var W=C.charAt(0),ne=C.charAt(C.length-1);if(C.length>1&&W===ne&&(W==='"'||W==="'"))return['"'+un(C.substr(1,C.length-2))+'"'];var be=/\[(false|true|null|\d+|'[^']*'|"[^"]*")\]/.exec(C);if(be)return tn(C.substr(0,be.index)).concat(tn(be[1])).concat(tn(C.substr(be.index+be[0].length)));var je=C.split(".");if(je.length===1)return['"'+un(C)+'"'];for(var Re=[],De=0;De<je.length;++De)Re=Re.concat(tn(je[De]));return Re}function yr(C){return"["+tn(C).join("][")+"]"}function Yn(C,W){return new Hn(C,yr(W+""))}function pi(C){return typeof C=="function"&&!C._reglType||C instanceof Hn}function ii(C,W){return typeof C=="function"?new Hn(en,C):C}var Wr={DynamicVariable:Hn,define:Yn,isDynamic:pi,unbox:ii,accessor:yr},Cn={next:typeof requestAnimationFrame=="function"?function(C){return requestAnimationFrame(C)}:function(C){return setTimeout(C,16)},cancel:typeof cancelAnimationFrame=="function"?function(C){return cancelAnimationFrame(C)}:clearTimeout},Yi=typeof performance<"u"&&performance.now?function(){return performance.now()}:function(){return+new Date};function Ma(){var C={"":0},W=[""];return{id:function(ne){var be=C[ne];return be||(be=C[ne]=W.length,W.push(ne),be)},str:function(ne){return W[ne]}}}function to(C,W,ne){var be=document.createElement("canvas");n(be.style,{border:0,margin:0,padding:0,top:0,left:0}),C.appendChild(be),C===document.body&&(be.style.position="absolute",n(C.style,{margin:0,padding:0}));function je(){var at=window.innerWidth,ut=window.innerHeight;if(C!==document.body){var mt=C.getBoundingClientRect();at=mt.right-mt.left,ut=mt.bottom-mt.top}be.width=ne*at,be.height=ne*ut,n(be.style,{width:at+"px",height:ut+"px"})}var Re;C!==document.body&&typeof ResizeObserver=="function"?(Re=new ResizeObserver(function(){setTimeout(je)}),Re.observe(C)):window.addEventListener("resize",je,!1);function De(){Re?Re.disconnect():window.removeEventListener("resize",je),C.removeChild(be)}return je(),{canvas:be,onDestroy:De}}function fu(C,W){function ne(be){try{return C.getContext(be,W)}catch{return null}}return ne("webgl")||ne("experimental-webgl")||ne("webgl-experimental")}function Qc(C){return typeof C.nodeName=="string"&&typeof C.appendChild=="function"&&typeof C.getBoundingClientRect=="function"}function Jc(C){return typeof C.drawArrays=="function"||typeof C.drawElements=="function"}function Es(C){return typeof C=="string"?C.split():(V(Array.isArray(C),"invalid extension array"),C)}function ro(C){return typeof C=="string"?(V(typeof document<"u","not supported outside of DOM"),document.querySelector(C)):C}function Ul(C){var W=C||{},ne,be,je,Re,De={},at=[],ut=[],mt=typeof window>"u"?1:window.devicePixelRatio,lt=!1,ft=function(dt){dt&&V.raise(dt)},vt=function(){};if(typeof W=="string"?(V(typeof document<"u","selector queries only supported in DOM enviroments"),ne=document.querySelector(W),V(ne,"invalid query string for element")):typeof W=="object"?Qc(W)?ne=W:Jc(W)?(Re=W,je=Re.canvas):(V.constructor(W),"gl"in W?Re=W.gl:"canvas"in W?je=ro(W.canvas):"container"in W&&(be=ro(W.container)),"attributes"in W&&(De=W.attributes,V.type(De,"object","invalid context attributes")),"extensions"in W&&(at=Es(W.extensions)),"optionalExtensions"in W&&(ut=Es(W.optionalExtensions)),"onDone"in W&&(V.type(W.onDone,"function","invalid or missing onDone callback"),ft=W.onDone),"profile"in W&&(lt=!!W.profile),"pixelRatio"in W&&(mt=+W.pixelRatio,V(mt>0,"invalid pixel ratio"))):V.raise("invalid arguments to regl"),ne&&(ne.nodeName.toLowerCase()==="canvas"?je=ne:be=ne),!Re){if(!je){V(typeof document<"u","must manually specify webgl context outside of DOM environments");var et=to(be||document.body,ft,mt);if(!et)return null;je=et.canvas,vt=et.onDestroy}De.premultipliedAlpha===void 0&&(De.premultipliedAlpha=!0),Re=fu(je,De)}return Re?{gl:Re,canvas:je,container:be,extensions:at,optionalExtensions:ut,pixelRatio:mt,profile:lt,onDone:ft,onDestroy:vt}:(vt(),ft("webgl not supported, try upgrading your browser or graphics drivers http://get.webgl.org"),null)}function ef(C,W){var ne={};function be(De){V.type(De,"string","extension name must be string");var at=De.toLowerCase(),ut;try{ut=ne[at]=C.getExtension(at)}catch{}return!!ut}for(var je=0;je<W.extensions.length;++je){var Re=W.extensions[je];if(!be(Re))return W.onDestroy(),W.onDone('"'+Re+'" extension is not supported by the current WebGL context, try upgrading your system or a different browser'),null}return W.optionalExtensions.forEach(be),{extensions:ne,restore:function(){Object.keys(ne).forEach(function(De){if(ne[De]&&!be(De))throw new Error("(regl): error restoring extension "+De)})}}}function ai(C,W){for(var ne=Array(C),be=0;be<C;++be)ne[be]=W(be);return ne}var kl=5120,du=5121,tf=5122,ch=5123,wa=5124,On=5125,oi=5126;function Fo(C){for(var W=16;W<=1<<28;W*=16)if(C<=W)return W;return 0}function Ts(C){var W,ne;return W=(C>65535)<<4,C>>>=W,ne=(C>255)<<3,C>>>=ne,W|=ne,ne=(C>15)<<2,C>>>=ne,W|=ne,ne=(C>3)<<1,C>>>=ne,W|=ne,W|C>>1}function hu(){var C=ai(8,function(){return[]});function W(Re){var De=Fo(Re),at=C[Ts(De)>>2];return at.length>0?at.pop():new ArrayBuffer(De)}function ne(Re){C[Ts(Re.byteLength)>>2].push(Re)}function be(Re,De){var at=null;switch(Re){case kl:at=new Int8Array(W(De),0,De);break;case du:at=new Uint8Array(W(De),0,De);break;case tf:at=new Int16Array(W(2*De),0,De);break;case ch:at=new Uint16Array(W(2*De),0,De);break;case wa:at=new Int32Array(W(4*De),0,De);break;case On:at=new Uint32Array(W(4*De),0,De);break;case oi:at=new Float32Array(W(4*De),0,De);break;default:return null}return at.length!==De?at.subarray(0,De):at}function je(Re){ne(Re.buffer)}return{alloc:W,free:ne,allocType:be,freeType:je}}var an=hu();an.zero=hu();var zl=3408,Ss=3410,pu=3411,no=3412,io=3413,Uo=3414,Na=3415,Zr=33901,ko=33902,zo=3379,$i=3386,Ia=34921,fh=36347,rf=36348,As=35661,Si=35660,da=34930,Di=36349,Un=34076,ao=34024,Li=7936,si=7937,vu=7938,mu=35724,_u=34047,Ai=36063,$n=34852,oo=3553,gu=34067,jo=34069,yu=33984,Bi=6408,Zi=5126,vi=5121,Ho=36160,Eu=36053,Tu=36064,Vo=16384,nf=function(C,W){var ne=1;W.ext_texture_filter_anisotropic&&(ne=C.getParameter(_u));var be=1,je=1;W.webgl_draw_buffers&&(be=C.getParameter($n),je=C.getParameter(Ai));var Re=!!W.oes_texture_float;if(Re){var De=C.createTexture();C.bindTexture(oo,De),C.texImage2D(oo,0,Bi,1,1,0,Bi,Zi,null);var at=C.createFramebuffer();if(C.bindFramebuffer(Ho,at),C.framebufferTexture2D(Ho,Tu,oo,De,0),C.bindTexture(oo,null),C.checkFramebufferStatus(Ho)!==Eu)Re=!1;else{C.viewport(0,0,1,1),C.clearColor(1,0,0,1),C.clear(Vo);var ut=an.allocType(Zi,4);C.readPixels(0,0,1,1,Bi,Zi,ut),C.getError()?Re=!1:(C.deleteFramebuffer(at),C.deleteTexture(De),Re=ut[0]===1),an.freeType(ut)}}var mt=typeof navigator<"u"&&(/MSIE/.test(navigator.userAgent)||/Trident\//.test(navigator.appVersion)||/Edge/.test(navigator.userAgent)),lt=!0;if(!mt){var ft=C.createTexture(),vt=an.allocType(vi,36);C.activeTexture(yu),C.bindTexture(gu,ft),C.texImage2D(jo,0,Bi,3,3,0,Bi,vi,vt),an.freeType(vt),C.bindTexture(gu,null),C.deleteTexture(ft),lt=!C.getError()}return{colorBits:[C.getParameter(Ss),C.getParameter(pu),C.getParameter(no),C.getParameter(io)],depthBits:C.getParameter(Uo),stencilBits:C.getParameter(Na),subpixelBits:C.getParameter(zl),extensions:Object.keys(W).filter(function(et){return!!W[et]}),maxAnisotropic:ne,maxDrawbuffers:be,maxColorAttachments:je,pointSizeDims:C.getParameter(Zr),lineWidthDims:C.getParameter(ko),maxViewportDims:C.getParameter($i),maxCombinedTextureUnits:C.getParameter(As),maxCubeMapSize:C.getParameter(Un),maxRenderbufferSize:C.getParameter(ao),maxTextureUnits:C.getParameter(da),maxTextureSize:C.getParameter(zo),maxAttributes:C.getParameter(Ia),maxVertexUniforms:C.getParameter(fh),maxVertexTextureUnits:C.getParameter(Si),maxVaryingVectors:C.getParameter(rf),maxFragmentUniforms:C.getParameter(Di),glsl:C.getParameter(mu),renderer:C.getParameter(si),vendor:C.getParameter(Li),version:C.getParameter(vu),readFloat:Re,npotTextureCube:lt}};function j(C){return!!C&&typeof C=="object"&&Array.isArray(C.shape)&&Array.isArray(C.stride)&&typeof C.offset=="number"&&C.shape.length===C.stride.length&&(Array.isArray(C.data)||r(C.data))}var Z=function(C){return Object.keys(C).map(function(W){return C[W]})},fe={shape:Tn,flatten:Pn};function Fe(C,W,ne){for(var be=0;be<W;++be)ne[be]=C[be]}function pt(C,W,ne,be){for(var je=0,Re=0;Re<W;++Re)for(var De=C[Re],at=0;at<ne;++at)be[je++]=De[at]}function Nt(C,W,ne,be,je,Re){for(var De=Re,at=0;at<W;++at)for(var ut=C[at],mt=0;mt<ne;++mt)for(var lt=ut[mt],ft=0;ft<be;++ft)je[De++]=lt[ft]}function pr(C,W,ne,be,je){for(var Re=1,De=ne+1;De<W.length;++De)Re*=W[De];var at=W[ne];if(W.length-ne===4){var ut=W[ne+1],mt=W[ne+2],lt=W[ne+3];for(De=0;De<at;++De)Nt(C[De],ut,mt,lt,be,je),je+=Re}else for(De=0;De<at;++De)pr(C[De],W,ne+1,be,je),je+=Re}function Pn(C,W,ne,be){var je=1;if(W.length)for(var Re=0;Re<W.length;++Re)je*=W[Re];else je=0;var De=be||an.allocType(ne,je);switch(W.length){case 0:break;case 1:Fe(C,W[0],De);break;case 2:pt(C,W[0],W[1],De);break;case 3:Nt(C,W[0],W[1],W[2],De,0);break;default:pr(C,W,0,De,0)}return De}function Tn(C){for(var W=[],ne=C;ne.length;ne=ne[0])W.push(ne.length);return W}var Mn={"[object Int8Array]":5120,"[object Int16Array]":5122,"[object Int32Array]":5124,"[object Uint8Array]":5121,"[object Uint8ClampedArray]":5121,"[object Uint16Array]":5123,"[object Uint32Array]":5125,"[object Float32Array]":5126,"[object Float64Array]":5121,"[object ArrayBuffer]":5121},bi=5120,Su=5122,Au=5124,tm=5121,dh=5123,rm=5125,jl=5126,so=5126,uo={int8:bi,int16:Su,int32:Au,uint8:tm,uint16:dh,uint32:rm,float:jl,float32:so},Hl=35048,Xo=35040,bu={dynamic:Hl,stream:Xo,static:35044},xu=fe.flatten,hh=fe.shape,Vl=35044,af=35040,of=5121,ui=5126,xi=[];xi[5120]=1,xi[5122]=2,xi[5124]=4,xi[5121]=1,xi[5123]=2,xi[5125]=4,xi[5126]=4;function bs(C){return Mn[Object.prototype.toString.call(C)]|0}function Ru(C,W){for(var ne=0;ne<W.length;++ne)C[ne]=W[ne]}function nm(C,W,ne,be,je,Re,De){for(var at=0,ut=0;ut<ne;++ut)for(var mt=0;mt<be;++mt)C[at++]=W[je*ut+Re*mt+De]}function ph(C,W,ne,be){var je=0,Re={};function De(me){this.id=je++,this.buffer=C.createBuffer(),this.type=me,this.usage=Vl,this.byteLength=0,this.dimension=1,this.dtype=of,this.persistentData=null,ne.profile&&(this.stats={size:0})}De.prototype.bind=function(){C.bindBuffer(this.type,this.buffer)},De.prototype.destroy=function(){vt(this)};var at=[];function ut(me,we){var ot=at.pop();return ot||(ot=new De(me)),ot.bind(),ft(ot,we,af,0,1,!1),ot}function mt(me){at.push(me)}function lt(me,we,ot){me.byteLength=we.byteLength,C.bufferData(me.type,we,ot)}function ft(me,we,ot,Et,$e,Tt){var st;if(me.usage=ot,Array.isArray(we)){if(me.dtype=Et||ui,we.length>0){var St;if(Array.isArray(we[0])){st=hh(we);for(var Ke=1,ht=1;ht<st.length;++ht)Ke*=st[ht];me.dimension=Ke,St=xu(we,st,me.dtype),lt(me,St,ot),Tt?me.persistentData=St:an.freeType(St)}else if(typeof we[0]=="number"){me.dimension=$e;var Lt=an.allocType(me.dtype,we.length);Ru(Lt,we),lt(me,Lt,ot),Tt?me.persistentData=Lt:an.freeType(Lt)}else r(we[0])?(me.dimension=we[0].length,me.dtype=Et||bs(we[0])||ui,St=xu(we,[we.length,we[0].length],me.dtype),lt(me,St,ot),Tt?me.persistentData=St:an.freeType(St)):V.raise("invalid buffer data")}}else if(r(we))me.dtype=Et||bs(we),me.dimension=$e,lt(me,we,ot),Tt&&(me.persistentData=new Uint8Array(new Uint8Array(we.buffer)));else if(j(we)){st=we.shape;var Gt=we.stride,gt=we.offset,He=0,qe=0,Wt=0,lr=0;st.length===1?(He=st[0],qe=1,Wt=Gt[0],lr=0):st.length===2?(He=st[0],qe=st[1],Wt=Gt[0],lr=Gt[1]):V.raise("invalid shape"),me.dtype=Et||bs(we.data)||ui,me.dimension=qe;var Mt=an.allocType(me.dtype,He*qe);nm(Mt,we.data,He,qe,Wt,lr,gt),lt(me,Mt,ot),Tt?me.persistentData=Mt:an.freeType(Mt)}else we instanceof ArrayBuffer?(me.dtype=of,me.dimension=$e,lt(me,we,ot),Tt&&(me.persistentData=new Uint8Array(new Uint8Array(we)))):V.raise("invalid buffer data")}function vt(me){W.bufferCount--,be(me);var we=me.buffer;V(we,"buffer must not be deleted already"),C.deleteBuffer(we),me.buffer=null,delete Re[me.id]}function et(me,we,ot,Et){W.bufferCount++;var $e=new De(we);Re[$e.id]=$e;function Tt(Ke){var ht=Vl,Lt=null,Gt=0,gt=0,He=1;return Array.isArray(Ke)||r(Ke)||j(Ke)||Ke instanceof ArrayBuffer?Lt=Ke:typeof Ke=="number"?Gt=Ke|0:Ke&&(V.type(Ke,"object","buffer arguments must be an object, a number or an array"),"data"in Ke&&(V(Lt===null||Array.isArray(Lt)||r(Lt)||j(Lt),"invalid data for buffer"),Lt=Ke.data),"usage"in Ke&&(V.parameter(Ke.usage,bu,"invalid buffer usage"),ht=bu[Ke.usage]),"type"in Ke&&(V.parameter(Ke.type,uo,"invalid buffer type"),gt=uo[Ke.type]),"dimension"in Ke&&(V.type(Ke.dimension,"number","invalid dimension"),He=Ke.dimension|0),"length"in Ke&&(V.nni(Gt,"buffer length must be a nonnegative integer"),Gt=Ke.length|0)),$e.bind(),Lt?ft($e,Lt,ht,gt,He,Et):(Gt&&C.bufferData($e.type,Gt,ht),$e.dtype=gt||of,$e.usage=ht,$e.dimension=He,$e.byteLength=Gt),ne.profile&&($e.stats.size=$e.byteLength*xi[$e.dtype]),Tt}function st(Ke,ht){V(ht+Ke.byteLength<=$e.byteLength,"invalid buffer subdata call, buffer is too small.  Can't write data of size "+Ke.byteLength+" starting from offset "+ht+" to a buffer of size "+$e.byteLength),C.bufferSubData($e.type,ht,Ke)}function St(Ke,ht){var Lt=(ht||0)|0,Gt;if($e.bind(),r(Ke)||Ke instanceof ArrayBuffer)st(Ke,Lt);else if(Array.isArray(Ke)){if(Ke.length>0)if(typeof Ke[0]=="number"){var gt=an.allocType($e.dtype,Ke.length);Ru(gt,Ke),st(gt,Lt),an.freeType(gt)}else if(Array.isArray(Ke[0])||r(Ke[0])){Gt=hh(Ke);var He=xu(Ke,Gt,$e.dtype);st(He,Lt),an.freeType(He)}else V.raise("invalid buffer data")}else if(j(Ke)){Gt=Ke.shape;var qe=Ke.stride,Wt=0,lr=0,Mt=0,Zt=0;Gt.length===1?(Wt=Gt[0],lr=1,Mt=qe[0],Zt=0):Gt.length===2?(Wt=Gt[0],lr=Gt[1],Mt=qe[0],Zt=qe[1]):V.raise("invalid shape");var Yt=Array.isArray(Ke.data)?$e.dtype:bs(Ke.data),er=an.allocType(Yt,Wt*lr);nm(er,Ke.data,Wt,lr,Mt,Zt,Ke.offset),st(er,Lt),an.freeType(er)}else V.raise("invalid data for buffer subdata");return Tt}return ot||Tt(me),Tt._reglType="buffer",Tt._buffer=$e,Tt.subdata=St,ne.profile&&(Tt.stats=$e.stats),Tt.destroy=function(){vt($e)},Tt}function dt(){Z(Re).forEach(function(me){me.buffer=C.createBuffer(),C.bindBuffer(me.type,me.buffer),C.bufferData(me.type,me.persistentData||me.byteLength,me.usage)})}return ne.profile&&(W.getTotalBufferSize=function(){var me=0;return Object.keys(Re).forEach(function(we){me+=Re[we].stats.size}),me}),{create:et,createStream:ut,destroyStream:mt,clear:function(){Z(Re).forEach(vt),at.forEach(vt)},getBuffer:function(me){return me&&me._buffer instanceof De?me._buffer:null},restore:dt,_initBuffer:ft}}var vh=0,Xl=0,sf=1,im=1,oy=4,sy=4,Cu={points:vh,point:Xl,lines:sf,line:im,triangles:oy,triangle:sy,"line loop":2,"line strip":3,"triangle strip":5,"triangle fan":6},mh=0,uy=1,Gl=4,ly=5120,Ou=5121,am=5122,xs=5123,om=5124,Rs=5125,_h=34963,cy=35040,gh=35044;function fy(C,W,ne,be){var je={},Re=0,De={uint8:Ou,uint16:xs};W.oes_element_index_uint&&(De.uint32=Rs);function at(dt){this.id=Re++,je[this.id]=this,this.buffer=dt,this.primType=Gl,this.vertCount=0,this.type=0}at.prototype.bind=function(){this.buffer.bind()};var ut=[];function mt(dt){var me=ut.pop();return me||(me=new at(ne.create(null,_h,!0,!1)._buffer)),ft(me,dt,cy,-1,-1,0,0),me}function lt(dt){ut.push(dt)}function ft(dt,me,we,ot,Et,$e,Tt){dt.buffer.bind();var st;if(me){var St=Tt;!Tt&&(!r(me)||j(me)&&!r(me.data))&&(St=W.oes_element_index_uint?Rs:xs),ne._initBuffer(dt.buffer,me,we,St,3)}else C.bufferData(_h,$e,we),dt.buffer.dtype=st||Ou,dt.buffer.usage=we,dt.buffer.dimension=3,dt.buffer.byteLength=$e;if(st=Tt,!Tt){switch(dt.buffer.dtype){case Ou:case ly:st=Ou;break;case xs:case am:st=xs;break;case Rs:case om:st=Rs;break;default:V.raise("unsupported type for element array")}dt.buffer.dtype=st}dt.type=st,V(st!==Rs||!!W.oes_element_index_uint,"32 bit element buffers not supported, enable oes_element_index_uint first");var Ke=Et;Ke<0&&(Ke=dt.buffer.byteLength,st===xs?Ke>>=1:st===Rs&&(Ke>>=2)),dt.vertCount=Ke;var ht=ot;if(ot<0){ht=Gl;var Lt=dt.buffer.dimension;Lt===1&&(ht=mh),Lt===2&&(ht=uy),Lt===3&&(ht=Gl)}dt.primType=ht}function vt(dt){be.elementsCount--,V(dt.buffer!==null,"must not double destroy elements"),delete je[dt.id],dt.buffer.destroy(),dt.buffer=null}function et(dt,me){var we=ne.create(null,_h,!0),ot=new at(we._buffer);be.elementsCount++;function Et($e){if(!$e)we(),ot.primType=Gl,ot.vertCount=0,ot.type=Ou;else if(typeof $e=="number")we($e),ot.primType=Gl,ot.vertCount=$e|0,ot.type=Ou;else{var Tt=null,st=gh,St=-1,Ke=-1,ht=0,Lt=0;Array.isArray($e)||r($e)||j($e)?Tt=$e:(V.type($e,"object","invalid arguments for elements"),"data"in $e&&(Tt=$e.data,V(Array.isArray(Tt)||r(Tt)||j(Tt),"invalid data for element buffer")),"usage"in $e&&(V.parameter($e.usage,bu,"invalid element buffer usage"),st=bu[$e.usage]),"primitive"in $e&&(V.parameter($e.primitive,Cu,"invalid element buffer primitive"),St=Cu[$e.primitive]),"count"in $e&&(V(typeof $e.count=="number"&&$e.count>=0,"invalid vertex count for elements"),Ke=$e.count|0),"type"in $e&&(V.parameter($e.type,De,"invalid buffer type"),Lt=De[$e.type]),"length"in $e?ht=$e.length|0:(ht=Ke,Lt===xs||Lt===am?ht*=2:(Lt===Rs||Lt===om)&&(ht*=4))),ft(ot,Tt,st,St,Ke,ht,Lt)}return Et}return Et(dt),Et._reglType="elements",Et._elements=ot,Et.subdata=function($e,Tt){return we.subdata($e,Tt),Et},Et.destroy=function(){vt(ot)},Et}return{create:et,createStream:mt,destroyStream:lt,getElements:function(dt){return typeof dt=="function"&&dt._elements instanceof at?dt._elements:null},clear:function(){Z(je).forEach(vt)}}}var sm=new Float32Array(1),dy=new Uint32Array(sm.buffer),um=5123;function lm(C){for(var W=an.allocType(um,C.length),ne=0;ne<C.length;++ne)if(isNaN(C[ne]))W[ne]=65535;else if(C[ne]===1/0)W[ne]=31744;else if(C[ne]===-1/0)W[ne]=64512;else{sm[0]=C[ne];var be=dy[0],je=be>>>31<<15,Re=(be<<1>>>24)-127,De=be>>13&1023;if(Re<-24)W[ne]=je;else if(Re<-14){var at=-14-Re;W[ne]=je+(De+1024>>at)}else Re>15?W[ne]=je+31744:W[ne]=je+(Re+15<<10)+De}return W}function ln(C){return Array.isArray(C)||r(C)}var cm=function(C){return!(C&C-1)&&!!C},hy=34467,lo=3553,fm=34067,uf=34069,Cs=6408,yh=6406,Mu=6407,co=6409,lf=6410,Eh=32854,cf=32855,Th=36194,dm=32819,hm=32820,wu=33635,py=34042,Sh=6402,ff=34041,df=35904,hf=35906,Pa=36193,Os=33776,Ah=33777,Nu=33778,pf=33779,bh=35986,vf=35987,mf=34798,xh=35840,Rh=35841,Ch=35842,pm=35843,vm=36196,Iu=5121,Oh=5123,Mh=5125,Zn=5126,ql=10242,mm=10243,_m=10497,_f=33071,gm=33648,wh=10240,vy=10241,Go=9728,Nh=9729,Ms=9984,gf=9985,Ih=9986,fo=9987,Pu=33170,Du=4352,ym=4353,ws=4354,Em=34046,Tm=3317,Sm=37440,_y=37441,gy=37443,Am=37444,Wl=33984,bm=[Ms,Ih,gf,fo],Lu=[0,co,lf,Mu,Cs],Sn={};Sn[co]=Sn[yh]=Sn[Sh]=1,Sn[ff]=Sn[lf]=2,Sn[Mu]=Sn[df]=3,Sn[Cs]=Sn[hf]=4;function Ns(C){return"[object "+C+"]"}var Fi=Ns("HTMLCanvasElement"),Ui=Ns("OffscreenCanvas"),Is=Ns("CanvasRenderingContext2D"),yf=Ns("ImageBitmap"),Yl=Ns("HTMLImageElement"),$l=Ns("HTMLVideoElement"),Ph=Object.keys(Mn).concat([Fi,Ui,Is,yf,Yl,$l]),ha=[];ha[Iu]=1,ha[Zn]=4,ha[Pa]=2,ha[Oh]=2,ha[Mh]=4;var kn=[];kn[Eh]=2,kn[cf]=2,kn[Th]=2,kn[ff]=4,kn[Os]=.5,kn[Ah]=.5,kn[Nu]=1,kn[pf]=1,kn[bh]=.5,kn[vf]=1,kn[mf]=1,kn[xh]=.5,kn[Rh]=.25,kn[Ch]=.5,kn[pm]=.25,kn[vm]=.5;function Zl(C){return Array.isArray(C)&&(C.length===0||typeof C[0]=="number")}function Ps(C){if(!Array.isArray(C))return!1;var W=C.length;return!(W===0||!ln(C[0]))}function Ds(C){return Object.prototype.toString.call(C)}function Ri(C){return Ds(C)===Fi}function Ef(C){return Ds(C)===Ui}function ho(C){return Ds(C)===Is}function xm(C){return Ds(C)===yf}function Tf(C){return Ds(C)===Yl}function Ls(C){return Ds(C)===$l}function Kl(C){if(!C)return!1;var W=Ds(C);return Ph.indexOf(W)>=0?!0:Zl(C)||Ps(C)||j(C)}function Sf(C){return Mn[Object.prototype.toString.call(C)]|0}function Bu(C,W){var ne=W.length;switch(C.type){case Iu:case Oh:case Mh:case Zn:var be=an.allocType(C.type,ne);be.set(W),C.data=be;break;case Pa:C.data=lm(W);break;default:V.raise("unsupported texture type, must specify a typed array")}}function Bs(C,W){return an.allocType(C.type===Pa?Zn:C.type,W)}function Ql(C,W){C.type===Pa?(C.data=lm(W),an.freeType(W)):C.data=W}function Af(C,W,ne,be,je,Re){for(var De=C.width,at=C.height,ut=C.channels,mt=De*at*ut,lt=Bs(C,mt),ft=0,vt=0;vt<at;++vt)for(var et=0;et<De;++et)for(var dt=0;dt<ut;++dt)lt[ft++]=W[ne*et+be*vt+je*dt+Re];Ql(C,lt)}function mi(C,W,ne,be,je,Re){var De;if(typeof kn[C]<"u"?De=kn[C]:De=Sn[C]*ha[W],Re&&(De*=6),je){for(var at=0,ut=ne;ut>=1;)at+=De*ut*ut,ut/=2;return at}else return De*ne*be}function Ki(C,W,ne,be,je,Re,De){var at={"don't care":Du,"dont care":Du,nice:ws,fast:ym},ut={repeat:_m,clamp:_f,mirror:gm},mt={nearest:Go,linear:Nh},lt=n({mipmap:fo,"nearest mipmap nearest":Ms,"linear mipmap nearest":gf,"nearest mipmap linear":Ih,"linear mipmap linear":fo},mt),ft={none:0,browser:Am},vt={uint8:Iu,rgba4:dm,rgb565:wu,"rgb5 a1":hm},et={alpha:yh,luminance:co,"luminance alpha":lf,rgb:Mu,rgba:Cs,rgba4:Eh,"rgb5 a1":cf,rgb565:Th},dt={};W.ext_srgb&&(et.srgb=df,et.srgba=hf),W.oes_texture_float&&(vt.float32=vt.float=Zn),W.oes_texture_half_float&&(vt.float16=vt["half float"]=Pa),W.webgl_depth_texture&&(n(et,{depth:Sh,"depth stencil":ff}),n(vt,{uint16:Oh,uint32:Mh,"depth stencil":py})),W.webgl_compressed_texture_s3tc&&n(dt,{"rgb s3tc dxt1":Os,"rgba s3tc dxt1":Ah,"rgba s3tc dxt3":Nu,"rgba s3tc dxt5":pf}),W.webgl_compressed_texture_atc&&n(dt,{"rgb atc":bh,"rgba atc explicit alpha":vf,"rgba atc interpolated alpha":mf}),W.webgl_compressed_texture_pvrtc&&n(dt,{"rgb pvrtc 4bppv1":xh,"rgb pvrtc 2bppv1":Rh,"rgba pvrtc 4bppv1":Ch,"rgba pvrtc 2bppv1":pm}),W.webgl_compressed_texture_etc1&&(dt["rgb etc1"]=vm);var me=Array.prototype.slice.call(C.getParameter(hy));Object.keys(dt).forEach(function(J){var Oe=dt[J];me.indexOf(Oe)>=0&&(et[J]=Oe)});var we=Object.keys(et);ne.textureFormats=we;var ot=[];Object.keys(et).forEach(function(J){var Oe=et[J];ot[Oe]=J});var Et=[];Object.keys(vt).forEach(function(J){var Oe=vt[J];Et[Oe]=J});var $e=[];Object.keys(mt).forEach(function(J){var Oe=mt[J];$e[Oe]=J});var Tt=[];Object.keys(lt).forEach(function(J){var Oe=lt[J];Tt[Oe]=J});var st=[];Object.keys(ut).forEach(function(J){var Oe=ut[J];st[Oe]=J});var St=we.reduce(function(J,Oe){var Ae=et[Oe];return Ae===co||Ae===yh||Ae===co||Ae===lf||Ae===Sh||Ae===ff||W.ext_srgb&&(Ae===df||Ae===hf)?J[Ae]=Ae:Ae===cf||Oe.indexOf("rgba")>=0?J[Ae]=Cs:J[Ae]=Mu,J},{});function Ke(){this.internalformat=Cs,this.format=Cs,this.type=Iu,this.compressed=!1,this.premultiplyAlpha=!1,this.flipY=!1,this.unpackAlignment=1,this.colorSpace=Am,this.width=0,this.height=0,this.channels=0}function ht(J,Oe){J.internalformat=Oe.internalformat,J.format=Oe.format,J.type=Oe.type,J.compressed=Oe.compressed,J.premultiplyAlpha=Oe.premultiplyAlpha,J.flipY=Oe.flipY,J.unpackAlignment=Oe.unpackAlignment,J.colorSpace=Oe.colorSpace,J.width=Oe.width,J.height=Oe.height,J.channels=Oe.channels}function Lt(J,Oe){if(!(typeof Oe!="object"||!Oe)){if("premultiplyAlpha"in Oe&&(V.type(Oe.premultiplyAlpha,"boolean","invalid premultiplyAlpha"),J.premultiplyAlpha=Oe.premultiplyAlpha),"flipY"in Oe&&(V.type(Oe.flipY,"boolean","invalid texture flip"),J.flipY=Oe.flipY),"alignment"in Oe&&(V.oneOf(Oe.alignment,[1,2,4,8],"invalid texture unpack alignment"),J.unpackAlignment=Oe.alignment),"colorSpace"in Oe&&(V.parameter(Oe.colorSpace,ft,"invalid colorSpace"),J.colorSpace=ft[Oe.colorSpace]),"type"in Oe){var Ae=Oe.type;V(W.oes_texture_float||!(Ae==="float"||Ae==="float32"),"you must enable the OES_texture_float extension in order to use floating point textures."),V(W.oes_texture_half_float||!(Ae==="half float"||Ae==="float16"),"you must enable the OES_texture_half_float extension in order to use 16-bit floating point textures."),V(W.webgl_depth_texture||!(Ae==="uint16"||Ae==="uint32"||Ae==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),V.parameter(Ae,vt,"invalid texture type"),J.type=vt[Ae]}var bt=J.width,qt=J.height,mr=J.channels,k=!1;"shape"in Oe?(V(Array.isArray(Oe.shape)&&Oe.shape.length>=2,"shape must be an array"),bt=Oe.shape[0],qt=Oe.shape[1],Oe.shape.length===3&&(mr=Oe.shape[2],V(mr>0&&mr<=4,"invalid number of channels"),k=!0),V(bt>=0&&bt<=ne.maxTextureSize,"invalid width"),V(qt>=0&&qt<=ne.maxTextureSize,"invalid height")):("radius"in Oe&&(bt=qt=Oe.radius,V(bt>=0&&bt<=ne.maxTextureSize,"invalid radius")),"width"in Oe&&(bt=Oe.width,V(bt>=0&&bt<=ne.maxTextureSize,"invalid width")),"height"in Oe&&(qt=Oe.height,V(qt>=0&&qt<=ne.maxTextureSize,"invalid height")),"channels"in Oe&&(mr=Oe.channels,V(mr>0&&mr<=4,"invalid number of channels"),k=!0)),J.width=bt|0,J.height=qt|0,J.channels=mr|0;var Y=!1;if("format"in Oe){var te=Oe.format;V(W.webgl_depth_texture||!(te==="depth"||te==="depth stencil"),"you must enable the WEBGL_depth_texture extension in order to use depth/stencil textures."),V.parameter(te,et,"invalid texture format");var Ee=J.internalformat=et[te];J.format=St[Ee],te in vt&&("type"in Oe||(J.type=vt[te])),te in dt&&(J.compressed=!0),Y=!0}!k&&Y?J.channels=Sn[J.format]:k&&!Y?J.channels!==Lu[J.format]&&(J.format=J.internalformat=Lu[J.channels]):Y&&k&&V(J.channels===Sn[J.format],"number of channels inconsistent with specified format")}}function Gt(J){C.pixelStorei(Sm,J.flipY),C.pixelStorei(_y,J.premultiplyAlpha),C.pixelStorei(gy,J.colorSpace),C.pixelStorei(Tm,J.unpackAlignment)}function gt(){Ke.call(this),this.xOffset=0,this.yOffset=0,this.data=null,this.needsFree=!1,this.element=null,this.needsCopy=!1}function He(J,Oe){var Ae=null;if(Kl(Oe)?Ae=Oe:Oe&&(V.type(Oe,"object","invalid pixel data type"),Lt(J,Oe),"x"in Oe&&(J.xOffset=Oe.x|0),"y"in Oe&&(J.yOffset=Oe.y|0),Kl(Oe.data)&&(Ae=Oe.data)),V(!J.compressed||Ae instanceof Uint8Array,"compressed texture data must be stored in a uint8array"),Oe.copy){V(!Ae,"can not specify copy and data field for the same texture");var bt=je.viewportWidth,qt=je.viewportHeight;J.width=J.width||bt-J.xOffset,J.height=J.height||qt-J.yOffset,J.needsCopy=!0,V(J.xOffset>=0&&J.xOffset<bt&&J.yOffset>=0&&J.yOffset<qt&&J.width>0&&J.width<=bt&&J.height>0&&J.height<=qt,"copy texture read out of bounds")}else if(!Ae)J.width=J.width||1,J.height=J.height||1,J.channels=J.channels||4;else if(r(Ae))J.channels=J.channels||4,J.data=Ae,!("type"in Oe)&&J.type===Iu&&(J.type=Sf(Ae));else if(Zl(Ae))J.channels=J.channels||4,Bu(J,Ae),J.alignment=1,J.needsFree=!0;else if(j(Ae)){var mr=Ae.data;!Array.isArray(mr)&&J.type===Iu&&(J.type=Sf(mr));var k=Ae.shape,Y=Ae.stride,te,Ee,Te,ie,ce,de;k.length===3?(Te=k[2],de=Y[2]):(V(k.length===2,"invalid ndarray pixel data, must be 2 or 3D"),Te=1,de=1),te=k[0],Ee=k[1],ie=Y[0],ce=Y[1],J.alignment=1,J.width=te,J.height=Ee,J.channels=Te,J.format=J.internalformat=Lu[Te],J.needsFree=!0,Af(J,mr,ie,ce,de,Ae.offset)}else if(Ri(Ae)||Ef(Ae)||ho(Ae))Ri(Ae)||Ef(Ae)?J.element=Ae:J.element=Ae.canvas,J.width=J.element.width,J.height=J.element.height,J.channels=4;else if(xm(Ae))J.element=Ae,J.width=Ae.width,J.height=Ae.height,J.channels=4;else if(Tf(Ae))J.element=Ae,J.width=Ae.naturalWidth,J.height=Ae.naturalHeight,J.channels=4;else if(Ls(Ae))J.element=Ae,J.width=Ae.videoWidth,J.height=Ae.videoHeight,J.channels=4;else if(Ps(Ae)){var K=J.width||Ae[0].length,se=J.height||Ae.length,$=J.channels;ln(Ae[0][0])?$=$||Ae[0][0].length:$=$||1;for(var ue=fe.shape(Ae),xe=1,Pe=0;Pe<ue.length;++Pe)xe*=ue[Pe];var Qe=Bs(J,xe);fe.flatten(Ae,ue,"",Qe),Ql(J,Qe),J.alignment=1,J.width=K,J.height=se,J.channels=$,J.format=J.internalformat=Lu[$],J.needsFree=!0}J.type===Zn?V(ne.extensions.indexOf("oes_texture_float")>=0,"oes_texture_float extension not enabled"):J.type===Pa&&V(ne.extensions.indexOf("oes_texture_half_float")>=0,"oes_texture_half_float extension not enabled")}function qe(J,Oe,Ae){var bt=J.element,qt=J.data,mr=J.internalformat,k=J.format,Y=J.type,te=J.width,Ee=J.height;Gt(J),bt?C.texImage2D(Oe,Ae,k,k,Y,bt):J.compressed?C.compressedTexImage2D(Oe,Ae,mr,te,Ee,0,qt):J.needsCopy?(be(),C.copyTexImage2D(Oe,Ae,k,J.xOffset,J.yOffset,te,Ee,0)):C.texImage2D(Oe,Ae,k,te,Ee,0,k,Y,qt||null)}function Wt(J,Oe,Ae,bt,qt){var mr=J.element,k=J.data,Y=J.internalformat,te=J.format,Ee=J.type,Te=J.width,ie=J.height;Gt(J),mr?C.texSubImage2D(Oe,qt,Ae,bt,te,Ee,mr):J.compressed?C.compressedTexSubImage2D(Oe,qt,Ae,bt,Y,Te,ie,k):J.needsCopy?(be(),C.copyTexSubImage2D(Oe,qt,Ae,bt,J.xOffset,J.yOffset,Te,ie)):C.texSubImage2D(Oe,qt,Ae,bt,Te,ie,te,Ee,k)}var lr=[];function Mt(){return lr.pop()||new gt}function Zt(J){J.needsFree&&an.freeType(J.data),gt.call(J),lr.push(J)}function Yt(){Ke.call(this),this.genMipmaps=!1,this.mipmapHint=Du,this.mipmask=0,this.images=Array(16)}function er(J,Oe,Ae){var bt=J.images[0]=Mt();J.mipmask=1,bt.width=J.width=Oe,bt.height=J.height=Ae,bt.channels=J.channels=4}function cr(J,Oe){var Ae=null;if(Kl(Oe))Ae=J.images[0]=Mt(),ht(Ae,J),He(Ae,Oe),J.mipmask=1;else if(Lt(J,Oe),Array.isArray(Oe.mipmap))for(var bt=Oe.mipmap,qt=0;qt<bt.length;++qt)Ae=J.images[qt]=Mt(),ht(Ae,J),Ae.width>>=qt,Ae.height>>=qt,He(Ae,bt[qt]),J.mipmask|=1<<qt;else Ae=J.images[0]=Mt(),ht(Ae,J),He(Ae,Oe),J.mipmask=1;ht(J,J.images[0]),J.compressed&&(J.internalformat===Os||J.internalformat===Ah||J.internalformat===Nu||J.internalformat===pf)&&V(J.width%4===0&&J.height%4===0,"for compressed texture formats, mipmap level 0 must have width and height that are a multiple of 4")}function Br(J,Oe){for(var Ae=J.images,bt=0;bt<Ae.length;++bt){if(!Ae[bt])return;qe(Ae[bt],Oe,bt)}}var In=[];function or(){var J=In.pop()||new Yt;Ke.call(J),J.mipmask=0;for(var Oe=0;Oe<16;++Oe)J.images[Oe]=null;return J}function bn(J){for(var Oe=J.images,Ae=0;Ae<Oe.length;++Ae)Oe[Ae]&&Zt(Oe[Ae]),Oe[Ae]=null;In.push(J)}function Fr(){this.minFilter=Go,this.magFilter=Go,this.wrapS=_f,this.wrapT=_f,this.anisotropic=1,this.genMipmaps=!1,this.mipmapHint=Du}function on(J,Oe){if("min"in Oe){var Ae=Oe.min;V.parameter(Ae,lt),J.minFilter=lt[Ae],bm.indexOf(J.minFilter)>=0&&!("faces"in Oe)&&(J.genMipmaps=!0)}if("mag"in Oe){var bt=Oe.mag;V.parameter(bt,mt),J.magFilter=mt[bt]}var qt=J.wrapS,mr=J.wrapT;if("wrap"in Oe){var k=Oe.wrap;typeof k=="string"?(V.parameter(k,ut),qt=mr=ut[k]):Array.isArray(k)&&(V.parameter(k[0],ut),V.parameter(k[1],ut),qt=ut[k[0]],mr=ut[k[1]])}else{if("wrapS"in Oe){var Y=Oe.wrapS;V.parameter(Y,ut),qt=ut[Y]}if("wrapT"in Oe){var te=Oe.wrapT;V.parameter(te,ut),mr=ut[te]}}if(J.wrapS=qt,J.wrapT=mr,"anisotropic"in Oe){var Ee=Oe.anisotropic;V(typeof Ee=="number"&&Ee>=1&&Ee<=ne.maxAnisotropic,"aniso samples must be between 1 and "),J.anisotropic=Oe.anisotropic}if("mipmap"in Oe){var Te=!1;switch(typeof Oe.mipmap){case"string":V.parameter(Oe.mipmap,at,"invalid mipmap hint"),J.mipmapHint=at[Oe.mipmap],J.genMipmaps=!0,Te=!0;break;case"boolean":Te=J.genMipmaps=Oe.mipmap;break;case"object":V(Array.isArray(Oe.mipmap),"invalid mipmap type"),J.genMipmaps=!1,Te=!0;break;default:V.raise("invalid mipmap type")}Te&&!("min"in Oe)&&(J.minFilter=Ms)}}function sn(J,Oe){C.texParameteri(Oe,vy,J.minFilter),C.texParameteri(Oe,wh,J.magFilter),C.texParameteri(Oe,ql,J.wrapS),C.texParameteri(Oe,mm,J.wrapT),W.ext_texture_filter_anisotropic&&C.texParameteri(Oe,Em,J.anisotropic),J.genMipmaps&&(C.hint(Pu,J.mipmapHint),C.generateMipmap(Oe))}var xn=0,Yr={},Sr=ne.maxTextureUnits,fn=Array(Sr).map(function(){return null});function Jt(J){Ke.call(this),this.mipmask=0,this.internalformat=Cs,this.id=xn++,this.refCount=1,this.target=J,this.texture=C.createTexture(),this.unit=-1,this.bindCount=0,this.texInfo=new Fr,De.profile&&(this.stats={size:0})}function Mr(J){C.activeTexture(Wl),C.bindTexture(J.target,J.texture)}function Ar(){var J=fn[0];J?C.bindTexture(J.target,J.texture):C.bindTexture(lo,null)}function Ut(J){var Oe=J.texture;V(Oe,"must not double destroy texture");var Ae=J.unit,bt=J.target;Ae>=0&&(C.activeTexture(Wl+Ae),C.bindTexture(bt,null),fn[Ae]=null),C.deleteTexture(Oe),J.texture=null,J.params=null,J.pixels=null,J.refCount=0,delete Yr[J.id],Re.textureCount--}n(Jt.prototype,{bind:function(){var J=this;J.bindCount+=1;var Oe=J.unit;if(Oe<0){for(var Ae=0;Ae<Sr;++Ae){var bt=fn[Ae];if(bt){if(bt.bindCount>0)continue;bt.unit=-1}fn[Ae]=J,Oe=Ae;break}Oe>=Sr&&V.raise("insufficient number of texture units"),De.profile&&Re.maxTextureUnits<Oe+1&&(Re.maxTextureUnits=Oe+1),J.unit=Oe,C.activeTexture(Wl+Oe),C.bindTexture(J.target,J.texture)}return Oe},unbind:function(){this.bindCount-=1},decRef:function(){--this.refCount<=0&&Ut(this)}});function sr(J,Oe){var Ae=new Jt(lo);Yr[Ae.id]=Ae,Re.textureCount++;function bt(k,Y){var te=Ae.texInfo;Fr.call(te);var Ee=or();return typeof k=="number"?typeof Y=="number"?er(Ee,k|0,Y|0):er(Ee,k|0,k|0):k?(V.type(k,"object","invalid arguments to regl.texture"),on(te,k),cr(Ee,k)):er(Ee,1,1),te.genMipmaps&&(Ee.mipmask=(Ee.width<<1)-1),Ae.mipmask=Ee.mipmask,ht(Ae,Ee),V.texture2D(te,Ee,ne),Ae.internalformat=Ee.internalformat,bt.width=Ee.width,bt.height=Ee.height,Mr(Ae),Br(Ee,lo),sn(te,lo),Ar(),bn(Ee),De.profile&&(Ae.stats.size=mi(Ae.internalformat,Ae.type,Ee.width,Ee.height,te.genMipmaps,!1)),bt.format=ot[Ae.internalformat],bt.type=Et[Ae.type],bt.mag=$e[te.magFilter],bt.min=Tt[te.minFilter],bt.wrapS=st[te.wrapS],bt.wrapT=st[te.wrapT],bt}function qt(k,Y,te,Ee){V(!!k,"must specify image data");var Te=Y|0,ie=te|0,ce=Ee|0,de=Mt();return ht(de,Ae),de.width=0,de.height=0,He(de,k),de.width=de.width||(Ae.width>>ce)-Te,de.height=de.height||(Ae.height>>ce)-ie,V(Ae.type===de.type&&Ae.format===de.format&&Ae.internalformat===de.internalformat,"incompatible format for texture.subimage"),V(Te>=0&&ie>=0&&Te+de.width<=Ae.width&&ie+de.height<=Ae.height,"texture.subimage write out of bounds"),V(Ae.mipmask&1<<ce,"missing mipmap data"),V(de.data||de.element||de.needsCopy,"missing image data"),Mr(Ae),Wt(de,lo,Te,ie,ce),Ar(),Zt(de),bt}function mr(k,Y){var te=k|0,Ee=Y|0||te;if(te===Ae.width&&Ee===Ae.height)return bt;bt.width=Ae.width=te,bt.height=Ae.height=Ee,Mr(Ae);for(var Te=0;Ae.mipmask>>Te;++Te){var ie=te>>Te,ce=Ee>>Te;if(!ie||!ce)break;C.texImage2D(lo,Te,Ae.format,ie,ce,0,Ae.format,Ae.type,null)}return Ar(),De.profile&&(Ae.stats.size=mi(Ae.internalformat,Ae.type,te,Ee,!1,!1)),bt}return bt(J,Oe),bt.subimage=qt,bt.resize=mr,bt._reglType="texture2d",bt._texture=Ae,De.profile&&(bt.stats=Ae.stats),bt.destroy=function(){Ae.decRef()},bt}function kt(J,Oe,Ae,bt,qt,mr){var k=new Jt(fm);Yr[k.id]=k,Re.cubeCount++;var Y=new Array(6);function te(ie,ce,de,K,se,$){var ue,xe=k.texInfo;for(Fr.call(xe),ue=0;ue<6;++ue)Y[ue]=or();if(typeof ie=="number"||!ie){var Pe=ie|0||1;for(ue=0;ue<6;++ue)er(Y[ue],Pe,Pe)}else if(typeof ie=="object")if(ce)cr(Y[0],ie),cr(Y[1],ce),cr(Y[2],de),cr(Y[3],K),cr(Y[4],se),cr(Y[5],$);else if(on(xe,ie),Lt(k,ie),"faces"in ie){var Qe=ie.faces;for(V(Array.isArray(Qe)&&Qe.length===6,"cube faces must be a length 6 array"),ue=0;ue<6;++ue)V(typeof Qe[ue]=="object"&&!!Qe[ue],"invalid input for cube map face"),ht(Y[ue],k),cr(Y[ue],Qe[ue])}else for(ue=0;ue<6;++ue)cr(Y[ue],ie);else V.raise("invalid arguments to cube map");for(ht(k,Y[0]),ne.npotTextureCube||V(cm(k.width)&&cm(k.height),"your browser does not support non power or two texture dimensions"),xe.genMipmaps?k.mipmask=(Y[0].width<<1)-1:k.mipmask=Y[0].mipmask,V.textureCube(k,xe,Y,ne),k.internalformat=Y[0].internalformat,te.width=Y[0].width,te.height=Y[0].height,Mr(k),ue=0;ue<6;++ue)Br(Y[ue],uf+ue);for(sn(xe,fm),Ar(),De.profile&&(k.stats.size=mi(k.internalformat,k.type,te.width,te.height,xe.genMipmaps,!0)),te.format=ot[k.internalformat],te.type=Et[k.type],te.mag=$e[xe.magFilter],te.min=Tt[xe.minFilter],te.wrapS=st[xe.wrapS],te.wrapT=st[xe.wrapT],ue=0;ue<6;++ue)bn(Y[ue]);return te}function Ee(ie,ce,de,K,se){V(!!ce,"must specify image data"),V(typeof ie=="number"&&ie===(ie|0)&&ie>=0&&ie<6,"invalid face");var $=de|0,ue=K|0,xe=se|0,Pe=Mt();return ht(Pe,k),Pe.width=0,Pe.height=0,He(Pe,ce),Pe.width=Pe.width||(k.width>>xe)-$,Pe.height=Pe.height||(k.height>>xe)-ue,V(k.type===Pe.type&&k.format===Pe.format&&k.internalformat===Pe.internalformat,"incompatible format for texture.subimage"),V($>=0&&ue>=0&&$+Pe.width<=k.width&&ue+Pe.height<=k.height,"texture.subimage write out of bounds"),V(k.mipmask&1<<xe,"missing mipmap data"),V(Pe.data||Pe.element||Pe.needsCopy,"missing image data"),Mr(k),Wt(Pe,uf+ie,$,ue,xe),Ar(),Zt(Pe),te}function Te(ie){var ce=ie|0;if(ce!==k.width){te.width=k.width=ce,te.height=k.height=ce,Mr(k);for(var de=0;de<6;++de)for(var K=0;k.mipmask>>K;++K)C.texImage2D(uf+de,K,k.format,ce>>K,ce>>K,0,k.format,k.type,null);return Ar(),De.profile&&(k.stats.size=mi(k.internalformat,k.type,te.width,te.height,!1,!0)),te}}return te(J,Oe,Ae,bt,qt,mr),te.subimage=Ee,te.resize=Te,te._reglType="textureCube",te._texture=k,De.profile&&(te.stats=k.stats),te.destroy=function(){k.decRef()},te}function br(){for(var J=0;J<Sr;++J)C.activeTexture(Wl+J),C.bindTexture(lo,null),fn[J]=null;Z(Yr).forEach(Ut),Re.cubeCount=0,Re.textureCount=0}De.profile&&(Re.getTotalTextureSize=function(){var J=0;return Object.keys(Yr).forEach(function(Oe){J+=Yr[Oe].stats.size}),J});function Xn(){for(var J=0;J<Sr;++J){var Oe=fn[J];Oe&&(Oe.bindCount=0,Oe.unit=-1,fn[J]=null)}Z(Yr).forEach(function(Ae){Ae.texture=C.createTexture(),C.bindTexture(Ae.target,Ae.texture);for(var bt=0;bt<32;++bt)if((Ae.mipmask&1<<bt)!==0)if(Ae.target===lo)C.texImage2D(lo,bt,Ae.internalformat,Ae.width>>bt,Ae.height>>bt,0,Ae.internalformat,Ae.type,null);else for(var qt=0;qt<6;++qt)C.texImage2D(uf+qt,bt,Ae.internalformat,Ae.width>>bt,Ae.height>>bt,0,Ae.internalformat,Ae.type,null);sn(Ae.texInfo,Ae.target)})}return{create2D:sr,createCube:kt,clear:br,getTexture:function(J){return null},restore:Xn}}var Ci=36161,Qi=32854,Da=32855,qo=36194,Dh=33189,bf=36168,xf=34041,li=35907,cn=34836,Dr=34842,Wo=34843,Dn=[];Dn[Qi]=2,Dn[Da]=2,Dn[qo]=2,Dn[Dh]=2,Dn[bf]=1,Dn[xf]=4,Dn[li]=4,Dn[cn]=16,Dn[Dr]=8,Dn[Wo]=6;function Rf(C,W,ne){return Dn[C]*W*ne}var Fs=function(C,W,ne,be,je){var Re={rgba4:Qi,rgb565:qo,"rgb5 a1":Da,depth:Dh,stencil:bf,"depth stencil":xf};W.ext_srgb&&(Re.srgba=li),W.ext_color_buffer_half_float&&(Re.rgba16f=Dr,Re.rgb16f=Wo),W.webgl_color_buffer_float&&(Re.rgba32f=cn);var De=[];Object.keys(Re).forEach(function(et){var dt=Re[et];De[dt]=et});var at=0,ut={};function mt(et){this.id=at++,this.refCount=1,this.renderbuffer=et,this.format=Qi,this.width=0,this.height=0,je.profile&&(this.stats={size:0})}mt.prototype.decRef=function(){--this.refCount<=0&&lt(this)};function lt(et){var dt=et.renderbuffer;V(dt,"must not double destroy renderbuffer"),C.bindRenderbuffer(Ci,null),C.deleteRenderbuffer(dt),et.renderbuffer=null,et.refCount=0,delete ut[et.id],be.renderbufferCount--}function ft(et,dt){var me=new mt(C.createRenderbuffer());ut[me.id]=me,be.renderbufferCount++;function we(Et,$e){var Tt=0,st=0,St=Qi;if(typeof Et=="object"&&Et){var Ke=Et;if("shape"in Ke){var ht=Ke.shape;V(Array.isArray(ht)&&ht.length>=2,"invalid renderbuffer shape"),Tt=ht[0]|0,st=ht[1]|0}else"radius"in Ke&&(Tt=st=Ke.radius|0),"width"in Ke&&(Tt=Ke.width|0),"height"in Ke&&(st=Ke.height|0);"format"in Ke&&(V.parameter(Ke.format,Re,"invalid renderbuffer format"),St=Re[Ke.format])}else typeof Et=="number"?(Tt=Et|0,typeof $e=="number"?st=$e|0:st=Tt):Et?V.raise("invalid arguments to renderbuffer constructor"):Tt=st=1;if(V(Tt>0&&st>0&&Tt<=ne.maxRenderbufferSize&&st<=ne.maxRenderbufferSize,"invalid renderbuffer size"),!(Tt===me.width&&st===me.height&&St===me.format))return we.width=me.width=Tt,we.height=me.height=st,me.format=St,C.bindRenderbuffer(Ci,me.renderbuffer),C.renderbufferStorage(Ci,St,Tt,st),V(C.getError()===0,"invalid render buffer format"),je.profile&&(me.stats.size=Rf(me.format,me.width,me.height)),we.format=De[me.format],we}function ot(Et,$e){var Tt=Et|0,st=$e|0||Tt;return Tt===me.width&&st===me.height||(V(Tt>0&&st>0&&Tt<=ne.maxRenderbufferSize&&st<=ne.maxRenderbufferSize,"invalid renderbuffer size"),we.width=me.width=Tt,we.height=me.height=st,C.bindRenderbuffer(Ci,me.renderbuffer),C.renderbufferStorage(Ci,me.format,Tt,st),V(C.getError()===0,"invalid render buffer format"),je.profile&&(me.stats.size=Rf(me.format,me.width,me.height))),we}return we(et,dt),we.resize=ot,we._reglType="renderbuffer",we._renderbuffer=me,je.profile&&(we.stats=me.stats),we.destroy=function(){me.decRef()},we}je.profile&&(be.getTotalRenderbufferSize=function(){var et=0;return Object.keys(ut).forEach(function(dt){et+=ut[dt].stats.size}),et});function vt(){Z(ut).forEach(function(et){et.renderbuffer=C.createRenderbuffer(),C.bindRenderbuffer(Ci,et.renderbuffer),C.renderbufferStorage(Ci,et.format,et.width,et.height)}),C.bindRenderbuffer(Ci,null)}return{create:ft,clear:function(){Z(ut).forEach(lt)},restore:vt}},La=36160,Cf=36161,pa=3553,Yo=34069,Lh=36064,Fu=36096,Of=36128,$o=33306,Ba=36053,Zo=36054,po=36055,Bh=36057,Fh=36061,Jl=36193,Mf=5121,Us=5126,Kn=6407,ec=6408,Rm=6402,yy=[Kn,ec],Uh=[];Uh[ec]=4,Uh[Kn]=3;var wf=[];wf[Mf]=1,wf[Us]=4,wf[Jl]=2;var zn=32854,kh=32855,tc=36194,rc=33189,zh=36168,ks=34041,Uu=35907,Ey=34836,Cm=34842,Ty=34843,Om=[zn,kh,tc,Uu,Cm,Ty,Ey],Ji={};Ji[Ba]="complete",Ji[Zo]="incomplete attachment",Ji[Bh]="incomplete dimensions",Ji[po]="incomplete, missing attachment",Ji[Fh]="unsupported";function jh(C,W,ne,be,je,Re){var De={cur:null,next:null,dirty:!1,setFBO:null},at=["rgba"],ut=["rgba4","rgb565","rgb5 a1"];W.ext_srgb&&ut.push("srgba"),W.ext_color_buffer_half_float&&ut.push("rgba16f","rgb16f"),W.webgl_color_buffer_float&&ut.push("rgba32f");var mt=["uint8"];W.oes_texture_half_float&&mt.push("half float","float16"),W.oes_texture_float&&mt.push("float","float32");function lt(gt,He,qe){this.target=gt,this.texture=He,this.renderbuffer=qe;var Wt=0,lr=0;He?(Wt=He.width,lr=He.height):qe&&(Wt=qe.width,lr=qe.height),this.width=Wt,this.height=lr}function ft(gt){gt&&(gt.texture&&gt.texture._texture.decRef(),gt.renderbuffer&&gt.renderbuffer._renderbuffer.decRef())}function vt(gt,He,qe){if(gt)if(gt.texture){var Wt=gt.texture._texture,lr=Math.max(1,Wt.width),Mt=Math.max(1,Wt.height);V(lr===He&&Mt===qe,"inconsistent width/height for supplied texture"),Wt.refCount+=1}else{var Zt=gt.renderbuffer._renderbuffer;V(Zt.width===He&&Zt.height===qe,"inconsistent width/height for renderbuffer"),Zt.refCount+=1}}function et(gt,He){He&&(He.texture?C.framebufferTexture2D(La,gt,He.target,He.texture._texture.texture,0):C.framebufferRenderbuffer(La,gt,Cf,He.renderbuffer._renderbuffer.renderbuffer))}function dt(gt){var He=pa,qe=null,Wt=null,lr=gt;typeof gt=="object"&&(lr=gt.data,"target"in gt&&(He=gt.target|0)),V.type(lr,"function","invalid attachment data");var Mt=lr._reglType;return Mt==="texture2d"?(qe=lr,V(He===pa)):Mt==="textureCube"?(qe=lr,V(He>=Yo&&He<Yo+6,"invalid cube map target")):Mt==="renderbuffer"?(Wt=lr,He=Cf):V.raise("invalid regl object for attachment"),new lt(He,qe,Wt)}function me(gt,He,qe,Wt,lr){if(qe){var Mt=be.create2D({width:gt,height:He,format:Wt,type:lr});return Mt._texture.refCount=0,new lt(pa,Mt,null)}else{var Zt=je.create({width:gt,height:He,format:Wt});return Zt._renderbuffer.refCount=0,new lt(Cf,null,Zt)}}function we(gt){return gt&&(gt.texture||gt.renderbuffer)}function ot(gt,He,qe){gt&&(gt.texture?gt.texture.resize(He,qe):gt.renderbuffer&&gt.renderbuffer.resize(He,qe),gt.width=He,gt.height=qe)}var Et=0,$e={};function Tt(){this.id=Et++,$e[this.id]=this,this.framebuffer=C.createFramebuffer(),this.width=0,this.height=0,this.colorAttachments=[],this.depthAttachment=null,this.stencilAttachment=null,this.depthStencilAttachment=null}function st(gt){gt.colorAttachments.forEach(ft),ft(gt.depthAttachment),ft(gt.stencilAttachment),ft(gt.depthStencilAttachment)}function St(gt){var He=gt.framebuffer;V(He,"must not double destroy framebuffer"),C.deleteFramebuffer(He),gt.framebuffer=null,Re.framebufferCount--,delete $e[gt.id]}function Ke(gt){var He;C.bindFramebuffer(La,gt.framebuffer);var qe=gt.colorAttachments;for(He=0;He<qe.length;++He)et(Lh+He,qe[He]);for(He=qe.length;He<ne.maxColorAttachments;++He)C.framebufferTexture2D(La,Lh+He,pa,null,0);C.framebufferTexture2D(La,$o,pa,null,0),C.framebufferTexture2D(La,Fu,pa,null,0),C.framebufferTexture2D(La,Of,pa,null,0),et(Fu,gt.depthAttachment),et(Of,gt.stencilAttachment),et($o,gt.depthStencilAttachment);var Wt=C.checkFramebufferStatus(La);!C.isContextLost()&&Wt!==Ba&&V.raise("framebuffer configuration not supported, status = "+Ji[Wt]),C.bindFramebuffer(La,De.next?De.next.framebuffer:null),De.cur=De.next,C.getError()}function ht(gt,He){var qe=new Tt;Re.framebufferCount++;function Wt(Mt,Zt){var Yt;V(De.next!==qe,"can not update framebuffer which is currently in use");var er=0,cr=0,Br=!0,In=!0,or=null,bn=!0,Fr="rgba",on="uint8",sn=1,xn=null,Yr=null,Sr=null,fn=!1;if(typeof Mt=="number")er=Mt|0,cr=Zt|0||er;else if(!Mt)er=cr=1;else{V.type(Mt,"object","invalid arguments for framebuffer");var Jt=Mt;if("shape"in Jt){var Mr=Jt.shape;V(Array.isArray(Mr)&&Mr.length>=2,"invalid shape for framebuffer"),er=Mr[0],cr=Mr[1]}else"radius"in Jt&&(er=cr=Jt.radius),"width"in Jt&&(er=Jt.width),"height"in Jt&&(cr=Jt.height);("color"in Jt||"colors"in Jt)&&(or=Jt.color||Jt.colors,Array.isArray(or)&&V(or.length===1||W.webgl_draw_buffers,"multiple render targets not supported")),or||("colorCount"in Jt&&(sn=Jt.colorCount|0,V(sn>0,"invalid color buffer count")),"colorTexture"in Jt&&(bn=!!Jt.colorTexture,Fr="rgba4"),"colorType"in Jt&&(on=Jt.colorType,bn?(V(W.oes_texture_float||!(on==="float"||on==="float32"),"you must enable OES_texture_float in order to use floating point framebuffer objects"),V(W.oes_texture_half_float||!(on==="half float"||on==="float16"),"you must enable OES_texture_half_float in order to use 16-bit floating point framebuffer objects")):on==="half float"||on==="float16"?(V(W.ext_color_buffer_half_float,"you must enable EXT_color_buffer_half_float to use 16-bit render buffers"),Fr="rgba16f"):(on==="float"||on==="float32")&&(V(W.webgl_color_buffer_float,"you must enable WEBGL_color_buffer_float in order to use 32-bit floating point renderbuffers"),Fr="rgba32f"),V.oneOf(on,mt,"invalid color type")),"colorFormat"in Jt&&(Fr=Jt.colorFormat,at.indexOf(Fr)>=0?bn=!0:ut.indexOf(Fr)>=0?bn=!1:bn?V.oneOf(Jt.colorFormat,at,"invalid color format for texture"):V.oneOf(Jt.colorFormat,ut,"invalid color format for renderbuffer"))),("depthTexture"in Jt||"depthStencilTexture"in Jt)&&(fn=!!(Jt.depthTexture||Jt.depthStencilTexture),V(!fn||W.webgl_depth_texture,"webgl_depth_texture extension not supported")),"depth"in Jt&&(typeof Jt.depth=="boolean"?Br=Jt.depth:(xn=Jt.depth,In=!1)),"stencil"in Jt&&(typeof Jt.stencil=="boolean"?In=Jt.stencil:(Yr=Jt.stencil,Br=!1)),"depthStencil"in Jt&&(typeof Jt.depthStencil=="boolean"?Br=In=Jt.depthStencil:(Sr=Jt.depthStencil,Br=!1,In=!1))}var Ar=null,Ut=null,sr=null,kt=null;if(Array.isArray(or))Ar=or.map(dt);else if(or)Ar=[dt(or)];else for(Ar=new Array(sn),Yt=0;Yt<sn;++Yt)Ar[Yt]=me(er,cr,bn,Fr,on);V(W.webgl_draw_buffers||Ar.length<=1,"you must enable the WEBGL_draw_buffers extension in order to use multiple color buffers."),V(Ar.length<=ne.maxColorAttachments,"too many color attachments, not supported"),er=er||Ar[0].width,cr=cr||Ar[0].height,xn?Ut=dt(xn):Br&&!In&&(Ut=me(er,cr,fn,"depth","uint32")),Yr?sr=dt(Yr):In&&!Br&&(sr=me(er,cr,!1,"stencil","uint8")),Sr?kt=dt(Sr):!xn&&!Yr&&In&&Br&&(kt=me(er,cr,fn,"depth stencil","depth stencil")),V(!!xn+!!Yr+!!Sr<=1,"invalid framebuffer configuration, can specify exactly one depth/stencil attachment");var br=null;for(Yt=0;Yt<Ar.length;++Yt)if(vt(Ar[Yt],er,cr),V(!Ar[Yt]||Ar[Yt].texture&&yy.indexOf(Ar[Yt].texture._texture.format)>=0||Ar[Yt].renderbuffer&&Om.indexOf(Ar[Yt].renderbuffer._renderbuffer.format)>=0,"framebuffer color attachment "+Yt+" is invalid"),Ar[Yt]&&Ar[Yt].texture){var Xn=Uh[Ar[Yt].texture._texture.format]*wf[Ar[Yt].texture._texture.type];br===null?br=Xn:V(br===Xn,"all color attachments much have the same number of bits per pixel.")}return vt(Ut,er,cr),V(!Ut||Ut.texture&&Ut.texture._texture.format===Rm||Ut.renderbuffer&&Ut.renderbuffer._renderbuffer.format===rc,"invalid depth attachment for framebuffer object"),vt(sr,er,cr),V(!sr||sr.renderbuffer&&sr.renderbuffer._renderbuffer.format===zh,"invalid stencil attachment for framebuffer object"),vt(kt,er,cr),V(!kt||kt.texture&&kt.texture._texture.format===ks||kt.renderbuffer&&kt.renderbuffer._renderbuffer.format===ks,"invalid depth-stencil attachment for framebuffer object"),st(qe),qe.width=er,qe.height=cr,qe.colorAttachments=Ar,qe.depthAttachment=Ut,qe.stencilAttachment=sr,qe.depthStencilAttachment=kt,Wt.color=Ar.map(we),Wt.depth=we(Ut),Wt.stencil=we(sr),Wt.depthStencil=we(kt),Wt.width=qe.width,Wt.height=qe.height,Ke(qe),Wt}function lr(Mt,Zt){V(De.next!==qe,"can not resize a framebuffer which is currently in use");var Yt=Math.max(Mt|0,1),er=Math.max(Zt|0||Yt,1);if(Yt===qe.width&&er===qe.height)return Wt;for(var cr=qe.colorAttachments,Br=0;Br<cr.length;++Br)ot(cr[Br],Yt,er);return ot(qe.depthAttachment,Yt,er),ot(qe.stencilAttachment,Yt,er),ot(qe.depthStencilAttachment,Yt,er),qe.width=Wt.width=Yt,qe.height=Wt.height=er,Ke(qe),Wt}return Wt(gt,He),n(Wt,{resize:lr,_reglType:"framebuffer",_framebuffer:qe,destroy:function(){St(qe),st(qe)},use:function(Mt){De.setFBO({framebuffer:Wt},Mt)}})}function Lt(gt){var He=Array(6);function qe(lr){var Mt;V(He.indexOf(De.next)<0,"can not update framebuffer which is currently in use");var Zt={color:null},Yt=0,er=null,cr="rgba",Br="uint8",In=1;if(typeof lr=="number")Yt=lr|0;else if(!lr)Yt=1;else{V.type(lr,"object","invalid arguments for framebuffer");var or=lr;if("shape"in or){var bn=or.shape;V(Array.isArray(bn)&&bn.length>=2,"invalid shape for framebuffer"),V(bn[0]===bn[1],"cube framebuffer must be square"),Yt=bn[0]}else"radius"in or&&(Yt=or.radius|0),"width"in or?(Yt=or.width|0,"height"in or&&V(or.height===Yt,"must be square")):"height"in or&&(Yt=or.height|0);("color"in or||"colors"in or)&&(er=or.color||or.colors,Array.isArray(er)&&V(er.length===1||W.webgl_draw_buffers,"multiple render targets not supported")),er||("colorCount"in or&&(In=or.colorCount|0,V(In>0,"invalid color buffer count")),"colorType"in or&&(V.oneOf(or.colorType,mt,"invalid color type"),Br=or.colorType),"colorFormat"in or&&(cr=or.colorFormat,V.oneOf(or.colorFormat,at,"invalid color format for texture"))),"depth"in or&&(Zt.depth=or.depth),"stencil"in or&&(Zt.stencil=or.stencil),"depthStencil"in or&&(Zt.depthStencil=or.depthStencil)}var Fr;if(er)if(Array.isArray(er))for(Fr=[],Mt=0;Mt<er.length;++Mt)Fr[Mt]=er[Mt];else Fr=[er];else{Fr=Array(In);var on={radius:Yt,format:cr,type:Br};for(Mt=0;Mt<In;++Mt)Fr[Mt]=be.createCube(on)}for(Zt.color=Array(Fr.length),Mt=0;Mt<Fr.length;++Mt){var sn=Fr[Mt];V(typeof sn=="function"&&sn._reglType==="textureCube","invalid cube map"),Yt=Yt||sn.width,V(sn.width===Yt&&sn.height===Yt,"invalid cube map shape"),Zt.color[Mt]={target:Yo,data:Fr[Mt]}}for(Mt=0;Mt<6;++Mt){for(var xn=0;xn<Fr.length;++xn)Zt.color[xn].target=Yo+Mt;Mt>0&&(Zt.depth=He[0].depth,Zt.stencil=He[0].stencil,Zt.depthStencil=He[0].depthStencil),He[Mt]?He[Mt](Zt):He[Mt]=ht(Zt)}return n(qe,{width:Yt,height:Yt,color:Fr})}function Wt(lr){var Mt,Zt=lr|0;if(V(Zt>0&&Zt<=ne.maxCubeMapSize,"invalid radius for cube fbo"),Zt===qe.width)return qe;var Yt=qe.color;for(Mt=0;Mt<Yt.length;++Mt)Yt[Mt].resize(Zt);for(Mt=0;Mt<6;++Mt)He[Mt].resize(Zt);return qe.width=qe.height=Zt,qe}return qe(gt),n(qe,{faces:He,resize:Wt,_reglType:"framebufferCube",destroy:function(){He.forEach(function(lr){lr.destroy()})}})}function Gt(){De.cur=null,De.next=null,De.dirty=!0,Z($e).forEach(function(gt){gt.framebuffer=C.createFramebuffer(),Ke(gt)})}return n(De,{getFramebuffer:function(gt){if(typeof gt=="function"&&gt._reglType==="framebuffer"){var He=gt._framebuffer;if(He instanceof Tt)return He}return null},create:ht,createCube:Lt,clear:function(){Z($e).forEach(St)},restore:Gt})}var Nf=5126,Hh=34962;function zs(){this.state=0,this.x=0,this.y=0,this.z=0,this.w=0,this.buffer=null,this.size=0,this.normalized=!1,this.type=Nf,this.offset=0,this.stride=0,this.divisor=0}function Mm(C,W,ne,be,je){for(var Re=ne.maxAttributes,De=new Array(Re),at=0;at<Re;++at)De[at]=new zs;var ut=0,mt={},lt={Record:zs,scope:{},state:De,currentVAO:null,targetVAO:null,restore:vt()?$e:function(){},createVAO:Tt,getVAO:dt,destroyBuffer:ft,setVAO:vt()?me:we,clear:vt()?ot:function(){}};function ft(st){for(var St=0;St<De.length;++St){var Ke=De[St];Ke.buffer===st&&(C.disableVertexAttribArray(St),Ke.buffer=null)}}function vt(){return W.oes_vertex_array_object}function et(){return W.angle_instanced_arrays}function dt(st){return typeof st=="function"&&st._vao?st._vao:null}function me(st){if(st!==lt.currentVAO){var St=vt();st?St.bindVertexArrayOES(st.vao):St.bindVertexArrayOES(null),lt.currentVAO=st}}function we(st){if(st!==lt.currentVAO){if(st)st.bindAttrs();else for(var St=et(),Ke=0;Ke<De.length;++Ke){var ht=De[Ke];ht.buffer?(C.enableVertexAttribArray(Ke),C.vertexAttribPointer(Ke,ht.size,ht.type,ht.normalized,ht.stride,ht.offfset),St&&St.vertexAttribDivisorANGLE(Ke,ht.divisor)):(C.disableVertexAttribArray(Ke),C.vertexAttrib4f(Ke,ht.x,ht.y,ht.z,ht.w))}lt.currentVAO=st}}function ot(){Z(mt).forEach(function(st){st.destroy()})}function Et(){this.id=++ut,this.attributes=[];var st=vt();st?this.vao=st.createVertexArrayOES():this.vao=null,mt[this.id]=this,this.buffers=[]}Et.prototype.bindAttrs=function(){for(var st=et(),St=this.attributes,Ke=0;Ke<St.length;++Ke){var ht=St[Ke];ht.buffer?(C.enableVertexAttribArray(Ke),C.bindBuffer(Hh,ht.buffer.buffer),C.vertexAttribPointer(Ke,ht.size,ht.type,ht.normalized,ht.stride,ht.offset),st&&st.vertexAttribDivisorANGLE(Ke,ht.divisor)):(C.disableVertexAttribArray(Ke),C.vertexAttrib4f(Ke,ht.x,ht.y,ht.z,ht.w))}for(var Lt=St.length;Lt<Re;++Lt)C.disableVertexAttribArray(Lt)},Et.prototype.refresh=function(){var st=vt();st&&(st.bindVertexArrayOES(this.vao),this.bindAttrs(),lt.currentVAO=this)},Et.prototype.destroy=function(){if(this.vao){var st=vt();this===lt.currentVAO&&(lt.currentVAO=null,st.bindVertexArrayOES(null)),st.deleteVertexArrayOES(this.vao),this.vao=null}mt[this.id]&&(delete mt[this.id],be.vaoCount-=1)};function $e(){var st=vt();st&&Z(mt).forEach(function(St){St.refresh()})}function Tt(st){var St=new Et;be.vaoCount+=1;function Ke(ht){V(Array.isArray(ht),"arguments to vertex array constructor must be an array"),V(ht.length<Re,"too many attributes"),V(ht.length>0,"must specify at least one attribute");for(var Lt=0;Lt<St.buffers.length;++Lt)St.buffers[Lt].destroy();St.buffers.length=0;var Gt=St.attributes;Gt.length=ht.length;for(var gt=0;gt<ht.length;++gt){var He=ht[gt],qe=Gt[gt]=new zs;if(Array.isArray(He)||r(He)||j(He)){var Wt=je.create(He,Hh,!1,!0);qe.buffer=je.getBuffer(Wt),qe.size=qe.buffer.dimension|0,qe.normalized=!1,qe.type=qe.buffer.dtype,qe.offset=0,qe.stride=0,qe.divisor=0,qe.state=1,St.buffers.push(Wt)}else je.getBuffer(He)?(qe.buffer=je.getBuffer(He),qe.size=qe.buffer.dimension|0,qe.normalized=!1,qe.type=qe.buffer.dtype,qe.offset=0,qe.stride=0,qe.divisor=0,qe.state=1):je.getBuffer(He.buffer)?(qe.buffer=je.getBuffer(He.buffer),qe.size=(+He.size||qe.buffer.dimension)|0,qe.normalized=!!He.normalized||!1,"type"in He?(V.parameter(He.type,uo,"invalid buffer type"),qe.type=uo[He.type]):qe.type=qe.buffer.dtype,qe.offset=(He.offset||0)|0,qe.stride=(He.stride||0)|0,qe.divisor=(He.divisor||0)|0,qe.state=1,V(qe.size>=1&&qe.size<=4,"size must be between 1 and 4"),V(qe.offset>=0,"invalid offset"),V(qe.stride>=0&&qe.stride<=255,"stride must be between 0 and 255"),V(qe.divisor>=0,"divisor must be positive"),V(!qe.divisor||!!W.angle_instanced_arrays,"ANGLE_instanced_arrays must be enabled to use divisor")):"x"in He?(V(gt>0,"first attribute must not be a constant"),qe.x=+He.x||0,qe.y=+He.y||0,qe.z=+He.z||0,qe.w=+He.w||0,qe.state=2):V(!1,"invalid attribute spec for location "+gt)}return St.refresh(),Ke}return Ke.destroy=function(){St.destroy()},Ke._vao=St,Ke._reglType="vao",Ke(st)}return lt}var nc=35632,Vh=35633,wm=35718,If=35721;function Nm(C,W,ne,be){var je={},Re={};function De(me,we,ot,Et){this.name=me,this.id=we,this.location=ot,this.info=Et}function at(me,we){for(var ot=0;ot<me.length;++ot)if(me[ot].id===we.id){me[ot].location=we.location;return}me.push(we)}function ut(me,we,ot){var Et=me===nc?je:Re,$e=Et[we];if(!$e){var Tt=W.str(we);$e=C.createShader(me),C.shaderSource($e,Tt),C.compileShader($e),V.shaderError(C,$e,Tt,me,ot),Et[we]=$e}return $e}var mt={},lt=[],ft=0;function vt(me,we){this.id=ft++,this.fragId=me,this.vertId=we,this.program=null,this.uniforms=[],this.attributes=[],be.profile&&(this.stats={uniformsCount:0,attributesCount:0})}function et(me,we,ot){var Et,$e,Tt=ut(nc,me.fragId),st=ut(Vh,me.vertId),St=me.program=C.createProgram();if(C.attachShader(St,Tt),C.attachShader(St,st),ot)for(Et=0;Et<ot.length;++Et){var Ke=ot[Et];C.bindAttribLocation(St,Ke[0],Ke[1])}C.linkProgram(St),V.linkError(C,St,W.str(me.fragId),W.str(me.vertId),we);var ht=C.getProgramParameter(St,wm);be.profile&&(me.stats.uniformsCount=ht);var Lt=me.uniforms;for(Et=0;Et<ht;++Et)if($e=C.getActiveUniform(St,Et),$e)if($e.size>1)for(var Gt=0;Gt<$e.size;++Gt){var gt=$e.name.replace("[0]","["+Gt+"]");at(Lt,new De(gt,W.id(gt),C.getUniformLocation(St,gt),$e))}else at(Lt,new De($e.name,W.id($e.name),C.getUniformLocation(St,$e.name),$e));var He=C.getProgramParameter(St,If);be.profile&&(me.stats.attributesCount=He);var qe=me.attributes;for(Et=0;Et<He;++Et)$e=C.getActiveAttrib(St,Et),$e&&at(qe,new De($e.name,W.id($e.name),C.getAttribLocation(St,$e.name),$e))}be.profile&&(ne.getMaxUniformsCount=function(){var me=0;return lt.forEach(function(we){we.stats.uniformsCount>me&&(me=we.stats.uniformsCount)}),me},ne.getMaxAttributesCount=function(){var me=0;return lt.forEach(function(we){we.stats.attributesCount>me&&(me=we.stats.attributesCount)}),me});function dt(){je={},Re={};for(var me=0;me<lt.length;++me)et(lt[me],null,lt[me].attributes.map(function(we){return[we.location,we.name]}))}return{clear:function(){var me=C.deleteShader.bind(C);Z(je).forEach(me),je={},Z(Re).forEach(me),Re={},lt.forEach(function(we){C.deleteProgram(we.program)}),lt.length=0,mt={},ne.shaderCount=0},program:function(me,we,ot,Et){V.command(me>=0,"missing vertex shader",ot),V.command(we>=0,"missing fragment shader",ot);var $e=mt[we];$e||($e=mt[we]={});var Tt=$e[me];if(Tt&&!Et)return Tt;var st=new vt(we,me);return ne.shaderCount++,et(st,ot,Et),Tt||($e[me]=st),lt.push(st),st},restore:dt,shader:ut,frag:-1,vert:-1}}var ic=6408,ku=5121,Im=3333,va=5126;function Xh(C,W,ne,be,je,Re,De){function at(lt){var ft;W.next===null?(V(je.preserveDrawingBuffer,'you must create a webgl context with "preserveDrawingBuffer":true in order to read pixels from the drawing buffer'),ft=ku):(V(W.next.colorAttachments[0].texture!==null,"You cannot read from a renderbuffer"),ft=W.next.colorAttachments[0].texture._texture.type,Re.oes_texture_float?(V(ft===ku||ft===va,"Reading from a framebuffer is only allowed for the types 'uint8' and 'float'"),ft===va&&V(De.readFloat,"Reading 'float' values is not permitted in your browser. For a fallback, please see: https://www.npmjs.com/package/glsl-read-float")):V(ft===ku,"Reading from a framebuffer is only allowed for the type 'uint8'"));var vt=0,et=0,dt=be.framebufferWidth,me=be.framebufferHeight,we=null;r(lt)?we=lt:lt&&(V.type(lt,"object","invalid arguments to regl.read()"),vt=lt.x|0,et=lt.y|0,V(vt>=0&&vt<be.framebufferWidth,"invalid x offset for regl.read"),V(et>=0&&et<be.framebufferHeight,"invalid y offset for regl.read"),dt=(lt.width||be.framebufferWidth-vt)|0,me=(lt.height||be.framebufferHeight-et)|0,we=lt.data||null),we&&(ft===ku?V(we instanceof Uint8Array,"buffer must be 'Uint8Array' when reading from a framebuffer of type 'uint8'"):ft===va&&V(we instanceof Float32Array,"buffer must be 'Float32Array' when reading from a framebuffer of type 'float'")),V(dt>0&&dt+vt<=be.framebufferWidth,"invalid width for read pixels"),V(me>0&&me+et<=be.framebufferHeight,"invalid height for read pixels"),ne();var ot=dt*me*4;return we||(ft===ku?we=new Uint8Array(ot):ft===va&&(we=we||new Float32Array(ot))),V.isTypedArray(we,"data buffer for regl.read() must be a typedarray"),V(we.byteLength>=ot,"data buffer for regl.read() too small"),C.pixelStorei(Im,4),C.readPixels(vt,et,dt,me,ic,ft,we),we}function ut(lt){var ft;return W.setFBO({framebuffer:lt.framebuffer},function(){ft=at(lt)}),ft}function mt(lt){return!lt||!("framebuffer"in lt)?at(lt):ut(lt)}return mt}function Ko(C){return Array.prototype.slice.call(C)}function ki(C){return Ko(C).join("")}function Qo(){var C=0,W=[],ne=[];function be(ft){for(var vt=0;vt<ne.length;++vt)if(ne[vt]===ft)return W[vt];var et="g"+C++;return W.push(et),ne.push(ft),et}function je(){var ft=[];function vt(){ft.push.apply(ft,Ko(arguments))}var et=[];function dt(){var me="v"+C++;return et.push(me),arguments.length>0&&(ft.push(me,"="),ft.push.apply(ft,Ko(arguments)),ft.push(";")),me}return n(vt,{def:dt,toString:function(){return ki([et.length>0?"var "+et.join(",")+";":"",ki(ft)])}})}function Re(){var ft=je(),vt=je(),et=ft.toString,dt=vt.toString;function me(we,ot){vt(we,ot,"=",ft.def(we,ot),";")}return n(function(){ft.apply(ft,Ko(arguments))},{def:ft.def,entry:ft,exit:vt,save:me,set:function(we,ot,Et){me(we,ot),ft(we,ot,"=",Et,";")},toString:function(){return et()+dt()}})}function De(){var ft=ki(arguments),vt=Re(),et=Re(),dt=vt.toString,me=et.toString;return n(vt,{then:function(){return vt.apply(vt,Ko(arguments)),this},else:function(){return et.apply(et,Ko(arguments)),this},toString:function(){var we=me();return we&&(we="else{"+we+"}"),ki(["if(",ft,"){",dt(),"}",we])}})}var at=je(),ut={};function mt(ft,vt){var et=[];function dt(){var $e="a"+et.length;return et.push($e),$e}vt=vt||0;for(var me=0;me<vt;++me)dt();var we=Re(),ot=we.toString,Et=ut[ft]=n(we,{arg:dt,toString:function(){return ki(["function(",et.join(),"){",ot(),"}"])}});return Et}function lt(){var ft=['"use strict";',at,"return {"];Object.keys(ut).forEach(function(dt){ft.push('"',dt,'":',ut[dt].toString(),",")}),ft.push("}");var vt=ki(ft).replace(/;/g,`;
`).replace(/}/g,`}
`).replace(/{/g,`{
`),et=Function.apply(null,W.concat(vt));return et.apply(null,ne)}return{global:at,link:be,block:je,proc:mt,scope:Re,cond:De,compile:lt}}var Fa="xyzw".split(""),Pf=5121,Jo=1,js=2,zu=0,Gh=1,qh=2,Hs=3,ju=4,Wh="dither",Df="blend.enable",Lf="blend.color",Ua="blend.equation",hr="blend.func",Hr="depth.enable",wn="depth.func",ac="depth.range",Vs="depth.mask",vo="colorMask",oc="cull.enable",Hu="cull.face",es="frontFace",Yh="lineWidth",An="polygonOffset.enable",sc="polygonOffset.offset",Bf="sample.alpha",$h="sample.enable",Ff="sample.coverage",Pm="stencil.enable",Uf="stencil.mask",uc="stencil.func",lc="stencil.opFront",Vn="stencil.opBack",Nn="scissor.enable",Vu="scissor.box",zi="viewport",ts="profile",mo="framebuffer",ji="vert",rs="frag",_o="elements",go="primitive",ns="count",cc="offset",fc="instances",Xu="vao",kf="Width",zf="Height",is=mo+kf,Xs=mo+zf,Sy=zi+kf,Dm=zi+zf,Zh="drawingBuffer",Kh=Zh+kf,jf=Zh+zf,Lm=[hr,Ua,uc,lc,Vn,Ff,zi,Vu,sc],Gs=34962,Bm=34963,Fm=35632,Um=35633,km=3553,zm=34067,Gu=2884,Hf=3042,jm=3024,Vf=2960,dc=2929,Hm=3089,Vm=32823,Xm=32926,Gm=32928,Xf=5126,hc=35664,qu=35665,pc=35666,Gf=5124,Wu=35667,vc=35668,mc=35669,Qh=35670,Yu=35671,_c=35672,gc=35673,qs=35674,$u=35675,Zu=35676,yc=35678,Ec=35680,Jh=4,yo=1028,Eo=1029,Tc=2304,qf=2305,qm=32775,Wf=32776,Wm=519,To=7680,Ym=0,Ws=1,Ku=32774,Yf=513,Qu=36160,$f=36064,ma={0:0,1:1,zero:0,one:1,"src color":768,"one minus src color":769,"src alpha":770,"one minus src alpha":771,"dst color":774,"one minus dst color":775,"dst alpha":772,"one minus dst alpha":773,"constant color":32769,"one minus constant color":32770,"constant alpha":32771,"one minus constant alpha":32772,"src alpha saturate":776},ep=["constant color, constant alpha","one minus constant color, constant alpha","constant color, one minus constant alpha","one minus constant color, one minus constant alpha","constant alpha, constant color","constant alpha, one minus constant color","one minus constant alpha, constant color","one minus constant alpha, one minus constant color"],_a={never:512,less:513,"<":513,equal:514,"=":514,"==":514,"===":514,lequal:515,"<=":515,greater:516,">":516,notequal:517,"!=":517,"!==":517,gequal:518,">=":518,always:519},So={0:0,zero:0,keep:7680,replace:7681,increment:7682,decrement:7683,"increment wrap":34055,"decrement wrap":34056,invert:5386},Hi={frag:Fm,vert:Um},ea={cw:Tc,ccw:qf};function ga(C){return Array.isArray(C)||r(C)||j(C)}function tp(C){return C.sort(function(W,ne){return W===zi?-1:ne===zi?1:W<ne?-1:1})}function Ln(C,W,ne,be){this.thisDep=C,this.contextDep=W,this.propDep=ne,this.append=be}function ci(C){return C&&!(C.thisDep||C.contextDep||C.propDep)}function vr(C){return new Ln(!1,!1,!1,C)}function Qn(C,W){var ne=C.type;if(ne===zu){var be=C.data.length;return new Ln(!0,be>=1,be>=2,W)}else if(ne===ju){var je=C.data;return new Ln(je.thisDep,je.contextDep,je.propDep,W)}else return new Ln(ne===Hs,ne===qh,ne===Gh,W)}var Zf=new Ln(!1,!1,!1,function(){});function rp(C,W,ne,be,je,Re,De,at,ut,mt,lt,ft,vt,et,dt){var me=mt.Record,we={add:32774,subtract:32778,"reverse subtract":32779};ne.ext_blend_minmax&&(we.min=qm,we.max=Wf);var ot=ne.angle_instanced_arrays,Et=ne.webgl_draw_buffers,$e={dirty:!0,profile:dt.profile},Tt={},st=[],St={},Ke={};function ht(k){return k.replace(".","_")}function Lt(k,Y,te){var Ee=ht(k);st.push(k),Tt[Ee]=$e[Ee]=!!te,St[Ee]=Y}function Gt(k,Y,te){var Ee=ht(k);st.push(k),Array.isArray(te)?($e[Ee]=te.slice(),Tt[Ee]=te.slice()):$e[Ee]=Tt[Ee]=te,Ke[Ee]=Y}Lt(Wh,jm),Lt(Df,Hf),Gt(Lf,"blendColor",[0,0,0,0]),Gt(Ua,"blendEquationSeparate",[Ku,Ku]),Gt(hr,"blendFuncSeparate",[Ws,Ym,Ws,Ym]),Lt(Hr,dc,!0),Gt(wn,"depthFunc",Yf),Gt(ac,"depthRange",[0,1]),Gt(Vs,"depthMask",!0),Gt(vo,vo,[!0,!0,!0,!0]),Lt(oc,Gu),Gt(Hu,"cullFace",Eo),Gt(es,es,qf),Gt(Yh,Yh,1),Lt(An,Vm),Gt(sc,"polygonOffset",[0,0]),Lt(Bf,Xm),Lt($h,Gm),Gt(Ff,"sampleCoverage",[1,!1]),Lt(Pm,Vf),Gt(Uf,"stencilMask",-1),Gt(uc,"stencilFunc",[Wm,0,-1]),Gt(lc,"stencilOpSeparate",[yo,To,To,To]),Gt(Vn,"stencilOpSeparate",[Eo,To,To,To]),Lt(Nn,Hm),Gt(Vu,"scissor",[0,0,C.drawingBufferWidth,C.drawingBufferHeight]),Gt(zi,zi,[0,0,C.drawingBufferWidth,C.drawingBufferHeight]);var gt={gl:C,context:vt,strings:W,next:Tt,current:$e,draw:ft,elements:Re,buffer:je,shader:lt,attributes:mt.state,vao:mt,uniforms:ut,framebuffer:at,extensions:ne,timer:et,isBufferArgs:ga},He={primTypes:Cu,compareFuncs:_a,blendFuncs:ma,blendEquations:we,stencilOps:So,glTypes:uo,orientationType:ea};V.optional(function(){gt.isArrayLike=ln}),Et&&(He.backBuffer=[Eo],He.drawBuffer=ai(be.maxDrawbuffers,function(k){return k===0?[0]:ai(k,function(Y){return $f+Y})}));var qe=0;function Wt(){var k=Qo(),Y=k.link,te=k.global;k.id=qe++,k.batchId="0";var Ee=Y(gt),Te=k.shared={props:"a0"};Object.keys(gt).forEach(function(se){Te[se]=te.def(Ee,".",se)}),V.optional(function(){k.CHECK=Y(V),k.commandStr=V.guessCommand(),k.command=Y(k.commandStr),k.assert=function(se,$,ue){se("if(!(",$,"))",this.CHECK,".commandRaise(",Y(ue),",",this.command,");")},He.invalidBlendCombinations=ep});var ie=k.next={},ce=k.current={};Object.keys(Ke).forEach(function(se){Array.isArray($e[se])&&(ie[se]=te.def(Te.next,".",se),ce[se]=te.def(Te.current,".",se))});var de=k.constants={};Object.keys(He).forEach(function(se){de[se]=te.def(JSON.stringify(He[se]))}),k.invoke=function(se,$){switch($.type){case zu:var ue=["this",Te.context,Te.props,k.batchId];return se.def(Y($.data),".call(",ue.slice(0,Math.max($.data.length+1,4)),")");case Gh:return se.def(Te.props,$.data);case qh:return se.def(Te.context,$.data);case Hs:return se.def("this",$.data);case ju:return $.data.append(k,se),$.data.ref}},k.attribCache={};var K={};return k.scopeAttrib=function(se){var $=W.id(se);if($ in K)return K[$];var ue=mt.scope[$];ue||(ue=mt.scope[$]=new me);var xe=K[$]=Y(ue);return xe},k}function lr(k){var Y=k.static,te=k.dynamic,Ee;if(ts in Y){var Te=!!Y[ts];Ee=vr(function(ce,de){return Te}),Ee.enable=Te}else if(ts in te){var ie=te[ts];Ee=Qn(ie,function(ce,de){return ce.invoke(de,ie)})}return Ee}function Mt(k,Y){var te=k.static,Ee=k.dynamic;if(mo in te){var Te=te[mo];return Te?(Te=at.getFramebuffer(Te),V.command(Te,"invalid framebuffer object"),vr(function(ce,de){var K=ce.link(Te),se=ce.shared;de.set(se.framebuffer,".next",K);var $=se.context;return de.set($,"."+is,K+".width"),de.set($,"."+Xs,K+".height"),K})):vr(function(ce,de){var K=ce.shared;de.set(K.framebuffer,".next","null");var se=K.context;return de.set(se,"."+is,se+"."+Kh),de.set(se,"."+Xs,se+"."+jf),"null"})}else if(mo in Ee){var ie=Ee[mo];return Qn(ie,function(ce,de){var K=ce.invoke(de,ie),se=ce.shared,$=se.framebuffer,ue=de.def($,".getFramebuffer(",K,")");V.optional(function(){ce.assert(de,"!"+K+"||"+ue,"invalid framebuffer object")}),de.set($,".next",ue);var xe=se.context;return de.set(xe,"."+is,ue+"?"+ue+".width:"+xe+"."+Kh),de.set(xe,"."+Xs,ue+"?"+ue+".height:"+xe+"."+jf),ue})}else return null}function Zt(k,Y,te){var Ee=k.static,Te=k.dynamic;function ie(K){if(K in Ee){var se=Ee[K];V.commandType(se,"object","invalid "+K,te.commandStr);var $=!0,ue=se.x|0,xe=se.y|0,Pe,Qe;return"width"in se?(Pe=se.width|0,V.command(Pe>=0,"invalid "+K,te.commandStr)):$=!1,"height"in se?(Qe=se.height|0,V.command(Qe>=0,"invalid "+K,te.commandStr)):$=!1,new Ln(!$&&Y&&Y.thisDep,!$&&Y&&Y.contextDep,!$&&Y&&Y.propDep,function(It,Kt){var Rt=It.shared.context,Ht=Pe;"width"in se||(Ht=Kt.def(Rt,".",is,"-",ue));var Qt=Qe;return"height"in se||(Qt=Kt.def(Rt,".",Xs,"-",xe)),[ue,xe,Ht,Qt]})}else if(K in Te){var Xe=Te[K],rt=Qn(Xe,function(It,Kt){var Rt=It.invoke(Kt,Xe);V.optional(function(){It.assert(Kt,Rt+"&&typeof "+Rt+'==="object"',"invalid "+K)});var Ht=It.shared.context,Qt=Kt.def(Rt,".x|0"),Bt=Kt.def(Rt,".y|0"),ir=Kt.def('"width" in ',Rt,"?",Rt,".width|0:","(",Ht,".",is,"-",Qt,")"),ar=Kt.def('"height" in ',Rt,"?",Rt,".height|0:","(",Ht,".",Xs,"-",Bt,")");return V.optional(function(){It.assert(Kt,ir+">=0&&"+ar+">=0","invalid "+K)}),[Qt,Bt,ir,ar]});return Y&&(rt.thisDep=rt.thisDep||Y.thisDep,rt.contextDep=rt.contextDep||Y.contextDep,rt.propDep=rt.propDep||Y.propDep),rt}else return Y?new Ln(Y.thisDep,Y.contextDep,Y.propDep,function(It,Kt){var Rt=It.shared.context;return[0,0,Kt.def(Rt,".",is),Kt.def(Rt,".",Xs)]}):null}var ce=ie(zi);if(ce){var de=ce;ce=new Ln(ce.thisDep,ce.contextDep,ce.propDep,function(K,se){var $=de.append(K,se),ue=K.shared.context;return se.set(ue,"."+Sy,$[2]),se.set(ue,"."+Dm,$[3]),$})}return{viewport:ce,scissor_box:ie(Vu)}}function Yt(k,Y){var te=k.static,Ee=typeof te[rs]=="string"&&typeof te[ji]=="string";if(Ee){if(Object.keys(Y.dynamic).length>0)return null;var Te=Y.static,ie=Object.keys(Te);if(ie.length>0&&typeof Te[ie[0]]=="number"){for(var ce=[],de=0;de<ie.length;++de)V(typeof Te[ie[de]]=="number","must specify all vertex attribute locations when using vaos"),ce.push([Te[ie[de]]|0,ie[de]]);return ce}}return null}function er(k,Y,te){var Ee=k.static,Te=k.dynamic;function ie($){if($ in Ee){var ue=W.id(Ee[$]);V.optional(function(){lt.shader(Hi[$],ue,V.guessCommand())});var xe=vr(function(){return ue});return xe.id=ue,xe}else if($ in Te){var Pe=Te[$];return Qn(Pe,function(Qe,Xe){var rt=Qe.invoke(Xe,Pe),It=Xe.def(Qe.shared.strings,".id(",rt,")");return V.optional(function(){Xe(Qe.shared.shader,".shader(",Hi[$],",",It,",",Qe.command,");")}),It})}return null}var ce=ie(rs),de=ie(ji),K=null,se;return ci(ce)&&ci(de)?(K=lt.program(de.id,ce.id,null,te),se=vr(function($,ue){return $.link(K)})):se=new Ln(ce&&ce.thisDep||de&&de.thisDep,ce&&ce.contextDep||de&&de.contextDep,ce&&ce.propDep||de&&de.propDep,function($,ue){var xe=$.shared.shader,Pe;ce?Pe=ce.append($,ue):Pe=ue.def(xe,".",rs);var Qe;de?Qe=de.append($,ue):Qe=ue.def(xe,".",ji);var Xe=xe+".program("+Qe+","+Pe;return V.optional(function(){Xe+=","+$.command}),ue.def(Xe+")")}),{frag:ce,vert:de,progVar:se,program:K}}function cr(k,Y){var te=k.static,Ee=k.dynamic;function Te(){if(_o in te){var $=te[_o];ga($)?$=Re.getElements(Re.create($,!0)):$&&($=Re.getElements($),V.command($,"invalid elements",Y.commandStr));var ue=vr(function(Pe,Qe){if($){var Xe=Pe.link($);return Pe.ELEMENTS=Xe,Xe}return Pe.ELEMENTS=null,null});return ue.value=$,ue}else if(_o in Ee){var xe=Ee[_o];return Qn(xe,function(Pe,Qe){var Xe=Pe.shared,rt=Xe.isBufferArgs,It=Xe.elements,Kt=Pe.invoke(Qe,xe),Rt=Qe.def("null"),Ht=Qe.def(rt,"(",Kt,")"),Qt=Pe.cond(Ht).then(Rt,"=",It,".createStream(",Kt,");").else(Rt,"=",It,".getElements(",Kt,");");return V.optional(function(){Pe.assert(Qt.else,"!"+Kt+"||"+Rt,"invalid elements")}),Qe.entry(Qt),Qe.exit(Pe.cond(Ht).then(It,".destroyStream(",Rt,");")),Pe.ELEMENTS=Rt,Rt})}return null}var ie=Te();function ce(){if(go in te){var $=te[go];return V.commandParameter($,Cu,"invalid primitve",Y.commandStr),vr(function(xe,Pe){return Cu[$]})}else if(go in Ee){var ue=Ee[go];return Qn(ue,function(xe,Pe){var Qe=xe.constants.primTypes,Xe=xe.invoke(Pe,ue);return V.optional(function(){xe.assert(Pe,Xe+" in "+Qe,"invalid primitive, must be one of "+Object.keys(Cu))}),Pe.def(Qe,"[",Xe,"]")})}else if(ie)return ci(ie)?ie.value?vr(function(xe,Pe){return Pe.def(xe.ELEMENTS,".primType")}):vr(function(){return Jh}):new Ln(ie.thisDep,ie.contextDep,ie.propDep,function(xe,Pe){var Qe=xe.ELEMENTS;return Pe.def(Qe,"?",Qe,".primType:",Jh)});return null}function de($,ue){if($ in te){var xe=te[$]|0;return V.command(!ue||xe>=0,"invalid "+$,Y.commandStr),vr(function(Qe,Xe){return ue&&(Qe.OFFSET=xe),xe})}else if($ in Ee){var Pe=Ee[$];return Qn(Pe,function(Qe,Xe){var rt=Qe.invoke(Xe,Pe);return ue&&(Qe.OFFSET=rt,V.optional(function(){Qe.assert(Xe,rt+">=0","invalid "+$)})),rt})}else if(ue&&ie)return vr(function(Qe,Xe){return Qe.OFFSET="0",0});return null}var K=de(cc,!0);function se(){if(ns in te){var $=te[ns]|0;return V.command(typeof $=="number"&&$>=0,"invalid vertex count",Y.commandStr),vr(function(){return $})}else if(ns in Ee){var ue=Ee[ns];return Qn(ue,function(Qe,Xe){var rt=Qe.invoke(Xe,ue);return V.optional(function(){Qe.assert(Xe,"typeof "+rt+'==="number"&&'+rt+">=0&&"+rt+"===("+rt+"|0)","invalid vertex count")}),rt})}else if(ie)if(ci(ie)){if(ie)return K?new Ln(K.thisDep,K.contextDep,K.propDep,function(Qe,Xe){var rt=Xe.def(Qe.ELEMENTS,".vertCount-",Qe.OFFSET);return V.optional(function(){Qe.assert(Xe,rt+">=0","invalid vertex offset/element buffer too small")}),rt}):vr(function(Qe,Xe){return Xe.def(Qe.ELEMENTS,".vertCount")});var xe=vr(function(){return-1});return V.optional(function(){xe.MISSING=!0}),xe}else{var Pe=new Ln(ie.thisDep||K.thisDep,ie.contextDep||K.contextDep,ie.propDep||K.propDep,function(Qe,Xe){var rt=Qe.ELEMENTS;return Qe.OFFSET?Xe.def(rt,"?",rt,".vertCount-",Qe.OFFSET,":-1"):Xe.def(rt,"?",rt,".vertCount:-1")});return V.optional(function(){Pe.DYNAMIC=!0}),Pe}return null}return{elements:ie,primitive:ce(),count:se(),instances:de(fc,!1),offset:K}}function Br(k,Y){var te=k.static,Ee=k.dynamic,Te={};return st.forEach(function(ie){var ce=ht(ie);function de(K,se){if(ie in te){var $=K(te[ie]);Te[ce]=vr(function(){return $})}else if(ie in Ee){var ue=Ee[ie];Te[ce]=Qn(ue,function(xe,Pe){return se(xe,Pe,xe.invoke(Pe,ue))})}}switch(ie){case oc:case Df:case Wh:case Pm:case Hr:case Nn:case An:case Bf:case $h:case Vs:return de(function(K){return V.commandType(K,"boolean",ie,Y.commandStr),K},function(K,se,$){return V.optional(function(){K.assert(se,"typeof "+$+'==="boolean"',"invalid flag "+ie,K.commandStr)}),$});case wn:return de(function(K){return V.commandParameter(K,_a,"invalid "+ie,Y.commandStr),_a[K]},function(K,se,$){var ue=K.constants.compareFuncs;return V.optional(function(){K.assert(se,$+" in "+ue,"invalid "+ie+", must be one of "+Object.keys(_a))}),se.def(ue,"[",$,"]")});case ac:return de(function(K){return V.command(ln(K)&&K.length===2&&typeof K[0]=="number"&&typeof K[1]=="number"&&K[0]<=K[1],"depth range is 2d array",Y.commandStr),K},function(K,se,$){V.optional(function(){K.assert(se,K.shared.isArrayLike+"("+$+")&&"+$+".length===2&&typeof "+$+'[0]==="number"&&typeof '+$+'[1]==="number"&&'+$+"[0]<="+$+"[1]","depth range must be a 2d array")});var ue=se.def("+",$,"[0]"),xe=se.def("+",$,"[1]");return[ue,xe]});case hr:return de(function(K){V.commandType(K,"object","blend.func",Y.commandStr);var se="srcRGB"in K?K.srcRGB:K.src,$="srcAlpha"in K?K.srcAlpha:K.src,ue="dstRGB"in K?K.dstRGB:K.dst,xe="dstAlpha"in K?K.dstAlpha:K.dst;return V.commandParameter(se,ma,ce+".srcRGB",Y.commandStr),V.commandParameter($,ma,ce+".srcAlpha",Y.commandStr),V.commandParameter(ue,ma,ce+".dstRGB",Y.commandStr),V.commandParameter(xe,ma,ce+".dstAlpha",Y.commandStr),V.command(ep.indexOf(se+", "+ue)===-1,"unallowed blending combination (srcRGB, dstRGB) = ("+se+", "+ue+")",Y.commandStr),[ma[se],ma[ue],ma[$],ma[xe]]},function(K,se,$){var ue=K.constants.blendFuncs;V.optional(function(){K.assert(se,$+"&&typeof "+$+'==="object"',"invalid blend func, must be an object")});function xe(Rt,Ht){var Qt=se.def('"',Rt,Ht,'" in ',$,"?",$,".",Rt,Ht,":",$,".",Rt);return V.optional(function(){K.assert(se,Qt+" in "+ue,"invalid "+ie+"."+Rt+Ht+", must be one of "+Object.keys(ma))}),Qt}var Pe=xe("src","RGB"),Qe=xe("dst","RGB");V.optional(function(){var Rt=K.constants.invalidBlendCombinations;K.assert(se,Rt+".indexOf("+Pe+'+", "+'+Qe+") === -1 ","unallowed blending combination for (srcRGB, dstRGB)")});var Xe=se.def(ue,"[",Pe,"]"),rt=se.def(ue,"[",xe("src","Alpha"),"]"),It=se.def(ue,"[",Qe,"]"),Kt=se.def(ue,"[",xe("dst","Alpha"),"]");return[Xe,It,rt,Kt]});case Ua:return de(function(K){if(typeof K=="string")return V.commandParameter(K,we,"invalid "+ie,Y.commandStr),[we[K],we[K]];if(typeof K=="object")return V.commandParameter(K.rgb,we,ie+".rgb",Y.commandStr),V.commandParameter(K.alpha,we,ie+".alpha",Y.commandStr),[we[K.rgb],we[K.alpha]];V.commandRaise("invalid blend.equation",Y.commandStr)},function(K,se,$){var ue=K.constants.blendEquations,xe=se.def(),Pe=se.def(),Qe=K.cond("typeof ",$,'==="string"');return V.optional(function(){function Xe(rt,It,Kt){K.assert(rt,Kt+" in "+ue,"invalid "+It+", must be one of "+Object.keys(we))}Xe(Qe.then,ie,$),K.assert(Qe.else,$+"&&typeof "+$+'==="object"',"invalid "+ie),Xe(Qe.else,ie+".rgb",$+".rgb"),Xe(Qe.else,ie+".alpha",$+".alpha")}),Qe.then(xe,"=",Pe,"=",ue,"[",$,"];"),Qe.else(xe,"=",ue,"[",$,".rgb];",Pe,"=",ue,"[",$,".alpha];"),se(Qe),[xe,Pe]});case Lf:return de(function(K){return V.command(ln(K)&&K.length===4,"blend.color must be a 4d array",Y.commandStr),ai(4,function(se){return+K[se]})},function(K,se,$){return V.optional(function(){K.assert(se,K.shared.isArrayLike+"("+$+")&&"+$+".length===4","blend.color must be a 4d array")}),ai(4,function(ue){return se.def("+",$,"[",ue,"]")})});case Uf:return de(function(K){return V.commandType(K,"number",ce,Y.commandStr),K|0},function(K,se,$){return V.optional(function(){K.assert(se,"typeof "+$+'==="number"',"invalid stencil.mask")}),se.def($,"|0")});case uc:return de(function(K){V.commandType(K,"object",ce,Y.commandStr);var se=K.cmp||"keep",$=K.ref||0,ue="mask"in K?K.mask:-1;return V.commandParameter(se,_a,ie+".cmp",Y.commandStr),V.commandType($,"number",ie+".ref",Y.commandStr),V.commandType(ue,"number",ie+".mask",Y.commandStr),[_a[se],$,ue]},function(K,se,$){var ue=K.constants.compareFuncs;V.optional(function(){function Xe(){K.assert(se,Array.prototype.join.call(arguments,""),"invalid stencil.func")}Xe($+"&&typeof ",$,'==="object"'),Xe('!("cmp" in ',$,")||(",$,".cmp in ",ue,")")});var xe=se.def('"cmp" in ',$,"?",ue,"[",$,".cmp]",":",To),Pe=se.def($,".ref|0"),Qe=se.def('"mask" in ',$,"?",$,".mask|0:-1");return[xe,Pe,Qe]});case lc:case Vn:return de(function(K){V.commandType(K,"object",ce,Y.commandStr);var se=K.fail||"keep",$=K.zfail||"keep",ue=K.zpass||"keep";return V.commandParameter(se,So,ie+".fail",Y.commandStr),V.commandParameter($,So,ie+".zfail",Y.commandStr),V.commandParameter(ue,So,ie+".zpass",Y.commandStr),[ie===Vn?Eo:yo,So[se],So[$],So[ue]]},function(K,se,$){var ue=K.constants.stencilOps;V.optional(function(){K.assert(se,$+"&&typeof "+$+'==="object"',"invalid "+ie)});function xe(Pe){return V.optional(function(){K.assert(se,'!("'+Pe+'" in '+$+")||("+$+"."+Pe+" in "+ue+")","invalid "+ie+"."+Pe+", must be one of "+Object.keys(So))}),se.def('"',Pe,'" in ',$,"?",ue,"[",$,".",Pe,"]:",To)}return[ie===Vn?Eo:yo,xe("fail"),xe("zfail"),xe("zpass")]});case sc:return de(function(K){V.commandType(K,"object",ce,Y.commandStr);var se=K.factor|0,$=K.units|0;return V.commandType(se,"number",ce+".factor",Y.commandStr),V.commandType($,"number",ce+".units",Y.commandStr),[se,$]},function(K,se,$){V.optional(function(){K.assert(se,$+"&&typeof "+$+'==="object"',"invalid "+ie)});var ue=se.def($,".factor|0"),xe=se.def($,".units|0");return[ue,xe]});case Hu:return de(function(K){var se=0;return K==="front"?se=yo:K==="back"&&(se=Eo),V.command(!!se,ce,Y.commandStr),se},function(K,se,$){return V.optional(function(){K.assert(se,$+'==="front"||'+$+'==="back"',"invalid cull.face")}),se.def($,'==="front"?',yo,":",Eo)});case Yh:return de(function(K){return V.command(typeof K=="number"&&K>=be.lineWidthDims[0]&&K<=be.lineWidthDims[1],"invalid line width, must be a positive number between "+be.lineWidthDims[0]+" and "+be.lineWidthDims[1],Y.commandStr),K},function(K,se,$){return V.optional(function(){K.assert(se,"typeof "+$+'==="number"&&'+$+">="+be.lineWidthDims[0]+"&&"+$+"<="+be.lineWidthDims[1],"invalid line width")}),$});case es:return de(function(K){return V.commandParameter(K,ea,ce,Y.commandStr),ea[K]},function(K,se,$){return V.optional(function(){K.assert(se,$+'==="cw"||'+$+'==="ccw"',"invalid frontFace, must be one of cw,ccw")}),se.def($+'==="cw"?'+Tc+":"+qf)});case vo:return de(function(K){return V.command(ln(K)&&K.length===4,"color.mask must be length 4 array",Y.commandStr),K.map(function(se){return!!se})},function(K,se,$){return V.optional(function(){K.assert(se,K.shared.isArrayLike+"("+$+")&&"+$+".length===4","invalid color.mask")}),ai(4,function(ue){return"!!"+$+"["+ue+"]"})});case Ff:return de(function(K){V.command(typeof K=="object"&&K,ce,Y.commandStr);var se="value"in K?K.value:1,$=!!K.invert;return V.command(typeof se=="number"&&se>=0&&se<=1,"sample.coverage.value must be a number between 0 and 1",Y.commandStr),[se,$]},function(K,se,$){V.optional(function(){K.assert(se,$+"&&typeof "+$+'==="object"',"invalid sample.coverage")});var ue=se.def('"value" in ',$,"?+",$,".value:1"),xe=se.def("!!",$,".invert");return[ue,xe]})}}),Te}function In(k,Y){var te=k.static,Ee=k.dynamic,Te={};return Object.keys(te).forEach(function(ie){var ce=te[ie],de;if(typeof ce=="number"||typeof ce=="boolean")de=vr(function(){return ce});else if(typeof ce=="function"){var K=ce._reglType;K==="texture2d"||K==="textureCube"?de=vr(function(se){return se.link(ce)}):K==="framebuffer"||K==="framebufferCube"?(V.command(ce.color.length>0,'missing color attachment for framebuffer sent to uniform "'+ie+'"',Y.commandStr),de=vr(function(se){return se.link(ce.color[0])})):V.commandRaise('invalid data for uniform "'+ie+'"',Y.commandStr)}else ln(ce)?de=vr(function(se){var $=se.global.def("[",ai(ce.length,function(ue){return V.command(typeof ce[ue]=="number"||typeof ce[ue]=="boolean","invalid uniform "+ie,se.commandStr),ce[ue]}),"]");return $}):V.commandRaise('invalid or missing data for uniform "'+ie+'"',Y.commandStr);de.value=ce,Te[ie]=de}),Object.keys(Ee).forEach(function(ie){var ce=Ee[ie];Te[ie]=Qn(ce,function(de,K){return de.invoke(K,ce)})}),Te}function or(k,Y){var te=k.static,Ee=k.dynamic,Te={};return Object.keys(te).forEach(function(ie){var ce=te[ie],de=W.id(ie),K=new me;if(ga(ce))K.state=Jo,K.buffer=je.getBuffer(je.create(ce,Gs,!1,!0)),K.type=0;else{var se=je.getBuffer(ce);if(se)K.state=Jo,K.buffer=se,K.type=0;else if(V.command(typeof ce=="object"&&ce,"invalid data for attribute "+ie,Y.commandStr),"constant"in ce){var $=ce.constant;K.buffer="null",K.state=js,typeof $=="number"?K.x=$:(V.command(ln($)&&$.length>0&&$.length<=4,"invalid constant for attribute "+ie,Y.commandStr),Fa.forEach(function(It,Kt){Kt<$.length&&(K[It]=$[Kt])}))}else{ga(ce.buffer)?se=je.getBuffer(je.create(ce.buffer,Gs,!1,!0)):se=je.getBuffer(ce.buffer),V.command(!!se,'missing buffer for attribute "'+ie+'"',Y.commandStr);var ue=ce.offset|0;V.command(ue>=0,'invalid offset for attribute "'+ie+'"',Y.commandStr);var xe=ce.stride|0;V.command(xe>=0&&xe<256,'invalid stride for attribute "'+ie+'", must be integer betweeen [0, 255]',Y.commandStr);var Pe=ce.size|0;V.command(!("size"in ce)||Pe>0&&Pe<=4,'invalid size for attribute "'+ie+'", must be 1,2,3,4',Y.commandStr);var Qe=!!ce.normalized,Xe=0;"type"in ce&&(V.commandParameter(ce.type,uo,"invalid type for attribute "+ie,Y.commandStr),Xe=uo[ce.type]);var rt=ce.divisor|0;"divisor"in ce&&(V.command(rt===0||ot,'cannot specify divisor for attribute "'+ie+'", instancing not supported',Y.commandStr),V.command(rt>=0,'invalid divisor for attribute "'+ie+'"',Y.commandStr)),V.optional(function(){var It=Y.commandStr,Kt=["buffer","offset","divisor","normalized","type","size","stride"];Object.keys(ce).forEach(function(Rt){V.command(Kt.indexOf(Rt)>=0,'unknown parameter "'+Rt+'" for attribute pointer "'+ie+'" (valid parameters are '+Kt+")",It)})}),K.buffer=se,K.state=Jo,K.size=Pe,K.normalized=Qe,K.type=Xe||se.dtype,K.offset=ue,K.stride=xe,K.divisor=rt}}Te[ie]=vr(function(It,Kt){var Rt=It.attribCache;if(de in Rt)return Rt[de];var Ht={isStream:!1};return Object.keys(K).forEach(function(Qt){Ht[Qt]=K[Qt]}),K.buffer&&(Ht.buffer=It.link(K.buffer),Ht.type=Ht.type||Ht.buffer+".dtype"),Rt[de]=Ht,Ht})}),Object.keys(Ee).forEach(function(ie){var ce=Ee[ie];function de(K,se){var $=K.invoke(se,ce),ue=K.shared,xe=K.constants,Pe=ue.isBufferArgs,Qe=ue.buffer;V.optional(function(){K.assert(se,$+"&&(typeof "+$+'==="object"||typeof '+$+'==="function")&&('+Pe+"("+$+")||"+Qe+".getBuffer("+$+")||"+Qe+".getBuffer("+$+".buffer)||"+Pe+"("+$+'.buffer)||("constant" in '+$+"&&(typeof "+$+'.constant==="number"||'+ue.isArrayLike+"("+$+".constant))))",'invalid dynamic attribute "'+ie+'"')});var Xe={isStream:se.def(!1)},rt=new me;rt.state=Jo,Object.keys(rt).forEach(function(Ht){Xe[Ht]=se.def(""+rt[Ht])});var It=Xe.buffer,Kt=Xe.type;se("if(",Pe,"(",$,")){",Xe.isStream,"=true;",It,"=",Qe,".createStream(",Gs,",",$,");",Kt,"=",It,".dtype;","}else{",It,"=",Qe,".getBuffer(",$,");","if(",It,"){",Kt,"=",It,".dtype;",'}else if("constant" in ',$,"){",Xe.state,"=",js,";","if(typeof "+$+'.constant === "number"){',Xe[Fa[0]],"=",$,".constant;",Fa.slice(1).map(function(Ht){return Xe[Ht]}).join("="),"=0;","}else{",Fa.map(function(Ht,Qt){return Xe[Ht]+"="+$+".constant.length>"+Qt+"?"+$+".constant["+Qt+"]:0;"}).join(""),"}}else{","if(",Pe,"(",$,".buffer)){",It,"=",Qe,".createStream(",Gs,",",$,".buffer);","}else{",It,"=",Qe,".getBuffer(",$,".buffer);","}",Kt,'="type" in ',$,"?",xe.glTypes,"[",$,".type]:",It,".dtype;",Xe.normalized,"=!!",$,".normalized;");function Rt(Ht){se(Xe[Ht],"=",$,".",Ht,"|0;")}return Rt("size"),Rt("offset"),Rt("stride"),Rt("divisor"),se("}}"),se.exit("if(",Xe.isStream,"){",Qe,".destroyStream(",It,");","}"),Xe}Te[ie]=Qn(ce,de)}),Te}function bn(k,Y){var te=k.static,Ee=k.dynamic;if(Xu in te){var Te=te[Xu];return Te!==null&&mt.getVAO(Te)===null&&(Te=mt.createVAO(Te)),vr(function(ce){return ce.link(mt.getVAO(Te))})}else if(Xu in Ee){var ie=Ee[Xu];return Qn(ie,function(ce,de){var K=ce.invoke(de,ie);return de.def(ce.shared.vao+".getVAO("+K+")")})}return null}function Fr(k){var Y=k.static,te=k.dynamic,Ee={};return Object.keys(Y).forEach(function(Te){var ie=Y[Te];Ee[Te]=vr(function(ce,de){return typeof ie=="number"||typeof ie=="boolean"?""+ie:ce.link(ie)})}),Object.keys(te).forEach(function(Te){var ie=te[Te];Ee[Te]=Qn(ie,function(ce,de){return ce.invoke(de,ie)})}),Ee}function on(k,Y,te,Ee,Te){var ie=k.static,ce=k.dynamic;V.optional(function(){var Rt=[mo,ji,rs,_o,go,cc,ns,fc,ts,Xu].concat(st);function Ht(Qt){Object.keys(Qt).forEach(function(Bt){V.command(Rt.indexOf(Bt)>=0,'unknown parameter "'+Bt+'"',Te.commandStr)})}Ht(ie),Ht(ce)});var de=Yt(k,Y),K=Mt(k),se=Zt(k,K,Te),$=cr(k,Te),ue=Br(k,Te),xe=er(k,Te,de);function Pe(Rt){var Ht=se[Rt];Ht&&(ue[Rt]=Ht)}Pe(zi),Pe(ht(Vu));var Qe=Object.keys(ue).length>0,Xe={framebuffer:K,draw:$,shader:xe,state:ue,dirty:Qe,scopeVAO:null,drawVAO:null,useVAO:!1,attributes:{}};if(Xe.profile=lr(k),Xe.uniforms=In(te,Te),Xe.drawVAO=Xe.scopeVAO=bn(k),!Xe.drawVAO&&xe.program&&!de&&ne.angle_instanced_arrays){var rt=!0,It=xe.program.attributes.map(function(Rt){var Ht=Y.static[Rt];return rt=rt&&!!Ht,Ht});if(rt&&It.length>0){var Kt=mt.getVAO(mt.createVAO(It));Xe.drawVAO=new Ln(null,null,null,function(Rt,Ht){return Rt.link(Kt)}),Xe.useVAO=!0}}return de?Xe.useVAO=!0:Xe.attributes=or(Y,Te),Xe.context=Fr(Ee),Xe}function sn(k,Y,te){var Ee=k.shared,Te=Ee.context,ie=k.scope();Object.keys(te).forEach(function(ce){Y.save(Te,"."+ce);var de=te[ce];ie(Te,".",ce,"=",de.append(k,Y),";")}),Y(ie)}function xn(k,Y,te,Ee){var Te=k.shared,ie=Te.gl,ce=Te.framebuffer,de;Et&&(de=Y.def(Te.extensions,".webgl_draw_buffers"));var K=k.constants,se=K.drawBuffer,$=K.backBuffer,ue;te?ue=te.append(k,Y):ue=Y.def(ce,".next"),Ee||Y("if(",ue,"!==",ce,".cur){"),Y("if(",ue,"){",ie,".bindFramebuffer(",Qu,",",ue,".framebuffer);"),Et&&Y(de,".drawBuffersWEBGL(",se,"[",ue,".colorAttachments.length]);"),Y("}else{",ie,".bindFramebuffer(",Qu,",null);"),Et&&Y(de,".drawBuffersWEBGL(",$,");"),Y("}",ce,".cur=",ue,";"),Ee||Y("}")}function Yr(k,Y,te){var Ee=k.shared,Te=Ee.gl,ie=k.current,ce=k.next,de=Ee.current,K=Ee.next,se=k.cond(de,".dirty");st.forEach(function($){var ue=ht($);if(!(ue in te.state)){var xe,Pe;if(ue in ce){xe=ce[ue],Pe=ie[ue];var Qe=ai($e[ue].length,function(rt){return se.def(xe,"[",rt,"]")});se(k.cond(Qe.map(function(rt,It){return rt+"!=="+Pe+"["+It+"]"}).join("||")).then(Te,".",Ke[ue],"(",Qe,");",Qe.map(function(rt,It){return Pe+"["+It+"]="+rt}).join(";"),";"))}else{xe=se.def(K,".",ue);var Xe=k.cond(xe,"!==",de,".",ue);se(Xe),ue in St?Xe(k.cond(xe).then(Te,".enable(",St[ue],");").else(Te,".disable(",St[ue],");"),de,".",ue,"=",xe,";"):Xe(Te,".",Ke[ue],"(",xe,");",de,".",ue,"=",xe,";")}}}),Object.keys(te.state).length===0&&se(de,".dirty=false;"),Y(se)}function Sr(k,Y,te,Ee){var Te=k.shared,ie=k.current,ce=Te.current,de=Te.gl;tp(Object.keys(te)).forEach(function(K){var se=te[K];if(!(Ee&&!Ee(se))){var $=se.append(k,Y);if(St[K]){var ue=St[K];ci(se)?$?Y(de,".enable(",ue,");"):Y(de,".disable(",ue,");"):Y(k.cond($).then(de,".enable(",ue,");").else(de,".disable(",ue,");")),Y(ce,".",K,"=",$,";")}else if(ln($)){var xe=ie[K];Y(de,".",Ke[K],"(",$,");",$.map(function(Pe,Qe){return xe+"["+Qe+"]="+Pe}).join(";"),";")}else Y(de,".",Ke[K],"(",$,");",ce,".",K,"=",$,";")}})}function fn(k,Y){ot&&(k.instancing=Y.def(k.shared.extensions,".angle_instanced_arrays"))}function Jt(k,Y,te,Ee,Te){var ie=k.shared,ce=k.stats,de=ie.current,K=ie.timer,se=te.profile;function $(){return typeof performance>"u"?"Date.now()":"performance.now()"}var ue,xe;function Pe(Rt){ue=Y.def(),Rt(ue,"=",$(),";"),typeof Te=="string"?Rt(ce,".count+=",Te,";"):Rt(ce,".count++;"),et&&(Ee?(xe=Y.def(),Rt(xe,"=",K,".getNumPendingQueries();")):Rt(K,".beginQuery(",ce,");"))}function Qe(Rt){Rt(ce,".cpuTime+=",$(),"-",ue,";"),et&&(Ee?Rt(K,".pushScopeStats(",xe,",",K,".getNumPendingQueries(),",ce,");"):Rt(K,".endQuery();"))}function Xe(Rt){var Ht=Y.def(de,".profile");Y(de,".profile=",Rt,";"),Y.exit(de,".profile=",Ht,";")}var rt;if(se){if(ci(se)){se.enable?(Pe(Y),Qe(Y.exit),Xe("true")):Xe("false");return}rt=se.append(k,Y),Xe(rt)}else rt=Y.def(de,".profile");var It=k.block();Pe(It),Y("if(",rt,"){",It,"}");var Kt=k.block();Qe(Kt),Y.exit("if(",rt,"){",Kt,"}")}function Mr(k,Y,te,Ee,Te){var ie=k.shared;function ce(K){switch(K){case hc:case Wu:case Yu:return 2;case qu:case vc:case _c:return 3;case pc:case mc:case gc:return 4;default:return 1}}function de(K,se,$){var ue=ie.gl,xe=Y.def(K,".location"),Pe=Y.def(ie.attributes,"[",xe,"]"),Qe=$.state,Xe=$.buffer,rt=[$.x,$.y,$.z,$.w],It=["buffer","normalized","offset","stride"];function Kt(){Y("if(!",Pe,".buffer){",ue,".enableVertexAttribArray(",xe,");}");var Ht=$.type,Qt;if($.size?Qt=Y.def($.size,"||",se):Qt=se,Y("if(",Pe,".type!==",Ht,"||",Pe,".size!==",Qt,"||",It.map(function(ir){return Pe+"."+ir+"!=="+$[ir]}).join("||"),"){",ue,".bindBuffer(",Gs,",",Xe,".buffer);",ue,".vertexAttribPointer(",[xe,Qt,Ht,$.normalized,$.stride,$.offset],");",Pe,".type=",Ht,";",Pe,".size=",Qt,";",It.map(function(ir){return Pe+"."+ir+"="+$[ir]+";"}).join(""),"}"),ot){var Bt=$.divisor;Y("if(",Pe,".divisor!==",Bt,"){",k.instancing,".vertexAttribDivisorANGLE(",[xe,Bt],");",Pe,".divisor=",Bt,";}")}}function Rt(){Y("if(",Pe,".buffer){",ue,".disableVertexAttribArray(",xe,");",Pe,".buffer=null;","}if(",Fa.map(function(Ht,Qt){return Pe+"."+Ht+"!=="+rt[Qt]}).join("||"),"){",ue,".vertexAttrib4f(",xe,",",rt,");",Fa.map(function(Ht,Qt){return Pe+"."+Ht+"="+rt[Qt]+";"}).join(""),"}")}Qe===Jo?Kt():Qe===js?Rt():(Y("if(",Qe,"===",Jo,"){"),Kt(),Y("}else{"),Rt(),Y("}"))}Ee.forEach(function(K){var se=K.name,$=te.attributes[se],ue;if($){if(!Te($))return;ue=$.append(k,Y)}else{if(!Te(Zf))return;var xe=k.scopeAttrib(se);V.optional(function(){k.assert(Y,xe+".state","missing attribute "+se)}),ue={},Object.keys(new me).forEach(function(Pe){ue[Pe]=Y.def(xe,".",Pe)})}de(k.link(K),ce(K.info.type),ue)})}function Ar(k,Y,te,Ee,Te){for(var ie=k.shared,ce=ie.gl,de,K=0;K<Ee.length;++K){var se=Ee[K],$=se.name,ue=se.info.type,xe=te.uniforms[$],Pe=k.link(se),Qe=Pe+".location",Xe;if(xe){if(!Te(xe))continue;if(ci(xe)){var rt=xe.value;if(V.command(rt!==null&&typeof rt<"u",'missing uniform "'+$+'"',k.commandStr),ue===yc||ue===Ec){V.command(typeof rt=="function"&&(ue===yc&&(rt._reglType==="texture2d"||rt._reglType==="framebuffer")||ue===Ec&&(rt._reglType==="textureCube"||rt._reglType==="framebufferCube")),"invalid texture for uniform "+$,k.commandStr);var It=k.link(rt._texture||rt.color[0]._texture);Y(ce,".uniform1i(",Qe,",",It+".bind());"),Y.exit(It,".unbind();")}else if(ue===qs||ue===$u||ue===Zu){V.optional(function(){V.command(ln(rt),"invalid matrix for uniform "+$,k.commandStr),V.command(ue===qs&&rt.length===4||ue===$u&&rt.length===9||ue===Zu&&rt.length===16,"invalid length for matrix uniform "+$,k.commandStr)});var Kt=k.global.def("new Float32Array(["+Array.prototype.slice.call(rt)+"])"),Rt=2;ue===$u?Rt=3:ue===Zu&&(Rt=4),Y(ce,".uniformMatrix",Rt,"fv(",Qe,",false,",Kt,");")}else{switch(ue){case Xf:V.commandType(rt,"number","uniform "+$,k.commandStr),de="1f";break;case hc:V.command(ln(rt)&&rt.length===2,"uniform "+$,k.commandStr),de="2f";break;case qu:V.command(ln(rt)&&rt.length===3,"uniform "+$,k.commandStr),de="3f";break;case pc:V.command(ln(rt)&&rt.length===4,"uniform "+$,k.commandStr),de="4f";break;case Qh:V.commandType(rt,"boolean","uniform "+$,k.commandStr),de="1i";break;case Gf:V.commandType(rt,"number","uniform "+$,k.commandStr),de="1i";break;case Yu:V.command(ln(rt)&&rt.length===2,"uniform "+$,k.commandStr),de="2i";break;case Wu:V.command(ln(rt)&&rt.length===2,"uniform "+$,k.commandStr),de="2i";break;case _c:V.command(ln(rt)&&rt.length===3,"uniform "+$,k.commandStr),de="3i";break;case vc:V.command(ln(rt)&&rt.length===3,"uniform "+$,k.commandStr),de="3i";break;case gc:V.command(ln(rt)&&rt.length===4,"uniform "+$,k.commandStr),de="4i";break;case mc:V.command(ln(rt)&&rt.length===4,"uniform "+$,k.commandStr),de="4i";break}Y(ce,".uniform",de,"(",Qe,",",ln(rt)?Array.prototype.slice.call(rt):rt,");")}continue}else Xe=xe.append(k,Y)}else{if(!Te(Zf))continue;Xe=Y.def(ie.uniforms,"[",W.id($),"]")}ue===yc?Y("if(",Xe,"&&",Xe,'._reglType==="framebuffer"){',Xe,"=",Xe,".color[0];","}"):ue===Ec&&Y("if(",Xe,"&&",Xe,'._reglType==="framebufferCube"){',Xe,"=",Xe,".color[0];","}"),V.optional(function(){function ar(fi,$s){k.assert(Y,fi,'bad data or missing for uniform "'+$+'".  '+$s)}function xr(fi){ar("typeof "+Xe+'==="'+fi+'"',"invalid type, expected "+fi)}function _r(fi,$s){ar(ie.isArrayLike+"("+Xe+")&&"+Xe+".length==="+fi,"invalid vector, should have length "+fi,k.commandStr)}function Oi(fi){ar("typeof "+Xe+'==="function"&&'+Xe+'._reglType==="texture'+(fi===km?"2d":"Cube")+'"',"invalid texture type",k.commandStr)}switch(ue){case Gf:xr("number");break;case Wu:_r(2);break;case vc:_r(3);break;case mc:_r(4);break;case Xf:xr("number");break;case hc:_r(2);break;case qu:_r(3);break;case pc:_r(4);break;case Qh:xr("boolean");break;case Yu:_r(2);break;case _c:_r(3);break;case gc:_r(4);break;case qs:_r(4);break;case $u:_r(9);break;case Zu:_r(16);break;case yc:Oi(km);break;case Ec:Oi(zm);break}});var Ht=1;switch(ue){case yc:case Ec:var Qt=Y.def(Xe,"._texture");Y(ce,".uniform1i(",Qe,",",Qt,".bind());"),Y.exit(Qt,".unbind();");continue;case Gf:case Qh:de="1i";break;case Wu:case Yu:de="2i",Ht=2;break;case vc:case _c:de="3i",Ht=3;break;case mc:case gc:de="4i",Ht=4;break;case Xf:de="1f";break;case hc:de="2f",Ht=2;break;case qu:de="3f",Ht=3;break;case pc:de="4f",Ht=4;break;case qs:de="Matrix2fv";break;case $u:de="Matrix3fv";break;case Zu:de="Matrix4fv";break}if(Y(ce,".uniform",de,"(",Qe,","),de.charAt(0)==="M"){var Bt=Math.pow(ue-qs+2,2),ir=k.global.def("new Float32Array(",Bt,")");Y("false,(Array.isArray(",Xe,")||",Xe," instanceof Float32Array)?",Xe,":(",ai(Bt,function(ar){return ir+"["+ar+"]="+Xe+"["+ar+"]"}),",",ir,")")}else Ht>1?Y(ai(Ht,function(ar){return Xe+"["+ar+"]"})):Y(Xe);Y(");")}}function Ut(k,Y,te,Ee){var Te=k.shared,ie=Te.gl,ce=Te.draw,de=Ee.draw;function K(){var Qt=de.elements,Bt,ir=Y;return Qt?((Qt.contextDep&&Ee.contextDynamic||Qt.propDep)&&(ir=te),Bt=Qt.append(k,ir)):Bt=ir.def(ce,".",_o),Bt&&ir("if("+Bt+")"+ie+".bindBuffer("+Bm+","+Bt+".buffer.buffer);"),Bt}function se(){var Qt=de.count,Bt,ir=Y;return Qt?((Qt.contextDep&&Ee.contextDynamic||Qt.propDep)&&(ir=te),Bt=Qt.append(k,ir),V.optional(function(){Qt.MISSING&&k.assert(Y,"false","missing vertex count"),Qt.DYNAMIC&&k.assert(ir,Bt+">=0","missing vertex count")})):(Bt=ir.def(ce,".",ns),V.optional(function(){k.assert(ir,Bt+">=0","missing vertex count")})),Bt}var $=K();function ue(Qt){var Bt=de[Qt];return Bt?Bt.contextDep&&Ee.contextDynamic||Bt.propDep?Bt.append(k,te):Bt.append(k,Y):Y.def(ce,".",Qt)}var xe=ue(go),Pe=ue(cc),Qe=se();if(typeof Qe=="number"){if(Qe===0)return}else te("if(",Qe,"){"),te.exit("}");var Xe,rt;ot&&(Xe=ue(fc),rt=k.instancing);var It=$+".type",Kt=de.elements&&ci(de.elements);function Rt(){function Qt(){te(rt,".drawElementsInstancedANGLE(",[xe,Qe,It,Pe+"<<(("+It+"-"+Pf+")>>1)",Xe],");")}function Bt(){te(rt,".drawArraysInstancedANGLE(",[xe,Pe,Qe,Xe],");")}$?Kt?Qt():(te("if(",$,"){"),Qt(),te("}else{"),Bt(),te("}")):Bt()}function Ht(){function Qt(){te(ie+".drawElements("+[xe,Qe,It,Pe+"<<(("+It+"-"+Pf+")>>1)"]+");")}function Bt(){te(ie+".drawArrays("+[xe,Pe,Qe]+");")}$?Kt?Qt():(te("if(",$,"){"),Qt(),te("}else{"),Bt(),te("}")):Bt()}ot&&(typeof Xe!="number"||Xe>=0)?typeof Xe=="string"?(te("if(",Xe,">0){"),Rt(),te("}else if(",Xe,"<0){"),Ht(),te("}")):Rt():Ht()}function sr(k,Y,te,Ee,Te){var ie=Wt(),ce=ie.proc("body",Te);return V.optional(function(){ie.commandStr=Y.commandStr,ie.command=ie.link(Y.commandStr)}),ot&&(ie.instancing=ce.def(ie.shared.extensions,".angle_instanced_arrays")),k(ie,ce,te,Ee),ie.compile().body}function kt(k,Y,te,Ee){fn(k,Y),te.useVAO?te.drawVAO?Y(k.shared.vao,".setVAO(",te.drawVAO.append(k,Y),");"):Y(k.shared.vao,".setVAO(",k.shared.vao,".targetVAO);"):(Y(k.shared.vao,".setVAO(null);"),Mr(k,Y,te,Ee.attributes,function(){return!0})),Ar(k,Y,te,Ee.uniforms,function(){return!0}),Ut(k,Y,Y,te)}function br(k,Y){var te=k.proc("draw",1);fn(k,te),sn(k,te,Y.context),xn(k,te,Y.framebuffer),Yr(k,te,Y),Sr(k,te,Y.state),Jt(k,te,Y,!1,!0);var Ee=Y.shader.progVar.append(k,te);if(te(k.shared.gl,".useProgram(",Ee,".program);"),Y.shader.program)kt(k,te,Y,Y.shader.program);else{te(k.shared.vao,".setVAO(null);");var Te=k.global.def("{}"),ie=te.def(Ee,".id"),ce=te.def(Te,"[",ie,"]");te(k.cond(ce).then(ce,".call(this,a0);").else(ce,"=",Te,"[",ie,"]=",k.link(function(de){return sr(kt,k,Y,de,1)}),"(",Ee,");",ce,".call(this,a0);"))}Object.keys(Y.state).length>0&&te(k.shared.current,".dirty=true;")}function Xn(k,Y,te,Ee){k.batchId="a1",fn(k,Y);function Te(){return!0}Mr(k,Y,te,Ee.attributes,Te),Ar(k,Y,te,Ee.uniforms,Te),Ut(k,Y,Y,te)}function J(k,Y,te,Ee){fn(k,Y);var Te=te.contextDep,ie=Y.def(),ce="a0",de="a1",K=Y.def();k.shared.props=K,k.batchId=ie;var se=k.scope(),$=k.scope();Y(se.entry,"for(",ie,"=0;",ie,"<",de,";++",ie,"){",K,"=",ce,"[",ie,"];",$,"}",se.exit);function ue(It){return It.contextDep&&Te||It.propDep}function xe(It){return!ue(It)}if(te.needsContext&&sn(k,$,te.context),te.needsFramebuffer&&xn(k,$,te.framebuffer),Sr(k,$,te.state,ue),te.profile&&ue(te.profile)&&Jt(k,$,te,!1,!0),Ee)te.useVAO?te.drawVAO?ue(te.drawVAO)?$(k.shared.vao,".setVAO(",te.drawVAO.append(k,$),");"):se(k.shared.vao,".setVAO(",te.drawVAO.append(k,se),");"):se(k.shared.vao,".setVAO(",k.shared.vao,".targetVAO);"):(se(k.shared.vao,".setVAO(null);"),Mr(k,se,te,Ee.attributes,xe),Mr(k,$,te,Ee.attributes,ue)),Ar(k,se,te,Ee.uniforms,xe),Ar(k,$,te,Ee.uniforms,ue),Ut(k,se,$,te);else{var Pe=k.global.def("{}"),Qe=te.shader.progVar.append(k,$),Xe=$.def(Qe,".id"),rt=$.def(Pe,"[",Xe,"]");$(k.shared.gl,".useProgram(",Qe,".program);","if(!",rt,"){",rt,"=",Pe,"[",Xe,"]=",k.link(function(It){return sr(Xn,k,te,It,2)}),"(",Qe,");}",rt,".call(this,a0[",ie,"],",ie,");")}}function Oe(k,Y){var te=k.proc("batch",2);k.batchId="0",fn(k,te);var Ee=!1,Te=!0;Object.keys(Y.context).forEach(function(Pe){Ee=Ee||Y.context[Pe].propDep}),Ee||(sn(k,te,Y.context),Te=!1);var ie=Y.framebuffer,ce=!1;ie?(ie.propDep?Ee=ce=!0:ie.contextDep&&Ee&&(ce=!0),ce||xn(k,te,ie)):xn(k,te,null),Y.state.viewport&&Y.state.viewport.propDep&&(Ee=!0);function de(Pe){return Pe.contextDep&&Ee||Pe.propDep}Yr(k,te,Y),Sr(k,te,Y.state,function(Pe){return!de(Pe)}),(!Y.profile||!de(Y.profile))&&Jt(k,te,Y,!1,"a1"),Y.contextDep=Ee,Y.needsContext=Te,Y.needsFramebuffer=ce;var K=Y.shader.progVar;if(K.contextDep&&Ee||K.propDep)J(k,te,Y,null);else{var se=K.append(k,te);if(te(k.shared.gl,".useProgram(",se,".program);"),Y.shader.program)J(k,te,Y,Y.shader.program);else{te(k.shared.vao,".setVAO(null);");var $=k.global.def("{}"),ue=te.def(se,".id"),xe=te.def($,"[",ue,"]");te(k.cond(xe).then(xe,".call(this,a0,a1);").else(xe,"=",$,"[",ue,"]=",k.link(function(Pe){return sr(J,k,Y,Pe,2)}),"(",se,");",xe,".call(this,a0,a1);"))}}Object.keys(Y.state).length>0&&te(k.shared.current,".dirty=true;")}function Ae(k,Y){var te=k.proc("scope",3);k.batchId="a2";var Ee=k.shared,Te=Ee.current;sn(k,te,Y.context),Y.framebuffer&&Y.framebuffer.append(k,te),tp(Object.keys(Y.state)).forEach(function(ce){var de=Y.state[ce],K=de.append(k,te);ln(K)?K.forEach(function(se,$){te.set(k.next[ce],"["+$+"]",se)}):te.set(Ee.next,"."+ce,K)}),Jt(k,te,Y,!0,!0),[_o,cc,ns,fc,go].forEach(function(ce){var de=Y.draw[ce];de&&te.set(Ee.draw,"."+ce,""+de.append(k,te))}),Object.keys(Y.uniforms).forEach(function(ce){te.set(Ee.uniforms,"["+W.id(ce)+"]",Y.uniforms[ce].append(k,te))}),Object.keys(Y.attributes).forEach(function(ce){var de=Y.attributes[ce].append(k,te),K=k.scopeAttrib(ce);Object.keys(new me).forEach(function(se){te.set(K,"."+se,de[se])})}),Y.scopeVAO&&te.set(Ee.vao,".targetVAO",Y.scopeVAO.append(k,te));function ie(ce){var de=Y.shader[ce];de&&te.set(Ee.shader,"."+ce,de.append(k,te))}ie(ji),ie(rs),Object.keys(Y.state).length>0&&(te(Te,".dirty=true;"),te.exit(Te,".dirty=true;")),te("a1(",k.shared.context,",a0,",k.batchId,");")}function bt(k){if(!(typeof k!="object"||ln(k))){for(var Y=Object.keys(k),te=0;te<Y.length;++te)if(Wr.isDynamic(k[Y[te]]))return!0;return!1}}function qt(k,Y,te){var Ee=Y.static[te];if(!Ee||!bt(Ee))return;var Te=k.global,ie=Object.keys(Ee),ce=!1,de=!1,K=!1,se=k.global.def("{}");ie.forEach(function(ue){var xe=Ee[ue];if(Wr.isDynamic(xe)){typeof xe=="function"&&(xe=Ee[ue]=Wr.unbox(xe));var Pe=Qn(xe,null);ce=ce||Pe.thisDep,K=K||Pe.propDep,de=de||Pe.contextDep}else{switch(Te(se,".",ue,"="),typeof xe){case"number":Te(xe);break;case"string":Te('"',xe,'"');break;case"object":Array.isArray(xe)&&Te("[",xe.join(),"]");break;default:Te(k.link(xe));break}Te(";")}});function $(ue,xe){ie.forEach(function(Pe){var Qe=Ee[Pe];if(Wr.isDynamic(Qe)){var Xe=ue.invoke(xe,Qe);xe(se,".",Pe,"=",Xe,";")}})}Y.dynamic[te]=new Wr.DynamicVariable(ju,{thisDep:ce,contextDep:de,propDep:K,ref:se,append:$}),delete Y.static[te]}function mr(k,Y,te,Ee,Te){var ie=Wt();ie.stats=ie.link(Te),Object.keys(Y.static).forEach(function(de){qt(ie,Y,de)}),Lm.forEach(function(de){qt(ie,k,de)});var ce=on(k,Y,te,Ee,ie);return br(ie,ce),Ae(ie,ce),Oe(ie,ce),ie.compile()}return{next:Tt,current:$e,procs:(function(){var k=Wt(),Y=k.proc("poll"),te=k.proc("refresh"),Ee=k.block();Y(Ee),te(Ee);var Te=k.shared,ie=Te.gl,ce=Te.next,de=Te.current;Ee(de,".dirty=false;"),xn(k,Y),xn(k,te,null,!0);var K;ot&&(K=k.link(ot)),ne.oes_vertex_array_object&&te(k.link(ne.oes_vertex_array_object),".bindVertexArrayOES(null);");for(var se=0;se<be.maxAttributes;++se){var $=te.def(Te.attributes,"[",se,"]"),ue=k.cond($,".buffer");ue.then(ie,".enableVertexAttribArray(",se,");",ie,".bindBuffer(",Gs,",",$,".buffer.buffer);",ie,".vertexAttribPointer(",se,",",$,".size,",$,".type,",$,".normalized,",$,".stride,",$,".offset);").else(ie,".disableVertexAttribArray(",se,");",ie,".vertexAttrib4f(",se,",",$,".x,",$,".y,",$,".z,",$,".w);",$,".buffer=null;"),te(ue),ot&&te(K,".vertexAttribDivisorANGLE(",se,",",$,".divisor);")}return te(k.shared.vao,".currentVAO=null;",k.shared.vao,".setVAO(",k.shared.vao,".targetVAO);"),Object.keys(St).forEach(function(xe){var Pe=St[xe],Qe=Ee.def(ce,".",xe),Xe=k.block();Xe("if(",Qe,"){",ie,".enable(",Pe,")}else{",ie,".disable(",Pe,")}",de,".",xe,"=",Qe,";"),te(Xe),Y("if(",Qe,"!==",de,".",xe,"){",Xe,"}")}),Object.keys(Ke).forEach(function(xe){var Pe=Ke[xe],Qe=$e[xe],Xe,rt,It=k.block();if(It(ie,".",Pe,"("),ln(Qe)){var Kt=Qe.length;Xe=k.global.def(ce,".",xe),rt=k.global.def(de,".",xe),It(ai(Kt,function(Rt){return Xe+"["+Rt+"]"}),");",ai(Kt,function(Rt){return rt+"["+Rt+"]="+Xe+"["+Rt+"];"}).join("")),Y("if(",ai(Kt,function(Rt){return Xe+"["+Rt+"]!=="+rt+"["+Rt+"]"}).join("||"),"){",It,"}")}else Xe=Ee.def(ce,".",xe),rt=Ee.def(de,".",xe),It(Xe,");",de,".",xe,"=",Xe,";"),Y("if(",Xe,"!==",rt,"){",It,"}");te(It)}),k.compile()})(),compile:mr}}function $m(){return{vaoCount:0,bufferCount:0,elementsCount:0,framebufferCount:0,shaderCount:0,textureCount:0,cubeCount:0,renderbufferCount:0,maxTextureUnits:0}}var Zm=34918,Ys=34919,Sc=35007,Km=function(C,W){if(!W.ext_disjoint_timer_query)return null;var ne=[];function be(){return ne.pop()||W.ext_disjoint_timer_query.createQueryEXT()}function je(ot){ne.push(ot)}var Re=[];function De(ot){var Et=be();W.ext_disjoint_timer_query.beginQueryEXT(Sc,Et),Re.push(Et),et(Re.length-1,Re.length,ot)}function at(){W.ext_disjoint_timer_query.endQueryEXT(Sc)}function ut(){this.startQueryIndex=-1,this.endQueryIndex=-1,this.sum=0,this.stats=null}var mt=[];function lt(){return mt.pop()||new ut}function ft(ot){mt.push(ot)}var vt=[];function et(ot,Et,$e){var Tt=lt();Tt.startQueryIndex=ot,Tt.endQueryIndex=Et,Tt.sum=0,Tt.stats=$e,vt.push(Tt)}var dt=[],me=[];function we(){var ot,Et,$e=Re.length;if($e!==0){me.length=Math.max(me.length,$e+1),dt.length=Math.max(dt.length,$e+1),dt[0]=0,me[0]=0;var Tt=0;for(ot=0,Et=0;Et<Re.length;++Et){var st=Re[Et];W.ext_disjoint_timer_query.getQueryObjectEXT(st,Ys)?(Tt+=W.ext_disjoint_timer_query.getQueryObjectEXT(st,Zm),je(st)):Re[ot++]=st,dt[Et+1]=Tt,me[Et+1]=ot}for(Re.length=ot,ot=0,Et=0;Et<vt.length;++Et){var St=vt[Et],Ke=St.startQueryIndex,ht=St.endQueryIndex;St.sum+=dt[ht]-dt[Ke];var Lt=me[Ke],Gt=me[ht];Gt===Lt?(St.stats.gpuTime+=St.sum/1e6,ft(St)):(St.startQueryIndex=Lt,St.endQueryIndex=Gt,vt[ot++]=St)}vt.length=ot}}return{beginQuery:De,endQuery:at,pushScopeStats:et,update:we,getNumPendingQueries:function(){return Re.length},clear:function(){ne.push.apply(ne,Re);for(var ot=0;ot<ne.length;ot++)W.ext_disjoint_timer_query.deleteQueryEXT(ne[ot]);Re.length=0,ne.length=0},restore:function(){Re.length=0,ne.length=0}}},Qm=16384,Jm=256,Kf=1024,e_=34962,Qf="webglcontextlost",np="webglcontextrestored",ip=1,Ay=2,t_=3;function jn(C,W){for(var ne=0;ne<C.length;++ne)if(C[ne]===W)return ne;return-1}function Jn(C){var W=Ul(C);if(!W)return null;var ne=W.gl,be=ne.getContextAttributes(),je=ne.isContextLost(),Re=ef(ne,W);if(!Re)return null;var De=Ma(),at=$m(),ut=Re.extensions,mt=Km(ne,ut),lt=Yi(),ft=ne.drawingBufferWidth,vt=ne.drawingBufferHeight,et={tick:0,time:0,viewportWidth:ft,viewportHeight:vt,framebufferWidth:ft,framebufferHeight:vt,drawingBufferWidth:ft,drawingBufferHeight:vt,pixelRatio:W.pixelRatio},dt={},me={elements:null,primitive:4,count:-1,offset:0,instances:-1},we=nf(ne,ut),ot=ph(ne,at,W,$e),Et=Mm(ne,ut,we,at,ot);function $e(Ut){return Et.destroyBuffer(Ut)}var Tt=fy(ne,ut,ot,at),st=Nm(ne,De,at,W),St=Ki(ne,ut,we,function(){Lt.procs.poll()},et,at,W),Ke=Fs(ne,ut,we,at,W),ht=jh(ne,ut,we,St,Ke,at),Lt=rp(ne,De,ut,we,ot,Tt,St,ht,dt,Et,st,me,et,mt,W),Gt=Xh(ne,ht,Lt.procs.poll,et,be,ut,we),gt=Lt.next,He=ne.canvas,qe=[],Wt=[],lr=[],Mt=[W.onDestroy],Zt=null;function Yt(){if(qe.length===0){mt&&mt.update(),Zt=null;return}Zt=Cn.next(Yt),Sr();for(var Ut=qe.length-1;Ut>=0;--Ut){var sr=qe[Ut];sr&&sr(et,null,0)}ne.flush(),mt&&mt.update()}function er(){!Zt&&qe.length>0&&(Zt=Cn.next(Yt))}function cr(){Zt&&(Cn.cancel(Yt),Zt=null)}function Br(Ut){Ut.preventDefault(),je=!0,cr(),Wt.forEach(function(sr){sr()})}function In(Ut){ne.getError(),je=!1,Re.restore(),st.restore(),ot.restore(),St.restore(),Ke.restore(),ht.restore(),Et.restore(),mt&&mt.restore(),Lt.procs.refresh(),er(),lr.forEach(function(sr){sr()})}He&&(He.addEventListener(Qf,Br,!1),He.addEventListener(np,In,!1));function or(){qe.length=0,cr(),He&&(He.removeEventListener(Qf,Br),He.removeEventListener(np,In)),st.clear(),ht.clear(),Ke.clear(),St.clear(),Tt.clear(),ot.clear(),Et.clear(),mt&&mt.clear(),Mt.forEach(function(Ut){Ut()})}function bn(Ut){V(!!Ut,"invalid args to regl({...})"),V.type(Ut,"object","invalid args to regl({...})");function sr(Te){var ie=n({},Te);delete ie.uniforms,delete ie.attributes,delete ie.context,delete ie.vao,"stencil"in ie&&ie.stencil.op&&(ie.stencil.opBack=ie.stencil.opFront=ie.stencil.op,delete ie.stencil.op);function ce(de){if(de in ie){var K=ie[de];delete ie[de],Object.keys(K).forEach(function(se){ie[de+"."+se]=K[se]})}}return ce("blend"),ce("depth"),ce("cull"),ce("stencil"),ce("polygonOffset"),ce("scissor"),ce("sample"),"vao"in Te&&(ie.vao=Te.vao),ie}function kt(Te){var ie={},ce={};return Object.keys(Te).forEach(function(de){var K=Te[de];Wr.isDynamic(K)?ce[de]=Wr.unbox(K,de):ie[de]=K}),{dynamic:ce,static:ie}}var br=kt(Ut.context||{}),Xn=kt(Ut.uniforms||{}),J=kt(Ut.attributes||{}),Oe=kt(sr(Ut)),Ae={gpuTime:0,cpuTime:0,count:0},bt=Lt.compile(Oe,J,Xn,br,Ae),qt=bt.draw,mr=bt.batch,k=bt.scope,Y=[];function te(Te){for(;Y.length<Te;)Y.push(null);return Y}function Ee(Te,ie){var ce;if(je&&V.raise("context lost"),typeof Te=="function")return k.call(this,null,Te,0);if(typeof ie=="function")if(typeof Te=="number")for(ce=0;ce<Te;++ce)k.call(this,null,ie,ce);else if(Array.isArray(Te))for(ce=0;ce<Te.length;++ce)k.call(this,Te[ce],ie,ce);else return k.call(this,Te,ie,0);else if(typeof Te=="number"){if(Te>0)return mr.call(this,te(Te|0),Te|0)}else if(Array.isArray(Te)){if(Te.length)return mr.call(this,Te,Te.length)}else return qt.call(this,Te)}return n(Ee,{stats:Ae})}var Fr=ht.setFBO=bn({framebuffer:Wr.define.call(null,ip,"framebuffer")});function on(Ut,sr){var kt=0;Lt.procs.poll();var br=sr.color;br&&(ne.clearColor(+br[0]||0,+br[1]||0,+br[2]||0,+br[3]||0),kt|=Qm),"depth"in sr&&(ne.clearDepth(+sr.depth),kt|=Jm),"stencil"in sr&&(ne.clearStencil(sr.stencil|0),kt|=Kf),V(!!kt,"called regl.clear with no buffer specified"),ne.clear(kt)}function sn(Ut){if(V(typeof Ut=="object"&&Ut,"regl.clear() takes an object as input"),"framebuffer"in Ut)if(Ut.framebuffer&&Ut.framebuffer_reglType==="framebufferCube")for(var sr=0;sr<6;++sr)Fr(n({framebuffer:Ut.framebuffer.faces[sr]},Ut),on);else Fr(Ut,on);else on(null,Ut)}function xn(Ut){V.type(Ut,"function","regl.frame() callback must be a function"),qe.push(Ut);function sr(){var kt=jn(qe,Ut);V(kt>=0,"cannot cancel a frame twice");function br(){var Xn=jn(qe,br);qe[Xn]=qe[qe.length-1],qe.length-=1,qe.length<=0&&cr()}qe[kt]=br}return er(),{cancel:sr}}function Yr(){var Ut=gt.viewport,sr=gt.scissor_box;Ut[0]=Ut[1]=sr[0]=sr[1]=0,et.viewportWidth=et.framebufferWidth=et.drawingBufferWidth=Ut[2]=sr[2]=ne.drawingBufferWidth,et.viewportHeight=et.framebufferHeight=et.drawingBufferHeight=Ut[3]=sr[3]=ne.drawingBufferHeight}function Sr(){et.tick+=1,et.time=Jt(),Yr(),Lt.procs.poll()}function fn(){Yr(),Lt.procs.refresh(),mt&&mt.update()}function Jt(){return(Yi()-lt)/1e3}fn();function Mr(Ut,sr){V.type(sr,"function","listener callback must be a function");var kt;switch(Ut){case"frame":return xn(sr);case"lost":kt=Wt;break;case"restore":kt=lr;break;case"destroy":kt=Mt;break;default:V.raise("invalid event, must be one of frame,lost,restore,destroy")}return kt.push(sr),{cancel:function(){for(var br=0;br<kt.length;++br)if(kt[br]===sr){kt[br]=kt[kt.length-1],kt.pop();return}}}}var Ar=n(bn,{clear:sn,prop:Wr.define.bind(null,ip),context:Wr.define.bind(null,Ay),this:Wr.define.bind(null,t_),draw:bn({}),buffer:function(Ut){return ot.create(Ut,e_,!1,!1)},elements:function(Ut){return Tt.create(Ut,!1)},texture:St.create2D,cube:St.createCube,renderbuffer:Ke.create,framebuffer:ht.create,framebufferCube:ht.createCube,vao:Et.createVAO,attributes:be,frame:xn,on:Mr,limits:we,hasExtension:function(Ut){return we.extensions.indexOf(Ut.toLowerCase())>=0},read:Gt,destroy:or,_gl:ne,_refresh:fn,poll:function(){Sr(),mt&&mt.update()},now:Jt,stats:at});return W.onDone(null,Ar),Ar}return Jn}))})(E0)),E0.exports}var ioe=noe();const aoe=Pr(ioe);var ooe=class{constructor(e,t){const{buffer:r,offset:n,stride:i,normalized:a,size:s,divisor:l}=t;this.buffer=r,this.attribute={buffer:r.get(),offset:n||0,stride:i||0,normalized:a||!1,divisor:l||0},s&&(this.attribute.size=s)}get(){return this.attribute}updateBuffer(e){this.buffer.subData(e)}destroy(){this.buffer.destroy()}},soe={[N.POINTS]:"points",[N.LINES]:"lines",[N.LINE_LOOP]:"line loop",[N.LINE_STRIP]:"line strip",[N.TRIANGLES]:"triangles",[N.TRIANGLE_FAN]:"triangle fan",[N.TRIANGLE_STRIP]:"triangle strip"},LF={[N.STATIC_DRAW]:"static",[N.DYNAMIC_DRAW]:"dynamic",[N.STREAM_DRAW]:"stream"},FR={[N.BYTE]:"int8",[N.INT]:"int32",[N.UNSIGNED_BYTE]:"uint8",[N.UNSIGNED_SHORT]:"uint16",[N.UNSIGNED_INT]:"uint32",[N.FLOAT]:"float"},uoe={[N.ALPHA]:"alpha",[N.LUMINANCE]:"luminance",[N.LUMINANCE_ALPHA]:"luminance alpha",[N.RGB]:"rgb",[N.RGBA]:"rgba",[N.RGBA4]:"rgba4",[N.RGB5_A1]:"rgb5 a1",[N.RGB565]:"rgb565",[N.DEPTH_COMPONENT]:"depth",[N.DEPTH_STENCIL]:"depth stencil"},loe={[N.DONT_CARE]:"dont care",[N.NICEST]:"nice",[N.FASTEST]:"fast"},$P={[N.NEAREST]:"nearest",[N.LINEAR]:"linear",[N.LINEAR_MIPMAP_LINEAR]:"mipmap",[N.NEAREST_MIPMAP_LINEAR]:"nearest mipmap linear",[N.LINEAR_MIPMAP_NEAREST]:"linear mipmap nearest",[N.NEAREST_MIPMAP_NEAREST]:"nearest mipmap nearest"},ZP={[N.REPEAT]:"repeat",[N.CLAMP_TO_EDGE]:"clamp",[N.MIRRORED_REPEAT]:"mirror"},coe={[N.NONE]:"none",[N.BROWSER_DEFAULT_WEBGL]:"browser"},foe={[N.NEVER]:"never",[N.ALWAYS]:"always",[N.LESS]:"less",[N.LEQUAL]:"lequal",[N.GREATER]:"greater",[N.GEQUAL]:"gequal",[N.EQUAL]:"equal",[N.NOTEQUAL]:"notequal"},KP={[N.FUNC_ADD]:"add",[N.MIN_EXT]:"min",[N.MAX_EXT]:"max",[N.FUNC_SUBTRACT]:"subtract",[N.FUNC_REVERSE_SUBTRACT]:"reverse subtract"},K_={[N.ZERO]:"zero",[N.ONE]:"one",[N.SRC_COLOR]:"src color",[N.ONE_MINUS_SRC_COLOR]:"one minus src color",[N.SRC_ALPHA]:"src alpha",[N.ONE_MINUS_SRC_ALPHA]:"one minus src alpha",[N.DST_COLOR]:"dst color",[N.ONE_MINUS_DST_COLOR]:"one minus dst color",[N.DST_ALPHA]:"dst alpha",[N.ONE_MINUS_DST_ALPHA]:"one minus dst alpha",[N.CONSTANT_COLOR]:"constant color",[N.ONE_MINUS_CONSTANT_COLOR]:"one minus constant color",[N.CONSTANT_ALPHA]:"constant alpha",[N.ONE_MINUS_CONSTANT_ALPHA]:"one minus constant alpha",[N.SRC_ALPHA_SATURATE]:"src alpha saturate"},doe={[N.NEVER]:"never",[N.ALWAYS]:"always",[N.LESS]:"less",[N.LEQUAL]:"lequal",[N.GREATER]:"greater",[N.GEQUAL]:"gequal",[N.EQUAL]:"equal",[N.NOTEQUAL]:"notequal"},md={[N.ZERO]:"zero",[N.KEEP]:"keep",[N.REPLACE]:"replace",[N.INVERT]:"invert",[N.INCR]:"increment",[N.DECR]:"decrement",[N.INCR_WRAP]:"increment wrap",[N.DECR_WRAP]:"decrement wrap"},hoe={[N.FRONT]:"front",[N.BACK]:"back"},poe=class{constructor(e,t){this.isDestroyed=!1;const{data:r,usage:n,type:i}=t;this.buffer=e.buffer({data:r,usage:LF[n||N.STATIC_DRAW],type:FR[i||N.UNSIGNED_BYTE]})}get(){return this.buffer}destroy(){this.isDestroyed||this.buffer.destroy(),this.isDestroyed=!0}subData({data:e,offset:t}){this.buffer.subdata(e,t)}},voe=class{constructor(e,t){const{data:r,usage:n,type:i,count:a}=t;this.elements=e.elements({data:r,usage:LF[n||N.STATIC_DRAW],type:FR[i||N.UNSIGNED_BYTE],count:a})}get(){return this.elements}subData({data:e}){this.elements.subdata(e)}destroy(){}},moe=class{constructor(e,t){const{width:r,height:n,color:i,colors:a}=t,s={width:r,height:n};Array.isArray(a)&&(s.colors=a.map(l=>l.get())),i&&typeof i!="boolean"&&(s.color=i.get()),this.framebuffer=e.framebuffer(s)}get(){return this.framebuffer}destroy(){this.framebuffer.destroy()}resize({width:e,height:t}){this.framebuffer.resize(e,t)}},_oe=Object.defineProperty,goe=Object.defineProperties,yoe=Object.getOwnPropertyDescriptors,QP=Object.getOwnPropertySymbols,Eoe=Object.prototype.hasOwnProperty,Toe=Object.prototype.propertyIsEnumerable,JP=(e,t,r)=>t in e?_oe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Wp=(e,t)=>{for(var r in t||(t={}))Eoe.call(t,r)&&JP(e,r,t[r]);if(QP)for(var r of QP(t))Toe.call(t,r)&&JP(e,r,t[r]);return e},Soe=(e,t)=>goe(e,yoe(t)),{isPlainObject:Aoe,isTypedArray:boe}=yn,xoe=class{constructor(e,t){this.destroyed=!1,this.uniforms={},this.reGl=e;const{vs:r,fs:n,attributes:i,uniforms:a,primitive:s,count:l,elements:c,depth:d,cull:p,instances:h}=t,m={glslVersion:"#version 100",explicitBindingLocations:!1,separateSamplerTextures:!1,viewportOrigin:wo.LOWER_LEFT,clipSpaceNearZ:Wd.NEGATIVE_ONE},_={};this.options=t,a&&(this.uniforms=this.extractUniforms(a),Object.keys(a).forEach(b=>{_[b]=e.prop(b)}));const y={};Object.keys(i).forEach(b=>{y[b]=i[b].get()});const E=IN(Kd(m,"frag",n,null,!1)),T=IN(Kd(m,"vert",r,null,!1)),A={attributes:y,frag:E,uniforms:_,vert:T,colorMask:e.prop("colorMask"),lineWidth:1,blend:{enable:e.prop("blend.enable"),func:e.prop("blend.func"),equation:e.prop("blend.equation"),color:e.prop("blend.color")},stencil:{enable:e.prop("stencil.enable"),mask:e.prop("stencil.mask"),func:e.prop("stencil.func"),opFront:e.prop("stencil.opFront"),opBack:e.prop("stencil.opBack")},primitive:soe[s===void 0?N.TRIANGLES:s]};h&&(A.instances=h),l?A.count=l:c&&(A.elements=c.get()),this.initDepthDrawParams({depth:d},A),this.initCullDrawParams({cull:p},A),this.drawCommand=e(A),this.drawParams=A}updateAttributesAndElements(e,t){const r={};Object.keys(e).forEach(n=>{r[n]=e[n].get()}),this.drawParams.attributes=r,this.drawParams.elements=t.get(),this.drawCommand=this.reGl(this.drawParams)}updateAttributes(e){const t={};Object.keys(e).forEach(r=>{t[r]=e[r].get()}),this.drawParams.attributes=t,this.drawCommand=this.reGl(this.drawParams)}addUniforms(e){this.uniforms=Wp(Wp({},this.uniforms),this.extractUniforms(e))}draw(e,t){if(this.drawParams.attributes&&Object.keys(this.drawParams.attributes).length===0)return;const r=Wp(Wp({},this.uniforms),this.extractUniforms(e.uniforms||{})),n={};Object.keys(r).forEach(i=>{const a=typeof r[i];a==="boolean"||a==="number"||Array.isArray(r[i])||r[i].BYTES_PER_ELEMENT?n[i]=r[i]:n[i]=r[i].get()}),n.blend=t?this.getBlendDrawParams({blend:{enable:!1}}):this.getBlendDrawParams(e),n.stencil=this.getStencilDrawParams(e),n.colorMask=this.getColorMaskDrawParams(e,t),this.drawCommand(n)}destroy(){var e,t;(t=(e=this.drawParams)==null?void 0:e.elements)==null||t.destroy(),this.options.attributes&&Object.values(this.options.attributes).forEach(r=>{r?.destroy()}),this.destroyed=!0}initDepthDrawParams({depth:e},t){e&&(t.depth={enable:e.enable===void 0?!0:!!e.enable,mask:e.mask===void 0?!0:!!e.mask,func:foe[e.func||N.LESS],range:e.range||[0,1]})}getBlendDrawParams({blend:e}){const{enable:t,func:r,equation:n,color:i=[0,0,0,0]}=e||{};return{enable:!!t,func:{srcRGB:K_[r&&r.srcRGB||N.SRC_ALPHA],srcAlpha:K_[r&&r.srcAlpha||N.SRC_ALPHA],dstRGB:K_[r&&r.dstRGB||N.ONE_MINUS_SRC_ALPHA],dstAlpha:K_[r&&r.dstAlpha||N.ONE_MINUS_SRC_ALPHA]},equation:{rgb:KP[n&&n.rgb||N.FUNC_ADD],alpha:KP[n&&n.alpha||N.FUNC_ADD]},color:i}}getStencilDrawParams({stencil:e}){const{enable:t,mask:r=-1,func:n={cmp:N.ALWAYS,ref:0,mask:-1},opFront:i={fail:N.KEEP,zfail:N.KEEP,zpass:N.KEEP},opBack:a={fail:N.KEEP,zfail:N.KEEP,zpass:N.KEEP}}=e||{};return{enable:!!t,mask:r,func:Soe(Wp({},n),{cmp:doe[n.cmp]}),opFront:{fail:md[i.fail],zfail:md[i.zfail],zpass:md[i.zpass]},opBack:{fail:md[a.fail],zfail:md[a.zfail],zpass:md[a.zpass]}}}getColorMaskDrawParams({stencil:e},t){return e?.enable&&e.opFront&&!t?[!1,!1,!1,!1]:[!0,!0,!0,!0]}initCullDrawParams({cull:e},t){if(e){const{enable:r,face:n=N.BACK}=e;t.cull={enable:!!r,face:hoe[n]}}}extractUniforms(e){const t={};return Object.keys(e).forEach(r=>{this.extractUniformsRecursively(r,e[r],t,"")}),t}extractUniformsRecursively(e,t,r,n){if(t===null||typeof t=="number"||typeof t=="boolean"||Array.isArray(t)&&typeof t[0]=="number"||boe(t)||t===""||"resize"in t){r[`${n&&n+"."}${e}`]=t;return}Aoe(t)&&Object.keys(t).forEach(i=>{this.extractUniformsRecursively(i,t[i],r,`${n&&n+"."}${e}`)}),Array.isArray(t)&&t.forEach((i,a)=>{Object.keys(i).forEach(s=>{this.extractUniformsRecursively(s,i[s],r,`${n&&n+"."}${e}[${a}]`)})})}},Roe=class{constructor(e,t){this.isDestroy=!1;const{data:r,type:n=N.UNSIGNED_BYTE,width:i,height:a,flipY:s=!1,format:l=N.RGBA,mipmap:c=!1,wrapS:d=N.CLAMP_TO_EDGE,wrapT:p=N.CLAMP_TO_EDGE,aniso:h=0,alignment:m=1,premultiplyAlpha:_=!1,mag:y=N.NEAREST,min:E=N.NEAREST,colorSpace:T=N.BROWSER_DEFAULT_WEBGL,x:A=0,y:b=0,copy:R=!1}=t;this.width=i,this.height=a;const M={width:i,height:a,type:FR[n],format:uoe[l],wrapS:ZP[d],wrapT:ZP[p],mag:$P[y],min:$P[E],alignment:m,flipY:s,colorSpace:coe[T],premultiplyAlpha:_,aniso:h,x:A,y:b,copy:R};r&&(M.data=r),typeof c=="number"?M.mipmap=loe[c]:typeof c=="boolean"&&(M.mipmap=c),this.texture=e.texture(M)}get(){return this.texture}update(e={}){this.texture(e)}bind(){this.texture._texture.bind()}resize({width:e,height:t}){this.texture.resize(e,t),this.width=e,this.height=t}getSize(){return[this.width,this.height]}destroy(){var e;this.isDestroy||(e=this.texture)==null||e.destroy(),this.isDestroy=!0}},rb=(e,t,r)=>new Promise((n,i)=>{var a=c=>{try{l(r.next(c))}catch(d){i(d)}},s=c=>{try{l(r.throw(c))}catch(d){i(d)}},l=c=>c.done?n(c.value):Promise.resolve(c.value).then(a,s);l((r=r.apply(e,t)).next())}),Coe=class{constructor(){this.uniformBuffers=[],this.queryVerdorInfo=()=>"WebGL1",this.createModel=e=>new xoe(this.gl,e),this.createAttribute=e=>new ooe(this.gl,e),this.createBuffer=e=>new poe(this.gl,e),this.createElements=e=>new voe(this.gl,e),this.createTexture2D=e=>new Roe(this.gl,e),this.createFramebuffer=e=>new moe(this.gl,e),this.useFramebuffer=(e,t)=>{this.gl({framebuffer:e?e.get():null})(t)},this.useFramebufferAsync=(e,t)=>rb(this,null,function*(){this.gl({framebuffer:e?e.get():null})(t)}),this.clear=e=>{var t;const{color:r,depth:n,stencil:i,framebuffer:a=null}=e,s={color:r,depth:n,stencil:i};s.framebuffer=a===null?a:a.get(),(t=this.gl)==null||t.clear(s)},this.viewport=({x:e,y:t,width:r,height:n})=>{this.gl._gl.viewport(e,t,r,n),this.width=r,this.height=n,this.gl._refresh()},this.readPixels=e=>{const{framebuffer:t,x:r,y:n,width:i,height:a}=e,s={x:r,y:n,width:i,height:a};return t&&(s.framebuffer=t.get()),this.gl.read(s)},this.readPixelsAsync=e=>rb(this,null,function*(){return this.readPixels(e)}),this.getViewportSize=()=>({width:this.gl._gl.drawingBufferWidth,height:this.gl._gl.drawingBufferHeight}),this.getContainer=()=>{var e;return(e=this.canvas)==null?void 0:e.parentElement},this.getCanvas=()=>this.canvas,this.getGLContext=()=>this.gl._gl,this.destroy=()=>{var e,t,r;this.canvas=null,(r=(t=(e=this.gl)==null?void 0:e._gl)==null?void 0:t.getExtension("WEBGL_lose_context"))==null||r.loseContext(),this.gl.destroy(),this.gl=null}}init(e,t,r){return rb(this,null,function*(){this.canvas=e,r?this.gl=r:this.gl=yield new Promise((n,i)=>{aoe({canvas:this.canvas,attributes:{alpha:!0,antialias:t.antialias,premultipliedAlpha:!0,preserveDrawingBuffer:t.preserveDrawingBuffer,stencil:t.stencil},extensions:["OES_element_index_uint","OES_standard_derivatives","ANGLE_instanced_arrays"],optionalExtensions:["oes_texture_float_linear","OES_texture_float","EXT_texture_filter_anisotropic","EXT_blend_minmax","WEBGL_depth_texture","WEBGL_lose_context"],profile:!0,onDone:(a,s)=>{(a||!s)&&i(a),n(s)}})}),this.extensionObject={OES_texture_float:this.testExtension("OES_texture_float")}})}getPointSizeRange(){return this.gl._gl.getParameter(this.gl._gl.ALIASED_POINT_SIZE_RANGE)}testExtension(e){return!!this.getGLContext().getExtension(e)}setState(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!0,equation:"add"},framebuffer:null}),this.gl._refresh()}setBaseState(){this.gl({cull:{enable:!1,face:"back"},viewport:{x:0,y:0,height:this.width,width:this.height},blend:{enable:!1,equation:"add"},framebuffer:null}),this.gl._refresh()}setCustomLayerDefaults(){const e=this.getGLContext();e.disable(e.CULL_FACE)}setDirty(e){this.isDirty=e}getDirty(){return this.isDirty}beginFrame(){}endFrame(){}},nb=["selectstart","selecting","selectend"],Ooe=class extends Oa.EventEmitter{constructor(e,t={}){super(),this.isEnable=!1,this.onDragStart=r=>{this.box.style.display="block",this.startEvent=this.endEvent=r,this.syncBoxBound(),this.emit("selectstart",this.getLngLatBox(),this.startEvent,this.endEvent)},this.onDragging=r=>{this.endEvent=r,this.syncBoxBound(),this.emit("selecting",this.getLngLatBox(),this.startEvent,this.endEvent)},this.onDragEnd=r=>{this.endEvent=r,this.box.style.display="none",this.emit("selectend",this.getLngLatBox(),this.startEvent,this.endEvent)},this.scene=e,this.options=t}get container(){return this.scene.getMapService().getMarkerContainer()}enable(){if(this.isEnable)return;const{className:e}=this.options;if(this.scene.setMapStatus({dragEnable:!1}),this.container.style.cursor="crosshair",!this.box){const t=ba("div",void 0,this.container);t.classList.add("l7-select-box"),e&&t.classList.add(e),t.style.display="none",this.box=t}this.scene.on("dragstart",this.onDragStart),this.scene.on("dragging",this.onDragging),this.scene.on("dragend",this.onDragEnd),this.isEnable=!0}disable(){this.isEnable&&(this.scene.setMapStatus({dragEnable:!0}),this.container.style.cursor="auto",this.scene.off("dragstart",this.onDragStart),this.scene.off("dragging",this.onDragging),this.scene.off("dragend",this.onDragEnd),this.isEnable=!1)}syncBoxBound(){const{x:e,y:t}=this.startEvent,{x:r,y:n}=this.endEvent,i=Math.min(e,r),a=Math.min(t,n),s=Math.abs(e-r),l=Math.abs(t-n);this.box.style.top=`${a}px`,this.box.style.left=`${i}px`,this.box.style.width=`${s}px`,this.box.style.height=`${l}px`}getLngLatBox(){const{lngLat:{lng:e,lat:t}}=this.startEvent,{lngLat:{lng:r,lat:n}}=this.endEvent;return qV([[e,t],[r,n]])}},Moe=Object.defineProperty,woe=Object.defineProperties,Noe=Object.getOwnPropertyDescriptors,eD=Object.getOwnPropertySymbols,Ioe=Object.prototype.hasOwnProperty,Poe=Object.prototype.propertyIsEnumerable,tD=(e,t,r)=>t in e?Moe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Doe=(e,t)=>{for(var r in t||(t={}))Ioe.call(t,r)&&tD(e,r,t[r]);if(eD)for(var r of eD(t))Poe.call(t,r)&&tD(e,r,t[r]);return e},Loe=(e,t)=>woe(e,Noe(t)),Yp=(e,t,r)=>new Promise((n,i)=>{var a=c=>{try{l(r.next(c))}catch(d){i(d)}},s=c=>{try{l(r.throw(c))}catch(d){i(d)}},l=c=>c.done?n(c.value):Promise.resolve(c.value).then(a,s);l((r=r.apply(e,t)).next())}),Boe=class{constructor(e){const{id:t,map:r,renderer:n="device"}=e,i=WY();this.container=i,r.setContainer(i,t),n==="regl"?i.rendererService=new Coe:i.rendererService=new toe,this.sceneService=i.sceneService,this.mapService=i.mapService,this.iconService=i.iconService,this.fontService=i.fontService,this.controlService=i.controlService,this.layerService=i.layerService,this.debugService=i.debugService,this.debugService.setEnable(e.debug),this.markerService=i.markerService,this.interactionService=i.interactionService,this.popupService=i.popupService,this.boxSelect=new Ooe(this,{}),this.initComponent(t),this.sceneService.init(e),this.initControl()}get map(){return this.mapService.map}get loaded(){return this.sceneService.loaded}getServiceContainer(){return this.container}getSize(){return this.mapService.getSize()}getMinZoom(){return this.mapService.getMinZoom()}getMaxZoom(){return this.mapService.getMaxZoom()}getType(){return this.mapService.getType()}getMapContainer(){return this.mapService.getMapContainer()}getMapCanvasContainer(){return this.mapService.getMapCanvasContainer()}getMapService(){return this.mapService}getDebugService(){return this.debugService}exportPng(e){return Yp(this,null,function*(){return this.sceneService.exportPng(e)})}exportMap(e){return Yp(this,null,function*(){return this.sceneService.exportPng(e)})}registerRenderService(e){this.sceneService.loaded?new e(this).init():this.on("loaded",()=>{new e(this).init()})}setBgColor(e){this.mapService.setBgColor(e)}addLayer(e){this.loaded?this.preAddLayer(e):this.once("loaded",()=>{this.preAddLayer(e)})}preAddLayer(e){const t=yv(this.container);if(e.setContainer(t),this.sceneService.addLayer(e),e.inited){this.initTileLayer(e);const r=this.initMask(e);this.addMask(r,e.id)}else e.on("inited",()=>{this.initTileLayer(e);const r=this.initMask(e);this.addMask(r,e.id)})}initMask(e){const{mask:t,maskfence:r,maskColor:n="#000",maskOpacity:i=0}=e.getLayerConfig();return!t||!r?void 0:new cF().source(r).shape("fill").style({color:n,opacity:i})}addMask(e,t){if(!e)return;const r=this.getLayer(t);if(r){const n=yv(this.container);e.setContainer(n),r.addMaskLayer(e),this.sceneService.addMask(e)}else console.warn("parent layer not find!")}getPickedLayer(){return this.layerService.pickedLayerId}getLayers(){return this.layerService.getLayers()}getLayer(e){return this.layerService.getLayer(e)}getLayerByName(e){return this.layerService.getLayerByName(e)}removeLayer(e,t){return Yp(this,null,function*(){yield this.layerService.remove(e,t)})}removeAllLayer(){return Yp(this,null,function*(){yield this.layerService.removeAllLayers()})}render(){this.sceneService.render()}setEnableRender(e){this.layerService.setEnableRender(e)}addIconFont(e,t){this.fontService.addIconFont(e,t)}addIconFonts(e){e.forEach(([t,r])=>{this.fontService.addIconFont(t,r)})}addFontFace(e,t){this.fontService.once("fontloaded",r=>{this.emit("fontloaded",r)}),this.fontService.addFontFace(e,t)}addImage(e,t){return Yp(this,null,function*(){yield this.iconService.addImage(e,t)})}hasImage(e){return this.iconService.hasImage(e)}removeImage(e){this.iconService.removeImage(e)}addIconFontGlyphs(e,t){this.fontService.addIconGlyphs(t)}addControl(e){this.controlService.addControl(e,this.container)}removeControl(e){this.controlService.removeControl(e)}getControlByName(e){return this.controlService.getControlByName(e)}addMarker(e){this.markerService.addMarker(e)}addMarkerLayer(e){this.markerService.addMarkerLayer(e)}removeMarkerLayer(e){this.markerService.removeMarkerLayer(e)}removeAllMarkers(){this.markerService.removeAllMarkers()}removeAllMakers(){console.warn("removeAllMakers 已废弃，请使用 removeAllMarkers"),this.markerService.removeAllMarkers()}addPopup(e){this.popupService.addPopup(e)}removePopup(e){this.popupService.removePopup(e)}on(e,t){var r;nb.includes(e)?(r=this.boxSelect)==null||r.on(e,t):F_.includes(e)?this.sceneService.on(e,t):this.mapService.on(e,t)}once(e,t){var r;nb.includes(e)?(r=this.boxSelect)==null||r.once(e,t):F_.includes(e)?this.sceneService.once(e,t):this.mapService.once(e,t)}emit(e,t){F_.indexOf(e)===-1?this.mapService.on(e,t):this.sceneService.emit(e,t)}off(e,t){var r;nb.includes(e)?(r=this.boxSelect)==null||r.off(e,t):F_.includes(e)?this.sceneService.off(e,t):this.mapService.off(e,t)}getZoom(){return this.mapService.getZoom()}getCenter(e){return this.mapService.getCenter(e)}setCenter(e,t){return this.mapService.setCenter(e,t)}getPitch(){return this.mapService.getPitch()}setPitch(e){return this.mapService.setPitch(e)}getRotation(){return this.mapService.getRotation()}getBounds(){return this.mapService.getBounds()}setRotation(e){this.mapService.setRotation(e)}zoomIn(){this.mapService.zoomIn()}zoomOut(){this.mapService.zoomOut()}panTo(e){this.mapService.panTo(e)}panBy(e,t){this.mapService.panBy(e,t)}getContainer(){return this.mapService.getContainer()}setZoom(e){this.mapService.setZoom(e)}fitBounds(e,t){const{fitBoundsOptions:r,animate:n}=this.sceneService.getSceneConfig();this.mapService.fitBounds(e,t||Loe(Doe({},r),{animate:n}))}setZoomAndCenter(e,t){this.mapService.setZoomAndCenter(e,t)}setMapStyle(e){this.mapService.setMapStyle(e)}setMapStatus(e){this.mapService.setMapStatus(e)}pixelToLngLat(e){return this.mapService.pixelToLngLat(e)}lngLatToPixel(e){return this.mapService.lngLatToPixel(e)}containerToLngLat(e){return this.mapService.containerToLngLat(e)}lngLatToContainer(e){return this.mapService.lngLatToContainer(e)}destroy(){this.sceneService.destroy()}registerPostProcessingPass(e){this.container.postProcessingPass.name=new e}enableShaderPick(){this.layerService.enableShaderPick()}diasbleShaderPick(){this.layerService.disableShaderPick()}enableBoxSelect(e=!0){this.boxSelect.enable(),e&&this.boxSelect.once("selectend",()=>{this.disableBoxSelect()})}disableBoxSelect(){this.boxSelect.disable()}static addProtocol(e,t){s0.REGISTERED_PROTOCOLS[e]=t}static removeProtocol(e){delete s0.REGISTERED_PROTOCOLS[e]}getProtocol(e){return s0.REGISTERED_PROTOCOLS[e]}startAnimate(){this.layerService.startAnimate()}stopAnimate(){this.layerService.stopAnimate()}getPointSizeRange(){return this.sceneService.getPointSizeRange()}initComponent(e){this.controlService.init({container:OV(e)},this.container),this.markerService.init(this.container),this.popupService.init(this.container)}initControl(){const{logoVisible:e,logoPosition:t}=this.sceneService.getSceneConfig();e&&this.addControl(new JZ({position:t}))}initTileLayer(e){e.getSource().isTile&&(e.tileLayer=new Wre(e))}},rD={exports:{}},$p={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nD;function Foe(){if(nD)return $p;nD=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function r(n,i,a){var s=null;if(a!==void 0&&(s=""+a),i.key!==void 0&&(s=""+i.key),"key"in i){a={};for(var l in i)l!=="key"&&(a[l]=i[l])}else a=i;return i=a.ref,{$$typeof:e,type:n,key:s,ref:i!==void 0?i:null,props:a}}return $p.Fragment=t,$p.jsx=r,$p.jsxs=r,$p}var iD;function Uoe(){return iD||(iD=1,rD.exports=Foe()),rD.exports}var Le=Uoe();function aD(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function BF(...e){return t=>{let r=!1;const n=e.map(i=>{const a=aD(i,t);return!r&&typeof a=="function"&&(r=!0),a});if(r)return()=>{for(let i=0;i<n.length;i++){const a=n[i];typeof a=="function"?a():aD(e[i],null)}}}}function gn(...e){return q.useCallback(BF(...e),e)}function Jd(e){const t=zoe(e),r=q.forwardRef((n,i)=>{const{children:a,...s}=n,l=q.Children.toArray(a),c=l.find(Hoe);if(c){const d=c.props.children,p=l.map(h=>h===c?q.Children.count(d)>1?q.Children.only(null):q.isValidElement(d)?d.props.children:null:h);return Le.jsx(t,{...s,ref:i,children:q.isValidElement(d)?q.cloneElement(d,void 0,p):null})}return Le.jsx(t,{...s,ref:i,children:a})});return r.displayName=`${e}.Slot`,r}var koe=Jd("Slot");function zoe(e){const t=q.forwardRef((r,n)=>{const{children:i,...a}=r;if(q.isValidElement(i)){const s=Xoe(i),l=Voe(a,i.props);return i.type!==q.Fragment&&(l.ref=n?BF(n,s):s),q.cloneElement(i,l)}return q.Children.count(i)>1?q.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var joe=Symbol("radix.slottable");function Hoe(e){return q.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===joe}function Voe(e,t){const r={...t};for(const n in t){const i=e[n],a=t[n];/^on[A-Z]/.test(n)?i&&a?r[n]=(...s)=>{const l=a(...s);return i(...s),l}:i&&(r[n]=i):n==="style"?r[n]={...i,...a}:n==="className"&&(r[n]=[i,a].filter(Boolean).join(" "))}return{...e,...r}}function Xoe(e){let t=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=Object.getOwnPropertyDescriptor(e,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}function FF(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e)){var i=e.length;for(t=0;t<i;t++)e[t]&&(r=FF(e[t]))&&(n&&(n+=" "),n+=r)}else for(r in e)e[r]&&(n&&(n+=" "),n+=r);return n}function UF(){for(var e,t,r=0,n="",i=arguments.length;r<i;r++)(e=arguments[r])&&(t=FF(e))&&(n&&(n+=" "),n+=t);return n}const oD=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,sD=UF,kF=(e,t)=>r=>{var n;if(t?.variants==null)return sD(e,r?.class,r?.className);const{variants:i,defaultVariants:a}=t,s=Object.keys(i).map(d=>{const p=r?.[d],h=a?.[d];if(p===null)return null;const m=oD(p)||oD(h);return i[d][m]}),l=r&&Object.entries(r).reduce((d,p)=>{let[h,m]=p;return m===void 0||(d[h]=m),d},{}),c=t==null||(n=t.compoundVariants)===null||n===void 0?void 0:n.reduce((d,p)=>{let{class:h,className:m,..._}=p;return Object.entries(_).every(y=>{let[E,T]=y;return Array.isArray(T)?T.includes({...a,...l}[E]):{...a,...l}[E]===T})?[...d,h,m]:d},[]);return sD(e,s,c,r?.class,r?.className)},UR="-",Goe=e=>{const t=Woe(e),{conflictingClassGroups:r,conflictingClassGroupModifiers:n}=e;return{getClassGroupId:i=>{const a=i.split(UR);return a[0]===""&&a.length!==1&&a.shift(),zF(a,t)||qoe(i)},getConflictingClassGroupIds:(i,a)=>{const s=r[i]||[];return a&&n[i]?[...s,...n[i]]:s}}},zF=(e,t)=>{if(e.length===0)return t.classGroupId;const r=e[0],n=t.nextPart.get(r),i=n?zF(e.slice(1),n):void 0;if(i)return i;if(t.validators.length===0)return;const a=e.join(UR);return t.validators.find(({validator:s})=>s(a))?.classGroupId},uD=/^\[(.+)\]$/,qoe=e=>{if(uD.test(e)){const t=uD.exec(e)[1],r=t?.substring(0,t.indexOf(":"));if(r)return"arbitrary.."+r}},Woe=e=>{const{theme:t,prefix:r}=e,n={nextPart:new Map,validators:[]};return $oe(Object.entries(e.classGroups),r).forEach(([i,a])=>{_x(a,n,i,t)}),n},_x=(e,t,r,n)=>{e.forEach(i=>{if(typeof i=="string"){const a=i===""?t:lD(t,i);a.classGroupId=r;return}if(typeof i=="function"){if(Yoe(i)){_x(i(n),t,r,n);return}t.validators.push({validator:i,classGroupId:r});return}Object.entries(i).forEach(([a,s])=>{_x(s,lD(t,a),r,n)})})},lD=(e,t)=>{let r=e;return t.split(UR).forEach(n=>{r.nextPart.has(n)||r.nextPart.set(n,{nextPart:new Map,validators:[]}),r=r.nextPart.get(n)}),r},Yoe=e=>e.isThemeGetter,$oe=(e,t)=>t?e.map(([r,n])=>{const i=n.map(a=>typeof a=="string"?t+a:typeof a=="object"?Object.fromEntries(Object.entries(a).map(([s,l])=>[t+s,l])):a);return[r,i]}):e,Zoe=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,r=new Map,n=new Map;const i=(a,s)=>{r.set(a,s),t++,t>e&&(t=0,n=r,r=new Map)};return{get(a){let s=r.get(a);if(s!==void 0)return s;if((s=n.get(a))!==void 0)return i(a,s),s},set(a,s){r.has(a)?r.set(a,s):i(a,s)}}},jF="!",Koe=e=>{const{separator:t,experimentalParseClassName:r}=e,n=t.length===1,i=t[0],a=t.length,s=l=>{const c=[];let d=0,p=0,h;for(let T=0;T<l.length;T++){let A=l[T];if(d===0){if(A===i&&(n||l.slice(T,T+a)===t)){c.push(l.slice(p,T)),p=T+a;continue}if(A==="/"){h=T;continue}}A==="["?d++:A==="]"&&d--}const m=c.length===0?l:l.substring(p),_=m.startsWith(jF),y=_?m.substring(1):m,E=h&&h>p?h-p:void 0;return{modifiers:c,hasImportantModifier:_,baseClassName:y,maybePostfixModifierPosition:E}};return r?l=>r({className:l,parseClassName:s}):s},Qoe=e=>{if(e.length<=1)return e;const t=[];let r=[];return e.forEach(n=>{n[0]==="["?(t.push(...r.sort(),n),r=[]):r.push(n)}),t.push(...r.sort()),t},Joe=e=>({cache:Zoe(e.cacheSize),parseClassName:Koe(e),...Goe(e)}),ese=/\s+/,tse=(e,t)=>{const{parseClassName:r,getClassGroupId:n,getConflictingClassGroupIds:i}=t,a=[],s=e.trim().split(ese);let l="";for(let c=s.length-1;c>=0;c-=1){const d=s[c],{modifiers:p,hasImportantModifier:h,baseClassName:m,maybePostfixModifierPosition:_}=r(d);let y=!!_,E=n(y?m.substring(0,_):m);if(!E){if(!y){l=d+(l.length>0?" "+l:l);continue}if(E=n(m),!E){l=d+(l.length>0?" "+l:l);continue}y=!1}const T=Qoe(p).join(":"),A=h?T+jF:T,b=A+E;if(a.includes(b))continue;a.push(b);const R=i(E,y);for(let M=0;M<R.length;++M){const B=R[M];a.push(A+B)}l=d+(l.length>0?" "+l:l)}return l};function rse(){let e=0,t,r,n="";for(;e<arguments.length;)(t=arguments[e++])&&(r=HF(t))&&(n&&(n+=" "),n+=r);return n}const HF=e=>{if(typeof e=="string")return e;let t,r="";for(let n=0;n<e.length;n++)e[n]&&(t=HF(e[n]))&&(r&&(r+=" "),r+=t);return r};function nse(e,...t){let r,n,i,a=s;function s(c){const d=t.reduce((p,h)=>h(p),e());return r=Joe(d),n=r.cache.get,i=r.cache.set,a=l,l(c)}function l(c){const d=n(c);if(d)return d;const p=tse(c,r);return i(c,p),p}return function(){return a(rse.apply(null,arguments))}}const hn=e=>{const t=r=>r[e]||[];return t.isThemeGetter=!0,t},VF=/^\[(?:([a-z-]+):)?(.+)\]$/i,ise=/^\d+\/\d+$/,ase=new Set(["px","full","screen"]),ose=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,sse=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,use=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,lse=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,cse=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Js=e=>Ld(e)||ase.has(e)||ise.test(e),hl=e=>oh(e,"length",gse),Ld=e=>!!e&&!Number.isNaN(Number(e)),ib=e=>oh(e,"number",Ld),Zp=e=>!!e&&Number.isInteger(Number(e)),fse=e=>e.endsWith("%")&&Ld(e.slice(0,-1)),Er=e=>VF.test(e),pl=e=>ose.test(e),dse=new Set(["length","size","percentage"]),hse=e=>oh(e,dse,XF),pse=e=>oh(e,"position",XF),vse=new Set(["image","url"]),mse=e=>oh(e,vse,Ese),_se=e=>oh(e,"",yse),Kp=()=>!0,oh=(e,t,r)=>{const n=VF.exec(e);return n?n[1]?typeof t=="string"?n[1]===t:t.has(n[1]):r(n[2]):!1},gse=e=>sse.test(e)&&!use.test(e),XF=()=>!1,yse=e=>lse.test(e),Ese=e=>cse.test(e),Tse=()=>{const e=hn("colors"),t=hn("spacing"),r=hn("blur"),n=hn("brightness"),i=hn("borderColor"),a=hn("borderRadius"),s=hn("borderSpacing"),l=hn("borderWidth"),c=hn("contrast"),d=hn("grayscale"),p=hn("hueRotate"),h=hn("invert"),m=hn("gap"),_=hn("gradientColorStops"),y=hn("gradientColorStopPositions"),E=hn("inset"),T=hn("margin"),A=hn("opacity"),b=hn("padding"),R=hn("saturate"),M=hn("scale"),B=hn("sepia"),w=hn("skew"),D=hn("space"),U=hn("translate"),ae=()=>["auto","contain","none"],Q=()=>["auto","hidden","clip","visible","scroll"],X=()=>["auto",Er,t],x=()=>[Er,t],P=()=>["",Js,hl],H=()=>["auto",Ld,Er],pe=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],O=()=>["solid","dashed","dotted","double","none"],F=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],z=()=>["start","end","center","between","around","evenly","stretch"],re=()=>["","0",Er],oe=()=>["auto","avoid","all","avoid-page","page","left","right","column"],_e=()=>[Ld,Er];return{cacheSize:500,separator:":",theme:{colors:[Kp],spacing:[Js,hl],blur:["none","",pl,Er],brightness:_e(),borderColor:[e],borderRadius:["none","","full",pl,Er],borderSpacing:x(),borderWidth:P(),contrast:_e(),grayscale:re(),hueRotate:_e(),invert:re(),gap:x(),gradientColorStops:[e],gradientColorStopPositions:[fse,hl],inset:X(),margin:X(),opacity:_e(),padding:x(),saturate:_e(),scale:_e(),sepia:re(),skew:_e(),space:x(),translate:x()},classGroups:{aspect:[{aspect:["auto","square","video",Er]}],container:["container"],columns:[{columns:[pl]}],"break-after":[{"break-after":oe()}],"break-before":[{"break-before":oe()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...pe(),Er]}],overflow:[{overflow:Q()}],"overflow-x":[{"overflow-x":Q()}],"overflow-y":[{"overflow-y":Q()}],overscroll:[{overscroll:ae()}],"overscroll-x":[{"overscroll-x":ae()}],"overscroll-y":[{"overscroll-y":ae()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[E]}],"inset-x":[{"inset-x":[E]}],"inset-y":[{"inset-y":[E]}],start:[{start:[E]}],end:[{end:[E]}],top:[{top:[E]}],right:[{right:[E]}],bottom:[{bottom:[E]}],left:[{left:[E]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Zp,Er]}],basis:[{basis:X()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Er]}],grow:[{grow:re()}],shrink:[{shrink:re()}],order:[{order:["first","last","none",Zp,Er]}],"grid-cols":[{"grid-cols":[Kp]}],"col-start-end":[{col:["auto",{span:["full",Zp,Er]},Er]}],"col-start":[{"col-start":H()}],"col-end":[{"col-end":H()}],"grid-rows":[{"grid-rows":[Kp]}],"row-start-end":[{row:["auto",{span:[Zp,Er]},Er]}],"row-start":[{"row-start":H()}],"row-end":[{"row-end":H()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Er]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Er]}],gap:[{gap:[m]}],"gap-x":[{"gap-x":[m]}],"gap-y":[{"gap-y":[m]}],"justify-content":[{justify:["normal",...z()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...z(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...z(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[b]}],px:[{px:[b]}],py:[{py:[b]}],ps:[{ps:[b]}],pe:[{pe:[b]}],pt:[{pt:[b]}],pr:[{pr:[b]}],pb:[{pb:[b]}],pl:[{pl:[b]}],m:[{m:[T]}],mx:[{mx:[T]}],my:[{my:[T]}],ms:[{ms:[T]}],me:[{me:[T]}],mt:[{mt:[T]}],mr:[{mr:[T]}],mb:[{mb:[T]}],ml:[{ml:[T]}],"space-x":[{"space-x":[D]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[D]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Er,t]}],"min-w":[{"min-w":[Er,t,"min","max","fit"]}],"max-w":[{"max-w":[Er,t,"none","full","min","max","fit","prose",{screen:[pl]},pl]}],h:[{h:[Er,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Er,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Er,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Er,t,"auto","min","max","fit"]}],"font-size":[{text:["base",pl,hl]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",ib]}],"font-family":[{font:[Kp]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Er]}],"line-clamp":[{"line-clamp":["none",Ld,ib]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Js,Er]}],"list-image":[{"list-image":["none",Er]}],"list-style-type":[{list:["none","disc","decimal",Er]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[A]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[A]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...O(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Js,hl]}],"underline-offset":[{"underline-offset":["auto",Js,Er]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:x()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Er]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Er]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[A]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...pe(),pse]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",hse]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},mse]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[y]}],"gradient-via-pos":[{via:[y]}],"gradient-to-pos":[{to:[y]}],"gradient-from":[{from:[_]}],"gradient-via":[{via:[_]}],"gradient-to":[{to:[_]}],rounded:[{rounded:[a]}],"rounded-s":[{"rounded-s":[a]}],"rounded-e":[{"rounded-e":[a]}],"rounded-t":[{"rounded-t":[a]}],"rounded-r":[{"rounded-r":[a]}],"rounded-b":[{"rounded-b":[a]}],"rounded-l":[{"rounded-l":[a]}],"rounded-ss":[{"rounded-ss":[a]}],"rounded-se":[{"rounded-se":[a]}],"rounded-ee":[{"rounded-ee":[a]}],"rounded-es":[{"rounded-es":[a]}],"rounded-tl":[{"rounded-tl":[a]}],"rounded-tr":[{"rounded-tr":[a]}],"rounded-br":[{"rounded-br":[a]}],"rounded-bl":[{"rounded-bl":[a]}],"border-w":[{border:[l]}],"border-w-x":[{"border-x":[l]}],"border-w-y":[{"border-y":[l]}],"border-w-s":[{"border-s":[l]}],"border-w-e":[{"border-e":[l]}],"border-w-t":[{"border-t":[l]}],"border-w-r":[{"border-r":[l]}],"border-w-b":[{"border-b":[l]}],"border-w-l":[{"border-l":[l]}],"border-opacity":[{"border-opacity":[A]}],"border-style":[{border:[...O(),"hidden"]}],"divide-x":[{"divide-x":[l]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[l]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[A]}],"divide-style":[{divide:O()}],"border-color":[{border:[i]}],"border-color-x":[{"border-x":[i]}],"border-color-y":[{"border-y":[i]}],"border-color-s":[{"border-s":[i]}],"border-color-e":[{"border-e":[i]}],"border-color-t":[{"border-t":[i]}],"border-color-r":[{"border-r":[i]}],"border-color-b":[{"border-b":[i]}],"border-color-l":[{"border-l":[i]}],"divide-color":[{divide:[i]}],"outline-style":[{outline:["",...O()]}],"outline-offset":[{"outline-offset":[Js,Er]}],"outline-w":[{outline:[Js,hl]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:P()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[A]}],"ring-offset-w":[{"ring-offset":[Js,hl]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",pl,_se]}],"shadow-color":[{shadow:[Kp]}],opacity:[{opacity:[A]}],"mix-blend":[{"mix-blend":[...F(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":F()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[n]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",pl,Er]}],grayscale:[{grayscale:[d]}],"hue-rotate":[{"hue-rotate":[p]}],invert:[{invert:[h]}],saturate:[{saturate:[R]}],sepia:[{sepia:[B]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[n]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[d]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[p]}],"backdrop-invert":[{"backdrop-invert":[h]}],"backdrop-opacity":[{"backdrop-opacity":[A]}],"backdrop-saturate":[{"backdrop-saturate":[R]}],"backdrop-sepia":[{"backdrop-sepia":[B]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[s]}],"border-spacing-x":[{"border-spacing-x":[s]}],"border-spacing-y":[{"border-spacing-y":[s]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Er]}],duration:[{duration:_e()}],ease:[{ease:["linear","in","out","in-out",Er]}],delay:[{delay:_e()}],animate:[{animate:["none","spin","ping","pulse","bounce",Er]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[M]}],"scale-x":[{"scale-x":[M]}],"scale-y":[{"scale-y":[M]}],rotate:[{rotate:[Zp,Er]}],"translate-x":[{"translate-x":[U]}],"translate-y":[{"translate-y":[U]}],"skew-x":[{"skew-x":[w]}],"skew-y":[{"skew-y":[w]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Er]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Er]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":x()}],"scroll-mx":[{"scroll-mx":x()}],"scroll-my":[{"scroll-my":x()}],"scroll-ms":[{"scroll-ms":x()}],"scroll-me":[{"scroll-me":x()}],"scroll-mt":[{"scroll-mt":x()}],"scroll-mr":[{"scroll-mr":x()}],"scroll-mb":[{"scroll-mb":x()}],"scroll-ml":[{"scroll-ml":x()}],"scroll-p":[{"scroll-p":x()}],"scroll-px":[{"scroll-px":x()}],"scroll-py":[{"scroll-py":x()}],"scroll-ps":[{"scroll-ps":x()}],"scroll-pe":[{"scroll-pe":x()}],"scroll-pt":[{"scroll-pt":x()}],"scroll-pr":[{"scroll-pr":x()}],"scroll-pb":[{"scroll-pb":x()}],"scroll-pl":[{"scroll-pl":x()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Er]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[Js,hl,ib]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},Sse=nse(Tse);function Gr(...e){return Sse(UF(e))}const Ase=kF("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),bse=q.forwardRef(({className:e,variant:t,size:r,asChild:n=!1,...i},a)=>{const s=n?koe:"button";return Le.jsx(s,{className:Gr(Ase({variant:t,size:r,className:e})),ref:a,...i})});bse.displayName="Button";const xse=q.forwardRef(({className:e,type:t,...r},n)=>Le.jsx("input",{type:t,className:Gr("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:n,...r}));xse.displayName="Input";const Rse=q.forwardRef(({className:e,...t},r)=>Le.jsx("div",{ref:r,className:Gr("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));Rse.displayName="Card";const Cse=q.forwardRef(({className:e,...t},r)=>Le.jsx("div",{ref:r,className:Gr("flex flex-col space-y-1.5 p-6",e),...t}));Cse.displayName="CardHeader";const Ose=q.forwardRef(({className:e,...t},r)=>Le.jsx("div",{ref:r,className:Gr("text-2xl font-semibold leading-none tracking-tight",e),...t}));Ose.displayName="CardTitle";const Mse=q.forwardRef(({className:e,...t},r)=>Le.jsx("div",{ref:r,className:Gr("text-sm text-muted-foreground",e),...t}));Mse.displayName="CardDescription";const wse=q.forwardRef(({className:e,...t},r)=>Le.jsx("div",{ref:r,className:Gr("p-6 pt-0",e),...t}));wse.displayName="CardContent";const Nse=q.forwardRef(({className:e,...t},r)=>Le.jsx("div",{ref:r,className:Gr("flex items-center p-6 pt-0",e),...t}));Nse.displayName="CardFooter";var Ise=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Nr=Ise.reduce((e,t)=>{const r=Jd(`Primitive.${t}`),n=q.forwardRef((i,a)=>{const{asChild:s,...l}=i,c=s?r:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),Le.jsx(c,{...l,ref:a})});return n.displayName=`Primitive.${t}`,{...e,[t]:n}},{});function Pse(e,t){e&&th.flushSync(()=>e.dispatchEvent(t))}var Dse="Label",GF=q.forwardRef((e,t)=>Le.jsx(Nr.label,{...e,ref:t,onMouseDown:r=>{r.target.closest("button, input, select, textarea")||(e.onMouseDown?.(r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));GF.displayName=Dse;var qF=GF;const Lse=kF("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Bse=q.forwardRef(({className:e,...t},r)=>Le.jsx(qF,{ref:r,className:Gr(Lse(),e),...t}));Bse.displayName=qF.displayName;function Fse(e,t){const r=q.createContext(t),n=a=>{const{children:s,...l}=a,c=q.useMemo(()=>l,Object.values(l));return Le.jsx(r.Provider,{value:c,children:s})};n.displayName=e+"Provider";function i(a){const s=q.useContext(r);if(s)return s;if(t!==void 0)return t;throw new Error(`\`${a}\` must be used within \`${e}\``)}return[n,i]}function Kc(e,t=[]){let r=[];function n(a,s){const l=q.createContext(s),c=r.length;r=[...r,s];const d=h=>{const{scope:m,children:_,...y}=h,E=m?.[e]?.[c]||l,T=q.useMemo(()=>y,Object.values(y));return Le.jsx(E.Provider,{value:T,children:_})};d.displayName=a+"Provider";function p(h,m){const _=m?.[e]?.[c]||l,y=q.useContext(_);if(y)return y;if(s!==void 0)return s;throw new Error(`\`${h}\` must be used within \`${a}\``)}return[d,p]}const i=()=>{const a=r.map(s=>q.createContext(s));return function(s){const l=s?.[e]||a;return q.useMemo(()=>({[`__scope${e}`]:{...s,[e]:l}}),[s,l])}};return i.scopeName=e,[n,Use(i,...t)]}function Use(...e){const t=e[0];if(e.length===1)return t;const r=()=>{const n=e.map(i=>({useScope:i(),scopeName:i.scopeName}));return function(i){const a=n.reduce((s,{useScope:l,scopeName:c})=>{const d=l(i)[`__scope${c}`];return{...s,...d}},{});return q.useMemo(()=>({[`__scope${t.scopeName}`]:a}),[a])}};return r.scopeName=t.scopeName,r}function Nl(e){const t=q.useRef(e);return q.useEffect(()=>{t.current=e}),q.useMemo(()=>(...r)=>t.current?.(...r),[])}var ni=globalThis?.document?q.useLayoutEffect:()=>{},cD={exports:{}},ab={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fD;function kse(){if(fD)return ab;fD=1;var e=ua;function t(h,m){return h===m&&(h!==0||1/h===1/m)||h!==h&&m!==m}var r=typeof Object.is=="function"?Object.is:t,n=e.useState,i=e.useEffect,a=e.useLayoutEffect,s=e.useDebugValue;function l(h,m){var _=m(),y=n({inst:{value:_,getSnapshot:m}}),E=y[0].inst,T=y[1];return a(function(){E.value=_,E.getSnapshot=m,c(E)&&T({inst:E})},[h,_,m]),i(function(){return c(E)&&T({inst:E}),h(function(){c(E)&&T({inst:E})})},[h]),s(_),_}function c(h){var m=h.getSnapshot;h=h.value;try{var _=m();return!r(h,_)}catch{return!0}}function d(h,m){return m()}var p=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?d:l;return ab.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:p,ab}var dD;function zse(){return dD||(dD=1,cD.exports=kse()),cD.exports}var jse=zse();function Hse(){return jse.useSyncExternalStore(Vse,()=>!0,()=>!1)}function Vse(){return()=>{}}var kR="Avatar",[Xse]=Kc(kR),[Gse,WF]=Xse(kR),YF=q.forwardRef((e,t)=>{const{__scopeAvatar:r,...n}=e,[i,a]=q.useState("idle");return Le.jsx(Gse,{scope:r,imageLoadingStatus:i,onImageLoadingStatusChange:a,children:Le.jsx(Nr.span,{...n,ref:t})})});YF.displayName=kR;var $F="AvatarImage",ZF=q.forwardRef((e,t)=>{const{__scopeAvatar:r,src:n,onLoadingStatusChange:i=()=>{},...a}=e,s=WF($F,r),l=qse(n,a),c=Nl(d=>{i(d),s.onImageLoadingStatusChange(d)});return ni(()=>{l!=="idle"&&c(l)},[l,c]),l==="loaded"?Le.jsx(Nr.img,{...a,ref:t,src:n}):null});ZF.displayName=$F;var KF="AvatarFallback",QF=q.forwardRef((e,t)=>{const{__scopeAvatar:r,delayMs:n,...i}=e,a=WF(KF,r),[s,l]=q.useState(n===void 0);return q.useEffect(()=>{if(n!==void 0){const c=window.setTimeout(()=>l(!0),n);return()=>window.clearTimeout(c)}},[n]),s&&a.imageLoadingStatus!=="loaded"?Le.jsx(Nr.span,{...i,ref:t}):null});QF.displayName=KF;function hD(e,t){return e?t?(e.src!==t&&(e.src=t),e.complete&&e.naturalWidth>0?"loaded":"loading"):"error":"idle"}function qse(e,{referrerPolicy:t,crossOrigin:r}){const n=Hse(),i=q.useRef(null),a=n?(i.current||(i.current=new window.Image),i.current):null,[s,l]=q.useState(()=>hD(a,e));return ni(()=>{l(hD(a,e))},[a,e]),ni(()=>{const c=h=>()=>{l(h)};if(!a)return;const d=c("loaded"),p=c("error");return a.addEventListener("load",d),a.addEventListener("error",p),t&&(a.referrerPolicy=t),typeof r=="string"&&(a.crossOrigin=r),()=>{a.removeEventListener("load",d),a.removeEventListener("error",p)}},[a,r,t]),s}var JF=YF,e5=ZF,t5=QF;const Wse=q.forwardRef(({className:e,...t},r)=>Le.jsx(JF,{ref:r,className:Gr("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",e),...t}));Wse.displayName=JF.displayName;const Yse=q.forwardRef(({className:e,...t},r)=>Le.jsx(e5,{ref:r,className:Gr("aspect-square h-full w-full",e),...t}));Yse.displayName=e5.displayName;const $se=q.forwardRef(({className:e,...t},r)=>Le.jsx(t5,{ref:r,className:Gr("flex h-full w-full items-center justify-center rounded-full bg-muted",e),...t}));$se.displayName=t5.displayName;function Jr(e,t,{checkForDefaultPrevented:r=!0}={}){return function(n){if(e?.(n),r===!1||!n.defaultPrevented)return t?.(n)}}var Zse=WD[" useId ".trim().toString()]||(()=>{}),Kse=0;function r5(e){const[t,r]=q.useState(Zse());return ni(()=>{r(n=>n??String(Kse++))},[e]),t?`radix-${t}`:""}var Qse=WD[" useInsertionEffect ".trim().toString()]||ni;function n5({prop:e,defaultProp:t,onChange:r=()=>{},caller:n}){const[i,a,s]=Jse({defaultProp:t,onChange:r}),l=e!==void 0,c=l?e:i;{const p=q.useRef(e!==void 0);q.useEffect(()=>{const h=p.current;h!==l&&console.warn(`${n} is changing from ${h?"controlled":"uncontrolled"} to ${l?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),p.current=l},[l,n])}const d=q.useCallback(p=>{if(l){const h=eue(p)?p(e):p;h!==e&&s.current?.(h)}else a(p)},[l,e,a,s]);return[c,d]}function Jse({defaultProp:e,onChange:t}){const[r,n]=q.useState(e),i=q.useRef(r),a=q.useRef(t);return Qse(()=>{a.current=t},[t]),q.useEffect(()=>{i.current!==r&&(a.current?.(r),i.current=r)},[r,i]),[r,n,a]}function eue(e){return typeof e=="function"}function tue(e,t=globalThis?.document){const r=Nl(e);q.useEffect(()=>{const n=i=>{i.key==="Escape"&&r(i)};return t.addEventListener("keydown",n,{capture:!0}),()=>t.removeEventListener("keydown",n,{capture:!0})},[r,t])}var rue="DismissableLayer",gx="dismissableLayer.update",nue="dismissableLayer.pointerDownOutside",iue="dismissableLayer.focusOutside",pD,i5=q.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),zR=q.forwardRef((e,t)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:n,onPointerDownOutside:i,onFocusOutside:a,onInteractOutside:s,onDismiss:l,...c}=e,d=q.useContext(i5),[p,h]=q.useState(null),m=p?.ownerDocument??globalThis?.document,[,_]=q.useState({}),y=gn(t,D=>h(D)),E=Array.from(d.layers),[T]=[...d.layersWithOutsidePointerEventsDisabled].slice(-1),A=E.indexOf(T),b=p?E.indexOf(p):-1,R=d.layersWithOutsidePointerEventsDisabled.size>0,M=b>=A,B=sue(D=>{const U=D.target,ae=[...d.branches].some(Q=>Q.contains(U));!M||ae||(i?.(D),s?.(D),D.defaultPrevented||l?.())},m),w=uue(D=>{const U=D.target;[...d.branches].some(ae=>ae.contains(U))||(a?.(D),s?.(D),D.defaultPrevented||l?.())},m);return tue(D=>{b===d.layers.size-1&&(n?.(D),!D.defaultPrevented&&l&&(D.preventDefault(),l()))},m),q.useEffect(()=>{if(p)return r&&(d.layersWithOutsidePointerEventsDisabled.size===0&&(pD=m.body.style.pointerEvents,m.body.style.pointerEvents="none"),d.layersWithOutsidePointerEventsDisabled.add(p)),d.layers.add(p),vD(),()=>{r&&d.layersWithOutsidePointerEventsDisabled.size===1&&(m.body.style.pointerEvents=pD)}},[p,m,r,d]),q.useEffect(()=>()=>{p&&(d.layers.delete(p),d.layersWithOutsidePointerEventsDisabled.delete(p),vD())},[p,d]),q.useEffect(()=>{const D=()=>_({});return document.addEventListener(gx,D),()=>document.removeEventListener(gx,D)},[]),Le.jsx(Nr.div,{...c,ref:y,style:{pointerEvents:R?M?"auto":"none":void 0,...e.style},onFocusCapture:Jr(e.onFocusCapture,w.onFocusCapture),onBlurCapture:Jr(e.onBlurCapture,w.onBlurCapture),onPointerDownCapture:Jr(e.onPointerDownCapture,B.onPointerDownCapture)})});zR.displayName=rue;var aue="DismissableLayerBranch",oue=q.forwardRef((e,t)=>{const r=q.useContext(i5),n=q.useRef(null),i=gn(t,n);return q.useEffect(()=>{const a=n.current;if(a)return r.branches.add(a),()=>{r.branches.delete(a)}},[r.branches]),Le.jsx(Nr.div,{...e,ref:i})});oue.displayName=aue;function sue(e,t=globalThis?.document){const r=Nl(e),n=q.useRef(!1),i=q.useRef(()=>{});return q.useEffect(()=>{const a=l=>{if(l.target&&!n.current){let c=function(){a5(nue,r,d,{discrete:!0})};const d={originalEvent:l};l.pointerType==="touch"?(t.removeEventListener("click",i.current),i.current=c,t.addEventListener("click",i.current,{once:!0})):c()}else t.removeEventListener("click",i.current);n.current=!1},s=window.setTimeout(()=>{t.addEventListener("pointerdown",a)},0);return()=>{window.clearTimeout(s),t.removeEventListener("pointerdown",a),t.removeEventListener("click",i.current)}},[t,r]),{onPointerDownCapture:()=>n.current=!0}}function uue(e,t=globalThis?.document){const r=Nl(e),n=q.useRef(!1);return q.useEffect(()=>{const i=a=>{a.target&&!n.current&&a5(iue,r,{originalEvent:a},{discrete:!1})};return t.addEventListener("focusin",i),()=>t.removeEventListener("focusin",i)},[t,r]),{onFocusCapture:()=>n.current=!0,onBlurCapture:()=>n.current=!1}}function vD(){const e=new CustomEvent(gx);document.dispatchEvent(e)}function a5(e,t,r,{discrete:n}){const i=r.originalEvent.target,a=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:r});t&&i.addEventListener(e,t,{once:!0}),n?Pse(i,a):i.dispatchEvent(a)}var ob="focusScope.autoFocusOnMount",sb="focusScope.autoFocusOnUnmount",mD={bubbles:!1,cancelable:!0},lue="FocusScope",jR=q.forwardRef((e,t)=>{const{loop:r=!1,trapped:n=!1,onMountAutoFocus:i,onUnmountAutoFocus:a,...s}=e,[l,c]=q.useState(null),d=Nl(i),p=Nl(a),h=q.useRef(null),m=gn(t,E=>c(E)),_=q.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;q.useEffect(()=>{if(n){let E=function(R){if(_.paused||!l)return;const M=R.target;l.contains(M)?h.current=M:vl(h.current,{select:!0})},T=function(R){if(_.paused||!l)return;const M=R.relatedTarget;M!==null&&(l.contains(M)||vl(h.current,{select:!0}))},A=function(R){if(document.activeElement===document.body)for(const M of R)M.removedNodes.length>0&&vl(l)};document.addEventListener("focusin",E),document.addEventListener("focusout",T);const b=new MutationObserver(A);return l&&b.observe(l,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",E),document.removeEventListener("focusout",T),b.disconnect()}}},[n,l,_.paused]),q.useEffect(()=>{if(l){gD.add(_);const E=document.activeElement;if(!l.contains(E)){const T=new CustomEvent(ob,mD);l.addEventListener(ob,d),l.dispatchEvent(T),T.defaultPrevented||(cue(vue(o5(l)),{select:!0}),document.activeElement===E&&vl(l))}return()=>{l.removeEventListener(ob,d),setTimeout(()=>{const T=new CustomEvent(sb,mD);l.addEventListener(sb,p),l.dispatchEvent(T),T.defaultPrevented||vl(E??document.body,{select:!0}),l.removeEventListener(sb,p),gD.remove(_)},0)}}},[l,d,p,_]);const y=q.useCallback(E=>{if(!r&&!n||_.paused)return;const T=E.key==="Tab"&&!E.altKey&&!E.ctrlKey&&!E.metaKey,A=document.activeElement;if(T&&A){const b=E.currentTarget,[R,M]=fue(b);R&&M?!E.shiftKey&&A===M?(E.preventDefault(),r&&vl(R,{select:!0})):E.shiftKey&&A===R&&(E.preventDefault(),r&&vl(M,{select:!0})):A===b&&E.preventDefault()}},[r,n,_.paused]);return Le.jsx(Nr.div,{tabIndex:-1,...s,ref:m,onKeyDown:y})});jR.displayName=lue;function cue(e,{select:t=!1}={}){const r=document.activeElement;for(const n of e)if(vl(n,{select:t}),document.activeElement!==r)return}function fue(e){const t=o5(e),r=_D(t,e),n=_D(t.reverse(),e);return[r,n]}function o5(e){const t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:n=>{const i=n.tagName==="INPUT"&&n.type==="hidden";return n.disabled||n.hidden||i?NodeFilter.FILTER_SKIP:n.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)t.push(r.currentNode);return t}function _D(e,t){for(const r of e)if(!due(r,{upTo:t}))return r}function due(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function hue(e){return e instanceof HTMLInputElement&&"select"in e}function vl(e,{select:t=!1}={}){if(e&&e.focus){const r=document.activeElement;e.focus({preventScroll:!0}),e!==r&&hue(e)&&t&&e.select()}}var gD=pue();function pue(){let e=[];return{add(t){const r=e[0];t!==r&&r?.pause(),e=yD(e,t),e.unshift(t)},remove(t){e=yD(e,t),e[0]?.resume()}}}function yD(e,t){const r=[...e],n=r.indexOf(t);return n!==-1&&r.splice(n,1),r}function vue(e){return e.filter(t=>t.tagName!=="A")}var mue="Portal",HR=q.forwardRef((e,t)=>{const{container:r,...n}=e,[i,a]=q.useState(!1);ni(()=>a(!0),[]);const s=r||i&&globalThis?.document?.body;return s?qk.createPortal(Le.jsx(Nr.div,{...n,ref:t}),s):null});HR.displayName=mue;function _ue(e,t){return q.useReducer((r,n)=>t[r][n]??r,e)}var Jv=e=>{const{present:t,children:r}=e,n=gue(t),i=typeof r=="function"?r({present:n.isPresent}):q.Children.only(r),a=gn(n.ref,yue(i));return typeof r=="function"||n.isPresent?q.cloneElement(i,{ref:a}):null};Jv.displayName="Presence";function gue(e){const[t,r]=q.useState(),n=q.useRef(null),i=q.useRef(e),a=q.useRef("none"),s=e?"mounted":"unmounted",[l,c]=_ue(s,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return q.useEffect(()=>{const d=Q_(n.current);a.current=l==="mounted"?d:"none"},[l]),ni(()=>{const d=n.current,p=i.current;if(p!==e){const h=a.current,m=Q_(d);e?c("MOUNT"):m==="none"||d?.display==="none"?c("UNMOUNT"):c(p&&h!==m?"ANIMATION_OUT":"UNMOUNT"),i.current=e}},[e,c]),ni(()=>{if(t){let d;const p=t.ownerDocument.defaultView??window,h=_=>{const y=Q_(n.current).includes(CSS.escape(_.animationName));if(_.target===t&&y&&(c("ANIMATION_END"),!i.current)){const E=t.style.animationFillMode;t.style.animationFillMode="forwards",d=p.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=E)})}},m=_=>{_.target===t&&(a.current=Q_(n.current))};return t.addEventListener("animationstart",m),t.addEventListener("animationcancel",h),t.addEventListener("animationend",h),()=>{p.clearTimeout(d),t.removeEventListener("animationstart",m),t.removeEventListener("animationcancel",h),t.removeEventListener("animationend",h)}}else c("ANIMATION_END")},[t,c]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:q.useCallback(d=>{n.current=d?getComputedStyle(d):null,r(d)},[])}}function Q_(e){return e?.animationName||"none"}function yue(e){let t=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=Object.getOwnPropertyDescriptor(e,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}var ub=0;function s5(){q.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??ED()),document.body.insertAdjacentElement("beforeend",e[1]??ED()),ub++,()=>{ub===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),ub--}},[])}function ED(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var us=function(){return us=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++){t=arguments[r];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},us.apply(this,arguments)};function u5(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function Eue(e,t,r){for(var n=0,i=t.length,a;n<i;n++)(a||!(n in t))&&(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))}var T0="right-scroll-bar-position",S0="width-before-scroll-bar",Tue="with-scroll-bars-hidden",Sue="--removed-body-scroll-bar-size";function lb(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function Aue(e,t){var r=q.useState(function(){return{value:e,callback:t,facade:{get current(){return r.value},set current(n){var i=r.value;i!==n&&(r.value=n,r.callback(n,i))}}}})[0];return r.callback=t,r.facade}var bue=typeof window<"u"?q.useLayoutEffect:q.useEffect,TD=new WeakMap;function xue(e,t){var r=Aue(null,function(n){return e.forEach(function(i){return lb(i,n)})});return bue(function(){var n=TD.get(r);if(n){var i=new Set(n),a=new Set(e),s=r.current;i.forEach(function(l){a.has(l)||lb(l,null)}),a.forEach(function(l){i.has(l)||lb(l,s)})}TD.set(r,e)},[e]),r}function Rue(e){return e}function Cue(e,t){t===void 0&&(t=Rue);var r=[],n=!1,i={read:function(){if(n)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:e},useMedium:function(a){var s=t(a,n);return r.push(s),function(){r=r.filter(function(l){return l!==s})}},assignSyncMedium:function(a){for(n=!0;r.length;){var s=r;r=[],s.forEach(a)}r={push:function(l){return a(l)},filter:function(){return r}}},assignMedium:function(a){n=!0;var s=[];if(r.length){var l=r;r=[],l.forEach(a),s=r}var c=function(){var p=s;s=[],p.forEach(a)},d=function(){return Promise.resolve().then(c)};d(),r={push:function(p){s.push(p),d()},filter:function(p){return s=s.filter(p),r}}}};return i}function Oue(e){e===void 0&&(e={});var t=Cue(null);return t.options=us({async:!0,ssr:!1},e),t}var l5=function(e){var t=e.sideCar,r=u5(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var n=t.read();if(!n)throw new Error("Sidecar medium not found");return q.createElement(n,us({},r))};l5.isSideCarExport=!0;function Mue(e,t){return e.useMedium(t),l5}var c5=Oue(),cb=function(){},Zg=q.forwardRef(function(e,t){var r=q.useRef(null),n=q.useState({onScrollCapture:cb,onWheelCapture:cb,onTouchMoveCapture:cb}),i=n[0],a=n[1],s=e.forwardProps,l=e.children,c=e.className,d=e.removeScrollBar,p=e.enabled,h=e.shards,m=e.sideCar,_=e.noRelative,y=e.noIsolation,E=e.inert,T=e.allowPinchZoom,A=e.as,b=A===void 0?"div":A,R=e.gapMode,M=u5(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),B=m,w=xue([r,t]),D=us(us({},M),i);return q.createElement(q.Fragment,null,p&&q.createElement(B,{sideCar:c5,removeScrollBar:d,shards:h,noRelative:_,noIsolation:y,inert:E,setCallbacks:a,allowPinchZoom:!!T,lockRef:r,gapMode:R}),s?q.cloneElement(q.Children.only(l),us(us({},D),{ref:w})):q.createElement(b,us({},D,{className:c,ref:w}),l))});Zg.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Zg.classNames={fullWidth:S0,zeroRight:T0};var wue=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function Nue(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=wue();return t&&e.setAttribute("nonce",t),e}function Iue(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function Pue(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var Due=function(){var e=0,t=null;return{add:function(r){e==0&&(t=Nue())&&(Iue(t,r),Pue(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},Lue=function(){var e=Due();return function(t,r){q.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&r])}},f5=function(){var e=Lue(),t=function(r){var n=r.styles,i=r.dynamic;return e(n,i),null};return t},Bue={left:0,top:0,right:0,gap:0},fb=function(e){return parseInt(e||"",10)||0},Fue=function(e){var t=window.getComputedStyle(document.body),r=t[e==="padding"?"paddingLeft":"marginLeft"],n=t[e==="padding"?"paddingTop":"marginTop"],i=t[e==="padding"?"paddingRight":"marginRight"];return[fb(r),fb(n),fb(i)]},Uue=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return Bue;var t=Fue(e),r=document.documentElement.clientWidth,n=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,n-r+t[2]-t[0])}},kue=f5(),Bd="data-scroll-locked",zue=function(e,t,r,n){var i=e.left,a=e.top,s=e.right,l=e.gap;return r===void 0&&(r="margin"),`
  .`.concat(Tue,` {
   overflow: hidden `).concat(n,`;
   padding-right: `).concat(l,"px ").concat(n,`;
  }
  body[`).concat(Bd,`] {
    overflow: hidden `).concat(n,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(n,";"),r==="margin"&&`
    padding-left: `.concat(i,`px;
    padding-top: `).concat(a,`px;
    padding-right: `).concat(s,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(l,"px ").concat(n,`;
    `),r==="padding"&&"padding-right: ".concat(l,"px ").concat(n,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(T0,` {
    right: `).concat(l,"px ").concat(n,`;
  }
  
  .`).concat(S0,` {
    margin-right: `).concat(l,"px ").concat(n,`;
  }
  
  .`).concat(T0," .").concat(T0,` {
    right: 0 `).concat(n,`;
  }
  
  .`).concat(S0," .").concat(S0,` {
    margin-right: 0 `).concat(n,`;
  }
  
  body[`).concat(Bd,`] {
    `).concat(Sue,": ").concat(l,`px;
  }
`)},SD=function(){var e=parseInt(document.body.getAttribute(Bd)||"0",10);return isFinite(e)?e:0},jue=function(){q.useEffect(function(){return document.body.setAttribute(Bd,(SD()+1).toString()),function(){var e=SD()-1;e<=0?document.body.removeAttribute(Bd):document.body.setAttribute(Bd,e.toString())}},[])},Hue=function(e){var t=e.noRelative,r=e.noImportant,n=e.gapMode,i=n===void 0?"margin":n;jue();var a=q.useMemo(function(){return Uue(i)},[i]);return q.createElement(kue,{styles:zue(a,!t,i,r?"":"!important")})},yx=!1;if(typeof window<"u")try{var J_=Object.defineProperty({},"passive",{get:function(){return yx=!0,!0}});window.addEventListener("test",J_,J_),window.removeEventListener("test",J_,J_)}catch{yx=!1}var _d=yx?{passive:!1}:!1,Vue=function(e){return e.tagName==="TEXTAREA"},d5=function(e,t){if(!(e instanceof Element))return!1;var r=window.getComputedStyle(e);return r[t]!=="hidden"&&!(r.overflowY===r.overflowX&&!Vue(e)&&r[t]==="visible")},Xue=function(e){return d5(e,"overflowY")},Gue=function(e){return d5(e,"overflowX")},AD=function(e,t){var r=t.ownerDocument,n=t;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var i=h5(e,n);if(i){var a=p5(e,n),s=a[1],l=a[2];if(s>l)return!0}n=n.parentNode}while(n&&n!==r.body);return!1},que=function(e){var t=e.scrollTop,r=e.scrollHeight,n=e.clientHeight;return[t,r,n]},Wue=function(e){var t=e.scrollLeft,r=e.scrollWidth,n=e.clientWidth;return[t,r,n]},h5=function(e,t){return e==="v"?Xue(t):Gue(t)},p5=function(e,t){return e==="v"?que(t):Wue(t)},Yue=function(e,t){return e==="h"&&t==="rtl"?-1:1},$ue=function(e,t,r,n,i){var a=Yue(e,window.getComputedStyle(t).direction),s=a*n,l=r.target,c=t.contains(l),d=!1,p=s>0,h=0,m=0;do{if(!l)break;var _=p5(e,l),y=_[0],E=_[1],T=_[2],A=E-T-a*y;(y||A)&&h5(e,l)&&(h+=A,m+=y);var b=l.parentNode;l=b&&b.nodeType===Node.DOCUMENT_FRAGMENT_NODE?b.host:b}while(!c&&l!==document.body||c&&(t.contains(l)||t===l));return(p&&Math.abs(h)<1||!p&&Math.abs(m)<1)&&(d=!0),d},e0=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},bD=function(e){return[e.deltaX,e.deltaY]},xD=function(e){return e&&"current"in e?e.current:e},Zue=function(e,t){return e[0]===t[0]&&e[1]===t[1]},Kue=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},Que=0,gd=[];function Jue(e){var t=q.useRef([]),r=q.useRef([0,0]),n=q.useRef(),i=q.useState(Que++)[0],a=q.useState(f5)[0],s=q.useRef(e);q.useEffect(function(){s.current=e},[e]),q.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(i));var E=Eue([e.lockRef.current],(e.shards||[]).map(xD)).filter(Boolean);return E.forEach(function(T){return T.classList.add("allow-interactivity-".concat(i))}),function(){document.body.classList.remove("block-interactivity-".concat(i)),E.forEach(function(T){return T.classList.remove("allow-interactivity-".concat(i))})}}},[e.inert,e.lockRef.current,e.shards]);var l=q.useCallback(function(E,T){if("touches"in E&&E.touches.length===2||E.type==="wheel"&&E.ctrlKey)return!s.current.allowPinchZoom;var A=e0(E),b=r.current,R="deltaX"in E?E.deltaX:b[0]-A[0],M="deltaY"in E?E.deltaY:b[1]-A[1],B,w=E.target,D=Math.abs(R)>Math.abs(M)?"h":"v";if("touches"in E&&D==="h"&&w.type==="range")return!1;var U=AD(D,w);if(!U)return!0;if(U?B=D:(B=D==="v"?"h":"v",U=AD(D,w)),!U)return!1;if(!n.current&&"changedTouches"in E&&(R||M)&&(n.current=B),!B)return!0;var ae=n.current||B;return $ue(ae,T,E,ae==="h"?R:M)},[]),c=q.useCallback(function(E){var T=E;if(!(!gd.length||gd[gd.length-1]!==a)){var A="deltaY"in T?bD(T):e0(T),b=t.current.filter(function(B){return B.name===T.type&&(B.target===T.target||T.target===B.shadowParent)&&Zue(B.delta,A)})[0];if(b&&b.should){T.cancelable&&T.preventDefault();return}if(!b){var R=(s.current.shards||[]).map(xD).filter(Boolean).filter(function(B){return B.contains(T.target)}),M=R.length>0?l(T,R[0]):!s.current.noIsolation;M&&T.cancelable&&T.preventDefault()}}},[]),d=q.useCallback(function(E,T,A,b){var R={name:E,delta:T,target:A,should:b,shadowParent:ele(A)};t.current.push(R),setTimeout(function(){t.current=t.current.filter(function(M){return M!==R})},1)},[]),p=q.useCallback(function(E){r.current=e0(E),n.current=void 0},[]),h=q.useCallback(function(E){d(E.type,bD(E),E.target,l(E,e.lockRef.current))},[]),m=q.useCallback(function(E){d(E.type,e0(E),E.target,l(E,e.lockRef.current))},[]);q.useEffect(function(){return gd.push(a),e.setCallbacks({onScrollCapture:h,onWheelCapture:h,onTouchMoveCapture:m}),document.addEventListener("wheel",c,_d),document.addEventListener("touchmove",c,_d),document.addEventListener("touchstart",p,_d),function(){gd=gd.filter(function(E){return E!==a}),document.removeEventListener("wheel",c,_d),document.removeEventListener("touchmove",c,_d),document.removeEventListener("touchstart",p,_d)}},[]);var _=e.removeScrollBar,y=e.inert;return q.createElement(q.Fragment,null,y?q.createElement(a,{styles:Kue(i)}):null,_?q.createElement(Hue,{noRelative:e.noRelative,gapMode:e.gapMode}):null)}function ele(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const tle=Mue(c5,Jue);var VR=q.forwardRef(function(e,t){return q.createElement(Zg,us({},e,{ref:t,sideCar:tle}))});VR.classNames=Zg.classNames;var rle=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},yd=new WeakMap,t0=new WeakMap,r0={},db=0,v5=function(e){return e&&(e.host||v5(e.parentNode))},nle=function(e,t){return t.map(function(r){if(e.contains(r))return r;var n=v5(r);return n&&e.contains(n)?n:(console.error("aria-hidden",r,"in not contained inside",e,". Doing nothing"),null)}).filter(function(r){return!!r})},ile=function(e,t,r,n){var i=nle(t,Array.isArray(e)?e:[e]);r0[r]||(r0[r]=new WeakMap);var a=r0[r],s=[],l=new Set,c=new Set(i),d=function(h){!h||l.has(h)||(l.add(h),d(h.parentNode))};i.forEach(d);var p=function(h){!h||c.has(h)||Array.prototype.forEach.call(h.children,function(m){if(l.has(m))p(m);else try{var _=m.getAttribute(n),y=_!==null&&_!=="false",E=(yd.get(m)||0)+1,T=(a.get(m)||0)+1;yd.set(m,E),a.set(m,T),s.push(m),E===1&&y&&t0.set(m,!0),T===1&&m.setAttribute(r,"true"),y||m.setAttribute(n,"true")}catch(A){console.error("aria-hidden: cannot operate on ",m,A)}})};return p(t),l.clear(),db++,function(){s.forEach(function(h){var m=yd.get(h)-1,_=a.get(h)-1;yd.set(h,m),a.set(h,_),m||(t0.has(h)||h.removeAttribute(n),t0.delete(h)),_||h.removeAttribute(r)}),db--,db||(yd=new WeakMap,yd=new WeakMap,t0=new WeakMap,r0={})}},m5=function(e,t,r){r===void 0&&(r="data-aria-hidden");var n=Array.from(Array.isArray(e)?e:[e]),i=rle(e);return i?(n.push.apply(n,Array.from(i.querySelectorAll("[aria-live], script"))),ile(n,i,r,"aria-hidden")):function(){return null}},_5="Dialog",[g5]=Kc(_5),[Tde,Bo]=g5(_5),y5="DialogTrigger",ale=q.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,i=Bo(y5,r),a=gn(t,i.triggerRef);return Le.jsx(Nr.button,{type:"button","aria-haspopup":"dialog","aria-expanded":i.open,"aria-controls":i.contentId,"data-state":qR(i.open),...n,ref:a,onClick:Jr(e.onClick,i.onOpenToggle)})});ale.displayName=y5;var XR="DialogPortal",[ole,E5]=g5(XR,{forceMount:void 0}),T5=e=>{const{__scopeDialog:t,forceMount:r,children:n,container:i}=e,a=Bo(XR,t);return Le.jsx(ole,{scope:t,forceMount:r,children:q.Children.map(n,s=>Le.jsx(Jv,{present:r||a.open,children:Le.jsx(HR,{asChild:!0,container:i,children:s})}))})};T5.displayName=XR;var _g="DialogOverlay",S5=q.forwardRef((e,t)=>{const r=E5(_g,e.__scopeDialog),{forceMount:n=r.forceMount,...i}=e,a=Bo(_g,e.__scopeDialog);return a.modal?Le.jsx(Jv,{present:n||a.open,children:Le.jsx(ule,{...i,ref:t})}):null});S5.displayName=_g;var sle=Jd("DialogOverlay.RemoveScroll"),ule=q.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,i=Bo(_g,r);return Le.jsx(VR,{as:sle,allowPinchZoom:!0,shards:[i.contentRef],children:Le.jsx(Nr.div,{"data-state":qR(i.open),...n,ref:t,style:{pointerEvents:"auto",...n.style}})})}),Xc="DialogContent",A5=q.forwardRef((e,t)=>{const r=E5(Xc,e.__scopeDialog),{forceMount:n=r.forceMount,...i}=e,a=Bo(Xc,e.__scopeDialog);return Le.jsx(Jv,{present:n||a.open,children:a.modal?Le.jsx(lle,{...i,ref:t}):Le.jsx(cle,{...i,ref:t})})});A5.displayName=Xc;var lle=q.forwardRef((e,t)=>{const r=Bo(Xc,e.__scopeDialog),n=q.useRef(null),i=gn(t,r.contentRef,n);return q.useEffect(()=>{const a=n.current;if(a)return m5(a)},[]),Le.jsx(b5,{...e,ref:i,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Jr(e.onCloseAutoFocus,a=>{a.preventDefault(),r.triggerRef.current?.focus()}),onPointerDownOutside:Jr(e.onPointerDownOutside,a=>{const s=a.detail.originalEvent,l=s.button===0&&s.ctrlKey===!0;(s.button===2||l)&&a.preventDefault()}),onFocusOutside:Jr(e.onFocusOutside,a=>a.preventDefault())})}),cle=q.forwardRef((e,t)=>{const r=Bo(Xc,e.__scopeDialog),n=q.useRef(!1),i=q.useRef(!1);return Le.jsx(b5,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:a=>{e.onCloseAutoFocus?.(a),a.defaultPrevented||(n.current||r.triggerRef.current?.focus(),a.preventDefault()),n.current=!1,i.current=!1},onInteractOutside:a=>{e.onInteractOutside?.(a),a.defaultPrevented||(n.current=!0,a.detail.originalEvent.type==="pointerdown"&&(i.current=!0));const s=a.target;r.triggerRef.current?.contains(s)&&a.preventDefault(),a.detail.originalEvent.type==="focusin"&&i.current&&a.preventDefault()}})}),b5=q.forwardRef((e,t)=>{const{__scopeDialog:r,trapFocus:n,onOpenAutoFocus:i,onCloseAutoFocus:a,...s}=e,l=Bo(Xc,r),c=q.useRef(null),d=gn(t,c);return s5(),Le.jsxs(Le.Fragment,{children:[Le.jsx(jR,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:i,onUnmountAutoFocus:a,children:Le.jsx(zR,{role:"dialog",id:l.contentId,"aria-describedby":l.descriptionId,"aria-labelledby":l.titleId,"data-state":qR(l.open),...s,ref:d,onDismiss:()=>l.onOpenChange(!1)})}),Le.jsxs(Le.Fragment,{children:[Le.jsx(fle,{titleId:l.titleId}),Le.jsx(hle,{contentRef:c,descriptionId:l.descriptionId})]})]})}),GR="DialogTitle",x5=q.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,i=Bo(GR,r);return Le.jsx(Nr.h2,{id:i.titleId,...n,ref:t})});x5.displayName=GR;var R5="DialogDescription",C5=q.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,i=Bo(R5,r);return Le.jsx(Nr.p,{id:i.descriptionId,...n,ref:t})});C5.displayName=R5;var O5="DialogClose",M5=q.forwardRef((e,t)=>{const{__scopeDialog:r,...n}=e,i=Bo(O5,r);return Le.jsx(Nr.button,{type:"button",...n,ref:t,onClick:Jr(e.onClick,()=>i.onOpenChange(!1))})});M5.displayName=O5;function qR(e){return e?"open":"closed"}var w5="DialogTitleWarning",[Sde,N5]=Fse(w5,{contentName:Xc,titleName:GR,docsSlug:"dialog"}),fle=({titleId:e})=>{const t=N5(w5),r=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return q.useEffect(()=>{e&&(document.getElementById(e)||console.error(r))},[r,e]),null},dle="DialogDescriptionWarning",hle=({contentRef:e,descriptionId:t})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${N5(dle).contentName}}.`;return q.useEffect(()=>{const n=e.current?.getAttribute("aria-describedby");t&&n&&(document.getElementById(t)||console.warn(r))},[r,e,t]),null},ple=T5,I5=S5,P5=A5,D5=x5,L5=C5,vle=M5;/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mle=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),_le=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,n)=>n?n.toUpperCase():r.toLowerCase()),RD=e=>{const t=_le(e);return t.charAt(0).toUpperCase()+t.slice(1)},B5=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim(),gle=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var yle={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ele=q.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:i="",children:a,iconNode:s,...l},c)=>q.createElement("svg",{ref:c,...yle,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:B5("lucide",i),...!a&&!gle(l)&&{"aria-hidden":"true"},...l},[...s.map(([d,p])=>q.createElement(d,p)),...Array.isArray(a)?a:[a]]));/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kg=(e,t)=>{const r=q.forwardRef(({className:n,...i},a)=>q.createElement(Ele,{ref:a,iconNode:t,className:B5(`lucide-${mle(RD(e))}`,`lucide-${e}`,n),...i}));return r.displayName=RD(e),r};/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tle=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],F5=Kg("check",Tle);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sle=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],U5=Kg("chevron-down",Sle);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ale=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],ble=Kg("chevron-up",Ale);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xle=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Rle=Kg("x",xle),Cle=ple,k5=q.forwardRef(({className:e,...t},r)=>Le.jsx(I5,{ref:r,className:Gr("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...t}));k5.displayName=I5.displayName;const Ole=q.forwardRef(({className:e,children:t,...r},n)=>Le.jsxs(Cle,{children:[Le.jsx(k5,{}),Le.jsxs(P5,{ref:n,className:Gr("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...r,children:[t,Le.jsxs(vle,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[Le.jsx(Rle,{className:"h-4 w-4"}),Le.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Ole.displayName=P5.displayName;const Mle=q.forwardRef(({className:e,...t},r)=>Le.jsx(D5,{ref:r,className:Gr("text-lg font-semibold leading-none tracking-tight",e),...t}));Mle.displayName=D5.displayName;const wle=q.forwardRef(({className:e,...t},r)=>Le.jsx(L5,{ref:r,className:Gr("text-sm text-muted-foreground",e),...t}));wle.displayName=L5.displayName;function CD(e,[t,r]){return Math.min(r,Math.max(t,e))}function Nle(e){const t=e+"CollectionProvider",[r,n]=Kc(t),[i,a]=r(t,{collectionRef:{current:null},itemMap:new Map}),s=E=>{const{scope:T,children:A}=E,b=ua.useRef(null),R=ua.useRef(new Map).current;return Le.jsx(i,{scope:T,itemMap:R,collectionRef:b,children:A})};s.displayName=t;const l=e+"CollectionSlot",c=Jd(l),d=ua.forwardRef((E,T)=>{const{scope:A,children:b}=E,R=a(l,A),M=gn(T,R.collectionRef);return Le.jsx(c,{ref:M,children:b})});d.displayName=l;const p=e+"CollectionItemSlot",h="data-radix-collection-item",m=Jd(p),_=ua.forwardRef((E,T)=>{const{scope:A,children:b,...R}=E,M=ua.useRef(null),B=gn(T,M),w=a(p,A);return ua.useEffect(()=>(w.itemMap.set(M,{ref:M,...R}),()=>void w.itemMap.delete(M))),Le.jsx(m,{[h]:"",ref:B,children:b})});_.displayName=p;function y(E){const T=a(e+"CollectionConsumer",E);return ua.useCallback(()=>{const A=T.collectionRef.current;if(!A)return[];const b=Array.from(A.querySelectorAll(`[${h}]`));return Array.from(T.itemMap.values()).sort((R,M)=>b.indexOf(R.ref.current)-b.indexOf(M.ref.current))},[T.collectionRef,T.itemMap])}return[{Provider:s,Slot:d,ItemSlot:_},y,n]}q.createContext(void 0);const Ile=["top","right","bottom","left"],Il=Math.min,Sa=Math.max,gg=Math.round,n0=Math.floor,hs=e=>({x:e,y:e}),Ple={left:"right",right:"left",bottom:"top",top:"bottom"},Dle={start:"end",end:"start"};function Ex(e,t,r){return Sa(e,Il(t,r))}function ou(e,t){return typeof e=="function"?e(t):e}function su(e){return e.split("-")[0]}function sh(e){return e.split("-")[1]}function WR(e){return e==="x"?"y":"x"}function YR(e){return e==="y"?"height":"width"}const Lle=new Set(["top","bottom"]);function cs(e){return Lle.has(su(e))?"y":"x"}function $R(e){return WR(cs(e))}function Ble(e,t,r){r===void 0&&(r=!1);const n=sh(e),i=$R(e),a=YR(i);let s=i==="x"?n===(r?"end":"start")?"right":"left":n==="start"?"bottom":"top";return t.reference[a]>t.floating[a]&&(s=yg(s)),[s,yg(s)]}function Fle(e){const t=yg(e);return[Tx(e),t,Tx(t)]}function Tx(e){return e.replace(/start|end/g,t=>Dle[t])}const OD=["left","right"],MD=["right","left"],Ule=["top","bottom"],kle=["bottom","top"];function zle(e,t,r){switch(e){case"top":case"bottom":return r?t?MD:OD:t?OD:MD;case"left":case"right":return t?Ule:kle;default:return[]}}function jle(e,t,r,n){const i=sh(e);let a=zle(su(e),r==="start",n);return i&&(a=a.map(s=>s+"-"+i),t&&(a=a.concat(a.map(Tx)))),a}function yg(e){return e.replace(/left|right|bottom|top/g,t=>Ple[t])}function Hle(e){return{top:0,right:0,bottom:0,left:0,...e}}function z5(e){return typeof e!="number"?Hle(e):{top:e,right:e,bottom:e,left:e}}function Eg(e){const{x:t,y:r,width:n,height:i}=e;return{width:n,height:i,top:r,left:t,right:t+n,bottom:r+i,x:t,y:r}}function wD(e,t,r){let{reference:n,floating:i}=e;const a=cs(t),s=$R(t),l=YR(s),c=su(t),d=a==="y",p=n.x+n.width/2-i.width/2,h=n.y+n.height/2-i.height/2,m=n[l]/2-i[l]/2;let _;switch(c){case"top":_={x:p,y:n.y-i.height};break;case"bottom":_={x:p,y:n.y+n.height};break;case"right":_={x:n.x+n.width,y:h};break;case"left":_={x:n.x-i.width,y:h};break;default:_={x:n.x,y:n.y}}switch(sh(t)){case"start":_[s]-=m*(r&&d?-1:1);break;case"end":_[s]+=m*(r&&d?-1:1);break}return _}const Vle=async(e,t,r)=>{const{placement:n="bottom",strategy:i="absolute",middleware:a=[],platform:s}=r,l=a.filter(Boolean),c=await(s.isRTL==null?void 0:s.isRTL(t));let d=await s.getElementRects({reference:e,floating:t,strategy:i}),{x:p,y:h}=wD(d,n,c),m=n,_={},y=0;for(let E=0;E<l.length;E++){const{name:T,fn:A}=l[E],{x:b,y:R,data:M,reset:B}=await A({x:p,y:h,initialPlacement:n,placement:m,strategy:i,middlewareData:_,rects:d,platform:s,elements:{reference:e,floating:t}});p=b??p,h=R??h,_={..._,[T]:{..._[T],...M}},B&&y<=50&&(y++,typeof B=="object"&&(B.placement&&(m=B.placement),B.rects&&(d=B.rects===!0?await s.getElementRects({reference:e,floating:t,strategy:i}):B.rects),{x:p,y:h}=wD(d,m,c)),E=-1)}return{x:p,y:h,placement:m,strategy:i,middlewareData:_}};async function zv(e,t){var r;t===void 0&&(t={});const{x:n,y:i,platform:a,rects:s,elements:l,strategy:c}=e,{boundary:d="clippingAncestors",rootBoundary:p="viewport",elementContext:h="floating",altBoundary:m=!1,padding:_=0}=ou(t,e),y=z5(_),E=l[m?h==="floating"?"reference":"floating":h],T=Eg(await a.getClippingRect({element:(r=await(a.isElement==null?void 0:a.isElement(E)))==null||r?E:E.contextElement||await(a.getDocumentElement==null?void 0:a.getDocumentElement(l.floating)),boundary:d,rootBoundary:p,strategy:c})),A=h==="floating"?{x:n,y:i,width:s.floating.width,height:s.floating.height}:s.reference,b=await(a.getOffsetParent==null?void 0:a.getOffsetParent(l.floating)),R=await(a.isElement==null?void 0:a.isElement(b))?await(a.getScale==null?void 0:a.getScale(b))||{x:1,y:1}:{x:1,y:1},M=Eg(a.convertOffsetParentRelativeRectToViewportRelativeRect?await a.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:A,offsetParent:b,strategy:c}):A);return{top:(T.top-M.top+y.top)/R.y,bottom:(M.bottom-T.bottom+y.bottom)/R.y,left:(T.left-M.left+y.left)/R.x,right:(M.right-T.right+y.right)/R.x}}const Xle=e=>({name:"arrow",options:e,async fn(t){const{x:r,y:n,placement:i,rects:a,platform:s,elements:l,middlewareData:c}=t,{element:d,padding:p=0}=ou(e,t)||{};if(d==null)return{};const h=z5(p),m={x:r,y:n},_=$R(i),y=YR(_),E=await s.getDimensions(d),T=_==="y",A=T?"top":"left",b=T?"bottom":"right",R=T?"clientHeight":"clientWidth",M=a.reference[y]+a.reference[_]-m[_]-a.floating[y],B=m[_]-a.reference[_],w=await(s.getOffsetParent==null?void 0:s.getOffsetParent(d));let D=w?w[R]:0;(!D||!await(s.isElement==null?void 0:s.isElement(w)))&&(D=l.floating[R]||a.floating[y]);const U=M/2-B/2,ae=D/2-E[y]/2-1,Q=Il(h[A],ae),X=Il(h[b],ae),x=Q,P=D-E[y]-X,H=D/2-E[y]/2+U,pe=Ex(x,H,P),O=!c.arrow&&sh(i)!=null&&H!==pe&&a.reference[y]/2-(H<x?Q:X)-E[y]/2<0,F=O?H<x?H-x:H-P:0;return{[_]:m[_]+F,data:{[_]:pe,centerOffset:H-pe-F,...O&&{alignmentOffset:F}},reset:O}}}),Gle=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var r,n;const{placement:i,middlewareData:a,rects:s,initialPlacement:l,platform:c,elements:d}=t,{mainAxis:p=!0,crossAxis:h=!0,fallbackPlacements:m,fallbackStrategy:_="bestFit",fallbackAxisSideDirection:y="none",flipAlignment:E=!0,...T}=ou(e,t);if((r=a.arrow)!=null&&r.alignmentOffset)return{};const A=su(i),b=cs(l),R=su(l)===l,M=await(c.isRTL==null?void 0:c.isRTL(d.floating)),B=m||(R||!E?[yg(l)]:Fle(l)),w=y!=="none";!m&&w&&B.push(...jle(l,E,y,M));const D=[l,...B],U=await zv(t,T),ae=[];let Q=((n=a.flip)==null?void 0:n.overflows)||[];if(p&&ae.push(U[A]),h){const H=Ble(i,s,M);ae.push(U[H[0]],U[H[1]])}if(Q=[...Q,{placement:i,overflows:ae}],!ae.every(H=>H<=0)){var X,x;const H=(((X=a.flip)==null?void 0:X.index)||0)+1,pe=D[H];if(pe&&(!(h==="alignment"&&b!==cs(pe))||Q.every(F=>cs(F.placement)===b?F.overflows[0]>0:!0)))return{data:{index:H,overflows:Q},reset:{placement:pe}};let O=(x=Q.filter(F=>F.overflows[0]<=0).sort((F,z)=>F.overflows[1]-z.overflows[1])[0])==null?void 0:x.placement;if(!O)switch(_){case"bestFit":{var P;const F=(P=Q.filter(z=>{if(w){const re=cs(z.placement);return re===b||re==="y"}return!0}).map(z=>[z.placement,z.overflows.filter(re=>re>0).reduce((re,oe)=>re+oe,0)]).sort((z,re)=>z[1]-re[1])[0])==null?void 0:P[0];F&&(O=F);break}case"initialPlacement":O=l;break}if(i!==O)return{reset:{placement:O}}}return{}}}};function ND(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function ID(e){return Ile.some(t=>e[t]>=0)}const qle=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:r}=t,{strategy:n="referenceHidden",...i}=ou(e,t);switch(n){case"referenceHidden":{const a=await zv(t,{...i,elementContext:"reference"}),s=ND(a,r.reference);return{data:{referenceHiddenOffsets:s,referenceHidden:ID(s)}}}case"escaped":{const a=await zv(t,{...i,altBoundary:!0}),s=ND(a,r.floating);return{data:{escapedOffsets:s,escaped:ID(s)}}}default:return{}}}}},j5=new Set(["left","top"]);async function Wle(e,t){const{placement:r,platform:n,elements:i}=e,a=await(n.isRTL==null?void 0:n.isRTL(i.floating)),s=su(r),l=sh(r),c=cs(r)==="y",d=j5.has(s)?-1:1,p=a&&c?-1:1,h=ou(t,e);let{mainAxis:m,crossAxis:_,alignmentAxis:y}=typeof h=="number"?{mainAxis:h,crossAxis:0,alignmentAxis:null}:{mainAxis:h.mainAxis||0,crossAxis:h.crossAxis||0,alignmentAxis:h.alignmentAxis};return l&&typeof y=="number"&&(_=l==="end"?y*-1:y),c?{x:_*p,y:m*d}:{x:m*d,y:_*p}}const Yle=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var r,n;const{x:i,y:a,placement:s,middlewareData:l}=t,c=await Wle(t,e);return s===((r=l.offset)==null?void 0:r.placement)&&(n=l.arrow)!=null&&n.alignmentOffset?{}:{x:i+c.x,y:a+c.y,data:{...c,placement:s}}}}},$le=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:r,y:n,placement:i}=t,{mainAxis:a=!0,crossAxis:s=!1,limiter:l={fn:T=>{let{x:A,y:b}=T;return{x:A,y:b}}},...c}=ou(e,t),d={x:r,y:n},p=await zv(t,c),h=cs(su(i)),m=WR(h);let _=d[m],y=d[h];if(a){const T=m==="y"?"top":"left",A=m==="y"?"bottom":"right",b=_+p[T],R=_-p[A];_=Ex(b,_,R)}if(s){const T=h==="y"?"top":"left",A=h==="y"?"bottom":"right",b=y+p[T],R=y-p[A];y=Ex(b,y,R)}const E=l.fn({...t,[m]:_,[h]:y});return{...E,data:{x:E.x-r,y:E.y-n,enabled:{[m]:a,[h]:s}}}}}},Zle=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:r,y:n,placement:i,rects:a,middlewareData:s}=t,{offset:l=0,mainAxis:c=!0,crossAxis:d=!0}=ou(e,t),p={x:r,y:n},h=cs(i),m=WR(h);let _=p[m],y=p[h];const E=ou(l,t),T=typeof E=="number"?{mainAxis:E,crossAxis:0}:{mainAxis:0,crossAxis:0,...E};if(c){const R=m==="y"?"height":"width",M=a.reference[m]-a.floating[R]+T.mainAxis,B=a.reference[m]+a.reference[R]-T.mainAxis;_<M?_=M:_>B&&(_=B)}if(d){var A,b;const R=m==="y"?"width":"height",M=j5.has(su(i)),B=a.reference[h]-a.floating[R]+(M&&((A=s.offset)==null?void 0:A[h])||0)+(M?0:T.crossAxis),w=a.reference[h]+a.reference[R]+(M?0:((b=s.offset)==null?void 0:b[h])||0)-(M?T.crossAxis:0);y<B?y=B:y>w&&(y=w)}return{[m]:_,[h]:y}}}},Kle=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var r,n;const{placement:i,rects:a,platform:s,elements:l}=t,{apply:c=()=>{},...d}=ou(e,t),p=await zv(t,d),h=su(i),m=sh(i),_=cs(i)==="y",{width:y,height:E}=a.floating;let T,A;h==="top"||h==="bottom"?(T=h,A=m===(await(s.isRTL==null?void 0:s.isRTL(l.floating))?"start":"end")?"left":"right"):(A=h,T=m==="end"?"top":"bottom");const b=E-p.top-p.bottom,R=y-p.left-p.right,M=Il(E-p[T],b),B=Il(y-p[A],R),w=!t.middlewareData.shift;let D=M,U=B;if((r=t.middlewareData.shift)!=null&&r.enabled.x&&(U=R),(n=t.middlewareData.shift)!=null&&n.enabled.y&&(D=b),w&&!m){const Q=Sa(p.left,0),X=Sa(p.right,0),x=Sa(p.top,0),P=Sa(p.bottom,0);_?U=y-2*(Q!==0||X!==0?Q+X:Sa(p.left,p.right)):D=E-2*(x!==0||P!==0?x+P:Sa(p.top,p.bottom))}await c({...t,availableWidth:U,availableHeight:D});const ae=await s.getDimensions(l.floating);return y!==ae.width||E!==ae.height?{reset:{rects:!0}}:{}}}};function Qg(){return typeof window<"u"}function uh(e){return H5(e)?(e.nodeName||"").toLowerCase():"#document"}function xa(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function ys(e){var t;return(t=(H5(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function H5(e){return Qg()?e instanceof Node||e instanceof xa(e).Node:!1}function Io(e){return Qg()?e instanceof Element||e instanceof xa(e).Element:!1}function _s(e){return Qg()?e instanceof HTMLElement||e instanceof xa(e).HTMLElement:!1}function PD(e){return!Qg()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof xa(e).ShadowRoot}const Qle=new Set(["inline","contents"]);function em(e){const{overflow:t,overflowX:r,overflowY:n,display:i}=Po(e);return/auto|scroll|overlay|hidden|clip/.test(t+n+r)&&!Qle.has(i)}const Jle=new Set(["table","td","th"]);function ece(e){return Jle.has(uh(e))}const tce=[":popover-open",":modal"];function Jg(e){return tce.some(t=>{try{return e.matches(t)}catch{return!1}})}const rce=["transform","translate","scale","rotate","perspective"],nce=["transform","translate","scale","rotate","perspective","filter"],ice=["paint","layout","strict","content"];function ZR(e){const t=KR(),r=Io(e)?Po(e):e;return rce.some(n=>r[n]?r[n]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!t&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!t&&(r.filter?r.filter!=="none":!1)||nce.some(n=>(r.willChange||"").includes(n))||ice.some(n=>(r.contain||"").includes(n))}function ace(e){let t=Pl(e);for(;_s(t)&&!eh(t);){if(ZR(t))return t;if(Jg(t))return null;t=Pl(t)}return null}function KR(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const oce=new Set(["html","body","#document"]);function eh(e){return oce.has(uh(e))}function Po(e){return xa(e).getComputedStyle(e)}function ey(e){return Io(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Pl(e){if(uh(e)==="html")return e;const t=e.assignedSlot||e.parentNode||PD(e)&&e.host||ys(e);return PD(t)?t.host:t}function V5(e){const t=Pl(e);return eh(t)?e.ownerDocument?e.ownerDocument.body:e.body:_s(t)&&em(t)?t:V5(t)}function jv(e,t,r){var n;t===void 0&&(t=[]),r===void 0&&(r=!0);const i=V5(e),a=i===((n=e.ownerDocument)==null?void 0:n.body),s=xa(i);if(a){const l=Sx(s);return t.concat(s,s.visualViewport||[],em(i)?i:[],l&&r?jv(l):[])}return t.concat(i,jv(i,[],r))}function Sx(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function X5(e){const t=Po(e);let r=parseFloat(t.width)||0,n=parseFloat(t.height)||0;const i=_s(e),a=i?e.offsetWidth:r,s=i?e.offsetHeight:n,l=gg(r)!==a||gg(n)!==s;return l&&(r=a,n=s),{width:r,height:n,$:l}}function QR(e){return Io(e)?e:e.contextElement}function Fd(e){const t=QR(e);if(!_s(t))return hs(1);const r=t.getBoundingClientRect(),{width:n,height:i,$:a}=X5(t);let s=(a?gg(r.width):r.width)/n,l=(a?gg(r.height):r.height)/i;return(!s||!Number.isFinite(s))&&(s=1),(!l||!Number.isFinite(l))&&(l=1),{x:s,y:l}}const sce=hs(0);function G5(e){const t=xa(e);return!KR()||!t.visualViewport?sce:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function uce(e,t,r){return t===void 0&&(t=!1),!r||t&&r!==xa(e)?!1:t}function Gc(e,t,r,n){t===void 0&&(t=!1),r===void 0&&(r=!1);const i=e.getBoundingClientRect(),a=QR(e);let s=hs(1);t&&(n?Io(n)&&(s=Fd(n)):s=Fd(e));const l=uce(a,r,n)?G5(a):hs(0);let c=(i.left+l.x)/s.x,d=(i.top+l.y)/s.y,p=i.width/s.x,h=i.height/s.y;if(a){const m=xa(a),_=n&&Io(n)?xa(n):n;let y=m,E=Sx(y);for(;E&&n&&_!==y;){const T=Fd(E),A=E.getBoundingClientRect(),b=Po(E),R=A.left+(E.clientLeft+parseFloat(b.paddingLeft))*T.x,M=A.top+(E.clientTop+parseFloat(b.paddingTop))*T.y;c*=T.x,d*=T.y,p*=T.x,h*=T.y,c+=R,d+=M,y=xa(E),E=Sx(y)}}return Eg({width:p,height:h,x:c,y:d})}function ty(e,t){const r=ey(e).scrollLeft;return t?t.left+r:Gc(ys(e)).left+r}function q5(e,t){const r=e.getBoundingClientRect(),n=r.left+t.scrollLeft-ty(e,r),i=r.top+t.scrollTop;return{x:n,y:i}}function lce(e){let{elements:t,rect:r,offsetParent:n,strategy:i}=e;const a=i==="fixed",s=ys(n),l=t?Jg(t.floating):!1;if(n===s||l&&a)return r;let c={scrollLeft:0,scrollTop:0},d=hs(1);const p=hs(0),h=_s(n);if((h||!h&&!a)&&((uh(n)!=="body"||em(s))&&(c=ey(n)),_s(n))){const _=Gc(n);d=Fd(n),p.x=_.x+n.clientLeft,p.y=_.y+n.clientTop}const m=s&&!h&&!a?q5(s,c):hs(0);return{width:r.width*d.x,height:r.height*d.y,x:r.x*d.x-c.scrollLeft*d.x+p.x+m.x,y:r.y*d.y-c.scrollTop*d.y+p.y+m.y}}function cce(e){return Array.from(e.getClientRects())}function fce(e){const t=ys(e),r=ey(e),n=e.ownerDocument.body,i=Sa(t.scrollWidth,t.clientWidth,n.scrollWidth,n.clientWidth),a=Sa(t.scrollHeight,t.clientHeight,n.scrollHeight,n.clientHeight);let s=-r.scrollLeft+ty(e);const l=-r.scrollTop;return Po(n).direction==="rtl"&&(s+=Sa(t.clientWidth,n.clientWidth)-i),{width:i,height:a,x:s,y:l}}const DD=25;function dce(e,t){const r=xa(e),n=ys(e),i=r.visualViewport;let a=n.clientWidth,s=n.clientHeight,l=0,c=0;if(i){a=i.width,s=i.height;const p=KR();(!p||p&&t==="fixed")&&(l=i.offsetLeft,c=i.offsetTop)}const d=ty(n);if(d<=0){const p=n.ownerDocument,h=p.body,m=getComputedStyle(h),_=p.compatMode==="CSS1Compat"&&parseFloat(m.marginLeft)+parseFloat(m.marginRight)||0,y=Math.abs(n.clientWidth-h.clientWidth-_);y<=DD&&(a-=y)}else d<=DD&&(a+=d);return{width:a,height:s,x:l,y:c}}const hce=new Set(["absolute","fixed"]);function pce(e,t){const r=Gc(e,!0,t==="fixed"),n=r.top+e.clientTop,i=r.left+e.clientLeft,a=_s(e)?Fd(e):hs(1),s=e.clientWidth*a.x,l=e.clientHeight*a.y,c=i*a.x,d=n*a.y;return{width:s,height:l,x:c,y:d}}function LD(e,t,r){let n;if(t==="viewport")n=dce(e,r);else if(t==="document")n=fce(ys(e));else if(Io(t))n=pce(t,r);else{const i=G5(e);n={x:t.x-i.x,y:t.y-i.y,width:t.width,height:t.height}}return Eg(n)}function W5(e,t){const r=Pl(e);return r===t||!Io(r)||eh(r)?!1:Po(r).position==="fixed"||W5(r,t)}function vce(e,t){const r=t.get(e);if(r)return r;let n=jv(e,[],!1).filter(l=>Io(l)&&uh(l)!=="body"),i=null;const a=Po(e).position==="fixed";let s=a?Pl(e):e;for(;Io(s)&&!eh(s);){const l=Po(s),c=ZR(s);!c&&l.position==="fixed"&&(i=null),(a?!c&&!i:!c&&l.position==="static"&&i&&hce.has(i.position)||em(s)&&!c&&W5(e,s))?n=n.filter(d=>d!==s):i=l,s=Pl(s)}return t.set(e,n),n}function mce(e){let{element:t,boundary:r,rootBoundary:n,strategy:i}=e;const a=[...r==="clippingAncestors"?Jg(t)?[]:vce(t,this._c):[].concat(r),n],s=a[0],l=a.reduce((c,d)=>{const p=LD(t,d,i);return c.top=Sa(p.top,c.top),c.right=Il(p.right,c.right),c.bottom=Il(p.bottom,c.bottom),c.left=Sa(p.left,c.left),c},LD(t,s,i));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function _ce(e){const{width:t,height:r}=X5(e);return{width:t,height:r}}function gce(e,t,r){const n=_s(t),i=ys(t),a=r==="fixed",s=Gc(e,!0,a,t);let l={scrollLeft:0,scrollTop:0};const c=hs(0);function d(){c.x=ty(i)}if(n||!n&&!a)if((uh(t)!=="body"||em(i))&&(l=ey(t)),n){const _=Gc(t,!0,a,t);c.x=_.x+t.clientLeft,c.y=_.y+t.clientTop}else i&&d();a&&!n&&i&&d();const p=i&&!n&&!a?q5(i,l):hs(0),h=s.left+l.scrollLeft-c.x-p.x,m=s.top+l.scrollTop-c.y-p.y;return{x:h,y:m,width:s.width,height:s.height}}function hb(e){return Po(e).position==="static"}function BD(e,t){if(!_s(e)||Po(e).position==="fixed")return null;if(t)return t(e);let r=e.offsetParent;return ys(e)===r&&(r=r.ownerDocument.body),r}function Y5(e,t){const r=xa(e);if(Jg(e))return r;if(!_s(e)){let i=Pl(e);for(;i&&!eh(i);){if(Io(i)&&!hb(i))return i;i=Pl(i)}return r}let n=BD(e,t);for(;n&&ece(n)&&hb(n);)n=BD(n,t);return n&&eh(n)&&hb(n)&&!ZR(n)?r:n||ace(e)||r}const yce=async function(e){const t=this.getOffsetParent||Y5,r=this.getDimensions,n=await r(e.floating);return{reference:gce(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:n.width,height:n.height}}};function Ece(e){return Po(e).direction==="rtl"}const Tce={convertOffsetParentRelativeRectToViewportRelativeRect:lce,getDocumentElement:ys,getClippingRect:mce,getOffsetParent:Y5,getElementRects:yce,getClientRects:cce,getDimensions:_ce,getScale:Fd,isElement:Io,isRTL:Ece};function $5(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function Sce(e,t){let r=null,n;const i=ys(e);function a(){var l;clearTimeout(n),(l=r)==null||l.disconnect(),r=null}function s(l,c){l===void 0&&(l=!1),c===void 0&&(c=1),a();const d=e.getBoundingClientRect(),{left:p,top:h,width:m,height:_}=d;if(l||t(),!m||!_)return;const y=n0(h),E=n0(i.clientWidth-(p+m)),T=n0(i.clientHeight-(h+_)),A=n0(p),b={rootMargin:-y+"px "+-E+"px "+-T+"px "+-A+"px",threshold:Sa(0,Il(1,c))||1};let R=!0;function M(B){const w=B[0].intersectionRatio;if(w!==c){if(!R)return s();w?s(!1,w):n=setTimeout(()=>{s(!1,1e-7)},1e3)}w===1&&!$5(d,e.getBoundingClientRect())&&s(),R=!1}try{r=new IntersectionObserver(M,{...b,root:i.ownerDocument})}catch{r=new IntersectionObserver(M,b)}r.observe(e)}return s(!0),a}function Ace(e,t,r,n){n===void 0&&(n={});const{ancestorScroll:i=!0,ancestorResize:a=!0,elementResize:s=typeof ResizeObserver=="function",layoutShift:l=typeof IntersectionObserver=="function",animationFrame:c=!1}=n,d=QR(e),p=i||a?[...d?jv(d):[],...jv(t)]:[];p.forEach(A=>{i&&A.addEventListener("scroll",r,{passive:!0}),a&&A.addEventListener("resize",r)});const h=d&&l?Sce(d,r):null;let m=-1,_=null;s&&(_=new ResizeObserver(A=>{let[b]=A;b&&b.target===d&&_&&(_.unobserve(t),cancelAnimationFrame(m),m=requestAnimationFrame(()=>{var R;(R=_)==null||R.observe(t)})),r()}),d&&!c&&_.observe(d),_.observe(t));let y,E=c?Gc(e):null;c&&T();function T(){const A=Gc(e);E&&!$5(E,A)&&r(),E=A,y=requestAnimationFrame(T)}return r(),()=>{var A;p.forEach(b=>{i&&b.removeEventListener("scroll",r),a&&b.removeEventListener("resize",r)}),h?.(),(A=_)==null||A.disconnect(),_=null,c&&cancelAnimationFrame(y)}}const bce=Yle,xce=$le,Rce=Gle,Cce=Kle,Oce=qle,FD=Xle,Mce=Zle,wce=(e,t,r)=>{const n=new Map,i={platform:Tce,...r},a={...i.platform,_c:n};return Vle(e,t,{...i,platform:a})};var Nce=typeof document<"u",Ice=function(){},A0=Nce?q.useLayoutEffect:Ice;function Tg(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let r,n,i;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(r=e.length,r!==t.length)return!1;for(n=r;n--!==0;)if(!Tg(e[n],t[n]))return!1;return!0}if(i=Object.keys(e),r=i.length,r!==Object.keys(t).length)return!1;for(n=r;n--!==0;)if(!{}.hasOwnProperty.call(t,i[n]))return!1;for(n=r;n--!==0;){const a=i[n];if(!(a==="_owner"&&e.$$typeof)&&!Tg(e[a],t[a]))return!1}return!0}return e!==e&&t!==t}function Z5(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function UD(e,t){const r=Z5(e);return Math.round(t*r)/r}function pb(e){const t=q.useRef(e);return A0(()=>{t.current=e}),t}function Pce(e){e===void 0&&(e={});const{placement:t="bottom",strategy:r="absolute",middleware:n=[],platform:i,elements:{reference:a,floating:s}={},transform:l=!0,whileElementsMounted:c,open:d}=e,[p,h]=q.useState({x:0,y:0,strategy:r,placement:t,middlewareData:{},isPositioned:!1}),[m,_]=q.useState(n);Tg(m,n)||_(n);const[y,E]=q.useState(null),[T,A]=q.useState(null),b=q.useCallback(z=>{z!==w.current&&(w.current=z,E(z))},[]),R=q.useCallback(z=>{z!==D.current&&(D.current=z,A(z))},[]),M=a||y,B=s||T,w=q.useRef(null),D=q.useRef(null),U=q.useRef(p),ae=c!=null,Q=pb(c),X=pb(i),x=pb(d),P=q.useCallback(()=>{if(!w.current||!D.current)return;const z={placement:t,strategy:r,middleware:m};X.current&&(z.platform=X.current),wce(w.current,D.current,z).then(re=>{const oe={...re,isPositioned:x.current!==!1};H.current&&!Tg(U.current,oe)&&(U.current=oe,th.flushSync(()=>{h(oe)}))})},[m,t,r,X,x]);A0(()=>{d===!1&&U.current.isPositioned&&(U.current.isPositioned=!1,h(z=>({...z,isPositioned:!1})))},[d]);const H=q.useRef(!1);A0(()=>(H.current=!0,()=>{H.current=!1}),[]),A0(()=>{if(M&&(w.current=M),B&&(D.current=B),M&&B){if(Q.current)return Q.current(M,B,P);P()}},[M,B,P,Q,ae]);const pe=q.useMemo(()=>({reference:w,floating:D,setReference:b,setFloating:R}),[b,R]),O=q.useMemo(()=>({reference:M,floating:B}),[M,B]),F=q.useMemo(()=>{const z={position:r,left:0,top:0};if(!O.floating)return z;const re=UD(O.floating,p.x),oe=UD(O.floating,p.y);return l?{...z,transform:"translate("+re+"px, "+oe+"px)",...Z5(O.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:re,top:oe}},[r,l,O.floating,p.x,p.y]);return q.useMemo(()=>({...p,update:P,refs:pe,elements:O,floatingStyles:F}),[p,P,pe,O,F])}const Dce=e=>{function t(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:e,fn(r){const{element:n,padding:i}=typeof e=="function"?e(r):e;return n&&t(n)?n.current!=null?FD({element:n.current,padding:i}).fn(r):{}:n?FD({element:n,padding:i}).fn(r):{}}}},Lce=(e,t)=>({...bce(e),options:[e,t]}),Bce=(e,t)=>({...xce(e),options:[e,t]}),Fce=(e,t)=>({...Mce(e),options:[e,t]}),Uce=(e,t)=>({...Rce(e),options:[e,t]}),kce=(e,t)=>({...Cce(e),options:[e,t]}),zce=(e,t)=>({...Oce(e),options:[e,t]}),jce=(e,t)=>({...Dce(e),options:[e,t]});var Hce="Arrow",K5=q.forwardRef((e,t)=>{const{children:r,width:n=10,height:i=5,...a}=e;return Le.jsx(Nr.svg,{...a,ref:t,width:n,height:i,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?r:Le.jsx("polygon",{points:"0,0 30,0 15,10"})})});K5.displayName=Hce;var Vce=K5;function JR(e){const[t,r]=q.useState(void 0);return ni(()=>{if(e){r({width:e.offsetWidth,height:e.offsetHeight});const n=new ResizeObserver(i=>{if(!Array.isArray(i)||!i.length)return;const a=i[0];let s,l;if("borderBoxSize"in a){const c=a.borderBoxSize,d=Array.isArray(c)?c[0]:c;s=d.inlineSize,l=d.blockSize}else s=e.offsetWidth,l=e.offsetHeight;r({width:s,height:l})});return n.observe(e,{box:"border-box"}),()=>n.unobserve(e)}else r(void 0)},[e]),t}var Q5="Popper",[J5,eU]=Kc(Q5),[Ade,tU]=J5(Q5),rU="PopperAnchor",nU=q.forwardRef((e,t)=>{const{__scopePopper:r,virtualRef:n,...i}=e,a=tU(rU,r),s=q.useRef(null),l=gn(t,s),c=q.useRef(null);return q.useEffect(()=>{const d=c.current;c.current=n?.current||s.current,d!==c.current&&a.onAnchorChange(c.current)}),n?null:Le.jsx(Nr.div,{...i,ref:l})});nU.displayName=rU;var e2="PopperContent",[Xce,Gce]=J5(e2),iU=q.forwardRef((e,t)=>{const{__scopePopper:r,side:n="bottom",sideOffset:i=0,align:a="center",alignOffset:s=0,arrowPadding:l=0,avoidCollisions:c=!0,collisionBoundary:d=[],collisionPadding:p=0,sticky:h="partial",hideWhenDetached:m=!1,updatePositionStrategy:_="optimized",onPlaced:y,...E}=e,T=tU(e2,r),[A,b]=q.useState(null),R=gn(t,Ve=>b(Ve)),[M,B]=q.useState(null),w=JR(M),D=w?.width??0,U=w?.height??0,ae=n+(a!=="center"?"-"+a:""),Q=typeof p=="number"?p:{top:0,right:0,bottom:0,left:0,...p},X=Array.isArray(d)?d:[d],x=X.length>0,P={padding:Q,boundary:X.filter(Wce),altBoundary:x},{refs:H,floatingStyles:pe,placement:O,isPositioned:F,middlewareData:z}=Pce({strategy:"fixed",placement:ae,whileElementsMounted:(...Ve)=>Ace(...Ve,{animationFrame:_==="always"}),elements:{reference:T.anchor},middleware:[Lce({mainAxis:i+U,alignmentAxis:s}),c&&Bce({mainAxis:!0,crossAxis:!1,limiter:h==="partial"?Fce():void 0,...P}),c&&Uce({...P}),kce({...P,apply:({elements:Ve,rects:yt,availableWidth:Ue,availableHeight:ge})=>{const{width:nt,height:Ce}=yt.reference,zt=Ve.floating.style;zt.setProperty("--radix-popper-available-width",`${Ue}px`),zt.setProperty("--radix-popper-available-height",`${ge}px`),zt.setProperty("--radix-popper-anchor-width",`${nt}px`),zt.setProperty("--radix-popper-anchor-height",`${Ce}px`)}}),M&&jce({element:M,padding:l}),Yce({arrowWidth:D,arrowHeight:U}),m&&zce({strategy:"referenceHidden",...P})]}),[re,oe]=sU(O),_e=Nl(y);ni(()=>{F&&_e?.()},[F,_e]);const ye=z.arrow?.x,Ie=z.arrow?.y,Je=z.arrow?.centerOffset!==0,[We,Ct]=q.useState();return ni(()=>{A&&Ct(window.getComputedStyle(A).zIndex)},[A]),Le.jsx("div",{ref:H.setFloating,"data-radix-popper-content-wrapper":"",style:{...pe,transform:F?pe.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:We,"--radix-popper-transform-origin":[z.transformOrigin?.x,z.transformOrigin?.y].join(" "),...z.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:Le.jsx(Xce,{scope:r,placedSide:re,onArrowChange:B,arrowX:ye,arrowY:Ie,shouldHideArrow:Je,children:Le.jsx(Nr.div,{"data-side":re,"data-align":oe,...E,ref:R,style:{...E.style,animation:F?void 0:"none"}})})})});iU.displayName=e2;var aU="PopperArrow",qce={top:"bottom",right:"left",bottom:"top",left:"right"},oU=q.forwardRef(function(e,t){const{__scopePopper:r,...n}=e,i=Gce(aU,r),a=qce[i.placedSide];return Le.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[a]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:Le.jsx(Vce,{...n,ref:t,style:{...n.style,display:"block"}})})});oU.displayName=aU;function Wce(e){return e!==null}var Yce=e=>({name:"transformOrigin",options:e,fn(t){const{placement:r,rects:n,middlewareData:i}=t,a=i.arrow?.centerOffset!==0,s=a?0:e.arrowWidth,l=a?0:e.arrowHeight,[c,d]=sU(r),p={start:"0%",center:"50%",end:"100%"}[d],h=(i.arrow?.x??0)+s/2,m=(i.arrow?.y??0)+l/2;let _="",y="";return c==="bottom"?(_=a?p:`${h}px`,y=`${-l}px`):c==="top"?(_=a?p:`${h}px`,y=`${n.floating.height+l}px`):c==="right"?(_=`${-l}px`,y=a?p:`${m}px`):c==="left"&&(_=`${n.floating.width+l}px`,y=a?p:`${m}px`),{data:{x:_,y}}}});function sU(e){const[t,r="center"]=e.split("-");return[t,r]}var $ce=nU,Zce=iU,Kce=oU;function t2(e){const t=q.useRef({value:e,previous:e});return q.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var uU=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),Qce="VisuallyHidden",Jce=q.forwardRef((e,t)=>Le.jsx(Nr.span,{...e,ref:t,style:{...uU,...e.style}}));Jce.displayName=Qce;var efe=[" ","Enter","ArrowUp","ArrowDown"],tfe=[" ","Enter"],ry="Select",[r2,ny,rfe]=Nle(ry),[lh]=Kc(ry,[rfe,eU]),n2=eU(),[bde,Bl]=lh(ry),[xde,nfe]=lh(ry),lU="SelectTrigger",cU=q.forwardRef((e,t)=>{const{__scopeSelect:r,disabled:n=!1,...i}=e,a=n2(r),s=Bl(lU,r),l=s.disabled||n,c=gn(t,s.onTriggerChange),d=ny(r),p=q.useRef("touch"),[h,m,_]=IU(E=>{const T=d().filter(R=>!R.disabled),A=T.find(R=>R.value===s.value),b=PU(T,E,A);b!==void 0&&s.onValueChange(b.value)}),y=E=>{l||(s.onOpenChange(!0),_()),E&&(s.triggerPointerDownPosRef.current={x:Math.round(E.pageX),y:Math.round(E.pageY)})};return Le.jsx($ce,{asChild:!0,...a,children:Le.jsx(Nr.button,{type:"button",role:"combobox","aria-controls":s.contentId,"aria-expanded":s.open,"aria-required":s.required,"aria-autocomplete":"none",dir:s.dir,"data-state":s.open?"open":"closed",disabled:l,"data-disabled":l?"":void 0,"data-placeholder":NU(s.value)?"":void 0,...i,ref:c,onClick:Jr(i.onClick,E=>{E.currentTarget.focus(),p.current!=="mouse"&&y(E)}),onPointerDown:Jr(i.onPointerDown,E=>{p.current=E.pointerType;const T=E.target;T.hasPointerCapture(E.pointerId)&&T.releasePointerCapture(E.pointerId),E.button===0&&E.ctrlKey===!1&&E.pointerType==="mouse"&&(y(E),E.preventDefault())}),onKeyDown:Jr(i.onKeyDown,E=>{const T=h.current!=="";!(E.ctrlKey||E.altKey||E.metaKey)&&E.key.length===1&&m(E.key),!(T&&E.key===" ")&&efe.includes(E.key)&&(y(),E.preventDefault())})})})});cU.displayName=lU;var fU="SelectValue",ife=q.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:i,children:a,placeholder:s="",...l}=e,c=Bl(fU,r),{onValueNodeHasChildrenChange:d}=c,p=a!==void 0,h=gn(t,c.onValueNodeChange);return ni(()=>{d(p)},[d,p]),Le.jsx(Nr.span,{...l,ref:h,style:{pointerEvents:"none"},children:NU(c.value)?Le.jsx(Le.Fragment,{children:s}):a})});ife.displayName=fU;var afe="SelectIcon",dU=q.forwardRef((e,t)=>{const{__scopeSelect:r,children:n,...i}=e;return Le.jsx(Nr.span,{"aria-hidden":!0,...i,ref:t,children:n||"▼"})});dU.displayName=afe;var ofe="SelectPortal",hU=e=>Le.jsx(HR,{asChild:!0,...e});hU.displayName=ofe;var qc="SelectContent",pU=q.forwardRef((e,t)=>{const r=Bl(qc,e.__scopeSelect),[n,i]=q.useState();if(ni(()=>{i(new DocumentFragment)},[]),!r.open){const a=n;return a?th.createPortal(Le.jsx(vU,{scope:e.__scopeSelect,children:Le.jsx(r2.Slot,{scope:e.__scopeSelect,children:Le.jsx("div",{children:e.children})})}),a):null}return Le.jsx(mU,{...e,ref:t})});pU.displayName=qc;var bo=10,[vU,Fl]=lh(qc),sfe="SelectContentImpl",ufe=Jd("SelectContent.RemoveScroll"),mU=q.forwardRef((e,t)=>{const{__scopeSelect:r,position:n="item-aligned",onCloseAutoFocus:i,onEscapeKeyDown:a,onPointerDownOutside:s,side:l,sideOffset:c,align:d,alignOffset:p,arrowPadding:h,collisionBoundary:m,collisionPadding:_,sticky:y,hideWhenDetached:E,avoidCollisions:T,...A}=e,b=Bl(qc,r),[R,M]=q.useState(null),[B,w]=q.useState(null),D=gn(t,Ve=>M(Ve)),[U,ae]=q.useState(null),[Q,X]=q.useState(null),x=ny(r),[P,H]=q.useState(!1),pe=q.useRef(!1);q.useEffect(()=>{if(R)return m5(R)},[R]),s5();const O=q.useCallback(Ve=>{const[yt,...Ue]=x().map(Ce=>Ce.ref.current),[ge]=Ue.slice(-1),nt=document.activeElement;for(const Ce of Ve)if(Ce===nt||(Ce?.scrollIntoView({block:"nearest"}),Ce===yt&&B&&(B.scrollTop=0),Ce===ge&&B&&(B.scrollTop=B.scrollHeight),Ce?.focus(),document.activeElement!==nt))return},[x,B]),F=q.useCallback(()=>O([U,R]),[O,U,R]);q.useEffect(()=>{P&&F()},[P,F]);const{onOpenChange:z,triggerPointerDownPosRef:re}=b;q.useEffect(()=>{if(R){let Ve={x:0,y:0};const yt=ge=>{Ve={x:Math.abs(Math.round(ge.pageX)-(re.current?.x??0)),y:Math.abs(Math.round(ge.pageY)-(re.current?.y??0))}},Ue=ge=>{Ve.x<=10&&Ve.y<=10?ge.preventDefault():R.contains(ge.target)||z(!1),document.removeEventListener("pointermove",yt),re.current=null};return re.current!==null&&(document.addEventListener("pointermove",yt),document.addEventListener("pointerup",Ue,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",yt),document.removeEventListener("pointerup",Ue,{capture:!0})}}},[R,z,re]),q.useEffect(()=>{const Ve=()=>z(!1);return window.addEventListener("blur",Ve),window.addEventListener("resize",Ve),()=>{window.removeEventListener("blur",Ve),window.removeEventListener("resize",Ve)}},[z]);const[oe,_e]=IU(Ve=>{const yt=x().filter(nt=>!nt.disabled),Ue=yt.find(nt=>nt.ref.current===document.activeElement),ge=PU(yt,Ve,Ue);ge&&setTimeout(()=>ge.ref.current.focus())}),ye=q.useCallback((Ve,yt,Ue)=>{const ge=!pe.current&&!Ue;(b.value!==void 0&&b.value===yt||ge)&&(ae(Ve),ge&&(pe.current=!0))},[b.value]),Ie=q.useCallback(()=>R?.focus(),[R]),Je=q.useCallback((Ve,yt,Ue)=>{const ge=!pe.current&&!Ue;(b.value!==void 0&&b.value===yt||ge)&&X(Ve)},[b.value]),We=n==="popper"?Ax:_U,Ct=We===Ax?{side:l,sideOffset:c,align:d,alignOffset:p,arrowPadding:h,collisionBoundary:m,collisionPadding:_,sticky:y,hideWhenDetached:E,avoidCollisions:T}:{};return Le.jsx(vU,{scope:r,content:R,viewport:B,onViewportChange:w,itemRefCallback:ye,selectedItem:U,onItemLeave:Ie,itemTextRefCallback:Je,focusSelectedItem:F,selectedItemText:Q,position:n,isPositioned:P,searchRef:oe,children:Le.jsx(VR,{as:ufe,allowPinchZoom:!0,children:Le.jsx(jR,{asChild:!0,trapped:b.open,onMountAutoFocus:Ve=>{Ve.preventDefault()},onUnmountAutoFocus:Jr(i,Ve=>{b.trigger?.focus({preventScroll:!0}),Ve.preventDefault()}),children:Le.jsx(zR,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:a,onPointerDownOutside:s,onFocusOutside:Ve=>Ve.preventDefault(),onDismiss:()=>b.onOpenChange(!1),children:Le.jsx(We,{role:"listbox",id:b.contentId,"data-state":b.open?"open":"closed",dir:b.dir,onContextMenu:Ve=>Ve.preventDefault(),...A,...Ct,onPlaced:()=>H(!0),ref:D,style:{display:"flex",flexDirection:"column",outline:"none",...A.style},onKeyDown:Jr(A.onKeyDown,Ve=>{const yt=Ve.ctrlKey||Ve.altKey||Ve.metaKey;if(Ve.key==="Tab"&&Ve.preventDefault(),!yt&&Ve.key.length===1&&_e(Ve.key),["ArrowUp","ArrowDown","Home","End"].includes(Ve.key)){let Ue=x().filter(ge=>!ge.disabled).map(ge=>ge.ref.current);if(["ArrowUp","End"].includes(Ve.key)&&(Ue=Ue.slice().reverse()),["ArrowUp","ArrowDown"].includes(Ve.key)){const ge=Ve.target,nt=Ue.indexOf(ge);Ue=Ue.slice(nt+1)}setTimeout(()=>O(Ue)),Ve.preventDefault()}})})})})})})});mU.displayName=sfe;var lfe="SelectItemAlignedPosition",_U=q.forwardRef((e,t)=>{const{__scopeSelect:r,onPlaced:n,...i}=e,a=Bl(qc,r),s=Fl(qc,r),[l,c]=q.useState(null),[d,p]=q.useState(null),h=gn(t,D=>p(D)),m=ny(r),_=q.useRef(!1),y=q.useRef(!0),{viewport:E,selectedItem:T,selectedItemText:A,focusSelectedItem:b}=s,R=q.useCallback(()=>{if(a.trigger&&a.valueNode&&l&&d&&E&&T&&A){const D=a.trigger.getBoundingClientRect(),U=d.getBoundingClientRect(),ae=a.valueNode.getBoundingClientRect(),Q=A.getBoundingClientRect();if(a.dir!=="rtl"){const ge=Q.left-U.left,nt=ae.left-ge,Ce=D.left-nt,zt=D.width+Ce,jt=Math.max(zt,U.width),_t=window.innerWidth-bo,Ot=CD(nt,[bo,Math.max(bo,_t-jt)]);l.style.minWidth=zt+"px",l.style.left=Ot+"px"}else{const ge=U.right-Q.right,nt=window.innerWidth-ae.right-ge,Ce=window.innerWidth-D.right-nt,zt=D.width+Ce,jt=Math.max(zt,U.width),_t=window.innerWidth-bo,Ot=CD(nt,[bo,Math.max(bo,_t-jt)]);l.style.minWidth=zt+"px",l.style.right=Ot+"px"}const X=m(),x=window.innerHeight-bo*2,P=E.scrollHeight,H=window.getComputedStyle(d),pe=parseInt(H.borderTopWidth,10),O=parseInt(H.paddingTop,10),F=parseInt(H.borderBottomWidth,10),z=parseInt(H.paddingBottom,10),re=pe+O+P+z+F,oe=Math.min(T.offsetHeight*5,re),_e=window.getComputedStyle(E),ye=parseInt(_e.paddingTop,10),Ie=parseInt(_e.paddingBottom,10),Je=D.top+D.height/2-bo,We=x-Je,Ct=T.offsetHeight/2,Ve=T.offsetTop+Ct,yt=pe+O+Ve,Ue=re-yt;if(yt<=Je){const ge=X.length>0&&T===X[X.length-1].ref.current;l.style.bottom="0px";const nt=d.clientHeight-E.offsetTop-E.offsetHeight,Ce=Math.max(We,Ct+(ge?Ie:0)+nt+F),zt=yt+Ce;l.style.height=zt+"px"}else{const ge=X.length>0&&T===X[0].ref.current;l.style.top="0px";const nt=Math.max(Je,pe+E.offsetTop+(ge?ye:0)+Ct)+Ue;l.style.height=nt+"px",E.scrollTop=yt-Je+E.offsetTop}l.style.margin=`${bo}px 0`,l.style.minHeight=oe+"px",l.style.maxHeight=x+"px",n?.(),requestAnimationFrame(()=>_.current=!0)}},[m,a.trigger,a.valueNode,l,d,E,T,A,a.dir,n]);ni(()=>R(),[R]);const[M,B]=q.useState();ni(()=>{d&&B(window.getComputedStyle(d).zIndex)},[d]);const w=q.useCallback(D=>{D&&y.current===!0&&(R(),b?.(),y.current=!1)},[R,b]);return Le.jsx(ffe,{scope:r,contentWrapper:l,shouldExpandOnScrollRef:_,onScrollButtonChange:w,children:Le.jsx("div",{ref:c,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:M},children:Le.jsx(Nr.div,{...i,ref:h,style:{boxSizing:"border-box",maxHeight:"100%",...i.style}})})})});_U.displayName=lfe;var cfe="SelectPopperPosition",Ax=q.forwardRef((e,t)=>{const{__scopeSelect:r,align:n="start",collisionPadding:i=bo,...a}=e,s=n2(r);return Le.jsx(Zce,{...s,...a,ref:t,align:n,collisionPadding:i,style:{boxSizing:"border-box",...a.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});Ax.displayName=cfe;var[ffe,i2]=lh(qc,{}),bx="SelectViewport",gU=q.forwardRef((e,t)=>{const{__scopeSelect:r,nonce:n,...i}=e,a=Fl(bx,r),s=i2(bx,r),l=gn(t,a.onViewportChange),c=q.useRef(0);return Le.jsxs(Le.Fragment,{children:[Le.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),Le.jsx(r2.Slot,{scope:r,children:Le.jsx(Nr.div,{"data-radix-select-viewport":"",role:"presentation",...i,ref:l,style:{position:"relative",flex:1,overflow:"hidden auto",...i.style},onScroll:Jr(i.onScroll,d=>{const p=d.currentTarget,{contentWrapper:h,shouldExpandOnScrollRef:m}=s;if(m?.current&&h){const _=Math.abs(c.current-p.scrollTop);if(_>0){const y=window.innerHeight-bo*2,E=parseFloat(h.style.minHeight),T=parseFloat(h.style.height),A=Math.max(E,T);if(A<y){const b=A+_,R=Math.min(y,b),M=b-R;h.style.height=R+"px",h.style.bottom==="0px"&&(p.scrollTop=M>0?M:0,h.style.justifyContent="flex-end")}}}c.current=p.scrollTop})})})]})});gU.displayName=bx;var yU="SelectGroup",[dfe,hfe]=lh(yU),pfe=q.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,i=r5();return Le.jsx(dfe,{scope:r,id:i,children:Le.jsx(Nr.div,{role:"group","aria-labelledby":i,...n,ref:t})})});pfe.displayName=yU;var EU="SelectLabel",TU=q.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,i=hfe(EU,r);return Le.jsx(Nr.div,{id:i.id,...n,ref:t})});TU.displayName=EU;var Sg="SelectItem",[vfe,SU]=lh(Sg),AU=q.forwardRef((e,t)=>{const{__scopeSelect:r,value:n,disabled:i=!1,textValue:a,...s}=e,l=Bl(Sg,r),c=Fl(Sg,r),d=l.value===n,[p,h]=q.useState(a??""),[m,_]=q.useState(!1),y=gn(t,b=>c.itemRefCallback?.(b,n,i)),E=r5(),T=q.useRef("touch"),A=()=>{i||(l.onValueChange(n),l.onOpenChange(!1))};if(n==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return Le.jsx(vfe,{scope:r,value:n,disabled:i,textId:E,isSelected:d,onItemTextChange:q.useCallback(b=>{h(R=>R||(b?.textContent??"").trim())},[]),children:Le.jsx(r2.ItemSlot,{scope:r,value:n,disabled:i,textValue:p,children:Le.jsx(Nr.div,{role:"option","aria-labelledby":E,"data-highlighted":m?"":void 0,"aria-selected":d&&m,"data-state":d?"checked":"unchecked","aria-disabled":i||void 0,"data-disabled":i?"":void 0,tabIndex:i?void 0:-1,...s,ref:y,onFocus:Jr(s.onFocus,()=>_(!0)),onBlur:Jr(s.onBlur,()=>_(!1)),onClick:Jr(s.onClick,()=>{T.current!=="mouse"&&A()}),onPointerUp:Jr(s.onPointerUp,()=>{T.current==="mouse"&&A()}),onPointerDown:Jr(s.onPointerDown,b=>{T.current=b.pointerType}),onPointerMove:Jr(s.onPointerMove,b=>{T.current=b.pointerType,i?c.onItemLeave?.():T.current==="mouse"&&b.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Jr(s.onPointerLeave,b=>{b.currentTarget===document.activeElement&&c.onItemLeave?.()}),onKeyDown:Jr(s.onKeyDown,b=>{c.searchRef?.current!==""&&b.key===" "||(tfe.includes(b.key)&&A(),b.key===" "&&b.preventDefault())})})})})});AU.displayName=Sg;var dv="SelectItemText",bU=q.forwardRef((e,t)=>{const{__scopeSelect:r,className:n,style:i,...a}=e,s=Bl(dv,r),l=Fl(dv,r),c=SU(dv,r),d=nfe(dv,r),[p,h]=q.useState(null),m=gn(t,A=>h(A),c.onItemTextChange,A=>l.itemTextRefCallback?.(A,c.value,c.disabled)),_=p?.textContent,y=q.useMemo(()=>Le.jsx("option",{value:c.value,disabled:c.disabled,children:_},c.value),[c.disabled,c.value,_]),{onNativeOptionAdd:E,onNativeOptionRemove:T}=d;return ni(()=>(E(y),()=>T(y)),[E,T,y]),Le.jsxs(Le.Fragment,{children:[Le.jsx(Nr.span,{id:c.textId,...a,ref:m}),c.isSelected&&s.valueNode&&!s.valueNodeHasChildren?th.createPortal(a.children,s.valueNode):null]})});bU.displayName=dv;var xU="SelectItemIndicator",RU=q.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return SU(xU,r).isSelected?Le.jsx(Nr.span,{"aria-hidden":!0,...n,ref:t}):null});RU.displayName=xU;var xx="SelectScrollUpButton",CU=q.forwardRef((e,t)=>{const r=Fl(xx,e.__scopeSelect),n=i2(xx,e.__scopeSelect),[i,a]=q.useState(!1),s=gn(t,n.onScrollButtonChange);return ni(()=>{if(r.viewport&&r.isPositioned){let l=function(){const d=c.scrollTop>0;a(d)};const c=r.viewport;return l(),c.addEventListener("scroll",l),()=>c.removeEventListener("scroll",l)}},[r.viewport,r.isPositioned]),i?Le.jsx(MU,{...e,ref:s,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=r;l&&c&&(l.scrollTop=l.scrollTop-c.offsetHeight)}}):null});CU.displayName=xx;var Rx="SelectScrollDownButton",OU=q.forwardRef((e,t)=>{const r=Fl(Rx,e.__scopeSelect),n=i2(Rx,e.__scopeSelect),[i,a]=q.useState(!1),s=gn(t,n.onScrollButtonChange);return ni(()=>{if(r.viewport&&r.isPositioned){let l=function(){const d=c.scrollHeight-c.clientHeight,p=Math.ceil(c.scrollTop)<d;a(p)};const c=r.viewport;return l(),c.addEventListener("scroll",l),()=>c.removeEventListener("scroll",l)}},[r.viewport,r.isPositioned]),i?Le.jsx(MU,{...e,ref:s,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=r;l&&c&&(l.scrollTop=l.scrollTop+c.offsetHeight)}}):null});OU.displayName=Rx;var MU=q.forwardRef((e,t)=>{const{__scopeSelect:r,onAutoScroll:n,...i}=e,a=Fl("SelectScrollButton",r),s=q.useRef(null),l=ny(r),c=q.useCallback(()=>{s.current!==null&&(window.clearInterval(s.current),s.current=null)},[]);return q.useEffect(()=>()=>c(),[c]),ni(()=>{l().find(d=>d.ref.current===document.activeElement)?.ref.current?.scrollIntoView({block:"nearest"})},[l]),Le.jsx(Nr.div,{"aria-hidden":!0,...i,ref:t,style:{flexShrink:0,...i.style},onPointerDown:Jr(i.onPointerDown,()=>{s.current===null&&(s.current=window.setInterval(n,50))}),onPointerMove:Jr(i.onPointerMove,()=>{a.onItemLeave?.(),s.current===null&&(s.current=window.setInterval(n,50))}),onPointerLeave:Jr(i.onPointerLeave,()=>{c()})})}),mfe="SelectSeparator",wU=q.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e;return Le.jsx(Nr.div,{"aria-hidden":!0,...n,ref:t})});wU.displayName=mfe;var Cx="SelectArrow",_fe=q.forwardRef((e,t)=>{const{__scopeSelect:r,...n}=e,i=n2(r),a=Bl(Cx,r),s=Fl(Cx,r);return a.open&&s.position==="popper"?Le.jsx(Kce,{...i,...n,ref:t}):null});_fe.displayName=Cx;var gfe="SelectBubbleInput",yfe=q.forwardRef(({__scopeSelect:e,value:t,...r},n)=>{const i=q.useRef(null),a=gn(n,i),s=t2(t);return q.useEffect(()=>{const l=i.current;if(!l)return;const c=window.HTMLSelectElement.prototype,d=Object.getOwnPropertyDescriptor(c,"value").set;if(s!==t&&d){const p=new Event("change",{bubbles:!0});d.call(l,t),l.dispatchEvent(p)}},[s,t]),Le.jsx(Nr.select,{...r,style:{...uU,...r.style},ref:a,defaultValue:t})});yfe.displayName=gfe;function NU(e){return e===""||e===void 0}function IU(e){const t=Nl(e),r=q.useRef(""),n=q.useRef(0),i=q.useCallback(s=>{const l=r.current+s;t(l),(function c(d){r.current=d,window.clearTimeout(n.current),d!==""&&(n.current=window.setTimeout(()=>c(""),1e3))})(l)},[t]),a=q.useCallback(()=>{r.current="",window.clearTimeout(n.current)},[]);return q.useEffect(()=>()=>window.clearTimeout(n.current),[]),[r,i,a]}function PU(e,t,r){const n=t.length>1&&Array.from(t).every(l=>l===t[0])?t[0]:t,i=r?e.indexOf(r):-1;let a=Efe(e,Math.max(i,0));n.length===1&&(a=a.filter(l=>l!==r));const s=a.find(l=>l.textValue.toLowerCase().startsWith(n.toLowerCase()));return s!==r?s:void 0}function Efe(e,t){return e.map((r,n)=>e[(t+n)%e.length])}var DU=cU,Tfe=dU,Sfe=hU,LU=pU,Afe=gU,BU=TU,FU=AU,bfe=bU,xfe=RU,UU=CU,kU=OU,zU=wU;const Rfe=q.forwardRef(({className:e,children:t,...r},n)=>Le.jsxs(DU,{ref:n,className:Gr("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...r,children:[t,Le.jsx(Tfe,{asChild:!0,children:Le.jsx(U5,{className:"h-4 w-4 opacity-50"})})]}));Rfe.displayName=DU.displayName;const jU=q.forwardRef(({className:e,...t},r)=>Le.jsx(UU,{ref:r,className:Gr("flex cursor-default items-center justify-center py-1",e),...t,children:Le.jsx(ble,{className:"h-4 w-4"})}));jU.displayName=UU.displayName;const HU=q.forwardRef(({className:e,...t},r)=>Le.jsx(kU,{ref:r,className:Gr("flex cursor-default items-center justify-center py-1",e),...t,children:Le.jsx(U5,{className:"h-4 w-4"})}));HU.displayName=kU.displayName;const Cfe=q.forwardRef(({className:e,children:t,position:r="popper",...n},i)=>Le.jsx(Sfe,{children:Le.jsxs(LU,{ref:i,className:Gr("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:r,...n,children:[Le.jsx(jU,{}),Le.jsx(Afe,{className:Gr("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),Le.jsx(HU,{})]})}));Cfe.displayName=LU.displayName;const Ofe=q.forwardRef(({className:e,...t},r)=>Le.jsx(BU,{ref:r,className:Gr("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...t}));Ofe.displayName=BU.displayName;const Mfe=q.forwardRef(({className:e,children:t,...r},n)=>Le.jsxs(FU,{ref:n,className:Gr("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...r,children:[Le.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:Le.jsx(xfe,{children:Le.jsx(F5,{className:"h-4 w-4"})})}),Le.jsx(bfe,{children:t})]}));Mfe.displayName=FU.displayName;const wfe=q.forwardRef(({className:e,...t},r)=>Le.jsx(zU,{ref:r,className:Gr("-mx-1 my-1 h-px bg-muted",e),...t}));wfe.displayName=zU.displayName;var iy="Checkbox",[Nfe]=Kc(iy),[Ife,a2]=Nfe(iy);function Pfe(e){const{__scopeCheckbox:t,checked:r,children:n,defaultChecked:i,disabled:a,form:s,name:l,onCheckedChange:c,required:d,value:p="on",internal_do_not_use_render:h}=e,[m,_]=n5({prop:r,defaultProp:i??!1,onChange:c,caller:iy}),[y,E]=q.useState(null),[T,A]=q.useState(null),b=q.useRef(!1),R=y?!!s||!!y.closest("form"):!0,M={checked:m,disabled:a,setChecked:_,control:y,setControl:E,name:l,form:s,value:p,hasConsumerStoppedPropagationRef:b,required:d,defaultChecked:Ol(i)?!1:i,isFormControl:R,bubbleInput:T,setBubbleInput:A};return Le.jsx(Ife,{scope:t,...M,children:Dfe(h)?h(M):n})}var VU="CheckboxTrigger",XU=q.forwardRef(({__scopeCheckbox:e,onKeyDown:t,onClick:r,...n},i)=>{const{control:a,value:s,disabled:l,checked:c,required:d,setControl:p,setChecked:h,hasConsumerStoppedPropagationRef:m,isFormControl:_,bubbleInput:y}=a2(VU,e),E=gn(i,p),T=q.useRef(c);return q.useEffect(()=>{const A=a?.form;if(A){const b=()=>h(T.current);return A.addEventListener("reset",b),()=>A.removeEventListener("reset",b)}},[a,h]),Le.jsx(Nr.button,{type:"button",role:"checkbox","aria-checked":Ol(c)?"mixed":c,"aria-required":d,"data-state":$U(c),"data-disabled":l?"":void 0,disabled:l,value:s,...n,ref:E,onKeyDown:Jr(t,A=>{A.key==="Enter"&&A.preventDefault()}),onClick:Jr(r,A=>{h(b=>Ol(b)?!0:!b),y&&_&&(m.current=A.isPropagationStopped(),m.current||A.stopPropagation())})})});XU.displayName=VU;var o2=q.forwardRef((e,t)=>{const{__scopeCheckbox:r,name:n,checked:i,defaultChecked:a,required:s,disabled:l,value:c,onCheckedChange:d,form:p,...h}=e;return Le.jsx(Pfe,{__scopeCheckbox:r,checked:i,defaultChecked:a,disabled:l,required:s,onCheckedChange:d,name:n,form:p,value:c,internal_do_not_use_render:({isFormControl:m})=>Le.jsxs(Le.Fragment,{children:[Le.jsx(XU,{...h,ref:t,__scopeCheckbox:r}),m&&Le.jsx(YU,{__scopeCheckbox:r})]})})});o2.displayName=iy;var GU="CheckboxIndicator",qU=q.forwardRef((e,t)=>{const{__scopeCheckbox:r,forceMount:n,...i}=e,a=a2(GU,r);return Le.jsx(Jv,{present:n||Ol(a.checked)||a.checked===!0,children:Le.jsx(Nr.span,{"data-state":$U(a.checked),"data-disabled":a.disabled?"":void 0,...i,ref:t,style:{pointerEvents:"none",...e.style}})})});qU.displayName=GU;var WU="CheckboxBubbleInput",YU=q.forwardRef(({__scopeCheckbox:e,...t},r)=>{const{control:n,hasConsumerStoppedPropagationRef:i,checked:a,defaultChecked:s,required:l,disabled:c,name:d,value:p,form:h,bubbleInput:m,setBubbleInput:_}=a2(WU,e),y=gn(r,_),E=t2(a),T=JR(n);q.useEffect(()=>{const b=m;if(!b)return;const R=window.HTMLInputElement.prototype,M=Object.getOwnPropertyDescriptor(R,"checked").set,B=!i.current;if(E!==a&&M){const w=new Event("click",{bubbles:B});b.indeterminate=Ol(a),M.call(b,Ol(a)?!1:a),b.dispatchEvent(w)}},[m,E,a,i]);const A=q.useRef(Ol(a)?!1:a);return Le.jsx(Nr.input,{type:"checkbox","aria-hidden":!0,defaultChecked:s??A.current,required:l,disabled:c,name:d,value:p,form:h,...t,tabIndex:-1,ref:y,style:{...t.style,...T,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});YU.displayName=WU;function Dfe(e){return typeof e=="function"}function Ol(e){return e==="indeterminate"}function $U(e){return Ol(e)?"indeterminate":e?"checked":"unchecked"}const Lfe=q.forwardRef(({className:e,...t},r)=>Le.jsx(o2,{ref:r,className:Gr("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...t,children:Le.jsx(qU,{className:Gr("flex items-center justify-center text-current"),children:Le.jsx(F5,{className:"h-4 w-4"})})}));Lfe.displayName=o2.displayName;var ay="Switch",[Bfe]=Kc(ay),[Ffe,Ufe]=Bfe(ay),ZU=q.forwardRef((e,t)=>{const{__scopeSwitch:r,name:n,checked:i,defaultChecked:a,required:s,disabled:l,value:c="on",onCheckedChange:d,form:p,...h}=e,[m,_]=q.useState(null),y=gn(t,R=>_(R)),E=q.useRef(!1),T=m?p||!!m.closest("form"):!0,[A,b]=n5({prop:i,defaultProp:a??!1,onChange:d,caller:ay});return Le.jsxs(Ffe,{scope:r,checked:A,disabled:l,children:[Le.jsx(Nr.button,{type:"button",role:"switch","aria-checked":A,"aria-required":s,"data-state":e7(A),"data-disabled":l?"":void 0,disabled:l,value:c,...h,ref:y,onClick:Jr(e.onClick,R=>{b(M=>!M),T&&(E.current=R.isPropagationStopped(),E.current||R.stopPropagation())})}),T&&Le.jsx(JU,{control:m,bubbles:!E.current,name:n,value:c,checked:A,required:s,disabled:l,form:p,style:{transform:"translateX(-100%)"}})]})});ZU.displayName=ay;var KU="SwitchThumb",QU=q.forwardRef((e,t)=>{const{__scopeSwitch:r,...n}=e,i=Ufe(KU,r);return Le.jsx(Nr.span,{"data-state":e7(i.checked),"data-disabled":i.disabled?"":void 0,...n,ref:t})});QU.displayName=KU;var kfe="SwitchBubbleInput",JU=q.forwardRef(({__scopeSwitch:e,control:t,checked:r,bubbles:n=!0,...i},a)=>{const s=q.useRef(null),l=gn(s,a),c=t2(r),d=JR(t);return q.useEffect(()=>{const p=s.current;if(!p)return;const h=window.HTMLInputElement.prototype,m=Object.getOwnPropertyDescriptor(h,"checked").set;if(c!==r&&m){const _=new Event("click",{bubbles:n});m.call(p,r),p.dispatchEvent(_)}},[c,r,n]),Le.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:r,...i,tabIndex:-1,ref:l,style:{...i.style,...d,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});JU.displayName=kfe;function e7(e){return e?"checked":"unchecked"}var t7=ZU,zfe=QU;const jfe=q.forwardRef(({className:e,...t},r)=>Le.jsx(t7,{className:Gr("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",e),...t,ref:r,children:Le.jsx(zfe,{className:Gr("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));jfe.displayName=t7.displayName;const Hfe=q.forwardRef(({className:e,...t},r)=>Le.jsx("textarea",{className:Gr("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:r,...t}));Hfe.displayName="Textarea";var Vfe="Separator",kD="horizontal",Xfe=["horizontal","vertical"],r7=q.forwardRef((e,t)=>{const{decorative:r,orientation:n=kD,...i}=e,a=Gfe(n)?n:kD,s=r?{role:"none"}:{"aria-orientation":a==="vertical"?a:void 0,role:"separator"};return Le.jsx(Nr.div,{"data-orientation":a,...s,...i,ref:t})});r7.displayName=Vfe;function Gfe(e){return Xfe.includes(e)}var n7=r7;const qfe=q.forwardRef(({className:e,orientation:t="horizontal",decorative:r=!0,...n},i)=>Le.jsx(n7,{ref:i,decorative:r,orientation:t,className:Gr("shrink-0 bg-border",t==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",e),...n}));qfe.displayName=n7.displayName;function Wfe({events:e,onEventClick:t,height:r=400,className:n,enableCluster:i=!0,clusterRadius:a=50,minClusterSize:s=2}){const l=q.useRef(null),c=q.useRef(null),[d,p]=q.useState(!1);return q.useEffect(()=>l.current?((()=>{try{const m=new Boe({id:l.current,map:new Cne({style:"light",center:[104,35.5],zoom:4,token:"d2f3394e4d2807b003a50a8a6f4bb6bb"})});m.on("loaded",()=>{p(!0)}),c.current=m}catch(m){console.error("L7场景初始化失败:",m)}})(),()=>{c.current&&c.current.destroy()}):void 0,[]),q.useEffect(()=>{if(!c.current||!d||!e.length)return;const h=c.current;h.getLayers().forEach(T=>{T.name==="event-points"&&h.removeLayer(T)});const _=e.filter(T=>T.location&&typeof T.location.lng=="number"&&typeof T.location.lat=="number"),y=_.map(T=>({lng:T.location.lng,lat:T.location.lat,title:T.title,sentiment:T.sentiment,hotness:T.hotness,address:T.address,timestamp:T.timestamp})),E=new ig({name:"event-points"});i&&_.length>=s?E.source(y,{parser:{type:"json",x:"lng",y:"lat"},cluster:!0,clusterOptions:{radius:a}}).size("point_count",[12,40]).color("point_count",["#51cf66","#ffd43b","#ff8c42","#ff6b6b"]).shape("circle").style({opacity:.8,strokeWidth:2,stroke:"#fff"}):E.source(y,{parser:{type:"json",x:"lng",y:"lat"}}).size("hotness",[8,24]).color("sentiment",T=>Yfe(T)).shape("circle").style({opacity:.8,strokeWidth:2,stroke:"#fff"}),E.on("click",T=>{if(t){const A=T.lngLat;if(A){const b=_.find(R=>Math.abs(R.location.lng-A.lng)<1e-4&&Math.abs(R.location.lat-A.lat)<1e-4);b&&t(b)}}}),h.addLayer(E)},[e,d,t]),ze.jsxs("div",{className:Gr("relative w-full h-full bg-gray-100",n),style:{height:r},children:[ze.jsx("div",{ref:l,className:"w-full h-full"}),!d&&ze.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-gray-100/80",children:ze.jsx("div",{className:"text-sm text-gray-600",children:"L7 地图加载中..."})})]})}function Yfe(e){switch(e){case"positive":return"#52c41a";case"negative":return"#ff4d4f";case"neutral":return"#1890ff";default:return"#d9d9d9"}}function $fe({words:e}){const t=r=>{switch(r){case"positive":return"sentiment-positive";case"negative":return"sentiment-negative";case"neutral":return"sentiment-neutral";default:return""}};return ze.jsx("div",{className:"p-4",children:ze.jsx("div",{className:"flex flex-wrap gap-2",children:e.map((r,n)=>ze.jsxs("span",{className:`wordcloud-tag ${t(r.sentiment)}`,style:{fontSize:`${Math.max(.75,Math.min(1.5,r.count/100))}rem`},children:[r.word," (",r.count,")"]},n))})})}function Zfe({data:e,maxRows:t=10}){const r=a=>{switch(a){case"positive":return"正面";case"negative":return"负面";case"neutral":return"中性";default:return"未知"}},n=a=>{switch(a){case"positive":return"sentiment-positive";case"negative":return"sentiment-negative";case"neutral":return"sentiment-neutral";default:return""}},i=e.slice(0,t);return ze.jsx("div",{className:"overflow-auto",children:ze.jsxs("table",{className:"data-table",children:[ze.jsx("thead",{children:ze.jsxs("tr",{children:[ze.jsx("th",{children:"标题"}),ze.jsx("th",{children:"来源"}),ze.jsx("th",{children:"情感"}),ze.jsx("th",{children:"分值"}),ze.jsx("th",{children:"时间"})]})}),ze.jsx("tbody",{children:i.map(a=>ze.jsxs("tr",{children:[ze.jsx("td",{className:"truncate max-w-48",children:a.title}),ze.jsx("td",{children:a.source}),ze.jsx("td",{children:ze.jsx("span",{className:n(a.sentiment),children:r(a.sentiment)})}),ze.jsx("td",{children:a.score.toFixed(2)}),ze.jsx("td",{children:a.time})]},a.id))})]})})}const Kfe=[{id:"1",title:"北京新技术发布会获得热烈反响",content:"某科技公司在北京举办的新产品发布会获得业界广泛关注，用户反馈积极",sentiment:"positive",score:.85,location:{lat:39.9042,lng:116.4074},address:"北京市朝阳区",source:"科技日报",timestamp:"2024-01-24 14:30",hotness:8,tags:["科技","产品发布","创新"]},{id:"2",title:"上海某服务平台系统故障影响用户体验",content:"上海一家互联网公司的服务平台出现技术故障，导致部分用户无法正常使用",sentiment:"negative",score:-.72,location:{lat:31.2304,lng:121.4737},address:"上海市浦东新区",source:"澎湃新闻",timestamp:"2024-01-24 13:45",hotness:6,tags:["故障","用户体验","技术"]},{id:"3",title:"深圳智能制造展览会开幕",content:"第十五届深圳国际智能制造展览会正式开幕，展示最新工业4.0技术",sentiment:"neutral",score:.15,location:{lat:22.3193,lng:114.1694},address:"深圳市福田区",source:"深圳特区报",timestamp:"2024-01-24 12:00",hotness:5,tags:["展览会","智能制造","工业4.0"]},{id:"4",title:"广州美食节引发全民热议",content:"广州国际美食节吸引众多市民和游客参与，社交媒体上好评如潮",sentiment:"positive",score:.78,location:{lat:23.1291,lng:113.2644},address:"广州市天河区",source:"南方日报",timestamp:"2024-01-24 11:30",hotness:7,tags:["美食节","文化","旅游"]},{id:"5",title:"杭州网约车价格调整引发争议",content:"杭州多家网约车平台宣布价格调整，用户对此反应不一",sentiment:"negative",score:-.45,location:{lat:30.2741,lng:120.1551},address:"杭州市西湖区",source:"钱江晚报",timestamp:"2024-01-24 10:15",hotness:4,tags:["网约车","价格","争议"]},{id:"6",title:"成都文创产业园区项目启动",content:"成都高新区文创产业园区正式启动，将打造西南地区文创产业新高地",sentiment:"positive",score:.62,location:{lat:30.5728,lng:104.0668},address:"成都市高新区",source:"成都商报",timestamp:"2024-01-24 09:45",hotness:6,tags:["文创","产业园","高新区"]},{id:"7",title:"西安地铁新线路建设进展",content:"西安地铁新线路建设项目取得重要进展，预计明年通车",sentiment:"neutral",score:.25,location:{lat:34.3416,lng:108.9398},address:"西安市雁塔区",source:"西安晚报",timestamp:"2024-01-24 08:30",hotness:3,tags:["地铁","交通","建设"]},{id:"8",title:"武汉大学樱花节筹备工作启动",content:"武汉大学2024年樱花节筹备工作正式启动，预计将吸引大量游客",sentiment:"positive",score:.55,location:{lat:30.5928,lng:114.3055},address:"武汉市武昌区",source:"长江日报",timestamp:"2024-01-24 07:20",hotness:5,tags:["樱花节","旅游","大学"]}],i0={totalPosts:15432,positiveRatio:68.5,negativeRatio:18.3,neutralRatio:13.2},Qfe=[{word:"创新技术",count:156,sentiment:"positive"},{word:"用户体验",count:134,sentiment:"positive"},{word:"系统故障",count:89,sentiment:"negative"},{word:"服务优化",count:78,sentiment:"positive"},{word:"网络延迟",count:67,sentiment:"negative"},{word:"界面设计",count:56,sentiment:"neutral"},{word:"功能更新",count:45,sentiment:"positive"},{word:"Bug修复",count:34,sentiment:"neutral"}],Jfe=[{id:"1",title:"新版本用户体验大幅提升，获得广泛好评",source:"微博",sentiment:"positive",score:.85,time:"2024-01-24 14:30"},{id:"2",title:"系统维护期间服务暂时中断，用户反馈较多",source:"知乎",sentiment:"negative",score:-.62,time:"2024-01-24 13:45"},{id:"3",title:"产品功能介绍引发用户讨论",source:"微信",sentiment:"neutral",score:.12,time:"2024-01-24 12:20"}],ede=[{label:"正面",value:68,color:"var(--success)"},{label:"负面",value:18,color:"var(--destructive)"},{label:"中性",value:14,color:"var(--warning)"}];function tde(){const e=t=>{console.log("点击事件:",t)};return ze.jsxs("div",{className:"dashboard-layout",children:[ze.jsxs("header",{className:"dashboard-header",children:[ze.jsx("h1",{className:"dashboard-title",children:"舆情分析监控大屏"}),ze.jsx("p",{className:"dashboard-subtitle",children:"实时监控网络舆论动态，智能分析情感趋势"})]}),ze.jsxs("div",{className:"grid grid-cols-6 grid-rows-3 gap-4 p-4 h-[calc(100vh-120px)]",children:[ze.jsx(ll,{title:"总讨论量",className:"col-span-1",children:ze.jsx(I_,{title:"今日总量",value:i0.totalPosts.toLocaleString(),trend:"up",trendValue:"+12.5%"})}),ze.jsx(ll,{title:"正面占比",className:"col-span-1",children:ze.jsx(I_,{title:"正面占比",value:`${i0.positiveRatio}%`,trend:"up",trendValue:"+3.2%"})}),ze.jsx(ll,{title:"负面占比",className:"col-span-1",children:ze.jsx(I_,{title:"负面占比",value:`${i0.negativeRatio}%`,trend:"down",trendValue:"-1.8%"})}),ze.jsx(ll,{title:"中性占比",className:"col-span-1",children:ze.jsx(I_,{title:"中性占比",value:`${i0.neutralRatio}%`,trend:"neutral",trendValue:"+0.3%"})}),ze.jsx(ll,{title:"情感分布",className:"col-span-2",children:ze.jsx(N9,{data:ede,type:"pie",height:180})}),ze.jsx(ll,{title:"事件地理分布 (L7引擎)",className:"col-span-4 row-span-2",children:ze.jsx(Wfe,{events:Kfe,onEventClick:e,height:350,enableCluster:!0,clusterRadius:80,minClusterSize:2})}),ze.jsx(ll,{title:"热点词汇",className:"col-span-2",children:ze.jsx($fe,{words:Qfe})}),ze.jsx(ll,{title:"实时舆情动态",className:"col-span-2",children:ze.jsx(Zfe,{data:Jfe,maxRows:6})})]})]})}const s2=i9({component:x9}),rde=jx({getParentRoute:()=>s2,path:"/",component:w9}),nde=jx({getParentRoute:()=>s2,path:"/dashboard",component:tde}),ide=s2.addChildren([rde,nde]),ade=h9({routeTree:ide,defaultPreload:"intent",scrollRestoration:!0}),i7=document.getElementById("root");if(!i7)throw new Error("Failed to find the root element");T9.createRoot(i7).render(ze.jsx(q.StrictMode,{children:ze.jsx(O8,{client:b9,children:ze.jsxs(A9,{children:[ze.jsx(m9,{router:ade}),!1]})})}));
//# sourceMappingURL=index-kvKdQ6cy.js.map
